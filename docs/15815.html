<html>
<head>
<title>Financial Companies Data Dashboard with Python and MongoDB Charts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¸¦æœ‰Pythonå’ŒMongoDBå›¾è¡¨çš„é‡‘èå…¬å¸æ•°æ®ä»ªè¡¨æ¿</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/financial-companies-data-dashboard-with-python-and-mongodb-charts-b23a48fcd7ed?source=collection_archive---------5-----------------------#2022-11-23">https://medium.com/geekculture/financial-companies-data-dashboard-with-python-and-mongodb-charts-b23a48fcd7ed?source=collection_archive---------5-----------------------#2022-11-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f327fdfd26097f6d6e8eada4cca29583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PYtDvAWsWC_NqF4I"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@techdailyca?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tech Daily</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="be5e" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">ä½œä¸ºä¸€åè‚¡ç¥¨æŠ•èµ„è€…ï¼Œæˆ‘ä¸€ç›´åœ¨å¯»æ‰¾æ–°çš„æ–¹æ³•æ¥æ”¹å–„æˆ‘çš„äº¤æ˜“ç­–ç•¥ã€‚æœ€é‡è¦çš„äº‹æƒ…ä¹‹ä¸€æ˜¯å¯¹æˆ‘æŠ•èµ„çš„å…¬å¸çš„è´¢åŠ¡çŠ¶å†µæœ‰ä¸€ä¸ªå¾ˆå¥½çš„äº†è§£ã€‚</h2><p id="c995" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">æˆ‘ä¸€ç›´åœ¨å¯»æ‰¾ä¸€ç§æ–¹æ³•æ¥è‡ªåŠ¨åŒ–è·å–æ•°æ®çš„è¿‡ç¨‹ï¼Œå¹¶åœ¨ä¸€ä¸ªæ•´æ´çš„ä»ªè¡¨æ¿ä¸­å¯è§†åŒ–å®ƒä»¬ã€‚</p><p id="a563" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><em class="kt">é‚£ä¹ˆï¼Œå¦‚ä½•è·å¾—æˆ‘çš„è‚¡ç¥¨çš„å…³é”®è´¢åŠ¡æŒ‡æ ‡ï¼Œå¹¶åœ¨ä»ªè¡¨æ¿ä¸­æ˜¾ç¤ºå‡ºæ¥å‘¢ï¼Ÿ</em></p><h2 id="0d74" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">ä»‹ç»</h2><p id="dd48" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•è·å¾—æˆ‘æŠ•èµ„çš„å…¬å¸çš„è´¢åŠ¡çŠ¶å†µï¼Œå¹¶ä½¿ç”¨<strong class="jv hj"> Pythonã€é›…è™è´¢ç»python APIå’ŒMongoDBå›¾è¡¨åœ¨ä»ªè¡¨æ¿ä¸Šå¯è§†åŒ–å®ƒä»¬ã€‚</strong></p><p id="8ad2" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">MongoDB Chartsæœ€é…·çš„ç‰¹æ€§ä¹‹ä¸€æ˜¯å¾ˆå®¹æ˜“åœ¨ç½‘é¡µä¸Šå…±äº«ï¼Œåªéœ€ç‚¹å‡»å‡ ä¸‹ï¼Œäº†è§£ä¸€ç‚¹htmlå’ŒCSSçŸ¥è¯†(ç¨åæˆ‘å°†å±•ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªç®€å•çš„HTMLé¡µé¢å¹¶åµŒå…¥Mongo Chartsä»ªè¡¨æ¿)ã€‚</p><p id="31fb" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj">è¿™ä¸ªé¡¹ç›®å¯ä»¥å®šä¹‰ä¸ºä¸€ä¸ªåŸºç¡€æ•°æ®å·¥ç¨‹é¡¹ç›®ã€‚è¯¥è„šæœ¬ç”±å…¸å‹çš„æ•°æ®å·¥ç¨‹ç®¡é“æˆ–ETL(æå–ã€è½¬æ¢ã€åŠ è½½)ç®¡é“æ„æˆã€‚</strong>ä½ å¯ä»¥åœ¨æˆ‘çš„<a class="ae iu" href="https://github.com/marcello-calabrese/financial_data_companies_mongo" rel="noopener ugc nofollow" target="_blank"> GitHub Repo </a>é‡Œæ‰¾åˆ°è¯¥é¡¹ç›®çš„ä»£ç ã€‚</p><p id="6eab" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">è¿™ä¸ªé¡¹ç›®çš„æœ€ç»ˆç»“æœæ˜¯ä¸€ä¸ªhtmlé¡µé¢ï¼Œæ˜¾ç¤ºä»ªè¡¨æ¿å¹¶ä»MongoDBå›¾è¡¨ä¸­è·å–æ•°æ®ã€‚ä»ªè¡¨æ¿æ¯å¤©éƒ½ä¼šæ›´æ–°æˆ‘æŠ•èµ„ç»„åˆä¸­å…¬å¸çš„æœ€æ–°è´¢åŠ¡çŠ¶å†µã€‚</p><figure class="kv kw kx ky fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/04dd0ba9d4a977f53d03909e70cb096c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jD06M5ZGsVffMsBwCBrzqg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Web page dashboard: image by author</figcaption></figure><h2 id="a567" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">è·å–æˆ‘äº¤æ˜“çš„å…¬å¸çš„è´¢åŠ¡ä¿¡æ¯</strong></h2><p id="dbc6" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªåä¸ºyfinanceçš„åº“å¯ä»¥å¸®åŠ©æˆ‘ä»¬è·å¾—è´¢åŠ¡æ•°æ®ã€‚</p><p id="b339" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">é€šè¿‡ç®€å•çš„ä»£ç è¯­æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ä¿¡æ¯ï¼Œå¦‚æœ€æ–°çš„è‚¡ä»·ï¼Œå¸‚å€¼ï¼Œæµ‹è¯•ï¼Œ52å‘¨çš„èŒƒå›´ï¼Œæ”¶ç›Šæ—¥æœŸï¼Œè‚¡æ¯æ”¶ç›Šç‡ï¼Œå¸‚ç›ˆç‡ç­‰ã€‚</p><p id="dc5b" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">æˆ‘å†³å®šè·å–æˆ‘çš„æŠ•èµ„ç»„åˆä¸­æ‰€æœ‰å…¬å¸çš„è´¢åŠ¡ä¿¡æ¯ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨äº‘ä¸­çš„æ•°æ®åº“ä¸­ï¼Œè€Œ<em class="kt"> MongoDB </em>æ˜¯è¿™ä¸ªé¡¹ç›®çš„å®Œç¾é€‰æ‹©ï¼Œå› ä¸ºå®ƒå…è´¹ä¸”æ˜“äºä½¿ç”¨(å…è´¹å±‚å…è®¸æ‚¨å­˜å‚¨512 MBçš„æ•°æ®)ã€‚</p><p id="1865" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">ç›®å‰æˆ‘æŠ•èµ„ç»„åˆä¸­çš„è‚¡ç¥¨æœ‰:</p><p id="4c44" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj"> -å¾®è½¯</strong></p><p id="8c39" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj"> -éº¦å½“åŠ³</strong></p><p id="f658" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj"> - IBM </strong></p><p id="0971" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj"> -çº¦ç¿°é€Š&amp;çº¦ç¿°é€Š</strong></p><p id="c571" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj"> -é”¡å®‰é“¶è¡Œ</strong></p><p id="2033" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">æˆ‘å†³å®šå°†è¿™äº›å…¬å¸çš„è´¢åŠ¡æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­:</p><p id="f808" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj"> -ç¬¦å·æˆ–è‚¡ç¥¨</strong></p><p id="3af8" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj"> -å…¬å¸åç§°</strong></p><p id="d152" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj"> -å…¬å¸æè¿°</strong></p><p id="004a" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj"> - PEæ¯”ç‡(å¸‚ç›ˆç‡)ï¼Œå¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯PEæ¯”ç‡ï¼Œå¯ä»¥åœ¨è¿™é‡Œ</strong><a class="ae iu" href="https://www.investopedia.com/terms/p/pe.asp" rel="noopener ugc nofollow" target="_blank"><strong class="jv hj"/></a>äº†è§£æ›´å¤š</p><p id="1f4e" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj"> -å…¬å¸åˆ†çº¢</strong></p><p id="56bd" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj"> -ç°é‡‘æµ</strong></p><p id="979f" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><em class="kt">ç°åœ¨è®©æˆ‘ä»¬è¿è¡Œä»£ç ï¼Œçœ‹çœ‹å¦‚ä½•è·å–æˆ‘çš„æŠ•èµ„ç»„åˆä¸­å…¬å¸çš„è´¢åŠ¡ä¿¡æ¯ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨MongoDBæ•°æ®åº“ä¸­ã€‚</em></p><h2 id="4467" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">åˆ›å»ºä¸€ä¸ªMongoDBå¸æˆ·</strong></h2><p id="8126" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">æˆ‘ä¸ä¼šè¯¦ç»†ä»‹ç»å¦‚ä½•åˆ›å»ºä¸€ä¸ªMongoDBå¸æˆ·ï¼Œä¸‹é¢çš„é“¾æ¥å°†å¸®åŠ©æ‚¨å®Œæˆè¿™ä¸ªè¿‡ç¨‹:</p><ul class=""><li id="ba44" class="kz la hi jv b jw ko ka kp jg lb jk lc jo ld kn le lf lg lh bi translated">åˆ›å»ºMongoDBå…è´¹è´¦å·:<a class="ae iu" href="https://www.mongodb.com/cloud/atlas" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a></li><li id="72c1" class="kz la hi jv b jw li ka lj jg lk jk ll jo lm kn le lf lg lh bi translated">åˆ›å»ºä¸€ä¸ªé›†ç¾¤:<a class="ae iu" href="https://docs.atlas.mongodb.com/tutorial/create-new-cluster/" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a></li><li id="6d26" class="kz la hi jv b jw li ka lj jg lk jk ll jo lm kn le lf lg lh bi translated">åˆ›å»ºä¸€ä¸ªæ•°æ®åº“å’Œä¸€ä¸ªé›†åˆ:<a class="ae iu" href="https://docs.atlas.mongodb.com/tutorial/create-new-database/" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a></li></ul><h2 id="383a" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">å¯¼å…¥åº“</strong></h2><p id="47bc" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">ä¸ºäº†å®¹æ˜“åœ°å¤åˆ¶æˆ‘çš„é¡¹ç›®ï¼Œæˆ‘åœ¨æˆ‘çš„GitHubå­˜å‚¨åº“ä¸­æä¾›äº†ä¸€ä¸ª<em class="kt"> requirements.txt </em>æ–‡ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…æ‰€æœ‰åº“:</p><pre class="kv kw kx ky fd ln lo lp bn lq lr bi"><span id="5a41" class="ls iw hi lo b be lt lu l lv lw">pip install -r requirements.txt</span></pre><p id="1fa9" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">åœ¨æ–°åˆ›å»ºçš„ç¯å¢ƒä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹å¹¶åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶â€œâ€ã€‚pyâ€œâ€ã€‚<strong class="jv hj">æˆ‘è°ƒç”¨äº†(ä½ å¯ä»¥åœ¨æˆ‘çš„å›è´­ä¸­çœ‹åˆ°)run_mongo.py </strong>ã€‚åœ¨æ­¤æ–‡ä»¶ä¸­ï¼Œæ‚¨éœ€è¦å¯¼å…¥ä»¥ä¸‹åº“:</p><pre class="kv kw kx ky fd ln lo lp bn lq lr bi"><span id="1897" class="ls iw hi lo b be lt lu l lv lw"># import main libraries<br/><br/>import pandas as pd # data manipulation<br/>import numpy as np # data manipulation<br/>import yfinance as yf # get financials of the companies<br/>import pymongo # connect to MongoDB<br/>from pymongo import MongoClient # connect to MongoDB<br/>import json # convert data to json</span></pre><h2 id="ea5f" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak"> ETLç®¡é“:æå–ã€è½¬æ¢ã€åŠ è½½</strong></h2><p id="7a8a" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">ç°åœ¨åœ¨<em class="kt">é‡Œã€‚py </em>æ–‡ä»¶ï¼Œæˆ‘ä»¬å°†åˆ›å»º<strong class="jv hj"> ETLç®¡é“æ¥ä»yahoo financeä¸­æå–æ•°æ®ï¼Œè½¬æ¢æ•°æ®å¹¶å°†æ•°æ®åŠ è½½åˆ°MongoDBä¸­ã€‚</strong></p><h2 id="e25d" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">ä»é›…è™è´¢ç»æå–å…¬å¸è´¢åŠ¡æ•°æ®</strong></h2><p id="13df" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">æå–å‡½æ•°<em class="kt"> extract_ticker() </em>è·å–æˆ‘çš„æŠ•èµ„ç»„åˆä¸­çš„å…¬å¸è‚¡ç¥¨ï¼Œåˆ›å»ºä¸€ä¸ªå­—å…¸æ¥å­˜å‚¨æ¯ä¸ªå…¬å¸çš„ä¸Šè¿°æ•°æ®ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨pandasæ•°æ®æ¡†æ¶ä¸­ã€‚è¯¥å‡½æ•°è¿”å›ç†ŠçŒ«æ•°æ®å¸§ã€‚</p><pre class="kv kw kx ky fd ln lo lp bn lq lr bi"><span id="14bc" class="ls iw hi lo b be lt lu l lv lw">def extract_ticker():<br/>    # extract the ticker data<br/>    <br/>    msft = yf.Ticker('MSFT')<br/>    zion = yf.Ticker('ZION')<br/>    ibm = yf.Ticker('IBM')<br/>    jnj = yf.Ticker('JNJ')<br/>    mcd = yf.Ticker('MCD')<br/>    # create a dictionary to store the data<br/>    dct2 = {'Company_name': [msft.info['longName'], zion.info['longName'], ibm.info['longName'], jnj.info['longName'], mcd.info['longName']],<br/>                    'Company_ticker': [msft.info['symbol'], zion.info['symbol'], ibm.info['symbol'], jnj.info['symbol'], mcd.info['symbol']],<br/>                    'Closed_price': [msft.info['previousClose'], zion.info['previousClose'], ibm.info['previousClose'], jnj.info['previousClose'], mcd.info['previousClose']],<br/>                    'Company_info': [msft.info['longBusinessSummary'], zion.info['longBusinessSummary'], ibm.info['longBusinessSummary'], jnj.info['longBusinessSummary'], mcd.info['longBusinessSummary']],<br/>                    'Company_PE': [msft.info['trailingPE'], zion.info['trailingPE'], ibm.info['trailingPE'], jnj.info['trailingPE'], mcd.info['trailingPE']],<br/>                    'Company_cash_flow': [msft.info['operatingCashflow'], zion.info['operatingCashflow'], ibm.info['operatingCashflow'], jnj.info['operatingCashflow'], mcd.info['freeCashflow']],<br/>                    'Company_dividend': [msft.info['dividendRate'], zion.info['dividendRate'], ibm.info['dividendRate'], jnj.info['dividendRate'], mcd.info['dividendRate']]}<br/>        <br/>    # create a dataframe to store the data<br/>    df = pd.DataFrame(dct2)<br/>    # return the dataframe<br/>    return df</span></pre><h2 id="dae4" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">è½¬æ¢æ•°æ®</strong></h2><p id="34e6" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">è½¬æ¢å‡½æ•°<em class="kt"> transform_data() </em>åº”ç”¨ä¸€ä¸ªå°çš„æ•°æ®æ¸…ç†ï¼Œå°†å€¼èˆå…¥åˆ°2ä¸ªå°æ•°ä½ï¼Œå¹¶å°†æ•°æ®è½¬æ¢ä¸ºç¨åå°†æ•°æ®åŠ è½½åˆ°MongoDBæ‰€éœ€çš„jsonæ ¼å¼ã€‚</p><pre class="kv kw kx ky fd ln lo lp bn lq lr bi"><span id="cea9" class="ls iw hi lo b be lt lu l lv lw">def transform_data():<br/>    # create a dataframe to store the data<br/>    df_transformed = extract_ticker() # call the extract function<br/>    # round the values of the dataset to 2 decimal places<br/>    df_transformed = df_transformed.round(2)<br/>    <br/>    # convert the dataframe into a json file<br/>    json_file = df_transformed.to_json('Data/yahoo_data.json' ,indent=4, orient='records')<br/>    return json_file</span></pre><h2 id="e239" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">å°†æ•°æ®åŠ è½½åˆ°MongoDB </strong></h2><p id="f194" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">åŠ è½½å‡½æ•°<em class="kt"> load_mongo() </em>å°†æ•°æ®åŠ è½½åˆ°MongoDBä¸­ã€‚è¯¥å‡½æ•°å°†è¿æ¥å­—ç¬¦ä¸²ã€æ•°æ®åº“åç§°ã€é›†åˆåç§°å’Œjsonæ–‡ä»¶ä½œä¸ºå‚æ•°ã€‚è¯¥å‡½æ•°è¿”å›åŠ è½½åˆ°MongoDBä¸­çš„æ•°æ®ã€‚</p><pre class="kv kw kx ky fd ln lo lp bn lq lr bi"><span id="78b8" class="ls iw hi lo b be lt lu l lv lw">def load_mongo():<br/>    # load the json file into mongodb<br/>    # create a client object<br/>    client = MongoClient('mongodb+srv://USER:PASSWORD@cluster0.ragcpnf.mongodb.net/?retryWrites=true&amp;w=majority') # insert your connection string and your personal user and password of your MongoDB account<br/>    # get a database named "stockdb"<br/>    db1 = client.stockdb<br/>    # get a collection named "yahoo_data_test_json"<br/>    collection_main = db1.stock_data<br/>    # load a json file into mongodb<br/>    with open('Data/yahoo_data.json') as file:<br/>        file_data = json.load(file)<br/>    # insert_many is used else insert_one is used<br/>    if isinstance(file_data, list):<br/>        # empty the collection<br/>        collection_main.delete_many({})<br/>        # insert the data into the collection<br/>        collection_main.insert_many(file_data)<br/>    else:<br/>        collection_main.insert_one(file_data)<br/>    return True</span></pre><h2 id="8ad9" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">è¿è¡ŒETLç®¡é“</strong></h2><p id="9f55" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">ä»£ç çš„æœ€åä¸€éƒ¨åˆ†æ˜¯è¿è¡ŒETLç®¡é“ã€‚ä¸‹é¢çš„ä»£ç è°ƒç”¨è¿™äº›å‡½æ•°å¹¶æ‰“å°ç»“æœã€‚</p><p id="837e" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">æˆ‘ä½¿ç”¨æ ‡å‡†çš„<em class="kt"> def main() </em>å‡½æ•°ä½œä¸ºæ‘„å–3ä¸ªETLå‡½æ•°çš„ä¸»è¦éƒ¨åˆ†ï¼Œå¹¶ä½¿ç”¨<em class="kt">if _ _ name _ _ = _ _ main _ _:</em>æ¥è¿è¡Œä»£ç ã€‚</p><pre class="kv kw kx ky fd ln lo lp bn lq lr bi"><span id="1a00" class="ls iw hi lo b be lt lu l lv lw">def main():<br/>    # call the extract function<br/>    #extract_ticker()<br/>    # call the transform function<br/>    transform_data()<br/>    # call the load function<br/>    load_mongo()<br/>    return True<br/><br/>### Run Layer ###<br/><br/>if __name__ == '__main__':<br/>    main()<br/>    print('Data has been extracted, transformed, saved in a json file and loaded into mongodb')</span></pre><h2 id="2201" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">MongoDBæ•°æ®åº“ï¼Œæˆ‘æŠ•èµ„ç»„åˆä¸­çš„å…¬å¸æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªé›†åˆä¸­</strong></h2><p id="1094" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">æ‰§è¡Œä»£ç åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨MongoDBæ•°æ®åº“ä¸­çœ‹åˆ°æ•°æ®ã€‚æˆ‘åˆ›å»ºäº†ä¸€ä¸ªåä¸º<em class="kt"> stockdb </em>çš„æ•°æ®åº“å’Œä¸€ä¸ªåä¸º<em class="kt"> stock_data </em>çš„é›†åˆã€‚æ•°æ®å­˜å‚¨åœ¨é›†åˆä¸­ã€‚æé†’ä¸€ä¸‹ï¼Œåœ¨MongoDBä¸­ï¼Œé›†åˆç±»ä¼¼äºå…³ç³»æ•°æ®åº“ä¸­çš„è¡¨ï¼Œæ–‡æ¡£ç±»ä¼¼äºå…³ç³»æ•°æ®åº“ä¸­çš„è¡Œã€‚</p><p id="7a2a" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj">è¯·çœ‹ä¸‹é¢MongoDBä¸­çš„æ•°æ®æˆªå›¾ã€‚</strong></p><figure class="kv kw kx ky fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/f06c5402eab8045038472cda2715252b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KB-vNDlvw_SpNzeoZvtA6Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">MongoDB Database with the data of the companies in my portfolio stored in a collection</figcaption></figure><p id="41a4" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">ä½ å¯ä»¥çœ‹åˆ°è¿™ä¸ªè„šæœ¬æ˜¯å¦‚ä½•æ•æ‰æˆ‘çš„æŠ•èµ„ç»„åˆä¸­çš„å…¬å¸çš„å…³é”®æŒ‡æ ‡çš„ã€‚å¯¹äºä»¥å‰ä»æœªä½¿ç”¨è¿‡MongoDBçš„äººæ¥è¯´ï¼Œè¿™äº›æ•°æ®çœ‹èµ·æ¥ç±»ä¼¼äºå­—å…¸åˆ—è¡¨ï¼Œä¸æˆ‘ä»¬åœ¨å…³ç³»æ•°æ®åº“ä¸­çœ‹åˆ°çš„æ•°æ®å®Œå…¨ä¸åŒã€‚</p><p id="0a00" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><em class="kt">å¤ªå¥½äº†ï¼æˆ‘ä»¬åœ¨MongoDBé‡Œæœ‰æ•°æ®ã€‚ç°åœ¨è®©æˆ‘ä»¬è®©è¿™äº›æ•°æ®çœ‹èµ·æ¥æœ‰æ„ä¹‰ã€‚</em></p><p id="65d6" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj">ç°åœ¨æˆ‘ä»¬å¼€å§‹é¡¹ç›®çš„ç¬¬äºŒä¸ªæœ‰è¶£éƒ¨åˆ†ï¼Œç”¨MongoDBå›¾è¡¨å®ç°MongoDBå†…éƒ¨çš„æ•°æ®å¯è§†åŒ–</strong>ğŸ˜ï¼</p><h2 id="c365" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak"> MongoDBå›¾è¡¨</strong></h2><p id="47f4" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">ç°åœ¨æˆ‘ä»¬å¼€å§‹è¿™ä¸ªé¡¹ç›®çš„ç¬¬äºŒä¸ªæœ‰è¶£çš„éƒ¨åˆ†ã€‚</p><p id="4675" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">æˆ‘å°†å‘æ‚¨å±•ç¤ºç”¨MongoDBå›¾è¡¨åˆ›å»ºä¸€ä¸ªä»ªè¡¨æ¿æœ‰å¤šç®€å•ï¼Œåªéœ€ç‚¹å‡»å‡ ä¸‹ï¼Œå¹¶ä½¿ç”¨æ‹–æ”¾å·¥å…·åœ¨è½´ä¸Šç»˜åˆ¶æ•°æ®ã€‚æ¯æ¬¡æ‰§è¡ŒETLç®¡é“æ—¶ï¼Œä»ªè¡¨æ¿éƒ½ä¼šè‡ªåŠ¨æ›´æ–°ã€‚ä»ªè¡¨æ¿å°†æ˜¾ç¤º6ä¸ªå›¾è¡¨ï¼Œå…¶ä¸­åŒ…å«æˆ‘æŠ•èµ„ç»„åˆä¸­å…¬å¸çš„å…³é”®æŒ‡æ ‡å’Œä¿¡æ¯ã€‚</p><h2 id="3fc7" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">åˆ›å»ºä»ªè¡¨æ¿</strong></h2><p id="1599" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ä»ªè¡¨æ¿ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å•å‡»â€œåˆ›å»ºä»ªè¡¨æ¿â€æŒ‰é’®ã€‚<strong class="jv hj">è¯·çœ‹ä¸‹é¢çš„çŸ­è§†é¢‘æ¼”ç¤ºã€‚</strong></p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="260f" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">å¯è§†åŒ–ç”±ä¸¤ä¸ªè¡¨ç»„æˆï¼Œåˆ†åˆ«æ˜¯å…¬å¸åç§°å’Œæè¿°ä»¥åŠå…¬å¸åç§°å’Œè‚¡ç¥¨ä»£ç ï¼Œå…¶ä½™çš„å›¾è¡¨æ˜¯ç®€å•çš„æ¡å½¢å›¾ï¼Œæ˜¾ç¤ºæˆ‘çš„æŠ•èµ„ç»„åˆä¸­å…¬å¸çš„å…³é”®æŒ‡æ ‡ã€‚</p><p id="f6b2" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj">è§ä¸‹é¢è§†é¢‘æ¼”ç¤ºçš„ç¬¬äºŒéƒ¨åˆ†ç»˜åˆ¶å›¾è¡¨ã€‚</strong></p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="ly lz l"/></div></figure><h2 id="9819" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">å¯¼å‡ºä»ªè¡¨ç›˜</strong></h2><p id="0c53" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">åˆ›å»ºä»ªè¡¨æ¿åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨iframeå·¥å…·å°†ä»ªè¡¨æ¿å¯¼å‡ºå¹¶åµŒå…¥åˆ°ç½‘é¡µä¸­ã€‚</p><p id="db1f" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj">çœ‹ä¸‹é¢çš„è§†é¢‘æ¼”ç¤ºã€‚</strong></p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="ly lz l"/></div></figure><h2 id="37ac" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">åµŒå…¥ä»ªè¡¨æ¿çš„åŸºæœ¬htmlé¡µé¢</strong></h2><p id="f545" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">æœ€åä¸€æ­¥æ˜¯åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„htmlé¡µé¢æ¥åµŒå…¥ä»ªè¡¨æ¿ã€‚ä½ å¯ä»¥åœ¨ã€githubèµ„æºåº“ã€‘(https://github . com/marcello-cala brese/financial _ data _ companies _ mongo/tree/main/html _ dashboard)å’Œä¸‹é¢æ‰¾åˆ°ä»£ç ã€‚æˆ‘ç”¨<a class="ae iu" href="https://getbootstrap.com/docs/5.2/getting-started/introduction/" rel="noopener ugc nofollow" target="_blank"> Bootstrap </a> CSSæ¡†æ¶åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„é¡µé¢ã€‚</p><p id="5684" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj">å‚è§ä¸‹é¢çš„htmlä»£ç :</strong></p><pre class="kv kw kx ky fd ln lo lp bn lq lr bi"><span id="dcde" class="ls iw hi lo b be lt lu l lv lw">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>    &lt;meta charset="UTF-8"&gt;<br/>    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;<br/>    &lt;!-- CSS only --&gt;<br/>    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous"&gt;<br/>    &lt;title&gt;Portfolio' Shares Financial Data Dashboard&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;div class="container-fluid"&gt;<br/>        &lt;div class="row"&gt;<br/>            &lt;div class="col-md-12"&gt;<br/>                &lt;h1&gt;Portfolio's Shares Financial Data Dashboard&lt;/h1&gt;<br/>            &lt;/div&gt;<br/>        &lt;/div&gt;<br/>        &lt;div class="row"&gt;<br/>            &lt;div class="col-md-12"&gt;<br/>                &lt;h2&gt;Embedded MongoDB Dashboard directly from MongoDB Charts just with the iframe tags&lt;/h2&gt;<br/>            &lt;/div&gt;<br/>        &lt;/div&gt;<br/>        &lt;div class="row"&gt;<br/>            <br/>                &lt;!-- Add the iframe code generated from MongoDB Charts--&gt;<br/>                &lt;iframe style="background: #F1F5F4;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2); height: 700px;"  src="https://charts.mongodb.com/charts-project-0-mohor/embed/dashboards?id=6379f795-14ab-4c8d-8ceb-051750764578&amp;theme=light&amp;autoRefresh=true&amp;maxDataAge=3600&amp;showTitleAndDesc=false&amp;scalingWidth=fixed&amp;scalingHeight=fixed"&gt;&lt;/iframe&gt;<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="85b5" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj">é¡µé¢çŸ­è§†é¢‘æ¼”ç¤ºå¦‚ä¸‹ã€‚</strong>ä¸è¦å¿˜è®°ç”¨MongoDBå›¾è¡¨ç”Ÿæˆçš„ä»£ç æ›´æ”¹iframeä»£ç ï¼Œæˆ‘å¿…é¡»æ‰‹åŠ¨å°†iframeä¸­çš„é«˜åº¦åƒç´ æ·»åŠ åˆ°700pxï¼Œä»¥ç¡®ä¿ä»ªè¡¨æ¿åœ¨æ•´ä¸ªhtmlé¡µé¢ä¸­å±•å¼€:</p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="ly lz l"/></div></figure><h2 id="541d" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><strong class="ak">ç»“è®º</strong></h2><p id="ef32" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å‘æ‚¨å±•ç¤ºäº†ä½¿ç”¨MongoDBå›¾è¡¨åˆ›å»ºä»ªè¡¨æ¿æ˜¯å¤šä¹ˆå®¹æ˜“ã€‚æˆ‘ä½¿ç”¨ETLç®¡é“ä»webä¸­æå–æ•°æ®ï¼Œè½¬æ¢æ•°æ®å¹¶å°†å…¶åŠ è½½åˆ°MongoDBä¸­ã€‚ç„¶åæˆ‘ç”¨MongoDBå›¾è¡¨åˆ›å»ºäº†ä¸€ä¸ªä»ªè¡¨æ¿ï¼Œå¹¶ç”¨iframeå·¥å…·å¯¼å‡ºäº†ä»ªè¡¨æ¿ï¼Œå°†å…¶åµŒå…¥åˆ°ä¸€ä¸ªåŸºæœ¬çš„htmlé¡µé¢ä¸­ã€‚</p><p id="a882" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated"><strong class="jv hj">æˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œå¹¶å­¦åˆ°ä¸€äº›æ–°ä¸œè¥¿ã€‚å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·åœ¨ä¸‹é¢çš„è¯„è®ºä¸­å‘Šè¯‰æˆ‘ã€‚æ„Ÿè°¢é˜…è¯»ï¼</strong></p></div><div class="ab cl ma mb gp mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="hb hc hd he hf"><h1 id="aa4b" class="mh iw hi bd ix mi mj mk jb ml mm mn jf mo mp mq jj mr ms mt jn mu mv mw jr mx bi translated">ä½œè€…:</h1><p id="6e6b" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn hb bi translated">æˆ‘å†™å…³äºæ•°æ®ç§‘å­¦ã€pythonç¼–ç é¡¹ç›®å’Œæ•°æ®é©±åŠ¨è¥é”€çš„æ–‡ç« ã€‚æˆ‘è¿˜ä¸ºæ•°æ®æ–°æ‰‹æˆ–æ•°æ®å…¥é—¨è€…æä¾›æ•°æ®å’Œä¸šåŠ¡æŒ‡å¯¼ã€‚</p><p id="692e" class="pw-post-body-paragraph jt ju hi jv b jw ko jy jz ka kp kc kd jg kq kf kg jk kr ki kj jo ks kl km kn hb bi translated">ä½ å¯ä»¥åœ¨<a class="ae iu" rel="noopener" href="/@Marcello_Dichiera">åª’ä½“</a>å’Œ<a class="ae iu" href="https://twitter.com/ItalyMarcello" rel="noopener ugc nofollow" target="_blank">æ¨ç‰¹</a>ä¸Šå…³æ³¨æˆ‘ï¼Œæˆ–è€…è®¿é—®æˆ‘çš„<a class="ae iu" href="https://marcello-personal-website.netlify.app/" rel="noopener ugc nofollow" target="_blank">ç½‘ç«™</a>å’Œ<a class="ae iu" href="https://github.com/marcello-calabrese" rel="noopener ugc nofollow" target="_blank"> Githubé¡µé¢</a>ã€‚</p></div></div>    
</body>
</html>