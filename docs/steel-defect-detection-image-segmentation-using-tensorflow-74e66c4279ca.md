# é’¢é“ç¼ºé™·æ£€æµ‹â€”â€”å¼ é‡æµå›¾åƒåˆ†å‰²

> åŸæ–‡ï¼š<https://medium.com/geekculture/steel-defect-detection-image-segmentation-using-tensorflow-74e66c4279ca?source=collection_archive---------9----------------------->

![](img/4ccd17d6a6ce7e8db2d4b984a776424e.png)

[Severstal: Steel Defect Detection](https://www.kaggle.com/c/severstal-steel-defect-detection)

# å•†ä¸šé—®é¢˜

> [é’¢é“ç¼ºé™·æ£€æµ‹](https://www.kaggle.com/c/severstal-steel-defect-detection)æ˜¯ç”±æœ€å¤§çš„é’¢é“åˆ¶é€ å…¬å¸ä¹‹ä¸€[è°¢éŸ¦å°”é’¢é“å…¬å¸](https://www.severstal.com/eng/)åœ¨ Kaggle ä¸¾åŠçš„ç«èµ›ã€‚å› ä¸ºå¹³æ¿é’¢æ¿çš„ç”Ÿäº§è¿‡ç¨‹åŒ…æ‹¬è®¸å¤šå­è¿‡ç¨‹ï¼Œåœ¨è¿™äº›å­è¿‡ç¨‹ä¸­ï¼Œå¹³æ¿é’¢æ¿åœ¨å‡†å¤‡è£…è¿ä¹‹å‰å¿…é¡»æ¥è§¦å‡ å°æœºå™¨ã€‚å› æ­¤ï¼Œè°¢éŸ¦å°”é’¢é“å…¬å¸æ­£åœ¨ä½¿ç”¨æ¥è‡ªé«˜é¢‘æ‘„åƒå¤´çš„å›¾åƒæ¥é©±åŠ¨ç¼ºé™·æ£€æµ‹ç®—æ³•ã€‚é€šè¿‡è¿™æ¬¡æ¯”èµ›ï¼Œè°¢éŸ¦å°”é’¢é“å…¬å¸å¸Œæœ›å‚èµ›è€…é€šè¿‡å¯¹é’¢æ¿è¡¨é¢ç¼ºé™·è¿›è¡Œå®šä½å’Œåˆ†ç±»æ¥æ”¹è¿›ç®—æ³•ã€‚
> 
> æœ¬æ¬¡æ¯”èµ›çš„ç›®çš„æ˜¯ä½¿ç”¨æä¾›çš„å›¾åƒé¢„æµ‹é’¢é“åˆ¶é€ ä¸­å‘ç°çš„ç¼ºé™·çš„ä½ç½®å’Œç±»å‹ã€‚

# æ•°æ®é›†è¯¦ç»†ä¿¡æ¯

```
-Data
  |- sample_submission.csv
  |- train.csv
  |- test_images/
        |- 5506 nos. of .jpg files
  |- train_images/
        |- 12568 nos. of .jpg files
```

> ä¸º 18074 å¼ (12568 å¼ è®­ç»ƒå›¾åƒå’Œ 5506 å¼ æµ‹è¯•å›¾åƒ)å›¾åƒæä¾›å”¯ä¸€çš„å›¾åƒ IDã€‚æ¯ä¸ªå›¾åƒå¯ä»¥æ²¡æœ‰ç¼ºé™·ã€å•ä¸€ç§ç±»çš„ç¼ºé™·æˆ–å¤šç§ç±»çš„ç¼ºé™·ã€‚æœ‰å››ç±»ç¼ºé™·ã€‚
> 
> é™¤äº† train å’Œ test images æ–‡ä»¶å¤¹ï¼Œè¿˜æä¾›äº† train.csvï¼Œå…¶ä¸­åŒ…å«å…³äºç¼ºé™·ç±»å‹åŠå…¶å„è‡ªåœ¨ train images ä¸­çš„ä½ç½®çš„ä¿¡æ¯ã€‚train.csv çš„è¿™äº›æ•°æ®ç‚¹(7095 ä¸ª)ç»™å‡ºäº†ç¼ºé™·å›¾åƒçš„è¯¦ç»†ä¿¡æ¯(6666 ä¸ªå”¯ä¸€ id)ã€‚
> 
> train.csv çš„ 3 åˆ—æ˜¯ ImageIdã€ClassId å’Œ EncodedPixels:
> 
> i. ImageId:æ¯ä¸ªå›¾åƒçš„å”¯ä¸€ Idã€‚
> 
> äºŒã€‚ClassId:å›¾åƒåœ¨ EncodedPixels åˆ—ä¸­æåˆ°çš„åƒç´ ä½ç½®ä¸Šçš„ç¼ºé™·çš„ç±»å‹/ç±»åˆ« Idã€‚
> 
> ä¸‰ã€‚EncodedPixels:è¯¥åˆ—ç»™å‡ºäº†å›¾åƒä¸­ç¼ºé™·çš„åƒç´ ä½ç½®ä¿¡æ¯ã€‚ç¼ºé™·åƒç´ ä½ç½®åˆ—è¡¨è¢«ç¼–ç æˆå€¼å¯¹åˆ—è¡¨(æ¯å¯¹çš„ç¬¬ä¸€ä¸ªå€¼ä»£è¡¨èµ·å§‹ä½ç½®ï¼Œç¬¬äºŒä¸ªå€¼ä»£è¡¨å…¶æ¸¸ç¨‹é•¿åº¦)ä»¥å‡å°æ–‡ä»¶å¤§å°ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œäº†è§£æ›´å¤šå…³äº[çš„ä¿¡æ¯ã€‚](https://www.kaggle.com/c/severstal-steel-defect-detection/overview/evaluation)
> 
> train.csv å‰å‡ è¡Œçš„å¿«ç…§è§†å›¾:

```
ImageId,ClassId,EncodedPixels
0002cc93b.jpg,1,29102 12 29346 24 29602 24 ....... 192843 23 193099 14 193355 5
0007a71bf.jpg,3,18661 28 18863 82 19091 110 ..... 298245 251 298564 188 298945 63
000a4bcdd.jpg,1,37607 3 37858 8 38108 14 38359 20 ..... 117576 27 117843 16 118109 6
000f6bf48.jpg,4,131973 1 132228 4 132483 6 132738 8 .... 289263 2 289519 2 289776 1
```

# å°†ç°å®ä¸–ç•Œçš„é—®é¢˜æ˜ å°„åˆ° ML é—®é¢˜

è¿™æ˜¯ä¸€ä¸ªå›¾åƒåˆ†å‰²é—®é¢˜ï¼Œå¯¹äºç»™å®šçš„å›¾åƒï¼Œæˆ‘ä»¬éœ€è¦æ£€æµ‹å’Œå®šä½é’¢æ¿ä¸­çš„ç¼ºé™·ã€‚

è¿™åœºæ¯”èµ›æ˜¯æ ¹æ®å¹³å‡[éª°å­ç³»æ•°](https://en.wikipedia.org/wiki/S%C3%B8rensen%E2%80%93Dice_coefficient)æ¥è¯„ä¼°çš„ã€‚Dice ç³»æ•°å¯ç”¨äºæ¯”è¾ƒé¢„æµ‹çš„åˆ†å‰²ä¸å…¶å¯¹åº”çš„åŸºæœ¬äº‹å®ä¹‹é—´çš„é€åƒç´ ä¸€è‡´æ€§ã€‚è¯¥å…¬å¼ç”±ä¸‹å¼ç»™å‡º:

![](img/40aa29939d942be30f29706ec40741e1.png)

Dice Coefficient Formulation

å…¶ä¸­ X æ˜¯é¢„æµ‹çš„åƒç´ ç»„ï¼ŒY æ˜¯åœ°é¢å®å†µã€‚å½“ X å’Œ Y éƒ½ä¸ºç©ºæ—¶ï¼ŒDice ç³»æ•°å®šä¹‰ä¸º 1ã€‚

# ç°æœ‰æ–¹æ³•

**ã€1ã€‘ã€‚** [**å»ºç«‹æ¨¡å‹åˆ†ç±»é¢„æµ‹é’¢æä¸­çš„ç¼ºé™·**](/analytics-vidhya/severstal-steel-defect-detection-5e5b50fe21ce) **:**

*   ç”¨äºŒè¿›åˆ¶åˆ†ç±»å™¨è®­ç»ƒå…¨éƒ¨æ•°æ®ï¼Œä»¥å¯¹æœ‰ç¼ºé™·å’Œæ— ç¼ºé™·çš„çº¸å¼ å›¾åƒè¿›è¡Œåˆ†ç±»ã€‚å¯¹äºå¤šæ ‡ç­¾åˆ†ç±»å™¨ï¼Œåªæœ‰ç¼ºé™·å›¾åƒç”¨äºè®­ç»ƒã€‚è¿™ç§å¤šæ ‡ç­¾åˆ†ç±»å™¨è´Ÿè´£ç»™æ¯å¹…å›¾åƒæ ‡æ³¨å…¶æ‰€å…·æœ‰çš„ç¼ºé™·ç±»å‹ã€‚ä¸ºæ¯ç§ç¼ºé™·ç±»å‹è®­ç»ƒå››ä¸ªå•ç‹¬çš„åˆ†å‰²æ¨¡å‹ã€‚æ ‡è®°æœ‰ç¼ºé™·ç±»å‹çš„å›¾åƒè¢«ä¼ é€’åˆ°ç›¸åº”çš„ç¼ºé™·ç±»å‹åˆ†å‰²æ¨¡å‹è¿›è¡Œåˆ†å‰²ã€‚
*   å¯¹äºäºŒè¿›åˆ¶å’Œå¤šæ ‡ç­¾åˆ†ç±»ï¼Œä½¿ç”¨ç”± Keras é¢„å…ˆè®­ç»ƒçš„ InceptionResNetV2()æ¨¡å‹ï¼Œå¹¶ä¸”ä»å›¾åƒç½‘ç»œæ•°æ®è®­ç»ƒæƒé‡ã€‚å¹¶ä¸”ä½¿ç”¨äº†æ¥è‡ª [quvbel](https://github.com/qubvel) â€”ä»¥ resnet34 ä¸ºä¸»å¹²çš„ U-Net çš„é¢„å…ˆè®­ç»ƒå¥½çš„åˆ†å‰²æ¨¡å‹ã€‚

**ã€2ã€‘ã€‚** [**é’¢æç¼ºé™·æ£€æµ‹:ä½¿ç”¨ Keras è¿›è¡Œå›¾åƒåˆ†å‰²**](/@guildbilla/steel-defect-detection-image-segmentation-using-keras-dae8b4f986f0) **:**

*   è¿™ä¸ªè§£å†³æ–¹æ¡ˆæµç¨‹ç±»ä¼¼äº[1]ã€‚
*   å¯¹äºäºŒå…ƒå’Œå¤šæ ‡ç­¾åˆ†ç±»ï¼Œä½¿ç”¨æ¥è‡ª Keras çš„é¢„è®­ç»ƒæ¨¡å‹â€” [ä¾‹å¤–](https://keras.io/applications/#xception)ã€‚å’Œ U-Net çš„ efficientnetb1 ä¸»å¹²ç”¨äºç»†åˆ†æ¨¡å‹ã€‚
*   éª°å­ç³»æ•°(ç§åˆ†):0.88428ã€‚

**ã€3ã€‘ã€‚** [**åˆ©ç”¨å®Œå…¨å·ç§¯ç½‘ç»œè¿›è¡Œè¯­ä¹‰å›¾åƒåˆ†å‰²**](https://towardsdatascience.com/semantic-image-segmentation-using-fully-convolutional-networks-bf0189fa3eb8) **:**

*   åœ¨è¿™ä¸ªè§£å†³æ–¹æ¡ˆä¸­ï¼ŒäºŒè¿›åˆ¶å’Œå¤šæ ‡è®°åˆ†ç±»å™¨ä¸åƒ[1]å’Œ[2]é‚£æ ·åŒ…æ‹¬åœ¨æµæ°´çº¿ä¸­ã€‚æ•°æ®(ä½œä¸º X çš„çº¸å¼ å›¾åƒå’Œä½œä¸º Y çš„å¯¹åº”äº 4 ä¸ªç±»åˆ«çš„æ©æ¨¡å›¾åƒ)è¢«ç›´æ¥é¦ˆé€åˆ°ä»…ä»…ä¸€ä¸ªåˆ†å‰²æ¨¡å‹ã€‚
*   å°è¯•äº†ä¸¤ç§ç»†åˆ†æ¨¡å‹:U-Net & Deeplab V3+ã€‚Deeplab V3+è¡¨ç°ä¸é”™ï¼Œdice ç³»æ•°(ç§åˆ†)0.83763ã€‚
*   åœ¨æ­¤è§£å†³æ–¹æ¡ˆä¸­å®ç°çš„ U-Net æ¨¡å‹å‡å°‘äº†è¿‡æ»¤å™¨çš„æ•°é‡ï¼Œå¹¶ä¸”ç”¨åŸå§‹å›¾åƒçš„ä¸€åŠæ¥è®­ç»ƒæ¨¡å‹ï¼Œä»¥å‡å°‘è®¡ç®—å¹¶æ›´å¿«åœ°è®­ç»ƒæ¨¡å‹ã€‚å³ä½¿åœ¨ Deeplab V3+æ¶æ„ä¸Šä¹Ÿåšäº†ä¸€äº›ä¿®æ”¹ã€‚

**ã€4ã€‘ã€‚** [**è°¢éŸ¦å°”é’¢é“(Severstal)è¯¦ç»†æ¡ˆä¾‹åˆ†æ:é’¢é“ç¼ºé™·æ£€æµ‹ï¼Œèƒ½å¦å¯¹é’¢é“ä¸­çš„ç¼ºé™·è¿›è¡Œæ£€æµ‹å’Œåˆ†ç±»ï¼Ÿâ€”ä»åˆçº§åˆ°é«˜çº§ï¼**](/@saivenkat_/a-detailed-case-study-on-severstal-steel-defect-detection-can-we-detect-and-classify-defects-in-2844402392cc) **:**

*   åœ¨è¯¥è§£å†³æ–¹æ¡ˆä¸­ï¼Œæµæ°´çº¿æµç¨‹ä¸[3]ç›¸åŒï¼Œå³æ•´ä¸ªæ•°æ®è¢«é€å…¥ä¸€ä¸ªåˆ†å‰²æ¨¡å‹è¿›è¡Œåˆ†å‰²ã€‚ä»¥ä¸»å¹² resnet34 ä¸ºåˆ†å‰²æ¨¡å‹çš„ U-Net å¯¼è‡´ dice ç³»æ•°(ç§äººå¾—åˆ†)ä¸º 0.90305ã€‚

**ã€5ã€‘ã€‚** [**é’¢æç¼ºé™·æ£€æµ‹:ä½¿ç”¨ Keras å’Œ Tensorflow è¿›è¡Œå›¾åƒåˆ†å‰²**](/@gargishan209/detection-of-steel-defects-image-segmentation-using-keras-and-tensorflow-37e8ae8aabe8) **:**

*   åœ¨è¿™ä¸ªè§£å†³æ–¹æ¡ˆä¸­ï¼Œæµç¨‹ç®¡é“ä»…ç”±ä¸¤ä¸ªæ¨¡å‹ç»„æˆã€‚ä¸€ä¸ªäºŒå…ƒåˆ†ç±»å™¨ï¼Œç”¨äºå°†çº¸å¼ å›¾åƒåˆ†ç±»ä¸ºæœ‰ç¼ºé™·/æ— ç¼ºé™·ç±»åˆ«ï¼Œä¸€ä¸ªåˆ†å‰²æ¨¡å‹ç”¨äºæ‰€æœ‰ 4 ä¸ªç¼ºé™·ç±»åˆ«ã€‚åªæœ‰æœ‰ç¼ºé™·çš„çº¸å¼ å›¾åƒç”¨äºè®­ç»ƒåˆ†å‰²æ¨¡å‹ã€‚
*   å¯¹äºäºŒå…ƒåˆ†ç±»ï¼Œä½¿ç”¨å¼‚å¸¸æ¨¡å‹ä»¥åŠä»å›¾åƒç½‘ç»œæ•°æ®è®­ç»ƒçš„æƒé‡ã€‚å¯¹äºåˆ†å‰²æ¨¡å‹ï¼Œä½¿ç”¨å…·æœ‰ EfficientNetB5 ä¸»å¹²æ¨¡å‹çš„ Unet æ¶æ„ä»¥åŠä» image-net æ•°æ®è®­ç»ƒçš„æƒé‡ã€‚

# ç”µå­è®¾è®¡è‡ªåŠ¨åŒ–(Electronic Design Automation)

ä» EDA å¯ä»¥æ¸…æ¥šåœ°çœ‹å‡ºï¼Œè¿™äº›æœ‰ç¼ºé™·çš„æ•°æ®ç‚¹æ˜¯é«˜åº¦ä¸å¹³è¡¡çš„ã€‚

*   å¤§å¤šæ•°æ•°æ®ç‚¹(72.6%)å±äº class id-3ã€‚å’Œ ClassId-1 & 2 çš„ä»½é¢å‡ ä¹ç›¸ç­‰(åˆ†åˆ«ä¸º 12.6%å’Œ 11.3%)ã€‚
*   ClassId-2 çš„æ•°æ®ç‚¹åœ¨æ‰€æœ‰æ•°æ®ç‚¹ä¸­çš„ä»½é¢æœ€ä½ã€‚

**æ˜¾ç¤ºä¸€äº›æœ‰ç¼ºé™·çš„å›¾åƒ:**

![](img/60fa86986b6fefbda826c0e885a95987.png)

**æ˜¾ç¤ºä¸€äº›æ— ç¼ºé™·å›¾åƒ:**

![](img/f21a2cf1b7a67f8becaafe4acd363905.png)

çœ‹èµ·æ¥ï¼Œç”šè‡³æ¥è‡ªéç¼ºé™·é›†(ä¸åœ¨ train.csv ä¸­çš„ ImgaeIds)çš„ä¸€äº›å›¾åƒä¹Ÿæœ‰ç¼ºé™·ã€‚ä¹Ÿè®¸è¿™äº›ç¼ºé™·ç±»ä¸åœ¨ ClassIdsï¼Œ2ï¼Œ3ï¼Œ4]ä¸­ã€‚

# ç¬¬ä¸€æ¬¡åˆ‡å‰²æº¶æ¶²

*   æˆ‘ä¼šå°è¯•å•æ¨¡å‹ç®¡é“(4 æ ‡ç­¾åˆ†å‰²åªæœ‰ä¸€ä¸ªåˆ†å‰²æ¨¡å‹)ï¼Œå¦‚[3] & [4]ã€‚
*   è€ƒè™‘åˆ° U-Net ä½œä¸ºä¸€ä¸ªåŸºæœ¬æ¨¡å‹ï¼Œæˆ‘ä¹Ÿä¼šå°è¯•ä»»ä½•å…¶ä»–å¯ç”¨çš„æ¶æ„(LinkNetï¼ŒFPN å’Œ PSPNet)ã€‚æˆ‘è¿˜ä¼šé€šè¿‡æ›¿æ¢è¿™äº›æ¶æ„å¯ç”¨ä¸»å¹²æ¨¡å‹æ¥å°è¯•å…¶ä»–å˜åŒ–ã€‚
*   æˆ‘ä¹Ÿä¼šå¯¹è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ä½¿ç”¨æ•°æ®æ‰©å……æŠ€æœ¯ã€‚

# æ•°æ®å‡†å¤‡å’ŒåŸ¹è®­éªŒè¯åˆ†ç¦»

æˆ‘ä»¬å¯¹æä¾›çš„ train.csv è¿›è¡Œäº†æ ¼å¼åŒ–ï¼Œä»¥ä¾¿æ¯ä¸€è¡Œéƒ½åŒ…å« ImageId åŠå…¶å¯¹åº”çš„æ‰€æœ‰ 4 ä¸ªç¼ºé™·ç±»çš„æ©ç ç¼–ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•—
â•‘    ImageId    â•‘    rle_1     â•‘ rle_2 â•‘    rle_3     â•‘ rle_4 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•£
â•‘ 0002cc93b.jpg â•‘ 29102 12 ... â•‘       â•‘              â•‘       â•‘
â•‘ 00031f466.jpg â•‘              â•‘       â•‘              â•‘       â•‘
â•‘ 0007a71bf.jpg â•‘              â•‘       â•‘ 18661 28 ... â•‘       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•
```

æ•´ä¸ªæ•°æ®ä»¥ 85:15 çš„æ¯”ä¾‹éšæœºåˆ†å‰²ï¼Œåˆ†åˆ«ç”¨äºè®­ç»ƒå’ŒéªŒè¯ã€‚

# æ·±åº¦å­¦ä¹ æ¨¡å‹/æ¶æ„

# 1.ä¼˜ä¿¡ç½‘

è¿™ä¸ª [U-Net](https://arxiv.org/abs/1505.04597) æ¶æ„æœ€åˆæ˜¯ä¸ºç”Ÿç‰©åŒ»å­¦å›¾åƒåˆ†å‰²è€Œå¼€å‘çš„ã€‚è¿™ä¸ªæ¶æ„ä¸»è¦åŒ…å«ä¸¤æ¡è·¯å¾„:ç¼–ç å™¨è·¯å¾„&è§£ç å™¨è·¯å¾„ã€‚è€Œæ¯ä¸€çº§ç¼–ç å™¨&è§£ç å™¨ä¹‹é—´çš„è¿æ¥æ˜¯è¿™ç§æ¶æ„çš„å…³é”®ç‰¹å¾ã€‚

![](img/4bdb8781cb7bf773b2bd7be35cf2576c.png)

Architecture: U-Net

ç¼–ç å™¨è·¯å¾„(æˆ–æ”¶ç¼©è·¯å¾„)æ˜¯å·ç§¯å’Œæœ€å¤§æ± å±‚çš„å †æ ˆï¼Œæœ‰åŠ©äºæ•æ‰å›¾åƒä¸­çš„ä¸Šä¸‹æ–‡ã€‚è§£ç å™¨è·¯å¾„(æˆ–æ‰©å±•è·¯å¾„)æ˜¯è½¬ç½®å·ç§¯å’Œå·ç§¯å±‚ï¼Œè¿™æœ‰åŠ©äºå®šä½æ•è·çš„ä¸Šä¸‹æ–‡(åœ¨ç¼–ç å™¨è·¯å¾„ä¸­)ã€‚

é€šè¿‡æ¯ä¸€çº§çš„ç¼–ç å™¨å’Œè§£ç å™¨ä¹‹é—´çš„é‚£äº›è¿æ¥ï¼Œä¼ é€’é‚£äº›ç¼–ç å™¨å—çš„è¾“å‡ºï¼Œå¹¶å°†å®ƒä»¬è¿æ¥åˆ°è§£ç å™¨å—çš„è¾“å…¥å¼ é‡ã€‚è¿™æœ‰åŠ©äºé‡å»ºå›¾åƒï¼Œå¹¶ä½¿å…¶ä¸å›¾åƒçš„åŸå§‹å¤§å°ç›¸åŒ¹é…ã€‚

ä½¿ç”¨ [TensorFlow](https://www.tensorflow.org/) å®ç°äº† U-Net æ¶æ„(å‚è€ƒä½œå“ [U-Net:ç”¨äºç”Ÿç‰©åŒ»å­¦å›¾åƒåˆ†å‰²çš„å·ç§¯ç½‘ç»œ](https://arxiv.org/abs/1505.04597))ï¼Œå¦‚ä¸‹æ‰€ç¤º:

# 2.LinkNet

è¿™ä¸ª [LinkNet](https://arxiv.org/abs/1707.03718) æ¶æ„å‡ ä¹å’Œ U-Net å·®ä¸å¤šï¼Œåªæ˜¯ç¨åŠ ä¿®æ”¹ã€‚ç¼–ç å™¨å’Œè§£ç å™¨è·¯å¾„ç»“æ„ä¸ U-Net ä¸­çš„ç›¸åŒã€‚ä½†æ˜¯ç¼–ç å™¨å—çš„è¾“å‡ºåœ¨é€šè¿‡è¿æ¥ä¹‹åè¢«æ·»åŠ (åœ¨ U-Net çš„æƒ…å†µä¸‹æ˜¯çº§è”)åˆ°è§£ç å™¨å—çš„è¾“å…¥å¼ é‡ã€‚

![](img/25d7d02d70701eaa3bd2690fd1a55e4a.png)

Architecture: LinkNet

åœ¨è¿™é‡Œï¼Œå¯è®­ç»ƒå‚æ•°çš„æ•°é‡å‡å°‘äº†ï¼Œæ‰€ä»¥ä¸ U-Net ç›¸æ¯”ï¼ŒLinkNet æ˜¯ä¸€ä¸ªé‡é‡æ›´è½»çš„ç½‘ç»œã€‚

ä½¿ç”¨ [TensorFlow](https://www.tensorflow.org/) å®ç° LinkNet æ¶æ„(å‚è€ƒä½œå“ [LinkNet:åˆ©ç”¨ç¼–ç å™¨è¡¨ç¤ºè¿›è¡Œé«˜æ•ˆè¯­ä¹‰åˆ†å‰²](https://arxiv.org/abs/1707.03718)),å¦‚ä¸‹æ‰€ç¤º:

# 3.å¸¦æœ‰ ResNet ä¸»å¹²ç½‘çš„ U-Net

åœ¨è¿™ç§æ¶æ„ä¸­ï¼Œæˆ‘ä»¬å°† U-Net æ¶æ„çš„æ¯ä¸ªç¼–ç å™¨å’Œè§£ç å™¨æ¨¡å—ä¸­çš„ç®€å•å·ç§¯æ›¿æ¢ä¸ºå‰©ä½™æ¨¡å—ï¼Œå³åœ¨æ¯ä¸ªæ¨¡å—ä¸­æ·»åŠ è·³è¿‡è¿æ¥ã€‚

è¯·å‚è€ƒè¿™ç¯‡æ–‡ç« æ¥ç†è§£å¹¶æ›´å¥½åœ°äº†è§£è¿™ä¸ªæ¶æ„:[ä½¿ç”¨ ResBlock è¿›è¡Œè¯­ä¹‰åˆ†æ®µçš„ UNet](/@nishanksingla/unet-with-resblock-for-semantic-segmentation-dd1766b4ff66)ã€‚

![](img/a591d9b97293801cf07cd340fa6bb713.png)

Architecture: U-Net with ResNet Backbone

å®æ–½(ä½¿ç”¨ [TensorFlow](https://www.tensorflow.org/) )æ­¤æ¶æ„ï¼Œå°† UNet æ¶æ„ä¸­çš„ conv2D_block æ›¿æ¢ä¸º ResBlockï¼Œå¦‚ä¸‹æ‰€ç¤º:

# 4.å¸¦æœ‰ ResNet ä¸»å¹²ç½‘çš„ LinkNet

åœ¨è¿™ç§æ¶æ„ä¸­ï¼Œæˆ‘ä»¬å°† LinkNet æ¶æ„çš„æ¯ä¸ªç¼–ç å™¨&è§£ç å™¨æ¨¡å—ä¸­çš„ç®€å•å·ç§¯æ›¿æ¢ä¸ºå‰©ä½™æ¨¡å—(ä¸ ResNet ä¸»å¹²çš„ *U-Net ç›¸åŒ),å³åœ¨æ¯ä¸ªæ¨¡å—ä¸­æ·»åŠ è·³è¿‡è¿æ¥ã€‚*

![](img/e46e823a3245ea742af0a55661777019.png)

Architecture: LinkNet with ResNet Backbone

é€šè¿‡å°† LinkNet æ¶æ„ä¸­çš„ conv2D_block æ›¿æ¢ä¸º ResBlock æ¥å®ç°(ä½¿ç”¨ [TensorFlow](https://www.tensorflow.org/) )è¯¥æ¶æ„ï¼Œå¦‚ä¸‹æ‰€ç¤º:

# 5.U-Net++

å‚è€ƒå·¥ä½œ [UNet++:ä¸€ç§ç”¨äºåŒ»å­¦å›¾åƒåˆ†å‰²çš„åµŒå¥— U-Net æ¶æ„](https://arxiv.org/abs/1807.10165)ï¼Œå®ç°äº† U-Net++æ¶æ„ã€‚è¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å›¾åƒåˆ†å‰²æ¶æ„ã€‚

åœ¨è¿™ç§æ¶æ„ä¸­ï¼Œæˆ‘ä»¬åœ¨ç¼–ç å™¨è·¯å¾„çš„æ¯ä¸€å±‚ç”Ÿæˆè§£ç å™¨è·¯å¾„ã€‚å¹¶ä¸”æˆ‘ä»¬åœ¨æ¯ä¸€å±‚çš„æ‰€æœ‰å—ä¹‹é—´è¿›è¡Œè·³è·ƒè¿æ¥ã€‚è¿™äº›æœ‰åŠ©äºå‡å°‘ç¼–ç å™¨è·¯å¾„å’Œè§£ç å™¨å­è·¯å¾„ä¹‹é—´çš„è¯­ä¹‰å·®è·ã€‚

![](img/166dd8d7a771f6926f131751083836bc.png)

Architecture: UNet++

ä½¿ç”¨ [TensorFlow](https://www.tensorflow.org/) å®ç°äº† U-Net++æ¶æ„ï¼Œå¦‚ä¸‹æ‰€ç¤º:

ä½¿ç”¨è¿™äº›ç¼–è¯‘é…ç½®å¯¹ä¸Šè¿°æ¯ä¸ªæ¨¡å‹è¿›è¡Œ 60 ä¸ªæ—¶æœŸçš„è®­ç»ƒ:

```
loss: binary_crossentropy + dice_loss
optimizer: tensorflow.keras.optimizers.Adam()
metrics: dice_coefficient
```

# ç»“æœå’Œæ€§èƒ½æ¯”è¾ƒ

æ¯ä¸ªç»è¿‡è®­ç»ƒçš„æ¨¡å‹éƒ½è¢«ä¸Šä¼ åˆ° Kaggleï¼Œå¹¶ç”¨å…¬å…±å’Œç§æœ‰æµ‹è¯•æ•°æ®è¿›è¡Œè¯„ä¼°ã€‚ç»“æœåˆ—è¡¨å¦‚ä¸‹:

![](img/25e1c222f53b4c7fd8f6441034e8ba0f.png)

*   è™½ç„¶éªŒè¯åˆ†æ•°æ˜¯æ‰€æœ‰æµ‹è¯•ä¸­æœ€ä½çš„ï¼Œä½† UNet++æ¶æ„åœ¨æœ€ç»ˆæµ‹è¯•æ•°æ®ä¸Šè¡¨ç°éå¸¸å¥½ã€‚
*   é€šè¿‡é…ç½®æ›´å¤šæ•°é‡çš„è¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥æœŸå¾… UNet++æ¶æ„å¸¦æ¥æ›´å¥½çš„ç»“æœã€‚

åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ Flask åº”ç”¨ç¨‹åºæ¥éƒ¨ç½²è¿™ä¸ªç»è¿‡è®­ç»ƒçš„ U-Net ++æ¨¡å‹:

# è®­ç»ƒåé‡åŒ–

ä½¿ç”¨ [tf.lite.TFLiteConverter](https://www.tensorflow.org/api_docs/python/tf/lite/TFLiteConverter) å°†è®­ç»ƒå¥½çš„ Unet++ TensorFlow æ¨¡å‹è½¬æ¢ä¸º TensorFlow Lite æ¨¡å‹ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°†æ¨¡å‹çš„è§„æ¨¡ç¼©å°äº† 3 å€ï¼Œæ€§èƒ½ç•¥æœ‰ä¸‹é™(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡)ã€‚è¿™ç§æŠ€æœ¯è¢«ç§°ä¸ºè®­ç»ƒåé‡åŒ–ã€‚ç‚¹å‡»é˜…è¯»æ›´å¤šç›¸å…³ä¿¡æ¯[ã€‚](https://www.tensorflow.org/lite/performance/post_training_quantization)

ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æˆ‘ä»¬æ¨¡å‹[çš„é‡åŒ–ä»£ç æ‰§è¡Œã€‚](https://github.com/AkhilPenta/Steel-Defect-Detection/blob/main/Quantization.ipynb)

# å‚è€ƒ

1.  [https://www.kaggle.com/c/severstal-steel-defect-detection](https://www.kaggle.com/c/severstal-steel-defect-detection)
2.  [https://towards data science . com/understanding-semantic-segmentation-with-unet-6 be 4f 42 D4 b 47](https://towardsdatascience.com/understanding-semantic-segmentation-with-unet-6be4f42d4b47)
3.  [https://www.tensorflow.org/tutorials/images/segmentation](https://www.tensorflow.org/tutorials/images/segmentation)
4.  https://github.com/qubvel/segmentation_models
5.  [https://naokishibuya . medium . com/up-sampling-with-transposed-convolution-9 AE 4 F2 df 52d 0](https://naokishibuya.medium.com/up-sampling-with-transposed-convolution-9ae4f2df52d0)
6.  [https://towards data science . com/biomedical-image-segmentation-unet-991d 075 a3 a4b](https://towardsdatascience.com/biomedical-image-segmentation-unet-991d075a3a4b)
7.  [https://www.appliedaicourse.com](https://www.appliedaicourse.com/)

**è¯¦ç»†ä»£ç å‚è€ƒæˆ‘çš„**[**GitHub repo**](https://github.com/AkhilPenta/Steel-Defect-Detection)**ã€‚**

[](https://github.com/AkhilPenta/Steel-Defect-Detection) [## AkhilPenta/é’¢ç¼ºé™·æ£€æµ‹

### æ­¤æ—¶æ‚¨ä¸èƒ½æ‰§è¡Œè¯¥æ“ä½œã€‚æ‚¨å·²ä½¿ç”¨å¦ä¸€ä¸ªæ ‡ç­¾é¡µæˆ–çª—å£ç™»å½•ã€‚æ‚¨å·²åœ¨å¦ä¸€ä¸ªé€‰é¡¹å¡ä¸­æ³¨é”€ï¼Œæˆ–è€…â€¦

github.com](https://github.com/AkhilPenta/Steel-Defect-Detection) 

**è”ç³»æˆ‘ä¸Š**[**LinkedIn**](https://www.linkedin.com/in/akhil-penta-63468511a/)**ğŸ™‚**ã€‚****