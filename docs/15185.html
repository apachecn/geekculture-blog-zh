<html>
<head>
<title>Assigning Pods to Nodes | Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å°†çª—æ ¼åˆ†é…ç»™èŠ‚ç‚¹| Kubernetes</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/assigning-pods-to-nodes-kubernetes-aa6d22af6165?source=collection_archive---------4-----------------------#2022-10-18">https://medium.com/geekculture/assigning-pods-to-nodes-kubernetes-aa6d22af6165?source=collection_archive---------4-----------------------#2022-10-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="c62d" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">æ·±å…¥æ¢è®¨èŠ‚ç‚¹é€‰æ‹©å™¨ã€èŠ‚ç‚¹äº²ç¼˜æ€§å’ŒèŠ‚ç‚¹å</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/3f8202ed8bc9d748f6964be3d660b3bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wCadrDJY5HtRZ0gv"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://unsplash.com/@qwitka?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Maksym Kaharlytskyi</a> on <a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="6158" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">åœ¨<strong class="jq hj"> Kubernetes </strong>ä¸­ï¼Œç”±Kube-scheduleråœ¨èŠ‚ç‚¹ä¸Šè°ƒåº¦podã€‚Kubernetesè°ƒåº¦ç¨‹åºæ˜¯ä¸€ä¸ªæ§åˆ¶å¹³é¢è¿›ç¨‹ï¼Œå®ƒå°†podåˆ†é…ç»™èŠ‚ç‚¹ã€‚æ ¹æ®è®¾ç½®çš„çº¦æŸå’Œå¯ç”¨èµ„æºï¼Œç¡®å®šæ¯ä¸ªpodçš„æœ‰æ•ˆä½ç½®ã€‚ç„¶è€Œï¼Œå¯èƒ½æœ‰è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªpodéœ€è¦GPUæŒ‰ç…§æˆ‘ä»¬çš„é¢„æœŸå·¥ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ§åˆ¶podçš„è°ƒåº¦ï¼Œä»¥å°†podåˆ†é…ç»™å…·æœ‰å¯ç”¨GPUçš„èŠ‚ç‚¹ã€‚</p><p id="c000" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">æœ‰å‡ ç§æ–¹æ³•å¯ä»¥æ§åˆ¶è°ƒåº¦ï¼Œæ¨èçš„æ–¹æ³•æ˜¯ä½¿ç”¨<strong class="jq hj">æ ‡ç­¾é€‰æ‹©å™¨</strong>æ¥å¸®åŠ©é€‰æ‹©ã€‚</p><p id="bc48" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ä¸ºäº†æ›´è¿›ä¸€æ­¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å‘èŠ‚ç‚¹æ·»åŠ æ ‡ç­¾å¹¶æŸ¥çœ‹èŠ‚ç‚¹çš„æ ‡ç­¾:</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="31c8" class="kp kq hi kl b fi kr ks l kt ku"><strong class="kl hj">kubectl label nodes &lt;NODE-NAME&gt; &lt;KEY&gt;=&lt;VALUE&gt;<br/></strong>&gt;&gt; kubectl label nodes node01 <strong class="kl hj">gpu=yes</strong></span><span id="7606" class="kp kq hi kl b fi kv ks l kt ku"># View the labels of all nodes<br/>&gt;&gt; kubectl get nodes --show-labels</span><span id="a2fc" class="kp kq hi kl b fi kv ks l kt ku"># View the labels of a particular node<br/>&gt;&gt; kubectl get nodes <strong class="kl hj">node01 </strong>--show-labels | awk '{print $6}'</span><span id="8d03" class="kp kq hi kl b fi kv ks l kt ku">--------------------------------------------------------------------<br/>LABELS<br/>beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,<strong class="kl hj">gpu=yes</strong>,kubernetes.io/arch=amd64,kubernetes.io/hostname=node01,kubernetes.io/os=linux</span></pre><p id="ba8d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">ç§»é™¤æ ‡ç­¾:</strong></p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="d61b" class="kp kq hi kl b fi kr ks l kt ku"><strong class="kl hj">kubectl label node &lt;NODE-NAME&gt; &lt;LABEL&gt;-</strong><br/>&gt;&gt; kubectl label node node01  gpu-</span></pre><h2 id="c4bf" class="kp kq hi bd kw kx ky kz la lb lc ld le jx lf lg lh kb li lj lk kf ll lm ln lo bi translated">èŠ‚ç‚¹é€‰æ‹©å™¨</h2><p id="8760" class="pw-post-body-paragraph jo jp hi jq b jr lp ij jt ju lq im jw jx lr jz ka kb ls kd ke kf lt kh ki kj hb bi translated"><code class="du lu lv lw kl b">nodeSelector</code>æ˜¯å‘èŠ‚ç‚¹åˆ†é…çª—æ ¼çš„æœ€ç®€å•æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥å°†<code class="du lu lv lw kl b">nodeSelector</code>å­—æ®µæ·»åŠ åˆ°Podè§„èŒƒä¸­ï¼Œå¹¶æŒ‡å®šæˆ‘ä»¬å‡è®¾ç›®æ ‡èŠ‚ç‚¹å…·æœ‰çš„<strong class="jq hj">èŠ‚ç‚¹æ ‡ç­¾</strong>ã€‚Kubernetesåªå°†Podè°ƒåº¦åˆ°å…·æœ‰æˆ‘ä»¬åœ¨Podè§„èŒƒä¸­æŒ‡å®šçš„æ¯ä¸ªæ ‡ç­¾çš„èŠ‚ç‚¹ä¸Šã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šæ ‡ç­¾çš„å¯ç”¨èŠ‚ç‚¹ï¼Œåˆ™podå°†å¤„äºæŒ‚èµ·çŠ¶æ€ã€‚</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="8be6" class="kp kq hi kl b fi kr ks l kt ku">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: nginx<br/>spec:<br/>  containers:<br/>  - name: nginx<br/>    image: nginx<br/><strong class="kl hj">  nodeSelector:<br/>    gpu: "yes"</strong></span></pre><h2 id="a652" class="kp kq hi bd kw kx ky kz la lb lc ld le jx lf lg lh kb li lj lk kf ll lm ln lo bi translated">æ¼”ç»ƒ-1</h2><p id="7728" class="pw-post-body-paragraph jo jp hi jq b jr lp ij jt ju lq im jw jx lr jz ka kb ls kd ke kf lt kh ki kj hb bi translated">è®©æˆ‘ä»¬åœ¨podå®šä¹‰æ–‡ä»¶ä¸­æŒ‡å®šä¸€ä¸ªåœ¨èŠ‚ç‚¹æ ‡ç­¾ä¸­ä¸å¯ç”¨çš„æ ‡ç­¾ã€‚</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="15d6" class="kp kq hi kl b fi kr ks l kt ku">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: nginx-pod<br/>spec:<br/>  containers:<br/>  - name: nginx<br/>    image: nginx<br/><strong class="kl hj">  nodeSelector:<br/>    ssd: "yes"</strong></span></pre><p id="c95c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ä½¿ç”¨ä¸Šè¿°æ¸…å•åˆ›å»ºpodï¼Œå¹¶è§‚å¯ŸpodçŠ¶æ€:</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="e17c" class="kp kq hi kl b fi kr ks l kt ku"># Create the pod<br/>&gt;&gt; kubectl create -f nginx-pod.yaml</span><span id="4bdb" class="kp kq hi kl b fi kv ks l kt ku"># Inspect the pod events<br/>&gt;&gt; kubectl describe pod nginx-pod  | grep -A5 Events</span><span id="feb0" class="kp kq hi kl b fi kv ks l kt ku">--------------------------------------------------------------------<br/>Events:<br/>  Type     Reason            Age    From               Message<br/>  ----     ------            ----   ----               -------<br/>  Warning  FailedScheduling  12m    default-scheduler  0/2 nodes are available: <strong class="kl hj">2 node(s) didn't match Pod's node affinity/selector. </strong>preemption: 0/2 nodes are available: 2 Preemption is not helpful for scheduling.</span></pre><p id="5ccc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">åœ¨ä¸Šé¢çš„æ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç”±äº<strong class="jq hj">æ ‡ç­¾ä¸åŒ¹é…</strong>ï¼Œnginx-podå¤„äº<strong class="jq hj">æŒ‚èµ·çŠ¶æ€</strong>ã€‚å› æ­¤ï¼Œåœ¨podå®šä¹‰æ–‡ä»¶ä¸­æŒ‡å®šæ ‡ç­¾æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æ ¼å¤–å°å¿ƒã€‚</p><h2 id="d30b" class="kp kq hi bd kw kx ky kz la lb lc ld le jx lf lg lh kb li lj lk kf ll lm ln lo bi translated">nodeAffinity</h2><p id="7a03" class="pw-post-body-paragraph jo jp hi jq b jr lp ij jt ju lq im jw jx lr jz ka kb ls kd ke kf lt kh ki kj hb bi translated"><strong class="jq hj">èŠ‚ç‚¹å…³è”</strong>çš„åŠŸèƒ½ç±»ä¼¼äº<code class="du lu lv lw kl b"><strong class="jq hj">nodeSelector</strong></code> <strong class="jq hj"> </strong>å­—æ®µï¼Œä½†æ›´å…·è¡¨ç°åŠ›ï¼Œå…è®¸æˆ‘ä»¬æŒ‡å®šè½¯è§„åˆ™ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨å‰é¢çš„é˜¶æ®µä¸­çœ‹åˆ°çš„ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šæ ‡ç­¾çš„å¯ç”¨èŠ‚ç‚¹ï¼Œé‚£ä¹ˆpodå°†å¤„äº<strong class="jq hj">æŒ‚èµ·çŠ¶æ€</strong>ã€‚ä½¿ç”¨<strong class="jq hj">èŠ‚ç‚¹å…³è”</strong>è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å…‹æœè¿™ä¸ªé—®é¢˜ã€‚å› ä¸º<strong class="jq hj">èŠ‚ç‚¹å…³è”</strong>æ”¯æŒè½¯/é¦–é€‰è§„åˆ™ã€‚ä»¥ä¾¿è°ƒåº¦ç¨‹åºä»ç„¶è°ƒåº¦Podï¼Œå³ä½¿å®ƒæ‰¾ä¸åˆ°åŒ¹é…çš„èŠ‚ç‚¹ã€‚</p><p id="4e30" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">èŠ‚ç‚¹äº²å’Œç±»å‹:</strong></p><blockquote class="lx ly lz"><p id="4eae" class="jo jp ma jq b jr js ij jt ju jv im jw mb jy jz ka mc kc kd ke md kg kh ki kj hb bi translated"><code class="du lu lv lw kl b"><strong class="jq hj"><em class="hi">requiredDuringSchedulingIgnoredDuringExecution</em></strong></code> <strong class="jq hj"> <em class="hi"> : </em> </strong>è°ƒåº¦ç¨‹åºæ— æ³•è°ƒåº¦Podï¼Œé™¤éæ»¡è¶³è§„åˆ™ã€‚</p><p id="55ca" class="jo jp ma jq b jr js ij jt ju jv im jw mb jy jz ka mc kc kd ke md kg kh ki kj hb bi translated"><code class="du lu lv lw kl b"><strong class="jq hj"><em class="hi">preferredDuringSchedulingIgnoredDuringExecution</em></strong></code> <strong class="jq hj"> <em class="hi"> : </em> </strong>è°ƒåº¦å™¨è¯•å›¾æ‰¾åˆ°ç¬¦åˆè§„åˆ™çš„èŠ‚ç‚¹ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…çš„èŠ‚ç‚¹ï¼Œè°ƒåº¦ç¨‹åºä»ä¼šè°ƒåº¦Podã€‚</p></blockquote><p id="5abf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ä¸¤ä¸ª<strong class="jq hj">èŠ‚ç‚¹äº²å’Œ</strong>ç±»å‹ä¹‹é—´çš„å¸¸ç”¨çŸ­è¯­æ˜¯<br/> <code class="du lu lv lw kl b"><strong class="jq hj">IgnoredDuringExecution</strong></code> <em class="ma"> â€” </em>å®ƒçš„æ„æ€æ˜¯å°†ä¸€ä¸ªpodè°ƒåº¦æˆä¸€ä¸ªèŠ‚ç‚¹åã€‚å¦‚æœç¡®å®šèŠ‚ç‚¹é€‰æ‹©çš„æ ‡ç­¾è¢«åˆ é™¤ã€‚åˆ†ç¦»èˆ±å°†ç…§å¸¸è¿è¡Œã€‚podä¸ä¼šå—åˆ°å½±å“ã€‚</p><p id="4448" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">èŠ‚ç‚¹å…³è”</strong>çš„å¦ä¸€å¤§ä¼˜åŠ¿æ˜¯<strong class="jq hj"> </strong>ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<strong class="jq hj">æ“ä½œç¬¦</strong>æŒ‡å®šä¸€ä¸ªå€¼åˆ—è¡¨ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸‰ç§ç±»å‹çš„èŠ‚ç‚¹å¯ç”¨ï¼Œæ¯ç§ç±»å‹éƒ½æ ‡è®°ä¸º<code class="du lu lv lw kl b"><strong class="jq hj">size: large</strong></code> <strong class="jq hj">ã€</strong> <code class="du lu lv lw kl b"><strong class="jq hj">size: medium</strong></code> <strong class="jq hj">ã€</strong>å’Œ<code class="du lu lv lw kl b"><strong class="jq hj">size: small</strong></code>ã€‚æˆ‘ä»¬å¸Œæœ›å°†podåˆ†é…åœ¨å¤§å‹æˆ–ä¸­å‹èŠ‚ç‚¹ä¸Šã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨<code class="du lu lv lw kl b"><strong class="jq hj">nodeSelector</strong></code>ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿä¸€æ¬¡æŒ‡å®šä¸€ä¸ªæ ‡ç­¾<code class="du lu lv lw kl b"><strong class="jq hj">size: large</strong></code>æˆ–<code class="du lu lv lw kl b"><strong class="jq hj">size: medium</strong></code>ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä½¿ç”¨èŠ‚ç‚¹å…³è”ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿå°†<code class="du lu lv lw kl b"><strong class="jq hj">large</strong></code>å’Œ<code class="du lu lv lw kl b"><strong class="jq hj">medium</strong></code>æŒ‡å®šä¸ºä¸€ä¸ªå€¼åˆ—è¡¨ã€‚ç„¶åï¼Œpodå°†è¢«è°ƒåº¦åˆ°æ ‡è®°ä¸º<code class="du lu lv lw kl b"><strong class="jq hj">large</strong></code>çš„èŠ‚ç‚¹æˆ–æ ‡è®°ä¸º<code class="du lu lv lw kl b"><strong class="jq hj">medium</strong></code>çš„èŠ‚ç‚¹ä¸Šã€‚</p><h2 id="0e24" class="kp kq hi bd kw kx ky kz la lb lc ld le jx lf lg lh kb li lj lk kf ll lm ln lo bi translated">requiredduringschedulingignoredduringeexecution</h2><p id="1207" class="pw-post-body-paragraph jo jp hi jq b jr lp ij jt ju lq im jw jx lr jz ka kb ls kd ke kf lt kh ki kj hb bi translated">è®©æˆ‘ä»¬ä½¿ç”¨æ¸…å•ä¸­æŒ‡å®šçš„èŠ‚ç‚¹å…³è”æ€§è§„åˆ™åˆ›å»ºä¸€ä¸ªéƒ¨ç½²:</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="bd5c" class="kp kq hi kl b fi kr ks l kt ku">apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  creationTimestamp: null<br/>  labels:<br/>    app: webserver<br/>  name: webserver<br/>spec:<br/>  replicas: 3<br/>  selector:<br/>    matchLabels:<br/>      app: webserver<br/>  template:<br/>    metadata:<br/>      creationTimestamp: null<br/>      labels:<br/>        app: webserver<br/>    spec:<br/><strong class="kl hj">       affinity:<br/>         nodeAffinity:<br/>           requiredDuringSchedulingIgnoredDuringExecution:<br/>             nodeSelectorTerms:<br/>             - matchExpressions:<br/>               - key: size<br/>                 operator: In<br/>                 values:<br/>                 - large<br/>                 - medium<br/>       </strong>containers:<br/>        - image: nginx<br/>          name: webserver</span></pre><p id="36d4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="du lu lv lw kl b">operator</code>å­—æ®µä¸ºKubernetesæŒ‡å®šä¸€ä¸ªé€»è¾‘æ“ä½œç¬¦ï¼Œä»¥ä¾¿åœ¨è¯Šæ–­è§„åˆ™æ—¶ä½¿ç”¨ã€‚å¯ä»¥ç”¨<code class="du lu lv lw kl b">In</code>ã€<code class="du lu lv lw kl b">NotIn</code>ã€<code class="du lu lv lw kl b">Exists</code>ã€<code class="du lu lv lw kl b">DoesNotExist</code>ã€<code class="du lu lv lw kl b">Gt</code>ã€<code class="du lu lv lw kl b">Lt</code>ã€‚</p><blockquote class="lx ly lz"><p id="8023" class="jo jp ma jq b jr js ij jt ju jv im jw mb jy jz ka mc kc kd ke md kg kh ki kj hb bi translated"><strong class="jq hj"> <em class="hi">æ³¨:</em> </strong> <em class="hi">ä½¿ç”¨</em> <code class="du lu lv lw kl b"><em class="hi">NotIn</em></code> <em class="hi">å’Œ</em> <code class="du lu lv lw kl b"><em class="hi">DoesNotExist</em></code> <em class="hi">è¿ç®—ç¬¦æˆ‘ä»¬å¯ä»¥æŒ‡å®šåèŠ‚ç‚¹äº²å’Œè§„åˆ™ã€‚</em></p></blockquote><p id="8399" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ä½¿ç”¨<code class="du lu lv lw kl b">Exists</code>æ“ä½œç¬¦åˆ›å»ºéƒ¨ç½²ã€‚åœ¨<code class="du lu lv lw kl b">Exists</code>çš„æƒ…å†µä¸‹ï¼Œä¸éœ€è¦æŒ‡å®šä»»ä½•å€¼ï¼Œå› ä¸ºå®ƒåªä¼šæ£€æŸ¥å¯†é’¥çš„å­˜åœ¨ã€‚</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="fddc" class="kp kq hi kl b fi kr ks l kt ku">apiVersion: apps/v1<br/>kind: Deployment<br/>metadata:<br/>  creationTimestamp: null<br/>  labels:<br/>    app: webserver<br/>  name: webserver<br/>spec:<br/>  replicas: 3<br/>  selector:<br/>    matchLabels:<br/>      app: webserver<br/>  template:<br/>    metadata:<br/>      creationTimestamp: null<br/>      labels:<br/>        app: webserver<br/>    spec:<br/><strong class="kl hj">       affinity:<br/>         nodeAffinity:<br/>           requiredDuringSchedulingIgnoredDuringExecution:<br/>             nodeSelectorTerms:<br/>             - matchExpressions:<br/>               - key: Size<br/>                 operator: Exists<br/>       </strong>containers:<br/>        - image: nginx<br/>          name: webserver</span></pre><h2 id="f9b3" class="kp kq hi bd kw kx ky kz la lb lc ld le jx lf lg lh kb li lj lk kf ll lm ln lo bi translated">schedulingignoredduringeexecutionæœŸé—´é¦–é€‰</h2><p id="296c" class="pw-post-body-paragraph jo jp hi jq b jr lp ij jt ju lq im jw jx lr jz ka kb ls kd ke kf lt kh ki kj hb bi translated">åœ¨<code class="du lu lv lw kl b">preferredDuringSchedulingIgnoredDuringExecution</code> <em class="ma"> </em>è§„åˆ™ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªå®ä¾‹æŒ‡å®š1åˆ°100ä¹‹é—´çš„<em class="ma"> </em> <code class="du lu lv lw kl b">weight</code>ã€‚å¦‚æœå¤šä¸ªèŠ‚ç‚¹æ»¡è¶³è¦æ±‚ï¼Œè°ƒåº¦å™¨ä¼šå°†è¯¥è¡¨è¾¾å¼çš„<code class="du lu lv lw kl b">weight</code>å€¼ç›¸åŠ ã€‚å…·æœ‰æœ€é«˜æ€»æ•°çš„èŠ‚ç‚¹è¢«èµ‹äºˆä¼˜å…ˆçº§ï¼Œå¹¶ä¸”podè¢«è°ƒåº¦åˆ°å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„èŠ‚ç‚¹ä¸­ã€‚</p><p id="4358" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œä¸€ä¸ªå¸¦æœ‰<code class="du lu lv lw kl b">size: large</code>æ ‡ç­¾ï¼Œå¦ä¸€ä¸ªå¸¦æœ‰<code class="du lu lv lw kl b">size: medium</code>æ ‡ç­¾ã€‚å¹¶ä¸”ä¸¤ä¸ªèŠ‚ç‚¹éƒ½ç¬¦åˆè¦æ±‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒåº¦ç¨‹åºå°†è€ƒè™‘æ¯ä¸ªèŠ‚ç‚¹çš„<code class="du lu lv lw kl b">weight</code>ï¼Œå¹¶å°†æƒé‡æ·»åŠ åˆ°è¯¥èŠ‚ç‚¹çš„å…¶ä»–å¾—åˆ†ä¸­ï¼Œå¹¶å°†Podè°ƒåº¦åˆ°æœ€ç»ˆå¾—åˆ†æœ€é«˜çš„èŠ‚ç‚¹ä¸Šã€‚</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="7f8f" class="kp kq hi kl b fi kr ks l kt ku">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: webserver<br/>spec:<br/>  affinity:<br/>    nodeAffinity:<br/>      preferredDuringSchedulingIgnoredDuringExecution:<br/>       <strong class="kl hj"> - weight: 15</strong><br/>          preference:<br/>            matchExpressions:<br/>            - key: size<br/>              operator: In<br/>              values:<br/>              - large<br/>       <strong class="kl hj"> - weight: 20</strong><br/>          preference:<br/>            matchExpressions:<br/>            - key: size<br/>              operator: In<br/>              values:<br/>              - medium<br/>  containers:<br/>  - name: webserver<br/>    image: nginx</span></pre><h2 id="476a" class="kp kq hi bd kw kx ky kz la lb lc ld le jx lf lg lh kb li lj lk kf ll lm ln lo bi translated">æ¼”ç»ƒ2</h2><p id="9953" class="pw-post-body-paragraph jo jp hi jq b jr lp ij jt ju lq im jw jx lr jz ka kb ls kd ke kf lt kh ki kj hb bi translated">éƒ¨ç½²å…·æœ‰<code class="du lu lv lw kl b">preferredDuringSchedulingIgnoredDuringExecution</code>ç±»å‹çš„<strong class="jq hj">èŠ‚ç‚¹å…³è”</strong>çš„podã€‚å’ŒaddæŒ‡å®šèŠ‚ç‚¹ä¸­ä¸å¯ç”¨ä½œæ ‡ç­¾çš„å€¼åˆ—è¡¨ã€‚</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="16fc" class="kp kq hi kl b fi kr ks l kt ku"><strong class="kl hj"># webserver-pod.yaml</strong></span><span id="e655" class="kp kq hi kl b fi kv ks l kt ku">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: webserver<br/>spec:<br/>  affinity:<br/>    nodeAffinity:<br/>      preferredDuringSchedulingIgnoredDuringExecution:<br/><strong class="kl hj">        - weight: 15</strong><br/>          preference:<br/>            matchExpressions:<br/>            - key: key<br/>              operator: In<br/><strong class="kl hj">              values:<br/>              - bar<br/>              - foo</strong><br/><strong class="kl hj">        - weight: 20</strong><br/>          preference:<br/>            matchExpressions:<br/>            - key: key<br/>              operator: In<br/><strong class="kl hj">              values:<br/>              - foo<br/>              - bar</strong><br/>  containers:<br/>  - name: webserver<br/>    image: nginx</span></pre><p id="3629" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ç°åœ¨ï¼Œå±•å¼€åŠèˆ±å¹¶è§‚å¯ŸçŠ¶æ€:</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="5e65" class="kp kq hi kl b fi kr ks l kt ku">&gt;&gt; kubectl create -f webserver-pod.yaml<br/>&gt;&gt; kubectl get pods webserver</span><span id="705a" class="kp kq hi kl b fi kv ks l kt ku">--------------------------------------------------------------------<br/>NAME        READY   STATUS    RESTARTS   AGE<br/>webserver   1/1    <strong class="kl hj"> Running</strong>   0          4m4s</span></pre><p id="497f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ä¸<a class="ae jn" href="#a652" rel="noopener ugc nofollow">èŠ‚ç‚¹é€‰æ‹©å™¨</a>ä¸åŒçš„æ˜¯ï¼Œè™½ç„¶æ²¡æœ‰åŒ¹é…çš„æ ‡ç­¾å¯ç”¨ï¼Œä½†ä»ç„¶ä¼šå°†podè°ƒåº¦åˆ°èŠ‚ç‚¹ä¸­ã€‚å› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†<code class="du lu lv lw kl b">preferredDuringSchedulingIgnoredDuringExecution</code>ç±»å‹çš„<strong class="jq hj">èŠ‚ç‚¹å…³è”</strong>ã€‚</p><h2 id="75f0" class="kp kq hi bd kw kx ky kz la lb lc ld le jx lf lg lh kb li lj lk kf ll lm ln lo bi translated">èŠ‚ç‚¹å</h2><p id="6dfb" class="pw-post-body-paragraph jo jp hi jq b jr lp ij jt ju lq im jw jx lr jz ka kb ls kd ke kf lt kh ki kj hb bi translated"><code class="du lu lv lw kl b">nodeName</code>æ˜¯å°†podè°ƒåº¦åˆ°æ‰€éœ€èŠ‚ç‚¹çš„æœ€ç›´æ¥æ–¹å¼ã€‚<code class="du lu lv lw kl b">nodeName</code>æ˜¯Podè§„èŒƒä¸­çš„ä¸€ä¸ªå­—æ®µã€‚å¦‚æœåœ¨Podè§„èŒƒä¸­æŒ‡å®šäº†<code class="du lu lv lw kl b">nodeName</code>å­—æ®µï¼Œè°ƒåº¦ç¨‹åºå°†å¿½ç•¥Podï¼Œæ‰€éœ€èŠ‚ç‚¹ä¸Šçš„kubeletå°†å°è¯•å°†Podæ”¾ç½®åœ¨è¯¥èŠ‚ç‚¹ä¸Šã€‚</p><p id="0957" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du lu lv lw kl b">nodeName</code>æœ‰ä¸€äº›ç¼ºç‚¹:</p><p id="e09d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">â—å¦‚æœæ‰€éœ€çš„èŠ‚ç‚¹ä¸å­˜åœ¨ï¼ŒPodå°†ä¸ä¼šè¿è¡Œã€‚<br/> â—å¦‚æœç›®æ ‡èŠ‚ç‚¹æ²¡æœ‰å®¹çº³Podçš„èµ„æºï¼ŒPodå°†æ— æ³•è¿è¡Œã€‚<br/> â—äº‘ç¯å¢ƒä¸­çš„èŠ‚ç‚¹åç§°å¹¶ä¸æ€»æ˜¯å¯é¢„æµ‹æˆ–ç¨³å®šçš„ã€‚</p><p id="bb03" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ä»¥ä¸‹æ˜¯ä½¿ç”¨<code class="du lu lv lw kl b">nodeName</code>å­—æ®µçš„podæ¸…å•:</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="6971" class="kp kq hi kl b fi kr ks l kt ku">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: nginx<br/>spec:<br/>  containers:<br/>  - name: nginx<br/>    image: nginx<br/><strong class="kl hj">  nodeName: node01</strong></span></pre></div><div class="ab cl me mf gp mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hb hc hd he hf"><blockquote class="lx ly lz"><p id="53d6" class="jo jp ma jq b jr js ij jt ju jv im jw mb jy jz ka mc kc kd ke md kg kh ki kj hb bi translated"><em class="hi">å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¾ˆæœ‰å¸®åŠ©ï¼Œè¯·</em> <strong class="jq hj"> <em class="hi">åˆ«å¿˜äº†</em> </strong> <em class="hi">ç‚¹å‡»</em> <strong class="jq hj"> <em class="hi">æ‹æ‹</em> </strong> <em class="hi">å’Œ</em> <strong class="jq hj"> <em class="hi">è·Ÿç€</em> </strong> <em class="hi">æŒ‰é’®å¸®æˆ‘å†™æ›´å¤šè¿™æ ·çš„æ–‡ç« ã€‚<br/>è°¢è°¢ğŸ–¤ </em></p></blockquote></div><div class="ab cl me mf gp mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hb hc hd he hf"><h2 id="fb5d" class="kp kq hi bd kw kx ky kz la lb lc ld le jx lf lg lh kb li lj lk kf ll lm ln lo bi translated">å‚è€ƒ</h2><div class="ml mm ez fb mn mo"><a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hj fi z dy mt ea eb mu ed ef hh bi translated">å°†çª—æ ¼åˆ†é…ç»™èŠ‚ç‚¹</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">æ‚¨å¯ä»¥çº¦æŸä¸€ä¸ªPodï¼Œä½¿å…¶è¢«é™åˆ¶åœ¨ç‰¹å®šçš„èŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œæˆ–è€…æ›´å–œæ¬¢åœ¨ç‰¹å®šçš„èŠ‚ç‚¹ä¸Šè¿è¡Œâ€¦</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">kubernetes.io</p></div></div><div class="mx l"><div class="my l mz na nb mx nc jh mo"/></div></div></a></div></div></div>    
</body>
</html>