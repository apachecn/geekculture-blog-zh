<html>
<head>
<title>A complete overview of Ansible Dynamic inventory</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">é™æ€åŠ¨æ€åº“å­˜çš„å®Œæ•´æ¦‚è¿°</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/a-complete-overview-of-ansible-dynamic-inventory-a9ded104df4c?source=collection_archive---------8-----------------------#2021-09-08">https://medium.com/geekculture/a-complete-overview-of-ansible-dynamic-inventory-a9ded104df4c?source=collection_archive---------8-----------------------#2021-09-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="f567" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">ä»€ä¹ˆæ˜¯Ansibleï¼Ÿ</h1><p id="a3c3" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj"> Ansible </strong>æ˜¯ä¸€æ¬¾å¼€æºè½¯ä»¶<strong class="jf hj">ä¾›åº”ã€é…ç½®ç®¡ç†å’Œéƒ¨ç½²å·¥å…·ã€‚</strong>å®ƒè¿è¡Œåœ¨è®¸å¤šç±»Unixç³»ç»Ÿä¸Šï¼Œå¯ä»¥é…ç½®ç±»Unixç³»ç»Ÿå’ŒMicrosoft Windowsã€‚Ansibleä½¿ç”¨SSHåè®®æ¥é…ç½®è¿œç¨‹æœåŠ¡å™¨ã€‚Ansibleéµå¾ªåŸºäº<strong class="jf hj">æ¨çš„</strong>æœºåˆ¶æ¥é…ç½®è¿œç¨‹æœåŠ¡å™¨ã€‚</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/0b2e7f01ccc163074ce23c3451290335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l-U9GJtmL5GwPqFPJdQo-w.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Ansible</figcaption></figure><h1 id="a2db" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">ä»€ä¹ˆæ˜¯åŠ¨æ€åº“å­˜ï¼Ÿ</h1><p id="e582" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">é»˜è®¤æƒ…å†µä¸‹ï¼Œansibleå¤„ç†é™æ€æ¸…å•ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåº”ç”¨ç¨‹åºåœ¨è‡ªåŠ¨æ‰©å±•ç»„ä¸Šè¿è¡Œï¼Œå› æ­¤ï¼ŒæœåŠ¡å™¨çš„IPåœ°å€ä¼šä¸æ–­å˜åŒ–ï¼Œå› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŠ¨æ€æ¸…å•å°±ä¼šå‡ºç°ã€‚Ansible dynamic inventoryè¿æ¥åˆ°äº‘æä¾›å•†ï¼Œå®ƒå°†è·å¾—å¯ç”¨çš„è™šæ‹ŸæœºIPï¼Œç„¶ååœ¨è¿™äº›è™šæ‹Ÿæœºä¸Šè¿è¡Œå‰§æœ¬ã€‚</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kr"><img src="../Images/bc018df78fca08e7726e282374e329bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pqcETBWxrnDO6lhU.jpg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Ansible dynamic inventory</figcaption></figure><p id="c178" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†è§£é‡Šå¦‚ä½•åœ¨AWSä¸Šä½¿ç”¨AnsibleåŠ¨æ€åº“å­˜ã€‚</p><h1 id="4c9a" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">å…ˆå†³æ¡ä»¶:</h1><ul class=""><li id="fa41" class="kx ky hi jf b jg jh jk jl jo kz js la jw lb ka lc ld le lf bi translated">å®‰è£…äº†<a class="ae lg" href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj"> ansible </strong> </a>çš„ç½‘ç»œæœåŠ¡å™¨</li><li id="2a8b" class="kx ky hi jf b jg lh jk li jo lj js lk jw ll ka lc ld le lf bi translated">å¯¹<a class="ae lg" href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj"> ansible </strong> </a>çš„åŸºæœ¬äº†è§£</li><li id="2589" class="kx ky hi jf b jg lh jk li jo lj js lk jw ll ka lc ld le lf bi translated">åŸºæœ¬äº†è§£<a class="ae lg" href="https://docs.aws.amazon.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj"> AWS </strong> </a></li><li id="62be" class="kx ky hi jf b jg lh jk li jo lj js lk jw ll ka lc ld le lf bi translated">AWS <strong class="jf hj">è®¿é—®å¯†é’¥</strong> &amp; <strong class="jf hj">ç§˜å¯†å¯†é’¥</strong></li></ul><p id="4f5b" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘å·²ç»æœ‰äº†ä¸€ä¸ªå®‰è£…äº†<strong class="jf hj"> ansible </strong>çš„<strong class="jf hj"> ubuntu 20.04 OS </strong>çš„<strong class="jf hj"> EC2 </strong>å®ä¾‹ã€‚åœ¨ç»§ç»­æœ¬æ•™ç¨‹ä¹‹å‰ï¼Œåˆ›å»ºä¸€ä¸ªç›®å½•å¹¶å°†æ‰€æœ‰æ–‡ä»¶å­˜å‚¨åœ¨å…¶ä¸­æ€»æ˜¯ä¸€ä¸ªå¥½çš„åšæ³•ã€‚</p><p id="f09c" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">è®©æˆ‘ä»¬å¼€å§‹é…ç½®é¡¹ç›®ã€‚</p><p id="c878" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">ç¬¬ä¸€æ­¥:- </strong>å®‰è£…<strong class="jf hj"> Ansible-EC2 </strong>æ’ä»¶</p><ul class=""><li id="ab1b" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥å®‰è£…Ansible-EC2æ’ä»¶</li></ul><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="04dd" class="lu ig hi lq b fi lv lw l lx ly">ansible-galaxy collection install amazon.aws</span></pre><p id="ca0c" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">ç¬¬äºŒæ­¥:- </strong>å®‰è£…<strong class="jf hj"> python3 &amp; pip </strong></p><ul class=""><li id="90c4" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥å®‰è£…<strong class="jf hj">å¤§é’³3 </strong>å’Œ<strong class="jf hj">å°é’³</strong></li></ul><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="90fd" class="lu ig hi lq b fi lv lw l lx ly">sudo apt-get install python3 -y<br/>sudo apt-get install python3-pip -y</span></pre><p id="4416" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">æ­¥éª¤3:-å®‰è£…<strong class="jf hj"> boto3 </strong>åº“</p><ul class=""><li id="8192" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">Ansibleä½¿ç”¨å¼•å¯¼æ ¸å¿ƒå¯¹AWSè¿›è¡ŒAPIè°ƒç”¨ï¼Œä»¥æ£€ç´¢EC2å®ä¾‹ç»†èŠ‚ã€‚</li><li id="ffeb" class="kx ky hi jf b jg lh jk li jo lj js lk jw ll ka lc ld le lf bi translated">è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…<strong class="jf hj"> boto3åº“</strong></li></ul><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="d17c" class="lu ig hi lq b fi lv lw l lx ly">sudo pip3 install boto3</span></pre><p id="296d" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">ç¬¬å››æ­¥:- </strong>åˆ›å»º<strong class="jf hj">ã€‚yaml </strong>æ–‡ä»¶</p><ul class=""><li id="3cc9" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">åˆ›å»ºåä¸º<code class="du lz ma mb lq b">aws_ec2.yaml</code>æˆ–<code class="du lz ma mb lq b">aws_ec2.yml</code>çš„æ–‡ä»¶</li><li id="f0f8" class="kx ky hi jf b jg lh jk li jo lj js lk jw ll ka lc ld le lf bi translated">ä¸Šé¢çš„æ–‡ä»¶å¯¹æˆ‘ä»¬æ¥è¯´å°±åƒåŠ¨æ€æ¸…å•ä¸€æ ·</li><li id="f172" class="kx ky hi jf b jg lh jk li jo lj js lk jw ll ka lc ld le lf bi translated">åœ¨<code class="du lz ma mb lq b">aws_ec2.yaml</code>æˆ–<code class="du lz ma mb lq b">aws_ec2.yml</code>æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç </li></ul><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="293c" class="lu ig hi lq b fi lv lw l lx ly"><strong class="lq hj">plugin:</strong> aws_ec2<br/><strong class="lq hj">regions:</strong><br/>  <strong class="lq hj">-</strong> us-east-1</span></pre><blockquote class="mc md me"><p id="bc5f" class="jd je mf jf b jg ks ji jj jk kt jm jn mg ku jq jr mh kv ju jv mi kw jy jz ka hb bi translated">æ‚¨ä¹Ÿå¯ä»¥æ›´æ”¹åœ°åŒº</p></blockquote><p id="2efb" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤5:- </strong>åˆ›å»ºä¸€ä¸ª<strong class="jf hj"> IAM </strong>è§’è‰²</p><ul class=""><li id="a0c9" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">ä¸ºäº†è·å–EC2å®ä¾‹çš„è¯¦ç»†ä¿¡æ¯ï¼Œansible serverå¿…é¡»éœ€è¦ä¸€ä¸ªIAMè§’è‰²æ¥å…è®¸ä¸EC2å®ä¾‹è¿›è¡Œäº¤äº’ã€‚</li><li id="9e8e" class="kx ky hi jf b jg lh jk li jo lj js lk jw ll ka lc ld le lf bi translated">å°†<code class="du lz ma mb lq b">AWS_EC2_FullAccess</code>è§’è‰²é™„åŠ åˆ°æœåŠ¡å™¨</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mj"><img src="../Images/8e47fe2fbb5ee781e86fbb2418b41933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W1ncbPY6Na11RLX9XjunbQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">IAM Role</figcaption></figure><p id="614e" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤6:- </strong>éªŒè¯<strong class="jf hj">è¾“å‡º</strong></p><ul class=""><li id="c37f" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥éªŒè¯è¾“å‡º</li></ul><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="d274" class="lu ig hi lq b fi lv lw l lx ly">ansible-inventory -i aws_ec2.yaml --list</span></pre><ul class=""><li id="bda2" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">ä¸Šè¿°å‘½ä»¤å°†ç»™å‡ºæ‚¨åœ¨<code class="du lz ma mb lq b">aws_ec2.yaml</code>æˆ–<code class="du lz ma mb lq b">aws_ec2.yml</code>æ–‡ä»¶ä¸­æŒ‡å®šçš„åŒºåŸŸä¸­æ‰€æœ‰EC2å®ä¾‹çš„è¯¦ç»†ä¿¡æ¯</li></ul><blockquote class="mc md me"><p id="b182" class="jd je mf jf b jg ks ji jj jk kt jm jn mg ku jq jr mh kv ju jv mi kw jy jz ka hb bi translated"><strong class="jf hj">æ³¨æ„:- </strong>å¦‚æœæ‚¨çš„ansibleæœåŠ¡å™¨ä¸åœ¨AWSä¸­ï¼Œé‚£ä¹ˆæ‚¨ä¸èƒ½å°†IAMè§’è‰²é™„åŠ åˆ°å®ƒï¼Œå› æ­¤æ‚¨å¯ä»¥ä¿®æ”¹<code class="du lz ma mb lq b">aws_ec2.yaml</code>æˆ–<code class="du lz ma mb lq b">aws_ec2.yml</code>æ–‡ä»¶å¹¶åœ¨å…¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ã€‚</p></blockquote><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="6349" class="lu ig hi lq b fi lv lw l lx ly">aws_access_key: &lt;YOUR-AWS-ACCESS-KEY&gt; <br/>aws_secret_key: &lt;YOUR-AWS-SECRET-KEY&gt;</span></pre><p id="4310" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">é€šè¿‡æ·»åŠ <strong class="jf hj"> AWSè®¿é—®å¯†é’¥</strong>å’Œ<strong class="jf hj"> AWSç§˜å¯†å¯†é’¥</strong>ï¼ŒansibleæœåŠ¡å™¨å¯ä»¥ä¸AWSå¸æˆ·é€šä¿¡ï¼Œå¹¶å¯ä»¥è·å¾—æ‰€æœ‰<strong class="jf hj"> EC2å®ä¾‹</strong>çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><p id="b2d5" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">æ‚¨åº”è¯¥å¾—åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„è¾“å‡ºã€‚æˆ‘åœ¨<code class="du lz ma mb lq b">us-east-1</code>åœ°åŒºæœ‰1ä¸ªEC2å®ä¾‹</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mj"><img src="../Images/d706405fe649d9d1dec5d41e968906d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tiC2t_RmFgUlFMUaMmWD1g.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">EC2 instance</figcaption></figure><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="9923" class="lu ig hi lq b fi lv lw l lx ly">ansible-inventory -i aws_ec2.yaml --list<br/>{<br/>    "_meta": {<br/>        "hostvars": {<br/>            "ec2-52-90-221-25.compute-1.amazonaws.com": {<br/>                "ami_launch_index": 0,<br/>                "architecture": "x86_64",<br/>                "block_device_mappings": [<br/>                    {<br/>                        "device_name": "/dev/xvda",<br/>                        "ebs": {<br/>                            "attach_time": "2021-09-08T06:32:38+00:00",<br/>                            "delete_on_termination": true,<br/>                            "status": "attached",<br/>                            "volume_id": "vol-0e65b1e8755de632c"<br/>                        }<br/>                    }<br/>                ],<br/>                "capacity_reservation_specification": {<br/>                    "capacity_reservation_preference": "open"<br/>                },<br/>                "client_token": "",<br/>                "cpu_options": {<br/>                    "core_count": 1,<br/>                    "threads_per_core": 1<br/>                },<br/>                "ebs_optimized": false,<br/>                "ena_support": true,<br/>                "enclave_options": {<br/>                    "enabled": false<br/>                },<br/>                "hibernation_options": {<br/>                    "configured": false<br/>                },<br/>                "hypervisor": "xen",<br/>                "image_id": "ami-087c17d1fe0178315",<br/>                "instance_id": "i-0d1f6c9e678e60185",<br/>                "instance_type": "t2.micro",<br/>                "key_name": "tests",<br/>                "launch_time": "2021-09-08T06:32:37+00:00",<br/>                "metadata_options": {<br/>                    "http_endpoint": "enabled",<br/>                    "http_protocol_ipv6": "disabled",<br/>                    "http_put_response_hop_limit": 1,<br/>                    "http_tokens": "optional",<br/>                    "state": "applied"<br/>                },<br/>                "monitoring": {<br/>                    "state": "disabled"<br/>                },<br/>                "network_interfaces": [<br/>                    {<br/>                        "association": {<br/>                            "ip_owner_id": "amazon",<br/>                            "public_dns_name": "ec2-52-90-221-25.compute-1.amazonaws.com",<br/>                            "public_ip": "52.90.221.25"<br/>                        },<br/>                        "attachment": {<br/>                            "attach_time": "2021-09-08T06:32:37+00:00",<br/>                            "attachment_id": "eni-attach-00b9e24d154e08de2",<br/>                            "delete_on_termination": true,<br/>                            "device_index": 0,<br/>                            "network_card_index": 0,<br/>                            "status": "attached"<br/>                        },<br/>                        "description": "",<br/>                        "groups": [<br/>                            {<br/>                                "group_id": "sg-06e7003e04d368388",<br/>                                "group_name": "launch-wizard-1"<br/>                            }<br/>                        ],<br/>                        "interface_type": "interface",<br/>                        "ipv6_addresses": [],<br/>                        "mac_address": "12:ec:04:76:8c:1d",<br/>                        "network_interface_id": "eni-0bd2237d5c6d162a7",<br/>                        "owner_id": "765631733981",<br/>                        "private_dns_name": "ip-172-31-84-192.ec2.internal",<br/>                        "private_ip_address": "172.31.84.192",<br/>                        "private_ip_addresses": [<br/>                            {<br/>                                "association": {<br/>                                    "ip_owner_id": "amazon",<br/>                                    "public_dns_name": "ec2-52-90-221-25.compute-1.amazonaws.com",<br/>                                    "public_ip": "52.90.221.25"<br/>                                },<br/>                                "primary": true,<br/>                                "private_dns_name": "ip-172-31-84-192.ec2.internal",<br/>                                "private_ip_address": "172.31.84.192"<br/>                            }<br/>                        ],<br/>                        "source_dest_check": true,<br/>                        "status": "in-use",<br/>                        "subnet_id": "subnet-e490c9c5",<br/>                        "vpc_id": "vpc-84bfd0f9"<br/>                    }<br/>                ],<br/>                "owner_id": "765631733981",<br/>                "placement": {<br/>                    "availability_zone": "us-east-1d",<br/>                    "group_name": "",<br/>                    "region": "us-east-1",<br/>                    "tenancy": "default"<br/>                },<br/>                "private_dns_name": "ip-172-31-84-192.ec2.internal",<br/>                "private_ip_address": "172.31.84.192",<br/>                "product_codes": [],<br/>                "public_dns_name": "ec2-52-90-221-25.compute-1.amazonaws.com",<br/>                "public_ip_address": "52.90.221.25",<br/>                "requester_id": "",<br/>                "reservation_id": "r-061722678cf48ffa4",<br/>                "root_device_name": "/dev/xvda",<br/>                "root_device_type": "ebs",<br/>                "security_groups": [<br/>                    {<br/>                        "group_id": "sg-06e7003e04d368388",<br/>                        "group_name": "launch-wizard-1"<br/>                    }<br/>                ],<br/>                "source_dest_check": true,<br/>                "state": {<br/>                    "code": 16,<br/>                    "name": "running"<br/>                },<br/>                "state_transition_reason": "",<br/>                "subnet_id": "subnet-e490c9c5",<br/>                "tags": {<br/>                    "Name": "Slave-1"<br/>                },<br/>                "virtualization_type": "hvm",<br/>                "vpc_id": "vpc-84bfd0f9"<br/>            }<br/>        }<br/>    },<br/>    "all": {<br/>        "children": [<br/>            "aws_ec2",<br/>            "ungrouped"<br/>        ]<br/>    },<br/>    "aws_ec2": {<br/>        "hosts": [<br/>            "ec2-52-90-221-25.compute-1.amazonaws.com"<br/>        ]<br/>    }<br/>}</span></pre><blockquote class="mc md me"><p id="f435" class="jd je mf jf b jg ks ji jj jk kt jm jn mg ku jq jr mh kv ju jv mi kw jy jz ka hb bi translated"><strong class="jf hj">æ³¨æ„:- </strong>æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨ï¼Œé€šè¿‡æ·»åŠ ä»¥ä¸‹ç»†èŠ‚æ¥ä¿®æ”¹<code class="du lz ma mb lq b">aws_ec2.yaml</code>æˆ–<code class="du lz ma mb lq b">aws_ec2.yml</code>æ–‡ä»¶ï¼Œä»è€Œè·å¾—ç‰¹å®šçš„è¾“å‡º</p></blockquote><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="1b93" class="lu ig hi lq b fi lv lw l lx ly"><strong class="lq hj">filters:</strong><br/>  <em class="mf"># All instances with their `Environment` tag set to `dev`</em><br/>  tag:Environment<strong class="lq hj">:</strong> dev<br/>  <em class="mf"># All dev and QA hosts</em><br/>  tag:Environment<strong class="lq hj">:</strong><br/>    <strong class="lq hj">-</strong> dev<br/>    <strong class="lq hj">-</strong> qa</span></pre><p id="0a34" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">ç¬¬7æ­¥:- </strong>è¿è¡Œ<code class="du lz ma mb lq b">ad-hoc</code>å‘½ä»¤</p><ul class=""><li id="ad8a" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œä¸‹é¢çš„å‘½ä»¤åœ¨EC2å®ä¾‹ä¸Šè¿è¡Œå„ç§å‘½ä»¤</li></ul><ol class=""><li id="4c1e" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka mk ld le lf bi translated"><strong class="jf hj">ä¹’</strong></li></ol><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="d3d6" class="lu ig hi lq b fi lv lw l lx ly">ansible &lt;group-name&gt; -i aws_ec2.yaml -m ping --private-key=&lt;private-key-name&gt; </span></pre><p id="36b3" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">æ‚¨åº”è¯¥å¾—åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„è¾“å‡º</p><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="c596" class="lu ig hi lq b fi lv lw l lx ly">ec2-107-21-17-60.compute-1.amazonaws.com | SUCCESS =&gt; {<br/>    "ansible_facts": {<br/>        "discovered_interpreter_python": "/usr/bin/python"<br/>    }, <br/>    "changed": false, <br/>    "ping": "pong"<br/>}</span></pre><p id="1117" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">2.å®‰è£…<strong class="jf hj"> Git </strong></p><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="ca92" class="lu ig hi lq b fi lv lw l lx ly">ansible &lt;group-name&gt; -i aws_ec2.yaml -m yum -a 'name=git state=present' --private-key=&lt;private-key-name&gt;</span></pre><p id="8f78" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">æ‚¨åº”è¯¥å¾—åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„è¾“å‡º</p><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="7364" class="lu ig hi lq b fi lv lw l lx ly">ec2-54-86-185-90.compute-1.amazonaws.com | CHANGED =&gt; {<br/>    "ansible_facts": {<br/>        "discovered_interpreter_python": "/usr/bin/python"<br/>    }, <br/>    "changed": true, <br/>    "changes": {<br/>        "installed": [<br/>            "git"<br/>        ]<br/>    }, <br/>    "msg": "", <br/>    "rc": 0, <br/>    "results": </span></pre><p id="de39" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">ç¬¬å…«æ­¥:</strong>-<strong class="jf hj">åˆ†ç»„</strong>å®ä¾‹</p><ul class=""><li id="da30" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">æ‚¨å¯ä»¥ä½¿ç”¨æ ‡ç­¾ã€å®ä¾‹ç±»å‹ã€å®ä¾‹åç§°ã€è‡ªå®šä¹‰è¿‡æ»¤å™¨ç­‰å¯¹å®ä¾‹è¿›è¡Œåˆ†ç»„</li><li id="9fd1" class="kx ky hi jf b jg lh jk li jo lj js lk jw ll ka lc ld le lf bi translated">ä½ å¯ä»¥ä»<a class="ae lg" href="https://docs.ansible.com/ansible/latest/collections/amazon/aws/aws_ec2_inventory.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">è¿™é‡Œ</strong> </a>æ‰¾åˆ°æ›´å¤šç»†èŠ‚</li><li id="61ae" class="kx ky hi jf b jg lh jk li jo lj js lk jw ll ka lc ld le lf bi translated">åœ¨<code class="du lz ma mb lq b">aws_ec2.yaml</code>æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç </li></ul><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="94d3" class="lu ig hi lq b fi lv lw l lx ly">keyed_groups:<br/>  - key: tags<br/>    prefix: tag<br/>  - prefix: instance_type<br/>    key: instance_type<br/>  - key: placement.region<br/>    prefix: aws_region</span></pre><ul class=""><li id="a65e" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥æ£€æŸ¥è¾“å‡º</li></ul><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="06d5" class="lu ig hi lq b fi lv lw l lx ly">ansible-inventory --graph</span></pre><ul class=""><li id="ff1d" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">æ‚¨å°†çœ‹åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„è¾“å‡ºï¼Œæ‰€æœ‰å®ä¾‹éƒ½åˆ†ç»„åœ¨æ ‡ç­¾ã€åŒºåŸŸå’ŒåŒºåŸŸä¸‹ï¼ŒåŠ¨æ€ç»„åä¸º<code class="du lz ma mb lq b">aws_region_us_east_1</code>ã€<code class="du lz ma mb lq b">instance_type_t2_micro</code>ã€<code class="du lz ma mb lq b">tag_Name_Ansible</code></li></ul><p id="ef90" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">ç¬¬9æ­¥:- </strong>è¿è¡Œ<strong class="jf hj"> ansible-playbook </strong></p><ul class=""><li id="9b34" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨åŠ¨æ€åº“å­˜æ¥è¿è¡Œansible-playbook</li><li id="2493" class="kx ky hi jf b jg lh jk li jo lj js lk jw ll ka lc ld le lf bi translated">åˆ›å»ºä¸€ä¸ªåä¸º<code class="du lz ma mb lq b">apache.yml</code>çš„æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="15e0" class="lu ig hi lq b fi lv lw l lx ly">---<br/>- hosts: aws_ec2<br/>  become: true<br/>  tasks:<br/>    - name: ensure apache is at the latest version<br/>      yum: name=httpd state=latest<br/>    - name: start apache<br/>      service:<br/>          name: httpd<br/>          state: started</span></pre><ul class=""><li id="0de7" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">ä¸Šé¢çš„ä»£ç å°†åœ¨æ‰€æœ‰EC2å®ä¾‹ä¸Šå®‰è£…apacheï¼Œå¹¶å¯åŠ¨apacheæœåŠ¡</li><li id="4522" class="kx ky hi jf b jg lh jk li jo lj js lk jw ll ka lc ld le lf bi translated">è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ‰§è¡Œè¡ŒåŠ¨æ‰‹å†Œ</li></ul><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="2023" class="lu ig hi lq b fi lv lw l lx ly">ansible-playbook -i aws_ec2.yml apache.yml --private-key=&lt;your-private-key&gt;</span></pre><ul class=""><li id="9f4e" class="kx ky hi jf b jg ks jk kt jo lm js ln jw lo ka lc ld le lf bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„è¾“å‡º</li></ul><pre class="kc kd ke kf fd lp lq lr ls aw lt bi"><span id="b499" class="lu ig hi lq b fi lv lw l lx ly">PLAY [aws_ec2] ****************************************************************************************************************************************</span><span id="c29b" class="lu ig hi lq b fi ml lw l lx ly">TASK [Gathering Facts] ********************************************************************************************************************************</span><span id="ef07" class="lu ig hi lq b fi ml lw l lx ly">[WARNING]: Platform linux on host ec2-54-86-185-90.compute-1.amazonaws.com is using the discovered Python interpreter at /usr/bin/python, but future</span><span id="c773" class="lu ig hi lq b fi ml lw l lx ly">installation of another Python interpreter could change this. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html</span><span id="52b0" class="lu ig hi lq b fi ml lw l lx ly">for more information.</span><span id="dd07" class="lu ig hi lq b fi ml lw l lx ly">ok: [ec2-54-86-185-90.compute-1.amazonaws.com]</span><span id="0665" class="lu ig hi lq b fi ml lw l lx ly">[WARNING]: Platform linux on host ec2-107-21-17-60.compute-1.amazonaws.com is using the discovered Python interpreter at /usr/bin/python, but future</span><span id="6919" class="lu ig hi lq b fi ml lw l lx ly">installation of another Python interpreter could change this. See https://docs.ansible.com/ansible/2.9/reference_appendices/interpreter_discovery.html</span><span id="ea3b" class="lu ig hi lq b fi ml lw l lx ly">for more information.</span><span id="46b4" class="lu ig hi lq b fi ml lw l lx ly">ok: [ec2-107-21-17-60.compute-1.amazonaws.com]</span><span id="1bb3" class="lu ig hi lq b fi ml lw l lx ly">TASK [ensure apache is at the latest version] *********************************************************************************************************</span><span id="5896" class="lu ig hi lq b fi ml lw l lx ly">changed: [ec2-54-86-185-90.compute-1.amazonaws.com]</span><span id="5075" class="lu ig hi lq b fi ml lw l lx ly">changed: [ec2-107-21-17-60.compute-1.amazonaws.com]</span><span id="7b30" class="lu ig hi lq b fi ml lw l lx ly">TASK [start apache] ***********************************************************************************************************************************</span><span id="176d" class="lu ig hi lq b fi ml lw l lx ly">changed: [ec2-54-86-185-90.compute-1.amazonaws.com]</span><span id="0464" class="lu ig hi lq b fi ml lw l lx ly">changed: [ec2-107-21-17-60.compute-1.amazonaws.com]</span><span id="4973" class="lu ig hi lq b fi ml lw l lx ly">PLAY RECAP ********************************************************************************************************************************************</span><span id="3bea" class="lu ig hi lq b fi ml lw l lx ly">ec2-107-21-17-60.compute-1.amazonaws.com : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span><span id="0c99" class="lu ig hi lq b fi ml lw l lx ly">ec2-54-86-185-90.compute-1.amazonaws.com : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span></pre><p id="2258" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">å°±è¿™æ ·ï¼Œä½ å·²ç»äº†è§£äº†AnsibleåŠ¨æ€åº“å­˜çš„æ‰€æœ‰å†…å®¹ã€‚æ‚¨å¯ä»¥ä»<a class="ae lg" href="https://docs.ansible.com/ansible/latest/collections/amazon/aws/aws_ec2_inventory.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">è¿™é‡Œ</strong> </a>è¿›ä¸€æ­¥æ¢ç´¢AnsibleåŠ¨æ€åº“å­˜ã€‚</p><p id="28bc" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">å¦‚æœæ‚¨å‘ç°æ­¤æŒ‡å—æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹å‡»ğŸ‘æŒ‰é’®ï¼Œä¹Ÿå¯ä»¥éšæ„å‘è¡¨è¯„è®ºã€‚</p><p id="c796" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">å…³æ³¨æ›´å¤šç±»ä¼¼çš„æ•…äº‹ğŸ˜Š</p></div></div>    
</body>
</html>