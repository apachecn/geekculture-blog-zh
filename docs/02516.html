<html>
<head>
<title>Three Ways to Use Secrets in Ansible</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨Ansibleä¸­ä½¿ç”¨æœºå¯†çš„ä¸‰ç§æ–¹å¼</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/three-ways-to-use-secrets-in-ansible-922ae18df847?source=collection_archive---------2-----------------------#2021-05-18">https://medium.com/geekculture/three-ways-to-use-secrets-in-ansible-922ae18df847?source=collection_archive---------2-----------------------#2021-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="1adc" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">åœ¨Ansibleä¸­ä½¿ç”¨æœºå¯†</h2><div class=""/><div class=""><h2 id="6abf" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">GPGï¼Œå®‰è¥¿å¸ƒå°”é‡‘åº“è¿˜æ˜¯å“ˆå¸Œç§‘å°”é‡‘åº“ï¼Ÿè§£å†³åŒä¸€ä¸ªé—®é¢˜çš„ä¸‰ç§æ–¹æ¡ˆã€‚</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/20f6e16cd781604a70b2de4329892701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GHAhEMtn_C6qV3Hc"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">Photo by <a class="ae jw" href="https://unsplash.com/@jankolar?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jan Antonin Kolar</a> on <a class="ae jw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="e472" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ix ki iy kj ja kk jb kl jd km je kn ko bi translated">ä»‹ç»</h1><p id="9e63" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">è¦ç”¨Ansibleå­˜å‚¨ç§˜å¯†ã€å‡­è¯ã€è¯ä¹¦ï¼Œæœ‰å‡ ç§å¯èƒ½æ€§ã€‚ä½ å¯ä»¥ä½¿ç”¨Ansible Vaultæ¥åŠ å¯†ä½ æ‰€æœ‰çš„æ•æ„Ÿä¿¡æ¯ã€‚Ansibleæä¾›çš„æœºåˆ¶æ˜¯å†…ç½®çš„ï¼Œå¯ä»¥æ»¡è¶³å„ç§ç”¨ä¾‹ã€‚æ­¤å¤–ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å¤šä¸ªä¿ç®¡åº“ï¼Œå¹¶å°†å®ƒä»¬ä¸æ‚¨çš„åº“å­˜ç»„ç»‡åœ¨ä¸€èµ·ã€‚</p><p id="6d08" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">è¿™æ ·åšæœ‰åŠ©äºæ‚¨ç»„ç»‡å’Œçº¦æŸä¸åº“å­˜ç›¸å…³çš„ç§˜å¯†ã€‚æˆ‘è¿‡å»ç”¨å®ƒæ¥å­˜å‚¨æˆ‘åœ¨GitHubä¸­çš„ä¸åŒå‰§æœ¬å’Œè§’è‰²ã€‚æˆ‘ä»¬å¯ä»¥è®¨è®ºåœ¨GitHubä¸Šå­˜å‚¨åŠ å¯†æ–‡ä»¶æ˜¯å¥½æ˜¯åï¼Œä½†è‡³å°‘è¿™æ¯”åœ¨è¿™æ ·çš„å¹³å°ä¸Šå­˜å‚¨å¸¦æœ‰å‡­è¯çš„æ˜æ–‡æ–‡ä»¶è¦å¥½å¾—å¤šğŸ˜…ã€‚</p><p id="b003" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">ä½ ä¹Ÿå¯ä»¥ç”¨ansible varæ–‡ä»¶(yamlæ–‡ä»¶)æ„å»ºä½ è‡ªå·±çš„è§£å†³æ–¹æ¡ˆï¼Œä½ å¯ä»¥ç”¨GPGè¿™æ ·çš„è§£å†³æ–¹æ¡ˆâ€œç®€å•åœ°â€åŠ å¯†è¿™äº›æ–‡ä»¶ã€‚è¿™å¾ˆç®€å•ï¼Œä¸å¤ªéš¾å®ç°ã€‚å½“ä½ æ²¡æœ‰æˆç™¾ä¸Šåƒçš„ç§˜å¯†æ—¶ï¼Œè¿™ä¸ªè§£å†³æ–¹æ¡ˆå°±è¶³å¤Ÿäº†ã€‚è¿™æ˜¯æˆ‘ä»¬åœ¨æˆ‘çš„å·¥ä½œä¸­å®ç°çš„ã€‚</p><p id="382c" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æœ€åï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å…¶ä»–è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚Ansible Vaultï¼Œå®ƒä»¬è¦å®Œæ•´å¾—å¤šï¼Œå¯ä»¥å¤„ç†æ›´å¤§çš„ç”¨ä¾‹ã€‚æ­£å¦‚å·²ç»è§£é‡Šè¿‡çš„ï¼Œå¯¹äºæˆ‘çš„å®éªŒå®¤ï¼Œæˆ‘çš„ç›®æ ‡æ˜¯æ¢ç´¢å°½å¯èƒ½å¤šçš„æŠ€æœ¯ã€‚æˆ‘æƒ³ä½¿ç”¨HashiCorp Vaultï¼Œå› ä¸ºå®ƒä¼¼ä¹æ˜¯ä¸€ä¸ªå®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼Œå³ä½¿æ˜¯ç¤¾åŒºç‰ˆã€‚</p><h1 id="7f3f" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ix ki iy kj ja kk jb kl jd km je kn ko bi translated">GPGè§£å†³æ–¹æ¡ˆ</h1><p id="b360" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">å¯¹äºé‚£äº›å¯¹è¿™ç§å¯èƒ½æ€§æ„Ÿå…´è¶£çš„äººï¼Œæˆ‘å°†è¯•ç€ç®€è¦ä»‹ç»ä¸€ä¸‹GPGçš„è§£å†³æ–¹æ¡ˆã€‚åœ¨Mac OS Xä¸Šï¼Œæˆ‘å®‰è£…äº†ä»¥ä¸‹å·¥å…·:</p><ul class=""><li id="8918" class="lq lr hi kr b ks ll kv lm ky ls lc lt lg lu lk lv lw lx ly bi translated"><a class="ae jw" href="https://gnupg.org/" rel="noopener ugc nofollow" target="_blank"> gpg2 </a>(ç®¡ç†å¯†é’¥å’ŒåŠ å¯†/è§£å¯†æ–‡ä»¶çš„æ ¸å¿ƒå·¥å…·)</li><li id="13c3" class="lq lr hi kr b ks lz kv ma ky mb lc mc lg md lk lv lw lx ly bi translated"><a class="ae jw" href="https://gpgtools.org/" rel="noopener ugc nofollow" target="_blank"> GPGSuite </a>(ç”¨äºç®¡ç†å¯†é’¥å¹¶è½»æ¾ä¸Appleé’¥åŒ™é“¾é›†æˆçš„å®ç”¨ç¨‹åº)</li></ul><h2 id="3ce0" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">è£…ç½®</h2><p id="ea79" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">ä¸ºäº†å®‰è£…å·¥å…·ï¼Œæˆ‘ç®€å•åœ°ä½¿ç”¨äº†<code class="du mr ms mt mu b">homebrew</code>ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="f5d3" class="me jy hi mu b fi mz na l nb nc"># Start the generation of the key. I keep the RSA &amp; RSA default,<br/># 4096 for the key length and no expiration (update to your needs).<br/># Then fill a proper name and an email address.<em class="nd"><br/></em><strong class="mu hs">â¯ brew cask install gpg-suite-no-mail</strong></span></pre><h2 id="4bf3" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">GPGå…³é”®ä¸€ä»£</h2><p id="1e86" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">ä¸‹ä¸€æ­¥æ˜¯ç”Ÿæˆä¸€ä¸ªGPGå¯†é’¥ã€‚GPGSuiteå·¥å…·ä¼šæç¤ºæ‚¨è¾“å…¥å¯†ç ä¸¤æ¬¡ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘é€‰æ‹©ä¸è¾“å…¥å¯†ç ã€‚æ‹¥æœ‰ä¸€ä¸ªå¯†ç å–å†³äºä½ å’Œä½ çš„å®‰å…¨éœ€æ±‚ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="98f2" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># Start the generation of the key. I keep the RSA &amp; RSA default,<br/># 4096 for the key length and no expiration (feel free to update<br/># to your needs).<br/># Then, you have to fill a real name and an email address.<br/></em><strong class="mu hs">â¯ gpg2 --full-generate-key</strong></span><span id="6acb" class="me jy hi mu b fi ne na l nb nc">gpg (GnuPG/MacGPG2) 2.2.20; Copyright (C) 2020 Free Software Foundation, Inc.<br/>This is free software: you are free to change and redistribute it.<br/>There is NO WARRANTY, to the extent permitted by law.</span><span id="de1e" class="me jy hi mu b fi ne na l nb nc">Please select what kind of key you want:<br/>   (1) RSA and RSA (default)<br/>   (2) DSA and Elgamal<br/>   (3) DSA (sign only)<br/>   (4) RSA (sign only)<br/>  (14) Existing key from card<br/>Your selection? 1<br/>RSA keys may be between 1024 and 4096 bits long.<br/>What keysize do you want? (2048) 4096<br/>Requested keysize is 4096 bits<br/>Please specify how long the key should be valid.<br/>         0 = key does not expire<br/>      &lt;n&gt;  = key expires in n days<br/>      &lt;n&gt;w = key expires in n weeks<br/>      &lt;n&gt;m = key expires in n months<br/>      &lt;n&gt;y = key expires in n years<br/>Key is valid for? (0) 0<br/>Key does not expire at all<br/>Is this correct? (y/N) y</span><span id="8076" class="me jy hi mu b fi ne na l nb nc">GnuPG needs to construct a user ID to identify your key.</span><span id="8efb" class="me jy hi mu b fi ne na l nb nc">Real name: &lt;realName&gt;<br/>Email address: <a class="ae jw" href="mailto:japan@prevole.ch" rel="noopener ugc nofollow" target="_blank">&lt;emailAddress&gt;</a><br/>Comment:<br/>You selected this USER-ID:<br/>    "&lt;realName&gt; &lt;<a class="ae jw" href="mailto:japan@prevole.ch" rel="noopener ugc nofollow" target="_blank">ema</a>ilAddress&gt;"</span><span id="9f5d" class="me jy hi mu b fi ne na l nb nc">Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit?</span><span id="9ad9" class="me jy hi mu b fi ne na l nb nc">We need to generate a lot of random bytes. It is a good idea to perform<br/>some other action (type on the keyboard, move the mouse, utilize the<br/>disks) during the prime generation; this gives the random number<br/>generator a better chance to gain enough entropy.<br/>gpg: key &lt;ID&gt; marked as ultimately trusted<br/>gpg: revocation certificate stored as '/Users/&lt;username&gt;/.gnupg/openpgp-revocs.d/&lt;anotherId&gt;.rev'<br/>public and secret key created and signed.</span><span id="c753" class="me jy hi mu b fi ne na l nb nc">pub   rsa4096 2020-10-05 [SC]<br/>      &lt;anotherId&gt;<br/>uid   &lt;realName&gt; &lt;emailAddress&gt;<br/>sub   rsa4096 2020-10-05 [E]</span></pre><p id="4082" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">è¦æ£€æŸ¥æ‚¨çš„å¯†é’¥æ˜¯å¦å·²ç»ç”Ÿæˆï¼Œæ‚¨å¯ä»¥åˆ—å‡ºå®ƒä»¬ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="97ae" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># You can have other keys, I only kept in the output the one <br/># just created</em><br/><strong class="mu hs">â¯ gpg2 --list-keys</strong></span><span id="5c19" class="me jy hi mu b fi ne na l nb nc">gpg: checking the trustdb<br/>gpg: marginals needed: 3  completes needed: 1  trust model: pgp<br/>gpg: depth: 0  valid:   4  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 4u<br/>/Users/&lt;username&gt;/.gnupg/pubring.kbx<br/>-----------------------------------------<br/>pub   rsa4096 2020-10-05 [SC]<br/>      &lt;anotherId&gt;<br/>uid           [ultimate] &lt;realName&gt; &lt;<a class="ae jw" href="mailto:japan@prevole.ch" rel="noopener ugc nofollow" target="_blank">emailAddress</a>&gt;<br/>sub   rsa4096 2020-10-05 [E]</span></pre><h2 id="f2cf" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">ç”¨GPGå¯†é’¥åŠ å¯†</h2><p id="e283" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">è¦ä½¿ç”¨æ‚¨çš„å¯†é’¥åŠ å¯†æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥ç®€å•åœ°ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="f1fd" class="me jy hi mu b fi mz na l nb nc"># We trust our generated key. We identify the key with the email<br/># address and we give the file to <!-- -->cipher<br/><strong class="mu hs">â¯ gpg --always-trust --yes --recipient "</strong><a class="ae jw" href="mailto:japan@prevole.ch" rel="noopener ugc nofollow" target="_blank"><strong class="mu hs">&lt;emailAddress&gt;</strong></a><strong class="mu hs">" --encrypt &lt;pathToTheFileToEncrypt&gt;</strong></span></pre><p id="9447" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">å¦‚æœåŠ å¯†æ“ä½œæˆåŠŸï¼Œæ§åˆ¶å°ä¸­æ²¡æœ‰ç‰¹æ®Šè¾“å‡ºã€‚è¯¥å‘½ä»¤äº§ç”Ÿä¸€ä¸ª<code class="du mr ms mt mu b">gpg</code>æ–‡ä»¶ã€‚</p><h2 id="260e" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">ç”¨GPGå¯†é’¥è§£å¯†</h2><p id="c7b5" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">è¦æ£€ç´¢åŠ å¯†æ–‡ä»¶çš„æ˜æ–‡å†…å®¹ï¼Œæˆ‘ä»¬åªéœ€æ‰§è¡Œä¸€ä¸ªç›¸åçš„å‘½ä»¤ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="dac7" class="me jy hi mu b fi mz na l nb nc"># To decrypt, we need to specify the input file, which is the<br/># encrypted file and the output file. GPG will automatically pick<br/># the right key to decrypt. The encrypted file contains the info.<br/><strong class="mu hs">â¯ gpg --output &lt;pathToDecryptedFile&gt; --yes --decrypt &lt;pathToCryptedFile&gt;</strong></span><span id="595b" class="me jy hi mu b fi ne na l nb nc">gpg: encrypted with 4096-bit RSA key, ID &lt;ID&gt;, created 2020-10-05<br/>      "&lt;realName&gt; &lt;<a class="ae jw" href="mailto:japan@prevole.ch" rel="noopener ugc nofollow" target="_blank">emailAddress</a>&gt;"</span></pre><p id="fef4" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">å°±æ˜¯è¿™æ ·ã€‚ç”¨GPGåŠ å¯†å’Œè§£å¯†çš„æ“ä½œéå¸¸å®¹æ˜“ã€‚æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†å¤„ç†ç§˜å¯†ä½¿ç”¨ç®¡ç†çš„æ‰€æœ‰å¯è¡Œä»»åŠ¡ã€‚</p><h2 id="9eb7" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">å®‰è¥¿å¸ƒå°”å’ŒGPGåœ¨ä¸€èµ·</h2><p id="ee9d" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">æ˜¯æ—¶å€™æŠŠæ‰€æœ‰çš„ç¢ç‰‡æ”¾åœ¨ä¸€èµ·ï¼Œå†™ä¸€ä¸ªå‰§æœ¬äº†ã€‚å‰§æœ¬å°†åŒ…å«è§£å¯†éƒ¨åˆ†å’Œä¸€äº›æœ€åçš„æ¸…ç†å·¥ä½œã€‚</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="nf ng l"/></div><figcaption class="js jt et er es ju jv bd b be z dx">Ansible Playbook with Encrypted Var File</figcaption></figure><p id="6911" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated"><strong class="kr hs"> â‘  </strong>æˆ‘ä»¬è§£å¯†åŒ…å«ç§˜å¯†çš„varæ–‡ä»¶ã€‚</p><p id="b6a7" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated"><strong class="kr hs"> â‘¡ </strong>ç„¶åï¼Œå¾ˆå®¹æ˜“å°†varæ–‡ä»¶ä½œä¸ºæ™®é€švaræ–‡ä»¶åŒ…å«åœ¨å‰§æœ¬ä¸­ã€‚</p><p id="c265" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æˆ‘ä»¬è¿è¡Œéœ€è¦ä¸€äº›ç§˜å¯†(å¯†ç ã€ä»¤ç‰Œã€è¯ä¹¦ç­‰)çš„ä»»åŠ¡</p><p id="905e" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated"><strong class="kr hs"> â‘£ </strong>æœ€åï¼Œæˆ‘ä»¬åªéœ€åˆ é™¤clearæ–‡ä»¶ã€‚</p><h2 id="b4c8" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">GPGæ‘˜è¦</h2><p id="162a" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">è¿™ç§æ–¹æ³•çš„ä¸»è¦ç¼ºç‚¹ä»ç„¶æ˜¯ï¼Œå¦‚æœå‰§æœ¬ç”±äºé”™è¯¯è€Œä¸­æ–­ï¼Œæ–‡ä»¶å¯èƒ½ä¸ä¼šè¢«æ¸…é™¤ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç­–ç•¥æ¥ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚é€šçŸ¥/å¤„ç†ç¨‹åºã€‚</p><p id="57e4" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">åœ¨æˆ‘çš„å·¥ä½œä¸­ï¼Œæˆ‘ç»§æ‰¿äº†ä¸€ä¸ªç°æœ‰çš„è®¾ç½®ï¼Œå…¶ä¸­varæ–‡ä»¶åŠ å¯†/è§£å¯†è¿‡ç¨‹æ˜¯åœ¨ä»»ä½•è¡ŒåŠ¨æ‰‹å†Œä¹‹å¤–å®Œæˆçš„ã€‚varæ–‡ä»¶è¢«åŠ å¯†å¹¶å­˜å‚¨åœ¨å†…éƒ¨GitHubä¼ä¸šå®ä¾‹çš„gitå­˜å‚¨åº“ä¸­ã€‚ç„¶åï¼Œè§£å¯†åçš„æ–‡ä»¶å­˜å‚¨åœ¨<code class="du mr ms mt mu b">/etc/ansible/group_vars</code>ä¸­ï¼Œå°±åƒä¸€ä¸ªç”¨äº<code class="du mr ms mt mu b">all</code>åº“å­˜çš„å…¨å±€varæ–‡ä»¶ã€‚</p><p id="d81c" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æœ€åï¼Œå¦‚æœä¸è€ƒè™‘å®‰å…¨æ€§ï¼Œæˆ‘ä¸æ¨èè¿™äº›æ–¹æ³•ã€‚å¦‚æœä½ ä¸å¾—ä¸ç®¡ç†çš„ç§˜å¯†ä¸æ˜¯é‚£ä¹ˆæ•æ„Ÿæˆ–è€…å¯¹äºå®¶åº­å®éªŒå®¤æ¥è¯´æ˜¯éå¸¸å¥½çš„ã€‚å¯¹äºçœŸå®çš„äº§å“ï¼Œæˆ‘ä¼šå¢åŠ ä¸€ç‚¹å®‰å…¨æ€§ï¼Œæ¯”å¦‚åœ¨GPGå¯†é’¥ä¸­åŠ å…¥ä¸€ä¸ªå¯†ç ã€‚æ­¤å¤–ï¼Œæˆ‘ä¼šå°½å¯èƒ½é¿å…ä½¿ç”¨æ˜æ–‡ã€‚</p><h1 id="fa0f" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ix ki iy kj ja kk jb kl jd km je kn ko bi translated">å¯æ—‹è½¬æ‹±é¡¶</h1><p id="fd1a" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">å¦‚å‰æ‰€è¿°ï¼ŒAnsibleæœ¬èº«æä¾›äº†å­˜å‚¨æ•æ„Ÿæ•°æ®çš„è§£å†³æ–¹æ¡ˆã€‚æˆ‘åœ¨Ansibleçš„æ—©æœŸä½¿ç”¨è¿‡è¿™ç§æœºåˆ¶ã€‚è¿™ä¹Ÿæ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„è§£å†³æ–¹æ¡ˆï¼Œå®‰å…¨åœ°å­˜å‚¨æ‚¨çš„æ•æ„Ÿæ•°æ®ã€‚</p><p id="cda1" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">Ansibleæ–‡æ¡£è­¦å‘Šæ‚¨ä½¿ç”¨Ansible Vaultçš„é£é™©ã€‚</p><blockquote class="nh ni nj"><p id="819a" class="kp kq nd kr b ks ll is ku kv lm iv kx nk ln la lb nl lo le lf nm lp li lj lk hb bi translated">Ansible VaultåŠ å¯†ä»…ä¿æŠ¤â€œé™æ€æ•°æ®â€ã€‚ä¸€æ—¦å†…å®¹è¢«è§£å¯†(â€œä½¿ç”¨ä¸­çš„æ•°æ®â€)ï¼Œplayå’Œæ’ä»¶ä½œè€…æœ‰è´£ä»»é¿å…ä»»ä½•ç§˜å¯†æ³„éœ²ï¼Œæœ‰å…³éšè—è¾“å‡ºçš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§<a class="ae jw" href="https://docs.ansible.com/ansible/latest/reference_appendices/faq.html#keep-secret-data" rel="noopener ugc nofollow" target="_blank"> no_log </a>ï¼Œæœ‰å…³ä¸Ansible Vaultä¸€èµ·ä½¿ç”¨çš„ç¼–è¾‘å™¨çš„å®‰å…¨æ³¨æ„äº‹é¡¹ï¼Œè¯·å‚è§<a class="ae jw" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html#vault-securing-editor" rel="noopener ugc nofollow" target="_blank">ä¿æŠ¤ç¼–è¾‘å™¨çš„æ­¥éª¤</a>ã€‚â€” <a class="ae jw" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html" rel="noopener ugc nofollow" target="_blank">å¯æä¾›çš„æ–‡ä»¶</a></p></blockquote><h2 id="c459" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">ä½¿ç”¨Ansible VaultåŠ å¯†</h2><p id="2097" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">ä½¿ç”¨ä¿é™©åº“åŠ å¯†æ•°æ®æœ‰ä¸¤ç§å¯èƒ½æ€§ã€‚ä¸€ç§æ˜¯ç›´æ¥åœ¨è¡ŒåŠ¨æ‰‹å†Œä¸­åŠ å¯†æ•æ„Ÿä¿¡æ¯ã€‚ä¸€æ¬¡åªèƒ½åŠ å¯†ä¸€ä¸ªå˜é‡ã€‚ç¬¬äºŒç§å¯èƒ½æ€§æ˜¯åŠ å¯†æ•´ä¸ªæ–‡ä»¶ã€‚æˆ‘åŠ å¯†äº†ä¸€ä¸ªå®Œæ•´çš„æ–‡ä»¶ï¼Œå°±åƒæˆ‘ä»¬ä¹‹å‰å’ŒGPGåšçš„ä¸€æ ·ã€‚</p><p id="186a" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">Ansible Vaultçš„ä¼˜ç‚¹æ˜¯å¯ä»¥ç›´æ¥åŠ å¯†varæ–‡ä»¶ã€‚ä¹‹åï¼Œå½“æˆ‘ä»¬è¿è¡ŒåŒ…å«æˆ–å¼•ç”¨varæ–‡ä»¶çš„å‰§æœ¬æ—¶ï¼ŒAnsibleä¼šè‡ªåŠ¨æç¤ºæ‚¨è§£å¯†ã€‚</p><p id="f0e2" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æ–‡ä»¶åŠ å¯†å°±åƒä¸‹é¢çš„å‘½ä»¤ä¸€æ ·ç®€å•ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="d24b" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># Encrypt an inventory var file</em><br/><strong class="mu hs">â¯ ansible-vault encrypt all.yml</strong></span><span id="aff7" class="me jy hi mu b fi ne na l nb nc">New Vault password: <br/>Confirm New Vault password: <br/>Encryption successful</span></pre><p id="abcc" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">è¦æŸ¥çœ‹åŠ å¯†æ–‡ä»¶çš„å†…å®¹ï¼Œåªéœ€è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="1b56" class="me jy hi mu b fi mz na l nb nc"><strong class="mu hs">â¯ ansible-vault view all.yml</strong>   </span><span id="1275" class="me jy hi mu b fi ne na l nb nc">Vault password:</span></pre><p id="ad36" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">è¦ç¼–è¾‘åŠ å¯†æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„å‘½ä»¤ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="c769" class="me jy hi mu b fi mz na l nb nc"><strong class="mu hs">â¯ ansible-vault edit all.yml</strong></span><span id="d00d" class="me jy hi mu b fi ne na l nb nc">Vault password:</span></pre><h2 id="7311" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated"><strong class="ak">ç”¨å®‰å…¨é‡‘åº“è§£å¯†</strong></h2><p id="4037" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">vaultæ–‡ä»¶çš„è§£å¯†ä¹Ÿå¾ˆå®¹æ˜“ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="a820" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># This command will decrypt the var file in place.</em><br/><strong class="mu hs">â¯ ansible-vault decrypt all.yml</strong></span><span id="5356" class="me jy hi mu b fi ne na l nb nc">Vault password: <br/>Decryption successful</span></pre><h2 id="cd62" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">å¯è½¬æ¢å’Œä¸å¯è½¬æ¢çš„æ‹±é¡¶åœ¨ä¸€èµ·</h2><p id="1047" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">æ˜¯æ—¶å€™æŠŠæ‰€æœ‰çš„ç¢ç‰‡æ”¾åœ¨ä¸€èµ·äº†ã€‚æˆ‘ä»¬çŸ¥é“å¦‚ä½•åŠ å¯†ä¸€ä¸ªå˜é‡æ–‡ä»¶ã€‚æˆ‘ä»¬åªéœ€è¦æŠŠæ‰€æœ‰ä¸œè¥¿æ”¾å¥½å°±å¯ä»¥ä½¿ç”¨åŠ å¯†æ–‡ä»¶äº†ã€‚</p><p id="e6bb" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æˆ‘ç”¨å‰§æœ¬å’Œæ¸…å•åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„é¡¹ç›®ã€‚æˆ‘å°†åŠ å¯†çš„å˜é‡æ–‡ä»¶æ”¾åœ¨æˆ‘çš„æ¸…å•çš„<code class="du mr ms mt mu b">group_vars</code>ä¸­ã€‚</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="nf ng l"/></div><figcaption class="js jt et er es ju jv bd b be z dx">Ansible Vault â€” Demo Project</figcaption></figure><p id="a127" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated"><strong class="kr hs">â‘ </strong>varæ–‡ä»¶ç”¨Ansible VaultåŠ å¯†ã€‚</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="nf ng l"/></div><figcaption class="js jt et er es ju jv bd b be z dx">Ansible Vault â€” Var File Encrypted</figcaption></figure><p id="d4e7" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated"><strong class="kr hs">â‘ </strong>varæ–‡ä»¶åªåŒ…å«åŠ å¯†çš„å†…å®¹å’Œåƒç®—æ³•ä¸€æ ·è§£å¯†æ–‡ä»¶çš„æ•°æ®ã€‚</p><p id="18a8" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">â‘¡æ˜ç¡®çš„å†…å®¹åœ¨é‚£é‡Œä½œä¸ºåé¢çš„å‚è€ƒã€‚å˜é‡<code class="du mr ms mt mu b">test</code>è¢«å®šä¹‰ã€‚</p><p id="0c31" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">å®¿ä¸»æ–‡ä»¶åªæ˜¯ä¸€ä¸ªæ¸…å•æ–‡ä»¶ï¼Œç”¨æ¥é“¾æ¥<code class="du mr ms mt mu b">group_vars/test</code>å˜é‡ã€‚</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="nf ng l"/></div><figcaption class="js jt et er es ju jv bd b be z dx">Ansible Vault â€” Host File</figcaption></figure><p id="e3a9" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æœ€åï¼Œæˆ‘ä»¬æœ‰äº†è¡ŒåŠ¨æ‰‹å†Œã€‚å‰§æœ¬åªåŒ…å«ä¸€ä¸ªä»»åŠ¡ï¼Œå³åœ¨varæ–‡ä»¶ä¸­æ‰“å°å˜é‡ã€‚</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="nf ng l"/></div><figcaption class="js jt et er es ju jv bd b be z dx">Ansible Vault â€” Demo Playbook</figcaption></figure><p id="5e64" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated"><strong class="kr hs"> â‘  </strong>å®ƒå°†åœ¨è°ƒè¯•æ¶ˆæ¯ä»»åŠ¡ä¸­æ‰“å°å‡ºåŠ å¯†æ–‡ä»¶ä¸­çš„å˜é‡<code class="du mr ms mt mu b">test</code>ã€‚</p><p id="e072" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">ä¸ºäº†è¿è¡Œå‰§æœ¬å¹¶æŸ¥çœ‹åŠ å¯†å˜é‡çš„å†…å®¹ï¼Œæˆ‘ä»¬è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="07bc" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># We have to specify the inventory file. We also need to specify <br/># to be asked for the vault password</em><strong class="mu hs"><br/>â¯ ansible-playbook --ask-vault-password -i inventories/test playbooks/test.yml</strong></span><span id="a0d1" class="me jy hi mu b fi ne na l nb nc">Vault password:</span><span id="3a73" class="me jy hi mu b fi ne na l nb nc">PLAY [test] ********************************************************************</span><span id="f7f6" class="me jy hi mu b fi ne na l nb nc"><em class="nd"># â‘ </em><br/>TASK [Debug] ********************************************************************<br/>ok: [0.0.0.0] =&gt; <br/>  test: my super secret password</span><span id="ac03" class="me jy hi mu b fi ne na l nb nc">PLAY RECAP ********************************************************************<br/>0.0.0.0                    : ok=1    changed=0    unreachable=0<br/>                             failed=0    skipped=0    rescued=0<br/>                             ignored=0</span></pre><p id="e34b" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated"><strong class="kr hs"> â‘  </strong>è°ƒè¯•ä»»åŠ¡ä»åŠ å¯†çš„varæ–‡ä»¶ä¸­è¾“å‡ºå¯†ç ã€‚</p><p id="46ef" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">å¦‚æœä½ å¿˜è®°æ·»åŠ é€‰é¡¹<code class="du mr ms mt mu b">--ask-vault-password</code>ï¼Œä½ ä¼šå¾—åˆ°ä»¥ä¸‹é”™è¯¯ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="6821" class="me jy hi mu b fi mz na l nb nc"><strong class="mu hs">â¯ ansible-playbook -i inventories/test playbooks/test.yml</strong></span><span id="2922" class="me jy hi mu b fi ne na l nb nc">PLAY [test] ********************************************************************ERROR! Attempting to decrypt but no vault secrets found</span></pre><h2 id="4344" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">æ˜“å˜ä¿é™©åº“æ‘˜è¦</h2><p id="9cd0" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">è¿™ç§æ–¹æ³•éå¸¸é€‚åˆå¤„ç†ç§˜å¯†å’Œå¯†ç ã€‚è¿™æ˜¯ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„é‡‘åº“ã€‚åªæ˜¯æœ‰ä¸€ç‚¹éº»çƒ¦ï¼Œæ¯æ¬¡æˆ‘ä»¬è°ƒç”¨å‰§æœ¬æ—¶éƒ½è¦è¢«è¿«è¾“å…¥å¯†ç ã€‚</p><p id="cfb9" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">ä½¿ç”¨<code class="du mr ms mt mu b">--vault-password-file</code>è‡³å°‘æœ‰ä¸€ç§å¯èƒ½æ€§ï¼Œå³ä½¿ç”¨åŒ…å«æ˜æ–‡å¯†ç çš„æ–‡ä»¶ã€‚ä½¿ç”¨è¿™ç§æŠ€æœ¯éœ€è¦æœ‰å…¶ä»–å®‰å…¨æœºåˆ¶æ¥é¿å…ä¸å…è®¸çš„äººçœ‹åˆ°å¯†ç ã€‚</p><p id="5b7f" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">è¿™ç§æœºåˆ¶çš„ä¸»è¦ä¼˜ç‚¹æ˜¯Ansibleä¸­çš„å†…ç½®ç‰¹æ€§ã€‚ä½ ä¸å¿…å®‰è£…å’Œè®¾ç½®é¢å¤–çš„ä¸œè¥¿ã€‚å¯¹æˆ‘æ¥è¯´ï¼Œæœ€å¤§çš„ç¼ºç‚¹æ˜¯å¿…é¡»è¾“å…¥å¯†ç æˆ–è€…ç»™å‡ºä¸€ä¸ªå¯†ç æ–‡ä»¶ä½œä¸ºå‚æ•°ã€‚</p><p id="ccde" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">è¿˜æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥ç”¨Ansibleè®¾ç½®é»˜è®¤å¯†ç æˆ–å¯†ç æ–‡ä»¶ã€‚äº‹å®ä¸Šï¼ŒAnsibleæ–‡æ¡£é¡µé¢åŒ…å«äº†æ‰€æœ‰çš„è®¾ç½®ä¿¡æ¯ã€‚</p><div class="nn no ez fb np nq"><a href="https://docs.ansible.com/ansible/latest/user_guide/vault.html#configuring-defaults-for-using-encrypted-content" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab dw"><div class="ns ab nt cl cj nu"><h2 class="bd hs fi z dy nv ea eb nw ed ef hr bi translated">ä½¿ç”¨Ansible VaultåŠ å¯†å†…å®¹- Ansibleæ–‡æ¡£</h2><div class="nx l"><h3 class="bd b fi z dy nv ea eb nw ed ef dx translated">Ansible VaultåŠ å¯†å˜é‡å’Œæ–‡ä»¶ï¼Œå› æ­¤æ‚¨å¯ä»¥ä¿æŠ¤æ•æ„Ÿå†…å®¹ï¼Œå¦‚å¯†ç æˆ–å¯†é’¥ï¼Œè€Œä¸æ˜¯â€¦</h3></div><div class="ny l"><p class="bd b fp z dy nv ea eb nw ed ef dx translated">docs.ansible.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe jq nq"/></div></div></a></div><h1 id="544f" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ix ki iy kj ja kk jb kl jd km je kn ko bi translated">å“ˆå¸Œå…¬å¸é‡‘åº“</h1><p id="7862" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">æˆ‘ä¸€ç›´æ˜¯åƒæµæµªè€…è¿™æ ·çš„äº§å“çš„ç²‰ä¸ã€‚æˆ‘ä¹Ÿåœ¨ä¸€äº›ä»»åŠ¡ä¸­ä½¿ç”¨Terraformã€‚æˆ‘å¬è¯´è·³é©¬å·²ç»å¾ˆä¹…äº†ã€‚è¿™äº›äº§å“æ¥è‡ªå“ˆå¸Œå…¬å¸ã€‚ä»–ä»¬å»ºç«‹äº†ä¸€å¥—äº§å“æ¥ç®¡ç†äº‘/æ··åˆåŸºç¡€æ¶æ„ã€‚</p><p id="2b9d" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">HashiCorp Vaultçš„æ‰¿è¯ºæ˜¯ç®¡ç†ç§˜å¯†å’Œæ›´å¤šï¼Œä½†éƒ½ä¸å®‰å…¨å­˜å‚¨æœ‰å…³ã€‚è¿™ä¸ªè§£å†³æ–¹æ¡ˆæä¾›äº†è®¸å¤šå¯èƒ½æ€§ï¼Œæˆ‘é¼“åŠ±ä½ å»çœ‹çœ‹ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†åªå±•ç¤ºåœ¨Vaultä¸­ä½¿ç”¨é”®-å€¼å¯¹å­˜å‚¨çš„ç®€å•ç§˜å¯†ç®¡ç†ã€‚</p><h2 id="c71a" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">è£…ç½®</h2><p id="1d1a" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">æˆ‘ä»¬éœ€è¦å®‰è£…å“ˆå¸Œå…¬å¸ã€‚åœ¨éº¦å…‹Â·OS Xçš„é¢†å¯¼ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code class="du mr ms mt mu b">homebrew</code>æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="5e79" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># Install the cli tools and the server</em><br/><strong class="mu hs">â¯ brew install hashicorp/tap/vault</strong></span></pre><p id="f57d" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated"><strong class="kr hs"> â€¼ï¸ </strong> <strong class="kr hs">å…è´£å£°æ˜:</strong>ä»¥ä¸‹å®‰è£…å’Œè®¾ç½®æ­¥éª¤æ˜¯æ‚¨å¯ä»¥åœ¨HashiCorp Vaultæ–‡æ¡£ä¸­æ‰¾åˆ°çš„å†…å®¹çš„ç²¾ç®€ç‰ˆæœ¬ã€‚æˆ‘å¼ºçƒˆå»ºè®®éµå¾ªä»–ä»¬çš„æ–‡æ¡£ï¼Œè€Œä¸æ˜¯æˆ‘çš„ã€‚åœ¨æ´»åŠ¨æ—¥å¿—ä¸­æŸ¥çœ‹æˆ‘çš„å®‰è£…è¿‡ç¨‹ğŸ˜ƒã€‚</p><p id="1d79" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">å®‰è£…å®Œæˆåï¼Œæ‚¨å°†è·å¾—æœåŠ¡å™¨å’Œcliå·¥å…·ã€‚HashiCorp Vaultçš„æ–‡æ¡£æä¾›äº†ä½¿ç”¨Vaultçš„æ•™ç¨‹ã€‚è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„èµ·ç‚¹ï¼Œä½†æ˜¯æœåŠ¡å™¨å°†ä»¥<code class="du mr ms mt mu b">dev</code>æ¨¡å¼è¿è¡Œï¼Œå°†ç§˜å¯†å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚åœæ­¢æœåŠ¡å™¨æ„å‘³ç€ä¸¢å¤±ä½ å­˜å‚¨çš„ç§˜å¯†ã€‚</p><div class="nn no ez fb np nq"><a href="https://learn.hashicorp.com/tutorials/vault/getting-started-intro?in=vault/getting-started" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab dw"><div class="ns ab nt cl cj nu"><h2 class="bd hs fi z dy nv ea eb nw ed ef hr bi translated">è·³é©¬ç®€ä»‹</h2><div class="nx l"><h3 class="bd b fi z dy nv ea eb nw ed ef dx translated">Vaulté™„å¸¦å„ç§ç§°ä¸ºæœºå¯†å¼•æ“çš„å¯æ’æ‹”ç»„ä»¶å’Œèº«ä»½éªŒè¯æ–¹æ³•ï¼Œå…è®¸æ‚¨â€¦</h3></div><div class="ny l"><p class="bd b fp z dy nv ea eb nw ed ef dx translated">learn.hashicorp.com</p></div></div><div class="nz l"><div class="of l ob oc od nz oe jq nq"/></div></div></a></div><p id="3b57" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">å®Œæˆåï¼Œæˆ‘é€‰æ‹©äº†éƒ¨ç½²ä¿é™©åº“çš„éƒ¨åˆ†ã€‚åœ¨åŒä¸€ä¸ªæ•™ç¨‹ä¸­ï¼Œæ‚¨æœ‰ä¸€ä¸ªä¸“é—¨çš„éƒ¨åˆ†æ¥ä¸ºâ€œrealâ€éƒ¨ç½²ä¸€ä¸ªVaultã€‚</p><p id="d529" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹æ¥å­˜å‚¨Vaultæ•°æ®ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="f261" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># Create the Vault working directory</em><br/><strong class="mu hs">â¯ mkdir -p vault/data</strong></span></pre><p id="e1b7" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">åœ¨<code class="du mr ms mt mu b">vault</code>ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸‹é¢çš„é…ç½®æ–‡ä»¶<code class="du mr ms mt mu b">config.hcl</code>ã€‚</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="nf ng l"/></div><figcaption class="js jt et er es ju jv bd b be z dx">Vault Configuration File</figcaption></figure><p id="0d3f" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æˆ‘ä»¬å‡†å¤‡å¯åŠ¨æœåŠ¡å™¨ã€‚æˆ‘ä»¬åœ¨å‰å°è¿è¡ŒæœåŠ¡å™¨ï¼Œç„¶åå‘½ä»¤è¡Œæç¤ºç¬¦è¢«è¿è¡Œçš„æœåŠ¡å™¨é˜»å¡ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="78ac" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># Start the server with the configuration file specified</em><br/><strong class="mu hs">â¯ vault server -config=config.hcl</strong></span><span id="4ff7" class="me jy hi mu b fi ne na l nb nc">WARNING! mlock is not supported on this system! An mlockall(2)-like syscall to<br/>prevent memory from being swapped to disk is not supported on this system. For<br/>better security, only run Vault on systems where this call is supported. If<br/>you are running Vault in a Docker container, provide the IPC_LOCK cap to the<br/>container.<br/>==&gt; Vault server configuration:</span><span id="0d05" class="me jy hi mu b fi ne na l nb nc">Api Address: http://127.0.0.1:8200<br/>                     Cgo: disabled<br/>         Cluster Address: https://127.0.0.1:8201<br/>              Go Version: go1.14.7<br/>              Listener 1: tcp (addr: "127.0.0.1:8200", cluster address: "127.0.0.1:8201", max_request_duration: "1m30s", max_request_size: "33554432", tls: "disabled")<br/>               Log Level: info<br/>                   Mlock: supported: false, enabled: false<br/>           Recovery Mode: false<br/>                 Storage: raft (HA available)<br/>                 Version: Vault v1.5.4<br/>             Version Sha: 1a730771ec70149293efe91e1d283b10d255c6d1</span><span id="9d31" class="me jy hi mu b fi ne na l nb nc">==&gt; Vault server started! Log data will stream in below:</span></pre><p id="83ec" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">è­¦å‘Šå¯¹æˆ‘çš„æ¦‚å¿µéªŒè¯å¹¶ä¸é‡è¦ã€‚æˆ‘ä¸ä¼šè®©å®ƒè¿è¡Œå¤ªä¹…çš„ã€‚éº¦å…‹Â·OS Xä¼¼ä¹å¹¶ä¸å®Œå…¨æ”¯æŒå“ˆå¸Œå…¬å¸çš„ä¿é™©åº“ã€‚å®ƒå¯ä»¥ä½¿ç”¨ï¼Œä½†ä½ ä¼šå¤±å»å®‰å…¨æ€§ã€‚æ–‡æ¡£è§£é‡Šäº†æ­¤è­¦å‘Šçš„åŸå› ã€‚</p><div class="nn no ez fb np nq"><a href="https://learn.hashicorp.com/tutorials/vault/getting-started-deploy?in=vault/getting-started#starting-the-server" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab dw"><div class="ns ab nt cl cj nu"><h2 class="bd hs fi z dy nv ea eb nw ed ef hr bi translated">éƒ¨ç½²ä¿ç®¡åº“</h2><div class="nx l"><h3 class="bd b fi z dy nv ea eb nw ed ef dx translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å·²ç»ä¸â€œdevâ€æœåŠ¡å™¨è¿›è¡Œäº†äº¤äº’ï¼Œå®ƒä¼šè‡ªåŠ¨è§£å°Vaultï¼Œè®¾ç½®å†…å­˜å­˜å‚¨â€¦</h3></div><div class="ny l"><p class="bd b fp z dy nv ea eb nw ed ef dx translated">learn.hashicorp.com</p></div></div><div class="nz l"><div class="og l ob oc od nz oe jq nq"/></div></div></a></div><p id="d44a" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–ä¿é™©åº“ã€‚è¦è¿æ¥åˆ°VaultæœåŠ¡å™¨ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸ªç¯å¢ƒå˜é‡ã€‚Vault cliå°†ä½¿ç”¨å®ƒæ¥è·å–ç›®æ ‡æœåŠ¡å™¨ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="3dae" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># Run this command or add it to your bash/zsh profile</em><br/><strong class="mu hs">â¯ export VAULT_ADDR=</strong><a class="ae jw" href="http://127.0.0.1:8200" rel="noopener ugc nofollow" target="_blank"><strong class="mu hs">http://127.0.0.1:8200</strong></a></span></pre><p id="23a5" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">ç„¶åæˆ‘ä»¬å¯ä»¥åˆå§‹åŒ–ä¿é™©åº“ã€‚</p><p id="f998" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">âš ï¸ <strong class="kr hs">è­¦å‘Š</strong>:åœ¨ä¸‹é¢çš„è¾“å‡ºä¸­ï¼Œä½ ä¼šçœ‹åˆ°æˆ‘çš„æœ¬åœ°æ¼”ç¤ºè§£å°å¯†é’¥å’Œæ ¹ä»¤ç‰Œã€‚åœ¨æˆ‘çš„æ¼”ç¤ºä¹‹åï¼Œæˆ‘ç ´åäº†æˆ‘çš„æœåŠ¡å™¨ï¼Œå¯†é’¥å’Œä»¤ç‰Œä¸å†æœ‰æ•ˆã€‚<strong class="kr hs">åƒä¸‡ä¸è¦åœ¨ç½‘ä¸Šç²˜è´´æ•æ„Ÿä¿¡æ¯</strong>ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="5b11" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># The initialisation will create the unseal keys and the root token.</em><br/><strong class="mu hs">â¯ vault operator init</strong></span><span id="7a9e" class="me jy hi mu b fi ne na l nb nc">Unseal Key 1: 43w3kecmIM62Zlmg3OzEkR3vcFWavPXOSo9R5hSorNMG<br/>Unseal Key 2: sfdRpD2vYSeWbDD+pd4RT+2cuh+g7s4blUzhzm/FKoxZ<br/>Unseal Key 3: 026gP9barUPvsOH8AL7p/UMYqb2XLYT0m562tItcdjmf<br/>Unseal Key 4: XCFT60P4zWq6tFbSSb1RRjsjumt/iZGQ32Ei4Wni9q6m<br/>Unseal Key 5: uM2YN7oAMXDi9AgOqJbBndvamP9SZIHfWE5FEZjK1RlU</span><span id="f841" class="me jy hi mu b fi ne na l nb nc">Initial Root Token: s.KQ6acXT29MpSHzMqTAw4c51O</span><span id="15b0" class="me jy hi mu b fi ne na l nb nc">Vault initialized with 5 key shares and a key threshold of 3. Please securely<br/>distribute the key shares printed above. When the Vault is re-sealed,<br/>restarted, or stopped, you must supply at least 3 of these keys to unseal it<br/>before it can start servicing requests.</span><span id="0a6b" class="me jy hi mu b fi ne na l nb nc">Vault does not store the generated master key. Without at least 3 key to<br/>reconstruct the master key, Vault will remain permanently sealed!</span><span id="dfb3" class="me jy hi mu b fi ne na l nb nc">It is possible to generate new unseal keys, provided you have a quorum of<br/>existing unseal keys shares. See "vault operator rekey" for more information.</span></pre><h2 id="0669" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">éªŒè¯å®‰è£…</h2><p id="88fc" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">æ˜¯æ—¶å€™å¼€å¯é‡‘åº“äº†ã€‚è¦æ‰“å¼€ä¿é™©åº“ï¼Œæˆ‘ä»¬éœ€è¦5æŠŠé’¥åŒ™ä¸­çš„3æŠŠã€‚è¿™èƒŒåçš„æƒ³æ³•æ˜¯åœ¨5ä¸ªäººä¹‹é—´å…±äº«å¯†é’¥ã€‚éœ€è¦5ä¸ªäººä¸­çš„3ä¸ªäººæ‰èƒ½æ‰“å¼€ä¿é™©åº“ã€‚é¿å…ç‹¬ä¸€æ— äºŒçš„äººå¯å°é‡‘åº“ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„æ¦‚å¿µã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="fd01" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># We run three times the command to unseal the Vault</em><br/><strong class="mu hs">â¯ vault operator unseal</strong></span><span id="6daa" class="me jy hi mu b fi ne na l nb nc">Unseal Key (will be hidden): &lt;key 1&gt;<br/>Key                Value<br/>---                -----<br/>Seal Type          shamir<br/>Initialized        true<br/>Sealed             true<br/>Total Shares       5<br/>Threshold          3<br/>Unseal Progress    1/3<br/>Unseal Nonce       adabe581-5284-bf2d-7aca-2952338eefd8<br/>Version            1.5.4<br/>HA Enabled         true</span><span id="d9b3" class="me jy hi mu b fi ne na l nb nc"><strong class="mu hs">â¯ vault operator unseal</strong></span><span id="03bf" class="me jy hi mu b fi ne na l nb nc">Unseal Key (will be hidden): &lt;key 2&gt;<br/>Key                Value<br/>---                -----<br/>Seal Type          shamir<br/>Initialized        true<br/>Sealed             true<br/>Total Shares       5<br/>Threshold          3<br/>Unseal Progress    2/3<br/>Unseal Nonce       adabe581-5284-bf2d-7aca-2952338eefd8<br/>Version            1.5.4<br/>HA Enabled         true</span><span id="d386" class="me jy hi mu b fi ne na l nb nc"><strong class="mu hs">â¯ vault operator unseal</strong><br/>Unseal Key (will be hidden): &lt;key 3&gt;<br/>Key                     Value<br/>---                     -----<br/>Seal Type               shamir<br/>Initialized             true<br/>Sealed                  false<br/>Total Shares            5<br/>Threshold               3<br/>Version                 1.5.4<br/>Cluster Name            vault-cluster-23bf4fd7<br/>Cluster ID              d4fd02c6-8935-8f50-4a6d-d445444249a8<br/>HA Enabled              true<br/>HA Cluster              n/a<br/>HA Mode                 standby<br/>Active Node Address     &lt;none&gt;<br/>Raft Committed Index    24<br/>Raft Applied Index      24</span></pre><p id="8f12" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">å¦‚æœæ‚¨å°è¯•åœ¨å­˜å‚¨åº“å¯†å°æ—¶ç™»å½•ï¼Œå°†ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="b198" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># Login attempt on a sealed Vault</em><br/><strong class="mu hs">â¯ vault login &lt;token&gt;</strong></span><span id="b143" class="me jy hi mu b fi ne na l nb nc">Error authenticating: error looking up token: Error making API request.</span><span id="4003" class="me jy hi mu b fi ne na l nb nc">URL: GET <a class="ae jw" href="http://127.0.0.1:8200/v1/auth/token/lookup-self" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8200/v1/auth/token/lookup-self</a><br/>Code: 503. Errors:</span><span id="fef9" class="me jy hi mu b fi ne na l nb nc">* Vault is sealed</span></pre><p id="2bd1" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">ç™»å½•ä»¥è§£å°ä¿ç®¡åº“</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="5078" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># Login on an unsealed Vault</em><br/><strong class="mu hs">â¯ vault login &lt;token&gt;</strong></span><span id="790f" class="me jy hi mu b fi ne na l nb nc">Success! You are now authenticated. The token information displayed below<br/>is already stored in the token helper. You do NOT need to run "vault login"<br/>again. Future Vault requests will automatically use this token.</span><span id="de75" class="me jy hi mu b fi ne na l nb nc">Key                  Value<br/>---                  -----<br/>token                &lt;token&gt;<br/>token_accessor       &lt;tokenAccessor&gt;<br/>token_duration       âˆ<br/>token_renewable      false<br/>token_policies       ["root"]<br/>identity_policies    []<br/>policies             ["root"]</span></pre><p id="1a0e" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æˆ‘ä»¬å‡†å¤‡å¥½åˆ›é€ æˆ‘ä»¬çš„ç§˜å¯†ã€‚æˆ‘ä»¬å¯ç”¨ä¸€ä¸ªç§˜å¯†å¼•æ“æ¥å­˜å‚¨å‡­è¯ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="3446" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># Enable key value engine on the path ansible</em><br/><strong class="mu hs">â¯ vault secrets enable -path=ansible kv</strong></span><span id="f9c8" class="me jy hi mu b fi ne na l nb nc">Success! Enabled the kv secrets engine at: ansible/</span></pre><p id="b47a" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æˆ‘ä»¬å‡†å¤‡å¥½å‚¨å­˜æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç§˜å¯†ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="13f1" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># We write the "password" with identifier "test" into a folder "demo"</em><br/><strong class="mu hs">â¯ vault kv put ansible/demo test=password</strong></span><span id="ebe5" class="me jy hi mu b fi ne na l nb nc">Success! Data written to: ansible/demo</span></pre><p id="dc97" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">è¦è¯»å–æ•°æ®ï¼Œä½¿ç”¨<code class="du mr ms mt mu b">get</code>å‘½ä»¤ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="0649" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># Read command</em><br/><strong class="mu hs">â¯ vault kv get  ansible/demo</strong></span><span id="bf60" class="me jy hi mu b fi ne na l nb nc">==== Data ====<br/>Key     Value<br/>---     -----<br/>test    password</span></pre><h2 id="0c56" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">HashiCorpé‡‘åº“å’ŒAnsibleä¸€èµ·</h2><p id="578e" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">å°†HashiCorp Vaulté›†æˆåˆ°Ansibleçš„ä¸€åˆ‡éƒ½å·²å°±ç»ªã€‚æœ‰ä¸¤ç§é›†æˆæ–¹å¼:</p><ul class=""><li id="fff2" class="lq lr hi kr b ks ll kv lm ky ls lc lt lg lu lk lv lw lx ly bi translated">åœ¨Ansibleå†…éƒ¨ä½¿ç”¨HashiCorp Vault</li><li id="6643" class="lq lr hi kr b ks lz kv ma ky mb lc mc lg md lk lv lw lx ly bi translated">ä»Ansibleç®¡ç†HashiCorp Vaultã€‚</li></ul><p id="aad9" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä»å“ˆå¸Œå…¬å¸ä¿é™©åº“å–å›çš„ç§˜å¯†ã€‚<code class="du mr ms mt mu b">community.general</code>é›†åˆä¸­çš„å®˜æ–¹æŸ¥æ‰¾æ’ä»¶æ­£æ˜¯æˆ‘ä»¬æ¶ˆè´¹ç§˜å¯†æ‰€éœ€è¦çš„ã€‚</p><p id="db01" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">ä½¿ç”¨HashiCorp Vaultçš„æ¼”ç¤ºé¡¹ç›®çš„ç»“æ„ä¸æˆ‘ç”¨äºAnsible Vaultçš„ç»“æ„å¤§è‡´ç›¸åŒã€‚æˆ‘åˆšåˆšæ‰”æ‰äº†<code class="du mr ms mt mu b">group_vars</code>æ–‡ä»¶å¤¹ã€‚</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="nf ng l"/></div><figcaption class="js jt et er es ju jv bd b be z dx">HashiCorp Ansible Demo Project Structure</figcaption></figure><p id="c478" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æ¼”ç¤ºHashiCorp Vaultç”¨æ³•çš„å‰§æœ¬éå¸¸ç®€å•ã€‚å®ƒåªåŒ…å«ä¸€ä¸ªå¸¦æœ‰æŸ¥æ‰¾çš„è°ƒè¯•ä»»åŠ¡ã€‚</p><figure class="jh ji jj jk fd jl"><div class="bz dy l di"><div class="nf ng l"/></div></figure><p id="f650" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated"><strong class="kr hs"> â‘  </strong>æŸ¥æ‰¾ä»»åŠ¡ä½¿ç”¨<code class="du mr ms mt mu b">hashi_vault</code>æ’ä»¶ã€‚æˆ‘ä»¬æŒ‡å®šç§˜å¯†çš„è·¯å¾„ã€è®¤è¯ä»¤ç‰Œå’Œè¦è¿æ¥çš„URLã€‚</p><p id="5e6a" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æŸ¥æ‰¾æ’ä»¶çš„æ–‡æ¡£æ˜¾ç¤ºäº†æ£€ç´¢æœºå¯†çš„å¯ç”¨é€‰é¡¹ã€‚è¿˜å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡æ¥è®¾ç½®èº«ä»½éªŒè¯ä»¤ç‰Œå’ŒURLã€‚å®ƒå°†é¿å…åœ¨æ¯ä¸ªæŸ¥æ‰¾è¯­å¥ä¸­æŒ‡å®šã€‚</p><div class="nn no ez fb np nq"><a href="https://docs.ansible.com/ansible/latest/collections/community/general/hashi_vault_lookup.html" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab dw"><div class="ns ab nt cl cj nu"><h2 class="bd hs fi z dy nv ea eb nw ed ef hr bi translated">community.general.hashi_vault -ä»HashiCorpçš„vault - Ansibleæ–‡æ¡£ä¸­æ£€ç´¢æœºå¯†</h2><div class="nx l"><h3 class="bd b fi z dy nv ea eb nw ed ef dx translated">æ³¨æ„env:AWS_SECRET_ACCESS_KEYå¯¹åº”äºè®¿é—®å¯†é’¥çš„AWSç§˜å¯†å¯†é’¥ã€‚åˆ«å:aws_secret_access_keyâ€¦</h3></div><div class="ny l"><p class="bd b fp z dy nv ea eb nw ed ef dx translated">docs.ansible.com</p></div></div><div class="nz l"><div class="oh l ob oc od nz oe jq nq"/></div></div></a></div><p id="a501" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œå‰§æœ¬ï¼Œçœ‹çœ‹é›†æˆæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="2259" class="me jy hi mu b fi mz na l nb nc"><em class="nd"># Run the playbook with the inventory specified</em><br/><strong class="mu hs">â¯ ansible-playbook -i inventories/test playbooks/test.yml</strong></span><span id="b166" class="me jy hi mu b fi ne na l nb nc">PLAY [test] ********************************************************************</span><span id="5624" class="me jy hi mu b fi ne na l nb nc"># <strong class="mu hs">â‘ </strong><br/>TASK [Debug] ********************************************************************<br/>ok: [0.0.0.0] =&gt; <br/>  msg:<br/>    test: password</span><span id="eedf" class="me jy hi mu b fi ne na l nb nc">PLAY RECAP ********************************************************************<br/>0.0.0.0                    : ok=1    changed=0    unreachable=0   <br/>                             failed=0    skipped=0    rescued=0   <br/>                             ignored=0</span></pre><p id="daff" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated"><strong class="kr hs"> â‘  </strong>è°ƒè¯•ä»»åŠ¡çš„è¾“å‡ºæ˜¯ç»“æ„åŒ–æ•°æ®ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å–å›äº†ä¸€ä¸ªç‰©ä½“ã€‚äº‹å®ä¸Šï¼Œå­˜å‚¨åœ¨Vaultä¸­çš„æ•°æ®å¯ä»¥æ˜¯å¤šé”®/å€¼å¯¹ã€‚</p><p id="09d3" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">è¦ä»å¯¹è±¡ä¸­è·å–ç‰¹å®šçš„æ•°æ®ï¼Œå¯ä»¥åƒè¿™æ ·ä½¿ç”¨æŸ¥æ‰¾æ’ä»¶ã€‚æ·»åŠ å¯†é’¥<code class="du mr ms mt mu b">:test</code>å°†åªè·å¾—æˆ‘ä»¬æ­£åœ¨å¯»æ‰¾çš„å¯†ç çš„å€¼ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="ef54" class="me jy hi mu b fi mz na l nb nc">{{ lookup('hashi_vault', 'ansible/demo:test ...) }}</span></pre><p id="e1f3" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">è¾“å‡ºå°†ä¼šæ˜¯ã€‚</p><pre class="jh ji jj jk fd mv mu mw mx aw my bi"><span id="8acc" class="me jy hi mu b fi mz na l nb nc">TASK [Debug] ********************************************************************<br/>ok: [0.0.0.0] =&gt; <br/>  msg: password</span></pre><h2 id="8943" class="me jy hi bd jz mf mg mh kd mi mj mk kh ky ml mm kj lc mn mo kl lg mp mq kn ho bi translated">å“ˆå¸Œå…¬å¸ä¿é™©åº“æ‘˜è¦</h2><p id="6305" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">æˆ‘å¯¹å“ˆå¸Œå…¬å¸çš„é‡‘åº“æ²¡ä»€ä¹ˆç»éªŒã€‚å¯¹äºç®€å•çš„ç”¨ä¾‹ï¼Œå®ƒä¼¼ä¹å¾ˆå®¹æ˜“ä½¿ç”¨å’Œç®¡ç†ã€‚ä¸Ansibleçš„é›†æˆå¹¶ä¸æ¯”ä½¿ç”¨Ansible Vaultæ›´å¤æ‚ã€‚è¿™ä¸¤ç§è§£å†³æ–¹æ¡ˆé…åˆå¾—å¾ˆå¥½ã€‚</p><p id="16aa" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">åœ¨æˆ‘çœ‹æ¥ï¼ŒHashiCorp Vaulté›†æˆäº†è®¸å¤šç®¡ç†ç§˜å¯†(çŸ­æš‚ç§˜å¯†)çš„è§£å†³æ–¹æ¡ˆã€‚è¿™æ¯”é‚£é‡Œä»‹ç»çš„å…¶ä»–ä¸¤ç§è§£å†³æ–¹æ¡ˆè¦å…ˆè¿›å¾—å¤šã€‚</p><h1 id="1494" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ix ki iy kj ja kk jb kl jd km je kn ko bi translated">ç»“è®º</h1><p id="00cd" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢äº†3ç§ä¸åŒçš„è§£å†³æ–¹æ¡ˆæ¥å­˜å‚¨æœºå¯†å¹¶åœ¨Ansibleä¸­ä½¿ç”¨å®ƒä»¬ã€‚</p><ul class=""><li id="13dd" class="lq lr hi kr b ks ll kv lm ky ls lc lt lg lu lk lv lw lx ly bi translated">åŸºäºGPGçš„å®šåˆ¶è§£å†³æ–¹æ¡ˆ</li><li id="db7e" class="lq lr hi kr b ks lz kv ma ky mb lc mc lg md lk lv lw lx ly bi translated">Ansible Vaultè§£å†³æ–¹æ¡ˆ</li><li id="cdd8" class="lq lr hi kr b ks lz kv ma ky mb lc mc lg md lk lv lw lx ly bi translated">å“ˆå¸Œå…¬å¸é‡‘åº“è§£å†³æ–¹æ¡ˆ</li></ul><p id="db18" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">å¯¹æˆ‘æ¥è¯´ï¼Œæ²¡æœ‰æœ€å¥½çš„è§£å†³æ–¹æ¡ˆã€‚è¿™å§‹ç»ˆæ˜¯ä¸€ä¸ªéœ€è¦è§£å†³çš„æƒè¡¡å’Œç”¨ä¾‹çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¯¹äºæ‚¨å®Œå…¨ä¿¡ä»»è¿è¡ŒAnsibleçš„è®¡ç®—æœºçš„ç¯å¢ƒï¼ŒGPGè§£å†³æ–¹æ¡ˆæ˜¯å¯ä»¥æ¥å—çš„ã€‚å®ƒå°†å…è®¸æ‚¨ä½¿ç”¨å¯†é’¥ç®¡ç†ç§˜å¯†ï¼Œè€Œä¸å¿…åœ¨æ¯æ¬¡è¿è¡Œå‰§æœ¬æ—¶è¾“å…¥å¯†ç ã€‚</p><p id="6014" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">Ansible Vaultçš„è§£å†³æ–¹æ¡ˆä¹Ÿå¾ˆç®€å•ï¼Œæœ€é‡è¦çš„æ˜¯åµŒå…¥åœ¨Ansibleä¸­ã€‚å®ƒä¸éœ€è¦ä»»ä½•é¢å¤–çš„è®¾ç½®ã€‚å®ƒå¯ä»¥åœ¨ä»»ä½•ç°æˆçš„è®¡ç®—æœºä¸Šè¿è¡Œã€‚æ‚¨ä¹Ÿå¯ä»¥å°†Ansible Vaultæ–‡ä»¶å­˜å‚¨åœ¨åº“å­˜çš„å­˜å‚¨åº“ä¸­ã€‚</p><p id="d32f" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æœ€åï¼ŒHashiCorp Vaultéœ€è¦æ›´å¤šçš„è®¾ç½®(å°¤å…¶æ˜¯ç”Ÿäº§è®¾ç½®)æ¥å®‰è£…å’Œç»´æŠ¤ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜å¸¦æ¥äº†æœ€å…ˆè¿›çš„åŠŸèƒ½å’Œå¯èƒ½æ€§ã€‚å®ƒä¸Ansibleé…åˆå¾—å¾ˆå¥½ã€‚</p><p id="20ac" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">æœ€ç»ˆï¼Œç”±æ‚¨æ¥é€‰æ‹©æœ€ç¬¦åˆæ‚¨éœ€æ±‚çš„è§£å†³æ–¹æ¡ˆã€‚åœ¨æˆ‘çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä¼šç»§ç»­ä½¿ç”¨HashiCorp Vaultæ¥å‘ç°å…³äºè¿™ä¸ªå·¥å…·çš„æ›´å¤šä¿¡æ¯ã€‚</p><h1 id="aae2" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ix ki iy kj ja kk jb kl jd km je kn ko bi translated">å‚è€ƒ</h1><p id="aa7a" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">GPGå’ŒGPGå¥—ä»¶å·¥å…·ã€‚</p><div class="nn no ez fb np nq"><a href="https://gnupg.org/" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab dw"><div class="ns ab nt cl cj nu"><h2 class="bd hs fi z dy nv ea eb nw ed ef hr bi translated">GNUéšç§å«å£«</h2><div class="nx l"><h3 class="bd b fi z dy nv ea eb nw ed ef dx translated">GnuPGæ˜¯ç”±RFC4880(ä¹Ÿç§°ä¸ºPGP)å®šä¹‰çš„OpenPGPæ ‡å‡†çš„å®Œæ•´å…è´¹å®ç°ã€‚GnuPGâ€¦</h3></div><div class="ny l"><p class="bd b fp z dy nv ea eb nw ed ef dx translated">gnupg.org</p></div></div><div class="nz l"><div class="oi l ob oc od nz oe jq nq"/></div></div></a></div><div class="nn no ez fb np nq"><a href="https://gpgtools.org/" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab dw"><div class="ns ab nt cl cj nu"><h2 class="bd hs fi z dy nv ea eb nw ed ef hr bi translated">GPGå¥—æˆ¿</h2><div class="nx l"><h3 class="bd b fi z dy nv ea eb nw ed ef dx translated">GPGå¥—ä»¶åŒ…æ‹¬30å¤©çš„GPGé‚®ä»¶è¯•ç”¨ã€‚è¦ç»§ç»­ä½¿ç”¨GPGé‚®ä»¶ï¼Œè¯·è´­ä¹°æ”¯æŒè®¡åˆ’ä½¿ç”¨GPGâ€¦</h3></div><div class="ny l"><p class="bd b fp z dy nv ea eb nw ed ef dx translated">gpgtools.org</p></div></div><div class="nz l"><div class="oj l ob oc od nz oe jq nq"/></div></div></a></div><p id="7639" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">Ansible Vaultæ–‡æ¡£</p><div class="nn no ez fb np nq"><a href="https://docs.ansible.com/ansible/latest/user_guide/vault.html" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab dw"><div class="ns ab nt cl cj nu"><h2 class="bd hs fi z dy nv ea eb nw ed ef hr bi translated">ä½¿ç”¨Ansible VaultåŠ å¯†å†…å®¹- Ansibleæ–‡æ¡£</h2><div class="nx l"><h3 class="bd b fi z dy nv ea eb nw ed ef dx translated">Ansible VaultåŠ å¯†å˜é‡å’Œæ–‡ä»¶ï¼Œå› æ­¤æ‚¨å¯ä»¥ä¿æŠ¤æ•æ„Ÿå†…å®¹ï¼Œå¦‚å¯†ç æˆ–å¯†é’¥ï¼Œè€Œä¸æ˜¯â€¦</h3></div><div class="ny l"><p class="bd b fp z dy nv ea eb nw ed ef dx translated">docs.ansible.com</p></div></div><div class="nz l"><div class="ok l ob oc od nz oe jq nq"/></div></div></a></div><p id="6221" class="pw-post-body-paragraph kp kq hi kr b ks ll is ku kv lm iv kx ky ln la lb lc lo le lf lg lp li lj lk hb bi translated">å“ˆå¸Œå…¬å¸é‡‘åº“</p><div class="nn no ez fb np nq"><a href="https://www.vaultproject.io/" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab dw"><div class="ns ab nt cl cj nu"><h2 class="bd hs fi z dy nv ea eb nw ed ef hr bi translated">å“ˆå¸Œå…¬å¸è·³é©¬</h2><div class="nx l"><h3 class="bd b fi z dy nv ea eb nw ed ef dx translated">Vaultä¿æŠ¤ã€å­˜å‚¨å¹¶ä¸¥æ ¼æ§åˆ¶å¯¹ä»¤ç‰Œã€å¯†ç ã€è¯ä¹¦ã€APIå¯†é’¥å’Œå…¶ä»–æœºå¯†çš„è®¿é—®â€¦</h3></div><div class="ny l"><p class="bd b fp z dy nv ea eb nw ed ef dx translated">www.vaultproject.io</p></div></div><div class="nz l"><div class="ol l ob oc od nz oe jq nq"/></div></div></a></div></div></div>    
</body>
</html>