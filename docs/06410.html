<html>
<head>
<title>SVM Classification with sklearn.svm.SVC: How To Plot A Decision Boundary With Margins in 2D Space</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨sklearn.svm.SVCè¿›è¡ŒSVMåˆ†ç±»:å¦‚ä½•åœ¨2Dç©ºé—´ä¸­ç»˜åˆ¶å¸¦æœ‰è¾¹è·çš„å†³ç­–è¾¹ç•Œ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/svm-classification-with-sklearn-svm-svc-how-to-plot-a-decision-boundary-with-margins-in-2d-space-7232cb3962c0?source=collection_archive---------2-----------------------#2021-08-19">https://medium.com/geekculture/svm-classification-with-sklearn-svm-svc-how-to-plot-a-decision-boundary-with-margins-in-2d-space-7232cb3962c0?source=collection_archive---------2-----------------------#2021-08-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/60b6dc54072049083fcaf77e1b2844cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dl-Nk6flF_mX5S1kh96T8Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://www.pexels.com/@cottonbro?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">cottonbro</a> from <a class="ae iu" href="https://www.pexels.com/photo/healthy-wood-playing-sport-5740517/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><p id="fc68" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å› æ­¤ï¼Œå¦‚æœä½ åŒå€¦äº†æŒ–æ˜å¤§é‡æ— ç”¨çš„é“¾æ¥ï¼Œå¸Œæœ›æ‰¾åˆ°å¦‚ä½•ç”¨æ”¯æŒå‘é‡æœºç®—æ³•ç»˜åˆ¶å†³ç­–è¾¹ç•Œå’Œè¾¹ç¼˜çº¿çš„è¯¦ç»†è§£é‡Šï¼Œé‚£ä¹ˆæ­å–œä½ â€”â€”ä½ ç»ˆäºæ‰¾åˆ°äº†ï¼è¿˜æœ‰æœ€åä¸€æ­¥â€”â€”é˜…è¯»æˆ‘å…³äºè¿™ä¸ªä¸»é¢˜çš„ç®€å•æŒ‡å—ã€‚å¼€å§‹å§ï¼</p><blockquote class="jt ju jv"><p id="c536" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">çµæ„Ÿæ¥æº:<a class="ae iu" href="https://scikit-learn.org/stable/auto_examples/svm/plot_svm_margin.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/auto _ examples/SVM/plot _ SVM _ margin . html</a></p></blockquote><p id="517f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jw">æ‹œæ‰˜ï¼Œä¸è¦åªèµ°è¿‡ä¸Šé¢çš„é“¾æ¥ã€‚ä¹Ÿè®¸ï¼Œå®ƒä¼šå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£è¿™ä¸ªè¯é¢˜ã€‚</em></p></div><div class="ab cl ka kb gp kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hb hc hd he hf"><h1 id="584f" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">0.è®©æ¨¡ç‰¹å­¦ä¼šï¼</h1><p id="2784" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">æˆ‘ç›¸ä¿¡ä½ å·²ç»ç†Ÿæ‚‰è¿™ä¸€æ­¥äº†ã€‚è¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ•°æ®é›†ï¼Œç„¶åæŒ‰è®­ç»ƒå’Œæµ‹è¯•æ ·æœ¬è¿›è¡Œæ‹†åˆ†ï¼Œæœ€åç”¨<code class="du lk ll lm ln b">sklearn.svm.SVC(kernel='linear')</code>è®­ç»ƒä¸€ä¸ªæ¨¡å‹ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬ç¡®åˆ‡åœ°ä½¿ç”¨äº†<strong class="ix hj">çº¿æ€§</strong>å†…æ ¸ç±»å‹(ä¸€äº›ä¾‹å­ä¸­çš„<a class="ae iu" href="https://scikit-learn.org/stable/auto_examples/svm/plot_svm_kernels.html" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a>)ã€‚ä»”ç»†é˜…è¯»è¯„è®º:</p><pre class="lo lp lq lr fd ls ln lt lu aw lv bi"><span id="e078" class="lw ki hi ln b fi lx ly l lz ma"><strong class="ln hj">import numpy as np<br/>from sklearn.svm import SVC</strong></span><span id="c845" class="lw ki hi ln b fi mb ly l lz ma"># Creating a random dataset of 2,000 samples and only 2 features<br/># (for 2â€“dimensional space). And yeah, it's a binary classification<br/># here (`y` contains two classes: 0 and 1).<br/><strong class="ln hj">X, y = make_classification(n_samples=2000, n_features=2,<br/>                           n_informative=2, n_redundant=0,<br/>                           n_classes=2,<br/>                           random_state=32)</strong></span><span id="e1b6" class="lw ki hi ln b fi mb ly l lz ma"># Splitting our dataset by train and test parts.<br/># `stratify` is here to make our splitting balanced<br/># in terms of classes.<br/><strong class="ln hj">X_train, X_test, y_train, y_test = train_test_split(X, y,<br/>                                   test_size=0.3, stratify=y,<br/>                                   random_state=32)</strong></span><span id="7c1d" class="lw ki hi ln b fi mb ly l lz ma"># And here we train our model. IMPORTANT: we use kernel='linear'.<br/><strong class="ln hj">svc_model = SVC(kernel='linear', random_state=32)<br/>svc_model.fit(X_train, y_train)</strong></span></pre><p id="eb61" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å¾ˆå¥½ï¼æ¨¡å‹å·²ç»è®­ç»ƒå¥½äº†ï¼Œç°åœ¨ä½ æƒ³ç»˜åˆ¶ä¸€ä¸ªå†³ç­–è¾¹ç•Œ(è¶…å¹³é¢)ï¼Œä½†æ˜¯ç­‰ç­‰â€¦â€¦ä½ ä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹ã€‚åˆ«æ‹…å¿ƒï¼Œæˆ‘ä¼šä¸€æ­¥æ­¥æŒ‡å¯¼ä½ ã€‚</p><h1 id="78ed" class="kh ki hi bd kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la mg lc ld le bi translated">1.æˆ‘ä»¬éœ€è¦ä»€ä¹ˆæ¥ç»˜åˆ¶å†³ç­–è¾¹ç•Œï¼Ÿ</h1><p id="a40f" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">æˆ‘ä»¬éœ€è¦ä¸€ä¸ªé€šç”¨çš„ç­‰å¼:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/54a8cc7647bb48d80b893b52768a38f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i0IVm-YFUdbk6lVuyoXqCw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">General equation of a decision boundary in a vector form</figcaption></figure><blockquote class="jt ju jv"><p id="263d" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">æ³¨:</strong>ç”±äºæˆ‘ä»¬åœ¨äºŒç»´ç©ºé—´ä¸­æ“ä½œï¼Œå†³ç­–è¾¹ç•Œå°†ç”±2Dç›´çº¿è¡¨ç¤ºï¼Œå› æ­¤<code class="du lk ll lm ln b">w</code>å’Œ<code class="du lk ll lm ln b">x</code>éƒ½ç”±ä¸¤ä¸ªå…ƒç´ ç»„æˆã€‚</p></blockquote><p id="7a6a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è¯€çªå°±åœ¨è¿™é‡Œã€‚æˆ‘ä»¬è½¬æ¢çŸ¢é‡<code class="du lk ll lm ln b">w</code>å’Œ<code class="du lk ll lm ln b">x</code>çš„ç‚¹ç§¯ï¼Œç„¶åæ±‚è§£<code class="du lk ll lm ln b">x</code>çš„ç¬¬äºŒä¸ªå…ƒç´ çš„æ–¹ç¨‹:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/4fe692a868b962961f4b795f3b0a6597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OrKFPKs6wDi3zIJININ3Fg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">From general equation to a 2D-line equation</figcaption></figure><p id="0e7d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ–œç‡æˆªè·å½¢å¼çš„ç»å…¸çº¿æ€§æ–¹ç¨‹ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒæè¿°äº†ä¸€æ¡2Dç›´çº¿ã€‚å¥½çš„ï¼Œæˆ‘ä»¬çŸ¥é“äº†ï¼Œä½†æ˜¯ä½ å¯èƒ½è¿˜æœ‰ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚:</p><ol class=""><li id="aefa" class="mi mj hi ix b iy iz jc jd jg mk jk ml jo mm js mn mo mp mq bi translated"><code class="du lk ll lm ln b">w_1</code>å’Œ<code class="du lk ll lm ln b">w_2</code>åˆ°åº•å­˜å‚¨åœ¨æˆ‘ä»¬çš„<code class="du lk ll lm ln b">sklearn</code>æ¨¡å‹å¯¹è±¡çš„ä»€ä¹ˆåœ°æ–¹ï¼Ÿ</li><li id="922a" class="mi mj hi ix b iy mr jc ms jg mt jk mu jo mv js mn mo mp mq bi translated">è¿˜æœ‰ä»€ä¹ˆæ˜¯<code class="du lk ll lm ln b">x_1</code>å’Œ<code class="du lk ll lm ln b">x_2</code>ï¼Ÿ</li></ol><p id="11cf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">çœ‹å›¾:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/4d125356ddcff5d025162be5cd502977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JXRQiHgNPlbALL1jVIHk4A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Revealing the parts of a 2D-line equation</figcaption></figure><p id="38f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lk ll lm ln b"><strong class="ix hj">w</strong></code>åŒ…å«åœ¨æˆ‘ä»¬çš„æ¨¡å‹(<code class="du lk ll lm ln b"><strong class="ix hj">svc_model.coef_</strong></code>)çš„å±æ€§<code class="du lk ll lm ln b"><strong class="ix hj">coef_</strong></code>ä¸­ï¼Œè¿™äº›æ˜¯æˆ‘ä»¬çš„å†³ç­–è¾¹ç•Œçš„æ³•å‘é‡çš„åæ ‡(è¯¥å‘é‡ä¸è¶…å¹³é¢æ­£äº¤)ã€‚</p><p id="507c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lk ll lm ln b"><strong class="ix hj">b</strong></code>æ˜¯æˆ‘ä»¬æ¨¡å‹(<code class="du lk ll lm ln b"><strong class="ix hj">svc_model.intercept_</strong></code>)çš„ä¸€ä¸ªå±æ€§<code class="du lk ll lm ln b"><strong class="ix hj">intercept_</strong></code>ã€‚</p><p id="c25c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lk ll lm ln b"><strong class="ix hj">x_1</strong></code>æ˜¯ä¸€ä¸ªåæ ‡å¹³é¢çš„<strong class="ix hj"> xç‚¹</strong>çš„æ•°ç»„ã€‚</p><p id="a783" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lk ll lm ln b"><strong class="ix hj">x_2</strong></code>æ˜¯ä¸€ä¸ªåæ ‡å¹³é¢çš„<strong class="ix hj"> yç‚¹</strong>çš„<em class="jw">ç»“æœ</em>æ•°ç»„ã€‚</p><blockquote class="jt ju jv"><p id="06bc" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">æ­£å¦‚ä½ æ‰€æ³¨æ„åˆ°çš„ï¼Œæˆ‘ä»¬åªæœ‰2ä¸ªå…ƒç´ ç”¨äº<code class="du lk ll lm ln b">w</code>ï¼ŒåŒæ ·çš„å…ƒç´ ç”¨äº<code class="du lk ll lm ln b">x</code>ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ­£åœ¨æ¢ç´¢äºŒç»´ç©ºé—´ä¸­çš„SVMåˆ†ç±»ï¼Œåªæ˜¯ä¸ºäº†è®©ç»˜åˆ¶SVMå†³ç­–è¾¹ç•Œå’Œè¾¹é™…çš„æƒ³æ³•æ›´åŠ æ¸…æ™°ã€‚</p></blockquote><h1 id="f8c7" class="kh ki hi bd kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la mg lc ld le bi translated">2.æŠŠæ‰€æœ‰çš„ä¸œè¥¿æ”¾åœ¨ä¸€èµ·</h1><p id="0b4c" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">åªè¦å¯¹2Dçº¿å…¬å¼åšä¸€äº›æ›¿æ¢â€¦</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/c023a4788a175c9dbecfeaedafa33ec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FLY-N1jpEjLdvRimDuRGDw.png"/></div></div></figure><p id="c3bd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">â€¦åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°:</p><pre class="lo lp lq lr fd ls ln lt lu aw lv bi"><span id="f3a4" class="lw ki hi ln b fi lx ly l lz ma"><strong class="ln hj">import matplotlib.pyplot as plt<br/>import seaborn as sns</strong></span><span id="f538" class="lw ki hi ln b fi mb ly l lz ma"><strong class="ln hj">plt.figure(figsize=(10, 8))</strong></span><span id="c2f8" class="lw ki hi ln b fi mb ly l lz ma"># Plotting our two-features-space<br/><strong class="ln hj">sns.scatterplot(x=X_train[:, 0], <br/>                y=X_train[:, 1], <br/>                hue=y_train, <br/>                s=8);</strong></span><span id="6b25" class="lw ki hi ln b fi mb ly l lz ma"># Constructing a hyperplane using a formula.<br/><strong class="ln hj">w = </strong><strong class="ln hj">svc_model</strong><strong class="ln hj">.coef_[0]           </strong># w consists of 2 elements<strong class="ln hj"><br/>b = </strong><strong class="ln hj">svc_model</strong><strong class="ln hj">.intercept_[0]      </strong># b consists of 1 element<strong class="ln hj"><br/>x_points = np.linspace(-1, 1)    </strong># generating x-points from -1 to 1<strong class="ln hj"><br/>y_points = -(w[0] / w[1]) * x_points - b / w[1]  </strong># getting corresponding y-points</span><span id="a785" class="lw ki hi ln b fi mb ly l lz ma"># Plotting a red hyperplane<br/><strong class="ln hj">plt.plot(x_points, y_points, c='r');</strong></span></pre><p id="5198" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å®ƒçš„è¾“å‡ºæ˜¯:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/b86fa26b1934a7f928bef583232fcf29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sKV7okWSKdlkajw3mo7Pvw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Two features (thatâ€™s why we have exactly 2 axis), two classes (blue and yellow) and a red decision boundary (hyperplane) in a form of 2D-line</figcaption></figure><p id="7e32" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å¤ªå¥½äº†ï¼æˆ‘ä»¬ç°åœ¨å·²ç»ç»˜åˆ¶äº†å†³ç­–è¾¹ç•Œï¼å› æ­¤ï¼Œæ˜¯æ—¶å€™è½¬å‘SVMåˆ©æ¶¦ç‡äº†ã€‚</p><h1 id="ee2a" class="kh ki hi bd kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la mg lc ld le bi translated">4.ç»˜åˆ¶SVMè¾¹è·</h1><p id="5879" class="pw-post-body-paragraph iv iw hi ix b iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo lj jq jr js hb bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªå†³ç­–è¾¹ç•Œå’Œåˆ©æ¶¦çš„å›¾ç‰‡ã€‚ç°è‰²è™šçº¿æ˜¯â€œè¾¹ç•Œâ€,æ˜¾ç¤ºäº†å®ƒä»¬çš„åŸºç¡€ï¼Œä»¥åŠå¦‚ä½•è®¡ç®—å®ƒä»¬çš„å¤§å°ã€‚ä»”ç»†çœ‹å„æ–¹é¢:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/852ea955d8f1b7f435113a9ab189c44a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bQz9W852S0Sh_rzpqWyIXg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">SVM classification illustrated. Decision boundary, margins, and support vectors.</figcaption></figure><p id="8c05" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å› æ­¤ï¼Œè™šçº¿åªæ˜¯æ²¿ç€å‘é‡<code class="du lk ll lm ln b">w</code>çš„æ–¹å‘å¹³ç§»äº†ç­‰äº<code class="du lk ll lm ln b">margin</code>çš„è·ç¦»çš„åˆ¤å®šè¾¹ç•Œçº¿ã€‚æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªç®—æ³•æ¥å®ç°:</p><pre class="lo lp lq lr fd ls ln lt lu aw lv bi"><span id="6b1a" class="lw ki hi ln b fi lx ly l lz ma"><strong class="ln hj">Step 1.</strong> Find a normal vector to the decision boundary;</span><span id="cf59" class="lw ki hi ln b fi mb ly l lz ma"><strong class="ln hj">Step 2.</strong> Calculate a unit vector of that normal vector -- let's call it `w_hat`;</span><span id="c0d3" class="lw ki hi ln b fi mb ly l lz ma"><strong class="ln hj">Step 3.</strong> Get a distance between the lines (margin);</span><span id="c781" class="lw ki hi ln b fi mb ly l lz ma"><strong class="ln hj">Step 4.</strong> Translate all points of the decision boundary to a new location by this formula:</span><span id="0232" class="lw ki hi ln b fi mb ly l lz ma"># for a line above<br/>new_points_above = hyperplane_points <strong class="ln hj">+</strong> w<!-- -->_hat * margin</span><span id="0648" class="lw ki hi ln b fi mb ly l lz ma"># for a line below<br/>new_points_below = hyperplane_points <strong class="ln hj">-</strong> w<!-- -->_hat * margin</span></pre><p id="3c1e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">ç¬¬ä¸€æ­¥:</strong>æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œ<code class="du lk ll lm ln b">w</code>æ˜¯æˆ‘ä»¬éœ€è¦çš„æ³•å‘é‡â€”â€”å®ƒæ€»æ˜¯æ­£äº¤äºè¶…å¹³é¢(é¡ºä¾¿è¯´ä¸€å¥ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆâ€”â€”<a class="ae iu" href="https://datascience.stackexchange.com/questions/6054/in-svm-algorithm-why-vector-w-is-orthogonal-to-the-separating-hyperplane" rel="noopener ugc nofollow" target="_blank">stack overflow link</a>)ã€‚è€Œä¸”æˆ‘ä»¬è¿˜çŸ¥é“å®ƒåŒ…å«åœ¨æˆ‘ä»¬æ¨¡å‹çš„å±æ€§<code class="du lk ll lm ln b"><strong class="ix hj">coef_</strong></code>(<code class="du lk ll lm ln b"><strong class="ix hj">svc_model.coef_</strong></code>)ä¸­ã€‚</p><p id="d73e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">ç¬¬äºŒæ­¥:</strong>æˆ‘ä»¬æ¥è®¡ç®—å•ä½çŸ¢é‡:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/6ba626daebfa60c96fbd1e457cf6e35c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dA10OjcsPbjvQHPhdC0faQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Unit-vector formula</figcaption></figure><pre class="lo lp lq lr fd ls ln lt lu aw lv bi"><span id="d5fa" class="lw ki hi ln b fi lx ly l lz ma"># Calculating the unit vector of w<br/><strong class="ln hj">w_hat = </strong><strong class="ln hj">svc_model</strong><strong class="ln hj">.coef_[0] / (np.sqrt(np.sum(</strong><strong class="ln hj">svc_model</strong><strong class="ln hj">.coef_[0] ** 2)))</strong></span></pre><p id="daf4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">ç¬¬ä¸‰æ­¥:</strong>ç°åœ¨æˆ‘ä»¬è®¡ç®—ä¿è¯é‡‘:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/d3f00dc2dfb04cb61e32210949acdc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*isurD3vZa0NCLP2alUc4JQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Margin formula</figcaption></figure><pre class="lo lp lq lr fd ls ln lt lu aw lv bi"><span id="1332" class="lw ki hi ln b fi lx ly l lz ma"># Calculating margin<br/><strong class="ln hj">margin = 1 / np.sqrt(np.sum(svc_model.coef_[0] ** 2))</strong></span></pre><p id="b3df" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ç¬¬å››æ­¥:æœ€åï¼Œæˆ‘ä»¬è®¡ç®—æ–°çº¿æ¡çš„ç‚¹æ•°:</p><pre class="lo lp lq lr fd ls ln lt lu aw lv bi"><span id="5bf1" class="lw ki hi ln b fi lx ly l lz ma"># Calculating margin lines<br/><strong class="ln hj">new_points_up   = </strong><strong class="ln hj">hyperplane_points</strong><strong class="ln hj"> + w_hat * margin<br/>new_points_down = </strong><strong class="ln hj">hyperplane_points</strong><strong class="ln hj"> - w_hat * margin</strong></span></pre><p id="6383" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è¿˜æœ‰ä¸€ä»¶äº‹â€¦æ˜¯çš„ï¼Œè®©æˆ‘ä»¬æŠŠå®ƒä»¬æ”¾åœ¨ä¸€èµ·ï¼Œç„¶åç”»å‡ºç»“æœ:</p><pre class="lo lp lq lr fd ls ln lt lu aw lv bi"><span id="5bbb" class="lw ki hi ln b fi lx ly l lz ma"><strong class="ln hj">plt.figure(figsize=(10, 8))</strong></span><span id="5ceb" class="lw ki hi ln b fi mb ly l lz ma"># Plotting our two-features-space<br/><strong class="ln hj">sns.scatterplot(x=X_train[:, 0], <br/>                y=X_train[:, 1], <br/>                hue=y_train, <br/>                s=8);</strong></span><span id="8018" class="lw ki hi ln b fi mb ly l lz ma"># Constructing a hyperplane using a formula.<br/><strong class="ln hj">w = </strong><strong class="ln hj">svc_model</strong><strong class="ln hj">.coef_[0]           </strong># w consists of 2 elements<strong class="ln hj"><br/>b = </strong><strong class="ln hj">svc_model</strong><strong class="ln hj">.intercept_[0]      </strong># b consists of 1 element<strong class="ln hj"><br/>x_points = np.linspace(-1, 1)    </strong># generating x-points from -1 to 1<strong class="ln hj"><br/>y_points = -(w[0] / w[1]) * x_points - b / w[1]  </strong># getting corresponding y-points</span><span id="4c31" class="lw ki hi ln b fi mb ly l lz ma"># Plotting a red hyperplane<br/><strong class="ln hj">plt.plot(x_points, y_points, c='r');</strong></span><span id="b949" class="lw ki hi ln b fi mb ly l lz ma"># Encircle support vectors<br/><strong class="ln hj">plt.scatter(</strong><strong class="ln hj">svc_model</strong><strong class="ln hj">.support_vectors_[:, 0],<br/>            </strong><strong class="ln hj">svc_model</strong><strong class="ln hj">.support_vectors_[:, 1], <br/>            s=50, <br/>            facecolors='none', <br/>            edgecolors='k', <br/>            alpha=.5);</strong></span><span id="807b" class="lw ki hi ln b fi mb ly l lz ma"># Step 2 (unit-vector):<br/><strong class="ln hj">w_hat = </strong><strong class="ln hj">svc_model</strong><strong class="ln hj">.coef_[0] / (np.sqrt(np.sum(</strong><strong class="ln hj">svc_model</strong><strong class="ln hj">.coef_[0] ** 2)))</strong></span><span id="7f26" class="lw ki hi ln b fi mb ly l lz ma"># Step 3 (margin):<br/><strong class="ln hj">margin = 1 / np.sqrt(np.sum(</strong><strong class="ln hj">svc_model</strong><strong class="ln hj">.coef_[0] ** 2))</strong></span><span id="6975" class="lw ki hi ln b fi mb ly l lz ma"># Step 4 (calculate points of the margin lines):<br/><strong class="ln hj">decision_boundary_points = np.array(list(zip(x_points, y_points)))<br/>points_of_line_above = decision_boundary_points + w_hat * margin<br/>points_of_line_below = decision_boundary_points - w_hat * margin</strong></span><span id="acab" class="lw ki hi ln b fi mb ly l lz ma"># Plot margin lines</span><span id="ad4f" class="lw ki hi ln b fi mb ly l lz ma"># Blue margin line above<strong class="ln hj"><br/>plt.plot(points_of_line_above[:, 0], <br/>         points_of_line_above[:, 1], <br/>         'b--', <br/>         linewidth=2)</strong></span><span id="2542" class="lw ki hi ln b fi mb ly l lz ma"># Green margin line below<strong class="ln hj"><br/>plt.plot(points_of_line_below[:, 0], <br/>         points_of_line_below[:, 1], <br/>         'g--',<br/>         linewidth=2)</strong></span></pre><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/84a999eab84e2f0ddde3db031ead5a86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ovOnPaQ7tKLtGCOMmGDhw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Final result: decision boundary (red), support vector (encircled dots), and margin lines (dashed blue and green lines)</figcaption></figure><p id="480c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘ä»¬å®Œäº†ã€‚å¸Œæœ›å¯¹ä½ æœ‰å¸®åŠ©ã€‚å¦‚æœæ˜¯ï¼ŒæŒ‰ä¸‹<code class="du lk ll lm ln b">thumbs up ğŸ‘</code>ã€‚</p></div><div class="ab cl ka kb gp kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hb hc hd he hf"><p id="9d15" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ„Ÿè°¢æ‚¨çš„å®è´µæ—¶é—´ï¼ğŸ‰<br/> <strong class="ix hj">å…³æ³¨æˆ‘</strong>æ›´å¤šæœ‰è¶£è¯é¢˜ğŸ˜‰ğŸ‘</p></div></div>    
</body>
</html>