# åœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­åŠ è½½å›¾åƒæ•°æ®çš„å›¾åƒå¤„ç†åº“

> åŸæ–‡ï¼š<https://medium.com/geekculture/image-processing-libraries-to-load-image-data-in-machine-learning-and-deep-learning-4c6ca538cc95?source=collection_archive---------20----------------------->

é—®å€™ï¼ğŸ˜ƒ

![](img/af840a775ec208d4a4106af5ba1607e3.png)

[Source](https://www.medicalnewstoday.com/articles/325466)

è®¡ç®—æœºè§†è§‰æ˜¯äººå·¥æ™ºèƒ½ä¸­éå¸¸è¿·äººçš„æ–°å…´é¢†åŸŸä¹‹ä¸€ã€‚å®ƒå°±åƒäººç±»çš„è§†è§‰ä¸€æ ·ï¼Œç°åœ¨æœºå™¨éœ€è¦çœ‹åˆ°(å›¾åƒ)ï¼Œç†è§£æ•°æ®(è¿‡ç¨‹)ï¼Œå¹¶è§£é‡Šç»“è®ºã€‚å°±åƒæˆ‘ä»¬çš„è§†ç½‘è†œå’Œè§†ç¥ç»è¶³ä»¥å®Œæˆç†è§£è§†è§‰çš„ä»»åŠ¡ä¸€æ ·ï¼Œæˆ‘ä»¬åŒæ ·ä¹Ÿåœ¨è®¡ç®—æœºè§†è§‰ä¸­è¿è¡ŒæŸäº›ç®—æ³•å’Œå·¥å…·ã€‚

# åŠ¨æœº

æ›¾ç»å¯¹ä½¿ç”¨å“ªä¸ªå›¾åƒå¤„ç†åº“æ„Ÿåˆ°å›°æƒ‘å—ï¼Ÿå—¯ï¼Œå¯¹æˆ‘ä¸ªäººæ¥è¯´æ˜¯çš„ï¼åœ¨ä»äº‹ä»»ä½•ä¸è®¡ç®—æœºè§†è§‰ç›¸å…³çš„é¡¹ç›®æ—¶ï¼Œæˆ‘ä¸ªäººä¼šå¯¹é€‰æ‹©å“ªä¸ªå›¾åƒå¤„ç†åº“æ¥è¯»å–å’Œæ“ä½œæˆ‘çš„å›¾åƒæ•°æ®é›†æ„Ÿåˆ°å›°æƒ‘ã€‚æœ‰å„ç§å„æ ·çš„åº“å’ŒæŠ€æœ¯æœ€é€‚åˆç‰¹æ®Šæƒ…å†µã€‚ä¾‹å¦‚ï¼ŒMahotas æ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºç”Ÿç‰©ä¿¡æ¯å­¦æ•°æ®é›†è®¾è®¡çš„åº“ã€‚æ­¤å¤–ï¼Œæœ‰äº›æœ€é€‚åˆ ML æˆ– DL çš„æƒ…å†µã€‚

æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬æ¢ç´¢æˆ‘ä»¬çš„é€‰æ‹©ã€‚

# ç°åœºç ”ç©¶

## 1.æ•å¤´(PIL)

*   PIL (PythonImagingLibrary)æ˜¯ä¸€ä¸ªå¼€æºçš„ python åº“ï¼Œç”¨äºå¤„ç†å›¾åƒå¤„ç†ä»»åŠ¡ï¼Œå¦‚è½¬æ¢ã€å¢å¼ºã€è¯»å–å’Œæ˜¾ç¤ºï¼Œè€Œæ•å¤´æ˜¯ä¸€ä¸ªåˆ†å‰çš„åº“ã€‚
*   ä¸ºäº†åŠ è½½å›¾åƒï¼Œä½¿ç”¨å›¾åƒæ¨¡å—çš„ **open()** ï¼Œè¿”å›ä¸€ä¸ªå›¾åƒå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡æœ‰åƒç´ æ•°æ®ï¼Œè¿™å¯¹å¤„ç†å›¾åƒå¾ˆæœ‰ç”¨ã€‚å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨ **fromarray()** å°† image å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªæ•°ç»„ï¼Œç¨åå†è½¬æ¢å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚å›¾ 1 æ‰€ç¤ºã€‚

**æ–‡æ¡£:**[https://pillow.readthedocs.io/en/stable/](https://pillow.readthedocs.io/en/stable/)
**å›¾åƒç±»å‹è¯»å–å¯¹è±¡:**å›¾åƒç±»å‹

![](img/3ed1351003410d9386168e2c04d027e3.png)

Figure1

## 2.OpenCV

*   OpenCV(OpenSourceComputerVision)åº“æ˜¯ä¸€ä¸ªå¼€æºçš„è®¡ç®—æœºè§†è§‰å’Œæœºå™¨å­¦ä¹ åº“
*   å®ƒæœ‰å¹¿æ³›çš„ä¼˜åŒ–ç®—æ³•ï¼Œä»æœ€å…ˆè¿›çš„ç®—æ³•åˆ°å…¸å‹çš„å›¾åƒå¤„ç†
*   å®ƒæ˜¯ç”¨ C++ç¼–å†™çš„ï¼Œå……å½“ C++ã€Matlabã€Java å’Œ Python çš„é€šç”¨æ¥å£ã€‚
*   **OpenCV-Python** æ˜¯åŸºäº Python çš„ OpenCV çš„åŒ…è£…å™¨ã€‚åœ¨è¿™é‡Œï¼Œcv2 åº“çš„ **imread()** å°†å›¾åƒæ–‡ä»¶ä½œä¸ºæ•°ç»„è¯»å–ï¼Œè€Œ **imshow()** å°†å›¾åƒæ˜¾ç¤ºåœ¨ä¸€ä¸ªå•ç‹¬çš„çª—å£ä¸­ï¼Œå¦‚å›¾ 2 æ‰€ç¤ºã€‚

**æ–‡æ¡£**:ã€https://opencv.org/ã€‘T21
å›¾åƒè¯»å–å¯¹è±¡ç±»å‹: Numpy æ•°ç»„ç±»å‹

![](img/7fc77fd19a178b405c993274e9c21613.png)

Figure 2

## 3.sci kit-å›¾åƒ

*   Scikit-Image æ˜¯ä¸€ä¸ªåŸºäº python çš„å¼€æºå›¾åƒå¤„ç†åº“ã€‚
*   å®ƒæ˜¯ç”¨ Cython ç¼–å†™çš„ï¼Œcy thon æ˜¯ç”¨ C è¯­è¨€ç¼–å†™çš„ Python çš„è¶…é›†ï¼Œä»¥ä½¿å®ƒè¿è¡Œå¾—æ›´å¿«ã€‚

**æ–‡æ¡£:**
**å›¾ç‰‡è¯»å–å¯¹è±¡ç±»å‹:** Numpy æ•°ç»„ç±»å‹

![](img/751ed1df229cd31dcd8dbaacf9bdcf3e.png)

Figure 3

## 4.Matplotlib

*   Matplotlib æ˜¯ä¸€ä¸ªåŸºäº python çš„å¯è§†åŒ–åº“ï¼Œå°¤å…¶é€‚ç”¨äº 2d
*   å®ƒä¸»è¦ç”¨äºç»˜åˆ¶æ•£ç‚¹å›¾ã€æ¡å½¢å›¾ç­‰
*   å®ƒä¸æ˜¯åƒä¸Šé¢çš„åº“é‚£æ ·ä¸“é—¨ä¸ºæœºå™¨å­¦ä¹ ä»»åŠ¡è®¾è®¡çš„ï¼Œä¾‹å¦‚åˆ†å‰²æˆ–å¯¹è±¡æ£€æµ‹ï¼Œä½†æ˜¯ï¼Œå®ƒå¯ä»¥ç”¨äºå›¾åƒå¤„ç†ã€‚
*   *CV ä¸Šä¸‹æ–‡é™åˆ¶:*ä¸æ”¯æŒæ‰€æœ‰æ–‡ä»¶æ ¼å¼ã€‚
*   matplotlib çš„ image æ¨¡å—çš„ **imread()** è¯»å–å›¾åƒå¹¶å°†å…¶è½¬æ¢ä¸º NumPy æ•°ç»„ï¼Œå¦‚å›¾ 4 æ‰€ç¤ºã€‚

**æ–‡æ¡£:**[https://matplotlib . org/stable/tutorials/introductive/images . html](https://matplotlib.org/stable/tutorials/introductory/images.html)
**å›¾ç‰‡è¯»å–å¯¹è±¡ç±»å‹:** Numpy æ•°ç»„ç±»å‹

![](img/7adc2398e4654b73d554685814291440.png)

Figure 4

## 5.é©¬éœå¡”æ–¯

*   Mahotas æ˜¯ä¸€ä¸ªç”¨ C++å®ç°çš„è®¡ç®—æœºè§†è§‰åº“
*   å®ƒæ˜¯ä¸“é—¨ä¸ºç”Ÿç‰©å›¾åƒä¿¡æ¯å­¦è®¾è®¡çš„ï¼Œå®ƒä½¿ç”¨ NumPy é˜µåˆ—ä½œä¸ºå›¾åƒå¯¹è±¡
*   mahotas **imread()** å‡½æ•°ç”¨äºåŠ è½½å›¾åƒï¼Œå¯¼å…¥ **pylab** åº“ç”¨äºæ˜¾ç¤ºå›¾åƒå¯¹è±¡ï¼Œå¦‚å›¾ 5 æ‰€ç¤º

**æ–‡æ¡£:**[https://mahotas.readthedocs.io/en/latest/#](https://mahotas.readthedocs.io/en/latest/index.html)
**å›¾åƒè¯»å–å¯¹è±¡ç±»å‹:** Numpy æ•°ç»„ç±»å‹

![](img/d5876d4b8273cf06dd5c18fbab37234a.png)

Figure 5

6. **keras load_img å‡½æ•°**

*   ä¸€ä¸ªå« Keras çš„æ·±åº¦å­¦ä¹ æ¡†æ¶æœ‰ä¸€ä¸ªå‡½æ•°å« load_img
*   **load_img** å‡½æ•°åŠ è½½ PIL æ ¼å¼çš„å›¾åƒï¼Œå¦‚å›¾ 6 æ‰€ç¤º

![](img/74519be5dc703e02d6fd82067eaf6008.png)

Figure 6

é€šå¸¸ï¼Œè¦å‡†å¤‡ä»»ä½•æ·±åº¦å­¦ä¹ è®¡ç®—æœºè§†è§‰æ¨¡å‹ï¼Œå»ºè®®æœ‰ä¸€ä¸ªåºå¤§çš„æ•°æ®é›†(è‡³å°‘è¶…è¿‡ 500 å¼ å›¾åƒ)ï¼Œå¦åˆ™ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ å°†è¶³ä»¥å®Œæˆä»»åŠ¡ã€‚æ­¤å¤–ï¼Œå½“å†…å­˜ä¸è¶³ä»¥åŠ è½½ã€å¤„ç†æˆ–è®­ç»ƒåºå¤§çš„æ•°æ®é›†æ—¶ï¼Œæ‰¹å¤„ç†çš„æ¦‚å¿µå°±å‡ºç°äº†ã€‚ä¸å…¶ä¸€æ¬¡åŠ è½½æ‰€æœ‰å›¾åƒï¼Œä¸ºä»€ä¹ˆä¸æ‰¹é‡åŠ è½½ã€æ‰©å……å’Œå¤„ç†å‘¢ï¼Ÿå›¾åƒé€šè¿‡ç¿»è½¬ã€æ—‹è½¬ã€ç¼©æ”¾æˆ–å‰ªåˆ‡æ¥å¢åŠ æ•°æ®é›†çš„å¤§å°ã€‚æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ Keras å¦‚ä½•èƒ½æä¾›åŒæ ·çš„å¸®åŠ©ã€‚

7. **Keras å¢å¼ºå›¾åƒæµ**

*   Keras ä½¿ç”¨ ImageDataGenerator ç±»æä¾›å›¾åƒå¢å¼ºã€‚è¿™ä¸ªç±»å¯ä»¥åŠ¨æ€åœ°æ‰¹é‡å¢åŠ ä½ çš„å›¾åƒï¼Œä½ å¯ä»¥æŠŠå®ƒä¿å­˜åœ¨ç¡¬ç›˜ä¸Šæˆ–è€…ç›´æ¥ä¼ é€’ç»™ä½ çš„æ¨¡å‹ã€‚
*   åœ¨é«˜æ€»è§ˆä¸­ï¼Œ
    1ã€‚æ„é€ ä¸€ä¸ª **ImageDataGenerator å¯¹è±¡**2ã€‚ä¸ºä½äºä»¥ä¸‹ä½ç½®çš„å›¾åƒæ•°æ®é›†åˆ›å»ºä¸€ä¸ª**è¿­ä»£å™¨**:
    2.1 é€šè¿‡ *flow()*
    è°ƒç”¨å†…å­˜ä¸­çš„æ•°æ® 2.2 é€šè¿‡*flow _ from _ directory()*
    è°ƒç”¨ç£ç›˜ä¸­çš„æ•°æ® 2.3 é€šè¿‡ *flow_from_dataframe()* è°ƒç”¨æ•°æ®å¸§ä¸­çš„æ•°æ®
*   è¿­ä»£å™¨åœ¨æ¯æ¬¡è¿­ä»£ä¸­è¿”å›ä¸€æ‰¹æ‰©å……å›¾åƒã€‚è¿™ä¸ªè¿­ä»£å™¨å¯ä»¥è¿›ä¸€æ­¥ç”¨äºä½¿ç”¨ fit_generator()è®­ç»ƒç½‘ç»œã€‚
*   è®©æˆ‘ä»¬ä¸Šåœºå§ã€‚
    ***æ­¥éª¤ 1:*** æ„é€ ä¸€ä¸ª **ImageDataGenerator å¯¹è±¡**
    ç”¨æ‰©å……å‚æ•°å®ä¾‹åŒ–ä¸€ä¸ª ImageDataGenerator å¯¹è±¡

```
from keras.preprocessing.image import ImageDataGenerator
img_gen = ImageDataGenerator(rotation_range=40, zoom_range=0.3, horizontal_flip = True, fill_mode='reflect') 
```

***æ­¥éª¤ 2.1:*** åŠ è½½åˆ°å†…å­˜ä¸­çš„æ•°æ®è°ƒç”¨é€šè¿‡ ***flow()*** å°†ä¸€å¹…å›¾åƒåŠ è½½åˆ°å†…å­˜ä¸­ã€‚ä¸€ä¸ªç”Ÿæˆå™¨è¢«åˆ›å»ºï¼Œå®ƒå°†ä¿å­˜ 5 ä¸ªå¢å¼ºçš„å›¾åƒåˆ°ä¸€ä¸ªç›®å½•ä¸­ã€‚

```
from skimage import io
# load image in memory
x = io.imread(join(path ,'data\\dogs.jpeg'))
x = x.reshape((1,)+ x.shape) # iterator should have rank 4# iterator generates batches of randomly transformed images
iterator = img_gen.flow(x, batch_size=4, save_to_dir = path_to_save ,save_prefix='pre', save_format='png')
```

***æ­¥éª¤ 2.2:*** ä¿å­˜åœ¨ç£ç›˜ä¸­çš„æ•°æ®ç§°ä¸º via****flow _ from _ directory()*** å›¾åƒä½œä¸ºç›®å½•ä¿å­˜åœ¨ç£ç›˜ä¸­ã€‚å‡è®¾æœ‰ä¸¤ç±»å›¾ç‰‡åˆ†åˆ«å­˜å‚¨åœ¨â€œ *train* â€å’Œ flow_from_directory()çš„å­æ–‡ä»¶å¤¹ä¸­ï¼Œç›´æ¥ä»ç›®å½•ä¸­è¯»å–ã€‚*

```
*# directory where images stored on disk in respective subfolders
folder = '/train'
# iterator generates batches of randomly transformed images
iterator = img_gen.flow_from_directory(
                   directory = folder, 
                   target_size = (100,100), 
                   batch_size=4, 
                   save_to_dir = path_to_save)
x,y = iterator.next()
print('Batch Image Shape:', x.shape)# outputs 
# Found 12 images belonging to 2 classes.
# Batch Image Shape (4, 256, 256, 3)*
```

****æ­¥éª¤ 2.3:*** ä¸åœ¨æœ¬åšå®¢èŒƒå›´å†…*

*å¦‚æœä½ æ›´å¥½å¥‡ï¼Œé‚£ä¹ˆåº”è¯¥è®¿é—®[è¿™ä¸€é¡µ](https://keras.io/api/preprocessing/image/)ã€‚*

*æˆ‘ä»¬å·²ç»åŒ…æ‹¬äº† ML/DL ä¸­ä½¿ç”¨çš„æœ€å¸¸è§å’Œæœ€æµè¡Œçš„åº“ã€‚ç„¶è€Œï¼Œè¿˜æœ‰å…¶ä»–å¯ç”¨çš„åº“ï¼Œå¦‚ **SimpleITKã€SimpleCVã€Pgmagickã€**å’Œ **SciPyã€‚***

*æ£€æŸ¥æˆ‘çš„ [GitHub repo](https://github.com/shachi01/machine-learning/blob/master/load_images_ml_dl.ipynb) æ€»ç»“äº†è¿™é‡Œæ¼”ç¤ºçš„æ‰€æœ‰ä»£ç ã€‚*

*å¦‚æœä½ å–œæ¬¢è¿™ä½ä½œè€…çš„åšå®¢ï¼Œè¯·éšæ„å…³æ³¨ä»–ï¼Œå› ä¸ºè¿™ä½ä½œè€…ä¿è¯ä½ ä¼šå›æ¥çœ‹æ›´å¤šæœ‰è¶£çš„äººå·¥æ™ºèƒ½ç›¸å…³çš„ä¸œè¥¿ã€‚
è°¢è°¢ï¼Œ
å­¦ä¹ æ„‰å¿«ï¼ğŸ˜„*

****å¯ä»¥é€šè¿‡***[***LinkedIn***](https://www.linkedin.com/in/kaul-shachi)***å–å¾—è”ç³»ã€‚****