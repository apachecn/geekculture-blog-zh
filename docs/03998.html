<html>
<head>
<title>Privacy-friendly analytics in GatsbyJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç›–èŒ¨æ¯”ä¸­çš„éšç§å‹å¥½åˆ†æ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/privacy-friendly-analytics-in-gatsbyjs-daaa2935518f?source=collection_archive---------7-----------------------#2021-06-19">https://medium.com/geekculture/privacy-friendly-analytics-in-gatsbyjs-daaa2935518f?source=collection_archive---------7-----------------------#2021-06-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="349e" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">æˆ‘å»ºç«‹äº†æˆ‘çš„Gatsbyç«™ç‚¹ï¼Œåªè·Ÿè¸ªå¸Œæœ›è¢«è·Ÿè¸ªçš„ç”¨æˆ·ï¼Œä½¿ç”¨cookieåŒæ„æ¨ªå¹…è¯·æ±‚ä»–ä»¬çš„è®¸å¯â€¦</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/8a9c1fa71e936166d45ebec89e377912.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nGhqX3NPH_KZYdtd.jpg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">â€œPhoto by <a class="ae jn" href="https://unsplash.com/@jdent?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Jason Dent</a> on <a class="ae jn" href="https://unsplash.com/s/photos/privacy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>â€</figcaption></figure><p id="ea5c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ğŸ””è¿™ç¯‡æ–‡ç« æœ€åˆå‘å¸ƒåœ¨æˆ‘çš„ç½‘ç«™ä¸Šï¼Œã€MihaiBojin.com T4ã€‘ã€‚ğŸ””</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="3343" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">å¯¹äºæˆ‘çš„ç½‘ç«™ï¼Œæˆ‘æƒ³è·å–ç”¨æˆ·åˆ†æï¼Œè€Œä¸è·Ÿè¸ªé‚£äº›ä¸æƒ³è¢«è·Ÿè¸ªçš„ç”¨æˆ·ã€‚åœ¨æ¬§æ´²ï¼Œé€šç”¨æ•°æ®ä¿æŠ¤æ¡ä¾‹(GDPR)ä¿æŠ¤æ¶ˆè´¹è€…çš„éšç§ã€‚ç‰¹åˆ«æ˜¯ï¼Œ<a class="ae jn" href="https://gdpr.eu/cookies/" rel="noopener ugc nofollow" target="_blank"> ePrivacyæŒ‡ä»¤</a>åœ¨è®¾ç½®ä»»ä½•è·Ÿè¸ªcookiesä¹‹å‰ä¼šè¯·æ±‚ç”¨æˆ·çš„åŒæ„ã€‚</p><p id="5c64" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">å¿«é€Ÿæœç´¢æ˜¾ç¤º<a class="ae jn" href="https://github.com/andrezimpel/gatsby-plugin-gdpr-cookies" rel="noopener ugc nofollow" target="_blank">Gatsby-plugin-gdpr-cookies</a>ï¼Œä¸€ä¸ªæ”¯æŒ<a class="ae jn" href="https://analytics.google.com/analytics/web/" rel="noopener ugc nofollow" target="_blank">è°·æ­Œåˆ†æ</a>ã€<a class="ae jn" href="https://marketingplatform.google.com/about/tag-manager/" rel="noopener ugc nofollow" target="_blank">è°·æ­Œæ ‡ç­¾ç®¡ç†å™¨</a>å’Œ<a class="ae jn" href="https://www.facebook.com/business/help/742478679120153?id=1205376682832142&amp;helpref=faq_content" rel="noopener ugc nofollow" target="_blank">è„¸ä¹¦åƒç´ </a>çš„æ’ä»¶ã€‚</p><p id="dc9c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ç®€è€Œè¨€ä¹‹ï¼Œå®ƒæä¾›äº†ä¸€ç§è¦æ±‚ç”¨æˆ·æ˜ç¡®åŒæ„è®¾ç½®ä»»ä½•cookiesçš„æœºåˆ¶ï¼›æ­£æ˜¯æˆ‘æ‰€éœ€è¦çš„ï¼</p><h2 id="eb69" class="kr ks hi bd kt ku kv kw kx ky kz la lb jx lc ld le kb lf lg lh kf li lj lk ll bi translated">å®‰è£…æ’ä»¶</h2><p id="2f47" class="pw-post-body-paragraph jo jp hi jq b jr lm ij jt ju ln im jw jx lo jz ka kb lp kd ke kf lq kh ki kj hb bi translated">æˆ‘ç”¨<code class="du lr ls lt lu b">npm install gatsby-plugin-gdpr-cookies</code>å®‰è£…äº†æ’ä»¶ï¼Œç„¶åæŠŠå®ƒæ·»åŠ åˆ°æˆ‘çš„<code class="du lr ls lt lu b">gatsby-config.js</code>æ–‡ä»¶ä¸­:</p><pre class="iy iz ja jb fd lv lu lw lx aw ly bi"><span id="fcc8" class="kr ks hi lu b fi lz ma l mb mc">module.exports = {<br/>  plugins: [<br/>    {<br/>      resolve: `gatsby-plugin-gdpr-cookies`,<br/>      options: {<br/>        googleAnalytics: {<br/>          trackingId: /*GA_TRACKING_ID*/,<br/>          cookieName: "gatsby-gdpr-google-analytics",<br/>          anonymize: true, // https://github.com/andrezimpel/gatsby-plugin-gdpr-cookies#anonymize<br/>          allowAdFeatures: false,<br/>        },<br/>      },<br/>    },<br/>  ],<br/>};</span></pre><p id="a6c2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ç„¶åï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰â€¦</p><p id="13ff" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">äº‹å®è¯æ˜ï¼Œé…ç½®è¿™ä¸ªæ’ä»¶æ¯”æ–‡æ¡£æ˜¾ç¤ºçš„<a class="ae jn" href="https://github.com/andrezimpel/gatsby-plugin-gdpr-cookies#initialize-and-track" rel="noopener ugc nofollow" target="_blank">è¦éº»çƒ¦ä¸€ç‚¹ã€‚</a></p><p id="32a0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">æ’ä»¶<strong class="jq hj">è¦æ±‚æ‚¨è®¾ç½®åä¸º</strong> <code class="du lr ls lt lu b"><strong class="jq hj">cookieName</strong></code>çš„cookieï¼Œä¾‹å¦‚:<code class="du lr ls lt lu b">gatsby-gdpr-google-analytics=true</code>ï¼Œä»¥å¯ç”¨è·Ÿè¸ªã€‚</p><p id="18e0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">è¿™ä¸€ç‚¹å¹¶ä¸æ˜æ˜¾ï¼Œæˆ‘æœ€ç»ˆèŠ±è´¹äº†ä¸å¿…è¦çš„æ—¶é—´å»å¼„æ¸…æ¥šä¸ºä»€ä¹ˆå®ƒä¸èµ·ä½œç”¨ã€‚</p><h2 id="0ad1" class="kr ks hi bd kt ku kv kw kx ky kz la lb jx lc ld le kb lf lg lh kf li lj lk ll bi translated">ä¸åŒæ„æ¨ªå¹…æ•´åˆ</h2><p id="226e" class="pw-post-body-paragraph jo jp hi jq b jr lm ij jt ju ln im jw jx lo jz ka kb lp kd ke kf lq kh ki kj hb bi translated">è¿™æ ·ä¸€æ¥ï¼Œæˆ‘éœ€è¦ä¸€ä¸ªå¼€å…³æ¥è·Ÿè¸ªç”¨æˆ·æ˜¯å¦å·²ç»æ¥å—äº†æ¨ªå¹…ã€‚é€šå¸¸ï¼Œæˆ‘ä¼šä½¿ç”¨å¦ä¸€ç§cookieâ€”â€”ä½†é‚£ä¼šè¿èƒŒæˆ‘çš„åˆè¡·ã€‚</p><p id="567f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">æœ¬åœ°å­˜å‚¨æ¥æ•‘æ´ï¼</strong>æˆ‘æ‰¾åˆ°äº†<a class="ae jn" href="https://www.joshwcomeau.com/snippets/react-hooks/use-sticky-state/" rel="noopener ugc nofollow" target="_blank"> Josh Comeauå…³äºç²˜æ€§çŠ¶æ€çš„ä¼˜ç§€æ•™ç¨‹</a>å¹¶å®ç°äº†å®ƒã€‚</p><p id="4300" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ä¸€ä¸ªç®€å•çš„Reactç»„ä»¶ä¹‹åï¼Œå’Œä¸€äº›ç”¨äºæ¨ªå¹…çš„<a class="ae jn" href="https://tailwindui.com/components/marketing/elements/banners#component-39dd57897ef8e6d37aa07fbbafc188b1" rel="noopener ugc nofollow" target="_blank"> TailwindUIä»£ç ï¼Œå®ƒå°±å‡†å¤‡å¥½äº†ï¼</a></p><p id="d952" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ä¸‹é¢æ˜¯ç”Ÿæˆçš„ä»£ç (ç®€åŒ–):</p><pre class="iy iz ja jb fd lv lu lw lx aw ly bi"><span id="304e" class="kr ks hi lu b fi lz ma l mb mc">import * as React from 'react';<br/>import { useLocation } from '@reach/router';<br/>import { initializeAndTrack } from 'gatsby-plugin-gdpr-cookies';<br/><br/>function isBrowser() {<br/>  return typeof window !== 'undefined';<br/>}<br/><br/>function getValue(key, defaultValue) {<br/>  return isBrowser() &amp;&amp; window.localStorage.getItem(key)<br/>    ? JSON.parse(window.localStorage.getItem(key))<br/>    : defaultValue;<br/>}<br/><br/>function setValue(key, value) {<br/>  window.localStorage.setItem(key, JSON.stringify(value));<br/>}<br/><br/>function useStickyState(defaultValue, key) {<br/>  const [value, setter] = React.useState(() =&gt; {<br/>    return getValue(key, defaultValue);<br/>  });<br/><br/>  React.useEffect(() =&gt; {<br/>    setValue(key, value);<br/>  }, [key, value]);<br/><br/>  return [value, setter];<br/>}<br/><br/>const CookieConsent = () =&gt; {<br/>  const location = useLocation();<br/>  if (isBrowser()) {<br/>    initializeAndTrack(location);<br/>  }<br/><br/>  const [bannerHidden, setBannerHidden] = useStickyState(<br/>    false,<br/>    'consentCookieHidden',<br/>  );<br/><br/>  const EnableAnalytics = () =&gt; {<br/>    document.cookie = 'gatsby-gdpr-google-analytics=true';<br/>    setBannerHidden(true);<br/>  };<br/><br/>  return (<br/>    &lt;&gt;<br/>      {!bannerHidden &amp;&amp; (<br/>        &lt;div&gt;<br/>          &lt;span&gt;<br/>            We use cookies to personalize content and analyze our<br/>            traffic.<br/>          &lt;/span&gt;<br/>          &lt;button onClick={EnableAnalytics}&gt;OK&lt;/button&gt;<br/>        &lt;/div&gt;<br/>      )}<br/>    &lt;/&gt;<br/>  );<br/>};<br/><br/>export default CookieConsent;</span></pre><p id="e544" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">å‰©ä¸‹çš„æœ€åä¸€ä»¶äº‹æ˜¯åœ¨ç«™ç‚¹çš„é¡µè„šè°ƒç”¨è¿™ä¸ªç»„ä»¶ã€‚</p><pre class="iy iz ja jb fd lv lu lw lx aw ly bi"><span id="b405" class="kr ks hi lu b fi lz ma l mb mc">import CookieConsent from 'cookie-consent';<br/>...<br/>&lt;CookieConsent/&gt;</span></pre><p id="e016" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">è¿™ç¡®ä¿äº†åœ¨ç”¨æˆ·å•å‡»OKä¹‹å‰ï¼Œä¸ä¼šè¿è¡Œä»»ä½•åˆ†æä»£ç ï¼Œä¹Ÿä¸ä¼šè®¾ç½®ä»»ä½•cookiesã€‚</p><p id="6400" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">å°±æ˜¯è¿™æ ·ï¼è¿™æ˜¯æ‚¨åœ¨å¯ç”¨åˆ†æå’Œè·Ÿè¸ªcookiesä¹‹å‰è·å¾—ç”¨æˆ·åŒæ„çš„æ–¹å¼ï¼</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="7cf8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« å¹¶æƒ³é˜…è¯»æ›´å¤šç±»ä¼¼çš„æ–‡ç« ï¼Œ<a class="ae jn" href="https://motivated-founder-807.ck.page/db1cf284bf" rel="noopener ugc nofollow" target="_blank">è¯·è®¢é˜…æˆ‘çš„ç®€è®¯</a>ï¼›æˆ‘æ¯éš”å‡ å‘¨å°±å‘ä¸€å°ï¼</p></div></div>    
</body>
</html>