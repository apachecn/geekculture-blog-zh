# é€»è¾‘å›å½’-æœ€å¤§ä¼¼ç„¶æ³•ä¸­çš„ç¬¬ä¸€åˆ†ç±»æ¨¡å‹

> åŸæ–‡ï¼š<https://medium.com/geekculture/logistic-regression-first-classification-model-in-ml-5642b28298d5?source=collection_archive---------19----------------------->

æœºå™¨å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„ä¸€éƒ¨åˆ†ï¼Œæœºå™¨åœ¨æœ€å°‘çš„äººå·¥å¹²é¢„ä¸‹å­¦ä¹ ç»™å®ƒçš„æ•°æ®ã€‚æœºå™¨å­¦ä¹ åˆ†ä¸ºå››ç±»ï¼Œå³ç›‘ç£å­¦ä¹ ã€éç›‘ç£å­¦ä¹ ã€åŠç›‘ç£å­¦ä¹ å’Œå¼ºåŒ–å­¦ä¹ ã€‚å½“æ ‡ç­¾æ˜¯å·²çŸ¥çš„å¹¶ä¸”è¢«æä¾›ç»™æœºå™¨æ—¶ï¼Œä½¿ç”¨ç›‘ç£å­¦ä¹ ï¼Œä»¥ä¾¿å¯ä»¥å®¹æ˜“åœ°è¯†åˆ«è¿›ä¸€æ­¥çš„è¿™ç§æ•°æ®ã€‚å—ç›‘ç£çš„ ML è¿›ä¸€æ­¥åˆ†ä¸ºä¸¤ç§ç±»å‹ã€‚å®ƒä»¬æ˜¯å›å½’å’Œåˆ†ç±»ä»»åŠ¡ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œç¬¬ä¸€ä¸ªå·²çŸ¥çš„åŸºæœ¬å›å½’ç®—æ³•æ˜¯çº¿æ€§å›å½’ï¼Œç¬¬ä¸€ä¸ªå·²çŸ¥çš„åˆ†ç±»ç®—æ³•æ˜¯é€»è¾‘å›å½’ã€‚

ä»Šå¤©è®¨è®ºçš„è¯é¢˜æ˜¯é€»è¾‘å›å½’ï¼Œåœ¨æ­¤ä¹‹å‰æœ€å¥½å…ˆäº†è§£ä¸€ä¸‹çº¿æ€§å›å½’ã€‚ä¸è¿‡ï¼Œä½ å¯ä»¥é˜…è¯»é€»è¾‘å›å½’ï¼Œå¦‚æœä½ æƒ³äº†è§£çº¿æ€§å›å½’ï¼Œç‚¹å‡»[äº†è§£çº¿æ€§å›å½’](/geekculture/linear-regression-first-model-for-ml-cce82b2468e)ã€‚

é—®é¢˜å‡ºç°äº†:å¦‚æœé€»è¾‘å›å½’ä»…ç”¨äºåˆ†ç±»ï¼Œé‚£ä¹ˆé€»è¾‘å›å½’å¦‚ä½•å‘½åä¸ºâ€œå›å½’â€è€Œä¸æ˜¯â€œåˆ†ç±»â€ã€‚

è¿™é‡Œå›ç­”:è¿™æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„é—®é¢˜ã€‚é€»è¾‘å›å½’æ˜¯ç”¨äºåˆ†ç±»ä»»åŠ¡çš„çº¿æ€§å›å½’æ¨¡å‹çš„æ‰©å±•ã€‚â€œé€»è¾‘å›å½’â€è¿™ä¸ªåå­—ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æ­¤å¤–ï¼Œé€»è¾‘å›å½’å…·æœ‰ 0 åˆ° 1 æˆ–æ›´å¤§çš„å€¼ã€‚æ‰€æœ‰è¿™äº›éƒ½æ˜¯ç¦»æ•£å€¼ï¼Œä»…ç”¨äºåˆ†ç±»é—®é¢˜ã€‚

ä»…é‡‡ç”¨ä¸¤ä¸ªè¾“å‡ºå€¼(å¦‚ 0ï¼Œ1)çš„é€»è¾‘å›å½’ç§°ä¸ºäºŒå…ƒé€»è¾‘å›å½’ã€‚å½“è¾“å‡ºå¯ä»¥å–ä¸¤ä¸ªä»¥ä¸Šçš„å€¼æ—¶ç§°ä¸ºå¤šé¡¹é€»è¾‘å›å½’ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³é¢„æµ‹æŸäººæ˜¯å¦èƒ½æ‹¿åˆ°ç¥¨ï¼Œå¯ä»¥ç”¨äºŒå…ƒé€»è¾‘å›å½’æ¥è§£å†³ï¼Œè€Œå½“ä½ æƒ³çŸ¥é“æ˜å¤©æ˜¯å¤šäº‘ã€ä¸‹é›¨è¿˜æ˜¯ç‚çƒ­æ—¶ï¼Œä½ å¯ä»¥ç”¨å¤šé¡¹å¼é€»è¾‘å›å½’ã€‚

![](img/c9d5f8ea3467a164d65a1777d9cc5d70.png)

Logistic Regression

é€»è¾‘å›å½’ç†è®ºä¸‹é¢æ˜¯ä¸ºäº†äº†è§£é€»è¾‘å›å½’ç®—æ³•èƒŒåçš„ç›´è§‰:

åœ¨é€»è¾‘å›å½’ä¸­ï¼Œåˆ†ç±»ååº”æˆ–ç›®æ ‡æˆ–è¾“å‡ºä¸ºçœŸæˆ–æ­£çš„å¯¹æ•°ä¼˜åŠ¿è¢«å»ºæ¨¡ä¸ºç‰¹å¾çš„çº¿æ€§ç»„åˆã€‚æ•°å­¦ä¸Šï¼Œlog(p/1-p)= w0 + w1x1 +w2x2 + â€¦ã€‚wjxj(=wTx)åœ¨ä¸¤è¾¹åº”ç”¨æŒ‡æ•°ï¼Œä½ å¾—åˆ°=>p/1-p = e^WTx æœ€åæ±‚è§£ p ä½ å¾—åˆ°=> p = e^wTx/1+e^wTx æˆ– hw(x)= 1/1+e^-wTx

ä¸Šè¿° p(çœŸå€¼)æˆ– hw(x)ç§°ä¸º logit å‡½æ•°ã€‚[ä¸¤ä¸ª p=hw(x)]

é€»è¾‘æ–¹ç¨‹å¼çš„æˆæœ¬å‡½æ•°-Ï€(1 ç±»)HW(x)Ï€(0 ç±»)1-hw(x)ã€‚è¿™å¯ä»¥è¿›ä¸€æ­¥å†™æˆÏƒ(I = 1 åˆ° N) yi log hw(x) + (1-yi) log(1-hw(x))

ä¸Šé¢çš„ç­‰å¼è¢«ç§°ä¸ºæœ€å¤§ä¼¼ç„¶å‡½æ•°ï¼Œå®ƒéœ€è¦æœ€å¤§åŒ–ï¼Œå› ä¸ºå®ƒç»™å‡ºäº†ä¸ºçœŸçš„æ¦‚ç‡ã€‚ä¸Šè¿°å‡½æ•°å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»æœ‰äº† logit å‡½æ•°ï¼Œå®ƒå¯ä»¥ä»£å…¥ä¸Šè¿°æ–¹ç¨‹å¾—åˆ°Ïƒ(I = 1 åˆ° N) (yi-1) (wTxi)-log(1-e-WTxi)

æ¢¯åº¦ä¸‹é™ä¹Ÿå¯ä»¥åº”ç”¨äºé€»è¾‘å›å½’æˆæœ¬å‡½æ•°ï¼Œ

![](img/6fa53c2f83c6bd6b0ff935a9a66bcc01.png)![](img/440b2348af3aa40b5eae64ac59675fe2.png)

Î¸å’Œ w è¡¨ç¤ºé‡é‡ï¼Œç›¸åŒã€‚å¯¹ w æˆ–Î¸çš„å¯¼æ•°æ˜¯ä¸€æ ·çš„ã€‚

å¯¹äºé€»è¾‘å›å½’ï¼Œæˆæœ¬å‡½æ•°æ˜¯å¯¹æ•°æŸå¤±ï¼Œè€Œå¯¹äºå¤šé¡¹å¼é€»è¾‘å›å½’ï¼Œæˆæœ¬å‡½æ•°æ˜¯åˆ†ç±»äº¤å‰ç†µã€‚åœ¨é€»è¾‘å›å½’ä¸­ï¼Œæˆ‘ä»¬æœ‰ Sigmoid å‡½æ•°ã€æœ€å¤§ä¼¼ç„¶ä¼°è®¡å’Œæ¢¯åº¦ä¸‹é™ï¼Œåœ¨å¤šé¡¹å¼é€»è¾‘å›å½’ä¸­ï¼Œæˆ‘ä»¬æœ‰ Softmax å‡½æ•°ã€äº¤å‰ç†µæŸå¤±å‡½æ•°å’Œéšæœºæ¢¯åº¦ä¸‹é™ã€‚

![](img/06d4cecaa0ba49f6b8388c965a40eeb7.png)![](img/244b70234513f9f71b9df9b6bb5ea886.png)

Multinomial Cross-Entropy

ä¸ºäº†è§£é‡Šè¿™ç§äº¤å‰ç†µæŸå¤±ï¼Œå®ƒå°±åƒæ‰€æœ‰çš„æ¦‚ç‡ï¼Œå¹¶æ‰¾åˆ°å®ƒçš„æœ€é«˜å€¼ã€‚ç¤ºä¾‹å¦‚æœæœ‰ä¸‰ä¸ªç±»ï¼Œåˆ™è®¡ç®— f(1)ï¼Œf(2)ï¼Œf(3)ã€‚

![](img/140fbba28a06d116c238c434b054704f.png)

å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåœ¨ ML ä¸­ï¼Œé€»è¾‘å›å½’æ¯”å¤šé¡¹å¼é€»è¾‘å›å½’ä½¿ç”¨å¾—æ›´é¢‘ç¹ï¼Œåœ¨é«˜çº§ ML ä¸­ï¼Œè¿™ç§æƒ…å†µä½¿ç”¨å¾—æ›´å¤šï¼Œå› ä¸ºæ·±åº¦å­¦ä¹ é—®é¢˜å¾ˆå¤æ‚ï¼Œå¯¹äºå¤§å‹æ•°æ®é›†ï¼Œå½“æˆ‘ä»¬é‡åˆ°æ¯”ç®€å•æ•°æ®é›†ä¸­æ›´å¤šçš„åˆ†ç±»æ•°æ®æ—¶ï¼Œé€šå¸¸ä¼šä½¿ç”¨è¿™äº›æ•°æ®ã€‚

åˆ†ç±»æ¨¡å‹çš„è¯„ä¼°åº¦é‡æ˜¯å‡†ç¡®åº¦ã€ç²¾ç¡®åº¦ã€å¬å›ç‡ã€å‡é˜³æ€§ç‡ã€F1 åˆ†æ•°æˆ– F åº¦é‡ã€‚ä½¿ç”¨æ··æ·†çŸ©é˜µå¯ä»¥çŸ¥é“ä»¥ä¸Šæ‰€æœ‰å†…å®¹ã€‚Roc_auc åˆ†æ•°ä¹Ÿæ˜¯è¯„ä¼°åˆ†ç±»ä»»åŠ¡çš„ä¸€ä¸ªé‡è¦åº¦é‡ï¼Œå¹¶ä¸”åœ¨ç›®æ ‡ç±»ä¸å¹³è¡¡æ—¶éå¸¸æœ‰ç”¨ã€‚

é€»è¾‘å›å½’ä¸­æœ‰è®¸å¤šè¶…å‚æ•°ï¼Œå¦‚ penalty->å…¶ä¸­ l1ã€l2 å¯ä»¥ä½¿ç”¨å¼¹æ€§ç½‘ï¼ŒC->ç”¨äºæ­£åˆ™åŒ–ï¼ŒC å€¼è¶Šä½æ­£åˆ™åŒ–ç¨‹åº¦è¶Šé«˜ï¼ŒC å€¼è¶Šé«˜æ­£åˆ™åŒ–ç¨‹åº¦è¶Šä½æˆ–ä¸æ­£åˆ™åŒ–ï¼Œmulticlass->å…¶ä¸­å®ƒå¯ä»¥æ˜¯â€œautoâ€ã€â€œovrâ€ã€â€œmultinomialâ€ï¼Œé¡¾åæ€ä¹‰ ovr è¡¨ç¤ºäºŒè¿›åˆ¶ï¼Œauto è¡¨ç¤ºæœªè¯´æ˜çš„æƒ…å†µï¼Œmultinomial è¡¨ç¤ºæœ‰ä¸¤ä¸ªä»¥ä¸Šçš„ç±»ï¼Œç­‰ç­‰ã€‚åœ¨ Scikit-learn.org[**çš„ Sklearn Logistic å›å½’é¡µé¢å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„è¶…å‚æ•°åˆ—è¡¨ã€‚**](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html)

å®ç°å¾ˆç®€å•ï¼Œåªæœ‰å‡ è¡Œä»£ç ã€‚

![](img/67e494206761e0025926ff2098e29f1d.png)

Fitting Logistic model to the data

![](img/21528253332b195d321a3fc86c52193a.png)

Finding the accuracy of the model with true and predicted values

![](img/7f848423f75307d37a742c904098a6a1.png)

Intercept and coefficient can be known as in Linear regression

![](img/78f4d53860750cf4ab4ba3691357522b.png)

Even the probabilities of class 0 and 1 can be known using predict_proba

ä¸ä»…æ¦‚ç‡æ˜¯å·²çŸ¥çš„ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é‡æ–°è°ƒæ•´é¢„æµ‹ç±»åˆ«çš„é˜ˆå€¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œé˜ˆå€¼ä¸º 0.5ï¼Œè¿™æ„å‘³ç€å¦‚æœæ¦‚ç‡ä¸º<0.5 its is predicted as class 0 else if it is > 0.5ï¼Œæ¨¡å‹ä¼šå°†å…¶é¢„æµ‹ä¸º 1 ç±»ã€‚è¿™å¯ä»¥æ ¹æ®éœ€è¦æ›´æ”¹ä¸º 0.2 æˆ– 0.4 æˆ–ä»»ä½•å€¼ã€‚è¿™ä¹ˆçµæ´»å¯¹å§ï¼Ÿ

é€»è¾‘å›å½’æœ‰å®ƒçš„ä¼˜ç‚¹å’Œç¼ºç‚¹:

*   é€»è¾‘å›å½’**éœ€è¦ä¸€ä¸ªå¤§çš„æ•°æ®é›†**å’Œè¶³å¤Ÿçš„è®­ç»ƒæ ·æœ¬æ¥è¯†åˆ«æ‰€æœ‰éœ€è¦è¯†åˆ«çš„ç±»åˆ«ã€‚
*   é€»è¾‘å›å½’æ˜¯ä¸€ç§ç»Ÿè®¡åˆ†ææ¨¡å‹ï¼Œè¯•å›¾æ ¹æ®ç‹¬ç«‹ç‰¹å¾é¢„æµ‹ç²¾ç¡®çš„æ¦‚ç‡ç»“æœã€‚åœ¨**é«˜ç»´æ•°æ®é›†**ä¸Šï¼Œè¿™å¯èƒ½å¯¼è‡´æ¨¡å‹**åœ¨è®­ç»ƒé›†**ä¸Šè¿‡åº¦æ‹Ÿåˆï¼Œè¿™æ„å‘³ç€å¤¸å¤§äº†è®­ç»ƒé›†ä¸Šçš„é¢„æµ‹å‡†ç¡®æ€§ï¼Œå› æ­¤æ¨¡å‹**å¯èƒ½æ— æ³•åœ¨æµ‹è¯•é›†**ä¸Šé¢„æµ‹å‡†ç¡®çš„ç»“æœã€‚è¿™ç§æƒ…å†µé€šå¸¸å‘ç”Ÿåœ¨æ¨¡å‹æ ¹æ®å…·æœ‰å¤§é‡ç‰¹å¾çš„å°‘é‡è®­ç»ƒæ•°æ®è¿›è¡Œè®­ç»ƒçš„æƒ…å†µä¸‹ã€‚å› æ­¤ï¼Œåœ¨é«˜ç»´æ•°æ®é›†ä¸Šï¼Œåº”è€ƒè™‘æ­£åˆ™åŒ–æŠ€æœ¯ä»¥é¿å…è¿‡åº¦æ‹Ÿåˆ(ä½†è¿™ä¼šä½¿æ¨¡å‹å˜å¾—å¤æ‚)ã€‚éå¸¸é«˜çš„æ­£åˆ™åŒ–å› å­ç”šè‡³å¯èƒ½å¯¼è‡´æ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šæ¬ æ‹Ÿåˆã€‚
*   é€»è¾‘å›å½’å‡è®¾çº¿æ€§ï¼Œè€Œåœ¨ç°å®ä¸–ç•Œçš„é—®é¢˜ä¸­å¾ˆå°‘è§åˆ°ã€‚ä½¿ç”¨é€»è¾‘å›å½’å¾ˆéš¾è·å¾—å¤æ‚çš„å…³ç³»ã€‚æ›´å¼ºå¤§å’Œç´§å‡‘çš„ç®—æ³•ï¼Œå¦‚ç¥ç»ç½‘ç»œï¼Œå¯ä»¥è½»æ¾èƒœè¿‡è¿™ç§ç®—æ³•ã€‚
*   é€»è¾‘å›å½’ä¸å¤ªå€¾å‘äºè¿‡åº¦æ‹Ÿåˆï¼Œä½†å®ƒå¯èƒ½åœ¨é«˜ç»´æ•°æ®é›†ä¸­è¿‡åº¦æ‹Ÿåˆã€‚äººä»¬å¯ä»¥è€ƒè™‘æ­£åˆ™åŒ–(L1 å’Œ L2)æŠ€æœ¯ï¼Œä»¥é¿å…åœ¨è¿™äº›æƒ…å†µä¸‹è¿‡åº¦æ‹Ÿåˆã€‚åœ¨çº¿æ€§å›å½’ä¸­ï¼Œè‡ªå˜é‡å’Œå› å˜é‡æ˜¯çº¿æ€§ç›¸å…³çš„ã€‚ä½†æ˜¯ Logistic å›å½’**éœ€è¦è‡ªå˜é‡ä¸ log odds çº¿æ€§ç›¸å…³(log(p/(1-p))** ã€‚
*   æ•°æ®é›†ä¸­å‡ºç°åç¦»é¢„æœŸèŒƒå›´çš„æ•°æ®å€¼å¯èƒ½ä¼šå¯¼è‡´ä¸æ­£ç¡®çš„ç»“æœï¼Œå› ä¸ºæ­¤**ç®—æ³•å¯¹å¼‚å¸¸å€¼**å¾ˆæ•æ„Ÿã€‚

![](img/ca922cf3cf0f6d94d476a7460845a8fc.png)

Photo by [Aditya Chinchure](https://unsplash.com/@adityachinchure?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

> ***å¿—å­˜é«˜è¿œï¼Œé£å¾—æ›´é«˜***
> 
> æ€€ç–‘æ¯”å¤±è´¥æ›´èƒ½æ‰¼æ€æ¢¦æƒ³
> 
> è®©æ¯ä¸€å¤©éƒ½æˆä¸ºä½ çš„æ°ä½œ

å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¾ˆæœ‰ç”¨ï¼Œå¹¶ä¸”å­¦åˆ°äº†ä¸€äº›ä¸œè¥¿ï¼Œè¯·ç»™äºˆä¸€äº›æ”¯æŒï¼Œå¹¶ä¸å…¶ä»–æƒ³äº†è§£å®ƒçš„äººåˆ†äº«ã€‚å¦‚æœä½ æœ‰ä»€ä¹ˆè¦è¯´çš„ï¼Œæˆ‘æ„¿æ„å€¾å¬ä½ çš„å»ºè®®ï¼Œå¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–è¦æ±‚ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚ç»§ç»­åšåˆ°æœ€å¥½ã€‚ğŸ¥°Stay å®‰å…¨äº†ï¼Œç»§ç»­ç»™ä¸–ç•Œå¸¦æ¥å…‰æ˜ã€‚ä¼šåœ¨ä¸‹ä¸€éƒ¨å¤§ä½œä¸­ç›¸é‡ã€‚ğŸ˜‰