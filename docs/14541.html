<html>
<head>
<title>Storage | Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å‚¨ç‰©| Kubernetes</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/storage-kubernetes-92eb3d027282?source=collection_archive---------1-----------------------#2022-09-08">https://medium.com/geekculture/storage-kubernetes-92eb3d027282?source=collection_archive---------1-----------------------#2022-09-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="855d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ·±å…¥äº†è§£Kuberneteså‚¨ç‰©ä»¶</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/03c17b1f712cee6e1734f41666edb022.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GSqS3nVQBwoDjHAyujph4w.png"/></div></div></figure><h2 id="d468" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">å·</h2><p id="27ee" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">Kuberneteså·æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­åŒ…å«å¯ç”±Podä¸­çš„å®¹å™¨è®¿é—®çš„æ•°æ®ã€‚å·æä¾›äº†ä¸€ç§æ’ä»¶æœºåˆ¶ï¼Œå°†ä¸´æ—¶å®¹å™¨ä¸å…¶ä»–åœ°æ–¹çš„æŒä¹…æ•°æ®å­˜å‚¨è¿æ¥èµ·æ¥ã€‚</p><p id="1c1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨å°†äº†è§£åˆ°:</p><blockquote class="kp kq kr"><p id="a4cd" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated"><strong class="ih hj"> â— </strong> <a class="ae kw" href="#c842" rel="noopener ugc nofollow"> <strong class="ih hj">å·ç±»å‹</strong></a><strong class="ih hj"><br/>â—</strong><a class="ae kw" href="#7456" rel="noopener ugc nofollow"><strong class="ih hj">æŒä¹…å·</strong></a><strong class="ih hj"><br/>â—</strong><a class="ae kw" href="#d3b6" rel="noopener ugc nofollow"><strong class="ih hj">æŒä¹…å·ç´¢èµ”</strong></a><strong class="ih hj"><br/>â—</strong><strong class="ih hj">å·çš„åŠ¨æ€é¢„é…ç½®</strong> </p></blockquote><h2 id="c842" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">å·çš„ç±»å‹â€”</h2><h2 id="252a" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated"><strong class="ak">ä¸»æœºè·¯å¾„å·:</strong></h2><p id="fa88" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">æŒ‚è½½ä¸€ä¸ªç›®å½•<code class="du kx ky kz la b"><strong class="ih hj">/var/local/data</strong></code>ä½œä¸ºä»<em class="ks">ä¸»æœº</em>åˆ°ä¸€ä¸ªpodçš„<strong class="ih hj"> <em class="ks"> nginx </em> </strong>å®¹å™¨çš„<code class="du kx ky kz la b"><strong class="ih hj">/usr/share/nginx/html</strong></code>ä½ç½®çš„å·ã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lb"><img src="../Images/2884950c968b540c739b3502db1b3267.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*sWc3tpFGXSwKpInULjPyGA.jpeg"/></div><figcaption class="lc ld et er es le lf bd b be z dx">hostPath Volume</figcaption></figure><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="db5e" class="jp jq hi la b fi lk ll l lm ln"><strong class="la hj">#pod definition file with a volume </strong></span><span id="dd67" class="jp jq hi la b fi lo ll l lm ln">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: webserver<br/>spec:<br/>  containers:<br/>  - image: nginx:latest<br/>    name: nginx-container<br/><strong class="la hj">    volumeMounts:<br/>    - mountPath: /usr/share/nginx/html<br/>      name: test-vol</strong></span><span id="f367" class="jp jq hi la b fi lo ll l lm ln"><strong class="la hj">  volumes:<br/>  - name: test-vol<br/>    hostPath:<br/>      path: /var/local/data<br/>      type: DirectoryOrCreate</strong></span></pre><p id="8ebf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">nginx-container</strong></code> <strong class="ih hj"> </strong>åœ¨<code class="du kx ky kz la b"><strong class="ih hj">/usr/share/nginx/html</strong></code> <strong class="ih hj"> </strong>ä½ç½®å†™å…¥çš„ä»»ä½•æ•°æ®éƒ½å°†æŒä¹…ä¿å­˜åœ¨<em class="ks">ä¸»æœº</em>çš„<code class="du kx ky kz la b"><strong class="ih hj">/var/local/data</strong></code>ä½ç½®ã€‚å¦‚æœpodç»ˆæ­¢ï¼Œæ•°æ®å°†åœ¨<code class="du kx ky kz la b"><strong class="ih hj">/var/local/data</strong></code>ä½ç½®ä¿æŒå®‰å…¨ã€‚</p><p id="ff79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¹‹å‰ï¼Œæ¥è‡ª<em class="ks">ä¸»æœº</em>çš„ä¸€ä¸ªç›®å½•è¢«ç”¨ä½œå·ã€‚å®ƒè¢«ç§°ä¸º<code class="du kx ky kz la b"><strong class="ih hj">hostPath</strong></code>ä½“ç§¯ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªé‡è¦çš„äº‹å®éœ€è¦è®°ä½ï¼Œ<code class="du kx ky kz la b"><strong class="ih hj">hostPath</strong></code>é‡äº§çº§åº”ç”¨ä¸å»ºè®®ä½¿ç”¨volumeã€‚</p><p id="791e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">hostPath</strong></code>å·ä»…åœ¨å•èŠ‚ç‚¹é›†ç¾¤ä¸­è¿è¡Œè‰¯å¥½ã€‚ä½†ä¸åœ¨å¤šèŠ‚ç‚¹ç¾¤é›†ä¸­ã€‚å› ä¸º<em class="ks">éƒ¨ç½²/å¤åˆ¶é›†</em>ä¸‹çš„å•å…ƒå°†ä½¿ç”¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„<code class="du kx ky kz la b"><strong class="ih hj">/var/local/data</strong></code>ç›®å½•ï¼Œå¹¶æœŸæœ›æ‰€æœ‰èŠ‚ç‚¹åŒ…å«ç›¸åŒçš„æ•°æ®ã€‚ä½†è¿™æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸åŒçš„èŠ‚ç‚¹ã€‚</p><p id="0121" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆæ˜¯ä¸ºKubernetesé›†ç¾¤ä½¿ç”¨ä¸€ä¸ªå…±äº«å­˜å‚¨ç³»ç»Ÿã€‚å¦‚NFSå’ŒAWS EFSã€‚</p><p id="fa35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Kubernetesè¿˜æ”¯æŒå¤šç§ç±»å‹çš„æ ‡å‡†å­˜å‚¨è§£å†³æ–¹æ¡ˆï¼Œå¦‚NFSã€glusterFSæˆ–å…¬å…±äº‘è§£å†³æ–¹æ¡ˆï¼Œå¦‚AWS EBSã€AWS EFSã€Azure Diskæˆ–fileã€Googleçš„æŒä¹…ç£ç›˜ç­‰ç­‰ã€‚</p><h2 id="3a4f" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated"><strong class="ak"> NFSåˆ†äº«ä¸ºä¸€å·</strong></h2><p id="a137" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">ä½¿ç”¨<strong class="ih hj"> NFSå…±äº«</strong> <em class="ks"> </em>ç›®å½•åˆ›å»ºä¸€ä¸ªå·ï¼Œå¹¶å°†å…¶é™„åŠ åˆ°ä¸€ä¸ªpodã€‚ä½¿ç”¨NFSï¼Œæ•°æ®å¯ä»¥åœ¨podä¹‹é—´å…±äº«ï¼Œå°½ç®¡å®ƒä»¬åœ¨ä¸åŒçš„å·¥ä½œèŠ‚ç‚¹æˆ–å¯ç”¨æ€§åŒºåŸŸä¸­è¿è¡Œã€‚</p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="195e" class="jp jq hi la b fi lk ll l lm ln"><strong class="la hj">#Pod definiton with nfs share directory</strong></span><span id="3a8b" class="jp jq hi la b fi lo ll l lm ln">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: webserver<br/>spec:<br/>  containers:<br/>  - image: nginx:latest<br/>    name: nginx-container<br/>    volumeMounts:<br/>    - mountPath: /usr/share/nginx/html<br/>      name: test-vol<br/><strong class="la hj">  volumes:<br/>  - name: test-vol<br/>    nfs:<br/>      server: 10.3.97.250          </strong> # nfs server ip or dns<strong class="la hj"><br/>      path: /var/local/nfs-share   </strong> # nfs share directory</span></pre><h2 id="e846" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated"><strong class="ak"> AWS EBSå·</strong></h2><p id="9a0b" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">ä½¿ç”¨AWS-CLIåˆ›å»ºä¸€ä¸ªå·ï¼Œå¹¶è®°ä¸‹â€œ<strong class="ih hj">VolumeIdâ€</strong>ä»¥å°†è¯¥å·è¿æ¥åˆ°podã€‚</p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="e522" class="jp jq hi la b fi lk ll l lm ln">aws ec2 create-volume \<br/> <strong class="la hj"> --availability-zone</strong> ap-northeast-1d \<br/>  <strong class="la hj">--size</strong> 10 \<br/>  <strong class="la hj">--volume-type</strong> gp2 \<br/> <strong class="la hj"> --query "VolumeId"</strong> --output text</span></pre><blockquote class="kp kq kr"><p id="0278" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">æ³¨æ„:</em> </strong>ç”±äºEBSå·åªé”å®šåˆ°ç‰¹å®šçš„AZã€‚å› æ­¤ï¼ŒEBSå·å’Œå°†è¿è¡Œpodçš„å·¥ä½œèŠ‚ç‚¹åº”è¯¥åœ¨åŒä¸€ä¸ªAZä¸­ã€‚</p></blockquote><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="0bf2" class="jp jq hi la b fi lk ll l lm ln"><strong class="la hj">#Pod definition with node affinity </strong></span><span id="d017" class="jp jq hi la b fi lo ll l lm ln">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: webserver<br/>spec:<br/><strong class="la hj">  affinity:<br/>    nodeAffinity:</strong><br/>      requiredDuringSchedulingIgnoredDuringExecution:<br/>        nodeSelectorTerms:<br/>        - matchExpressions:<br/>          - key: topology.kubernetes.io/zone<br/>            operator: In<br/>            values:<br/>            <strong class="la hj">- ap-northeast-1d</strong><br/>  containers:<br/>  - image: nginx:latest<br/>    name: nginx-container<br/>    volumeMounts:<br/>    - mountPath: /usr/share/nginx/html<br/>      name: test-volume<br/><strong class="la hj">  volumes:<br/>  - name: test-volume<br/>    awsElasticBlockStore: </strong> # This AWS EBS Volume must already exist<strong class="la hj"> <br/>      volumeID: "vol-0b067ed35227a1bff"  </strong># Volume-id<strong class="la hj"><br/>      fsType: ext4</strong></span></pre><p id="3c67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç”±äºEBSå·æ˜¯åœ¨"<strong class="ih hj"> ap-northeast-1d" </strong> AZä¸­åˆ›å»ºçš„ï¼Œå› æ­¤ä¸ºäº†å°†è¯¥å·é™„åŠ åˆ°ä¸€ä¸ªpodï¼Œè¯¥podåº”è¯¥åœ¨åŒä¸€ä¸ªAZä¸Šã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½¿ç”¨èŠ‚ç‚¹å…³è”æ€§åœ¨ä¸EBSå·ä½äºåŒä¸€AZçš„èŠ‚ç‚¹ä¸Šéƒ¨ç½²podã€‚</p><h2 id="71f4" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">é…ç½®æ˜ å°„ä¸ºå·</h2><p id="cb51" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">ç°æœ‰çš„é…ç½®å›¾å¯ä»¥ä½œä¸ºå·æ³¨å…¥åˆ°podä¸­ã€‚</p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="ff22" class="jp jq hi la b fi lk ll l lm ln"><strong class="la hj"><em class="ks">#Pod-definition with configmap mounted as a volume into the pod</em></strong></span><span id="4c8f" class="jp jq hi la b fi lo ll l lm ln">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: web-server<br/>spec:<br/>  containers:<br/>  - name: wordpress<br/>    image: wordpress<br/><strong class="la hj">    volumeMounts:<br/>    - name: config-volume<br/>      mountPath: /etc/config  </strong><em class="ks">#Directory where files will be mounted</em><strong class="la hj"><br/>  volumes:<br/>    - name: config-volume<br/>      configMap:<br/>        name: user-config</strong></span></pre><h2 id="7c29" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated"><strong class="ak"> <em class="lp">ç§˜ä½œå·</em> </strong></h2><p id="76ae" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">ç°æœ‰çš„ç§˜å¯†å¯ä»¥ä½œä¸ºä¸€ä¸ªå·æ³¨å…¥åˆ°åŠèˆ±ä¸­ã€‚</p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="9f85" class="jp jq hi la b fi lk ll l lm ln"><strong class="la hj"><em class="ks">#Pod-definition with secret mounted as a volume into the pod</em></strong></span><span id="1b18" class="jp jq hi la b fi lo ll l lm ln">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: frontend<br/>spec:<br/>  containers:<br/>    - name: wordpress<br/>      image: wordpress<br/>      volumeMounts:<br/>      - name: secret-vol01<br/>        mountPath: /etc/secret    #files - mounted in this location<br/>        readOnly: true<br/> <strong class="la hj"> volumes:<br/>    - name: secret-vol01<br/>      secret:<br/>        secretName: app-secret</strong></span></pre><p id="874f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ›´å¤šå…³äºk8s <a class="ae kw" href="https://kubernetes.io/docs/concepts/storage/volumes/" rel="noopener ugc nofollow" target="_blank">å·<strong class="ih hj">å·</strong>å·</a></p><h2 id="7456" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">æ°¸ä¹…å·</h2><p id="54c9" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">æŒä¹…å·æ˜¯ç®¡ç†å‘˜åœ¨é›†ç¾¤ä¸­æä¾›çš„ä¸€å—å­˜å‚¨åŒºã€‚å®ƒæ˜¯é›†ç¾¤ä¸­çš„èµ„æºï¼Œå°±åƒèŠ‚ç‚¹æ˜¯é›†ç¾¤ä¸€æ ·ã€‚æ°¸ä¹…å·æ˜¯ä¸€ç§å·æ’ä»¶ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸç‹¬ç«‹äºä½¿ç”¨æ°¸ä¹…å·çš„ä»»ä½•å•ç‹¬podã€‚</p><h2 id="d3b6" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">æŒç»­é‡å£°æ˜(PVC)</h2><p id="aba8" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">PersistentVolumeClaim (PVC)æ˜¯ç”¨æˆ·å¯¹å­˜å‚¨çš„è¯·æ±‚ã€‚å®ƒç±»ä¼¼äºä¸€ä¸ªè±†èšã€‚Podsæ¶ˆè€—èŠ‚ç‚¹èµ„æºï¼ŒPVæ¶ˆè€—PVèµ„æºã€‚ç®€è€Œè¨€ä¹‹ï¼ŒPVæ˜¯ç”±PVCå£°æ˜çš„ï¼ŒPVå’ŒPVCä¹‹é—´æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ã€‚é€šè¿‡æŒ‡å®šæ°¸ä¹…å·æ‰€éœ€çš„æœ€å°å¤§å°å’Œè®¿é—®æ¨¡å¼æ¥é…ç½®PVCã€‚</p><p id="9b9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚æœä¸å­˜åœ¨åŒ¹é…çš„å·ï¼ŒPVCå°†æ— é™æœŸä¿æŒæœªç»‘å®šçŠ¶æ€ã€‚åªè¦æœ‰åŒ¹é…çš„PVå¯ç”¨ï¼Œå°±ä¼šç»‘å®šç´¢èµ”ã€‚</p><p id="75e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">åˆ›å»ºä¸€ä¸ªæŒä¹…å·(PV) </strong></p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="bf70" class="jp jq hi la b fi lk ll l lm ln"><strong class="la hj"><br/>&gt; </strong>kubectl create -f &lt;pv-manifest-file&gt;.yaml</span><span id="f8ca" class="jp jq hi la b fi lo ll l lm ln">---</span><span id="5154" class="jp jq hi la b fi lo ll l lm ln"><strong class="la hj">#PV using host directory</strong></span><span id="6cd1" class="jp jq hi la b fi lo ll l lm ln">apiVersion: v1<br/><strong class="la hj">kind: PersistentVolume</strong><br/>metadata:<br/>  name: pv-volume01<br/>  labels: <br/>    storage-tier: standard<br/>spec:<br/>  <strong class="la hj">capacity</strong>:<br/>    storage: 50Mi<br/>  <strong class="la hj">accessModes</strong>:<br/>    - ReadWriteMany<br/>  <strong class="la hj">persistentVolumeReclaimPolicy:</strong> Retain <br/>  <strong class="la hj">hostPath:</strong><br/>      path: /var/local/data</span><span id="26c8" class="jp jq hi la b fi lo ll l lm ln">---</span><span id="060e" class="jp jq hi la b fi lo ll l lm ln"><strong class="la hj">#PV using NFS-Share directory</strong></span><span id="ed13" class="jp jq hi la b fi lo ll l lm ln">apiVersion: v1<br/>kind: PersistentVolume<br/>metadata:<br/>  name: pv-nfs<strong class="la hj"><br/></strong>spec:<br/>  capacity:<br/>    storage: 20Gi<br/>  accessModes:<br/>    - ReadWriteOnce<br/><strong class="la hj">  nfs:<br/>    path: /var/nfs_server/kubernetes_data<br/>    server: 10.25.96.6     </strong>#IP or DNS of nfs server</span></pre><p id="f08a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">Capacity</strong></code> <strong class="ih hj"> â€” </strong> PVä¼šæœ‰ä¸€ä¸ªç‰¹å®šçš„å­˜å‚¨å®¹é‡ã€‚è¿™æ˜¯ä½¿ç”¨PVçš„<em class="ks">å®¹é‡</em>å±æ€§è®¾ç½®çš„ã€‚</p><p id="ac63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">accessModes</strong></code><strong class="ih hj">â€”â€”</strong></p><blockquote class="kp kq kr"><p id="0ea6" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated"><strong class="ih hj"> ReadWriteOnce </strong> â€”å·å¯ä»¥é€šè¿‡å•ä¸ªèŠ‚ç‚¹ä»¥è¯»å†™æ–¹å¼è£…è½½ã€‚<strong class="ih hj">read write only</strong>â€”<strong class="ih hj"/>å·å¯ä»¥ç”±è®¸å¤šèŠ‚ç‚¹ä»¥åªè¯»æ–¹å¼è£…è½½ã€‚<br/> <strong class="ih hj">è¯»å†™å¤š</strong> â€”å·å¯ä»¥ç”±è®¸å¤šèŠ‚ç‚¹ä»¥è¯»å†™æ–¹å¼è£…è½½ã€‚<br/><strong class="ih hj">ReadWriteOncePod</strong>â€”<strong class="ih hj"/>å·å¯ä»¥é€šè¿‡å•ä¸ªPodä»¥è¯»å†™æ–¹å¼æŒ‚è½½ã€‚</p></blockquote><p id="14a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">persistentVolumeReclaimPolicy</strong></code><strong class="ih hj">â€”â€”</strong></p><blockquote class="kp kq kr"><p id="1c5b" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated"><strong class="ih hj">ä¿ç•™</strong> â€”å…³è”podç»ˆæ­¢åï¼Œå·å°†è¢«ä¿ç•™ã€‚<br/> <strong class="ih hj">åˆ é™¤</strong> â€”å…³è”podç»ˆæ­¢åï¼Œå·å°†è¢«åˆ é™¤ã€‚<br/> <strong class="ih hj">å›æ”¶</strong> â€”å·å°†è¢«å›æ”¶ä»¥å¤‡å°†æ¥ä½¿ç”¨ã€‚</p></blockquote><p id="ada9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç›®å‰ï¼Œåªæœ‰NFSå’Œä¸»æœºè·¯å¾„æ”¯æŒå›æ”¶ã€‚AWS EBSã€GCE PDã€Azure Diskå’ŒCinderå·æ”¯æŒåˆ é™¤ã€‚</p><p id="15d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">Volume Type</strong></code> â€” <br/>å¯¹å·ç±»å‹æœ‰å·¨å¤§çš„æ”¯æŒï¼Œæ¯”å¦‚<code class="du kx ky kz la b"><strong class="ih hj">hostPath</strong></code><strong class="ih hj"/><code class="du kx ky kz la b"><strong class="ih hj">nfs</strong></code><strong class="ih hj"/><code class="du kx ky kz la b"><strong class="ih hj">aws ebs</strong></code><strong class="ih hj"/><code class="du kx ky kz la b"><strong class="ih hj">azureDisk</strong></code><strong class="ih hj"/>ç­‰ç­‰ã€‚<a class="ae kw" href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/#types-of-persistent-volumes" rel="noopener ugc nofollow" target="_blank">å…³äºå·ç±»å‹çš„æ›´å¤šä¿¡æ¯</a></p><h2 id="ed1f" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated"><strong class="ak"> <em class="lp">åˆ›å»ºä¸€ä¸ªæŒä¹…çš„å·ç´¢èµ”(PVC) </em> </strong></h2><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="055b" class="jp jq hi la b fi lk ll l lm ln">---</span><span id="3273" class="jp jq hi la b fi lo ll l lm ln"><strong class="la hj"><em class="ks">#PVC without selector</em></strong></span><span id="5516" class="jp jq hi la b fi lo ll l lm ln">apiVersion: v1<br/><strong class="la hj">kind: PersistentVolumeClaim</strong><br/>metadata:<br/>  name: myclaim<br/>spec:<br/>  <strong class="la hj">accessModes</strong>:<br/>    - ReadWriteMany<br/>  <strong class="la hj">resources</strong>:<br/>    requests:<br/>      storage: 50Mi</span><span id="9271" class="jp jq hi la b fi lo ll l lm ln">---</span><span id="6b88" class="jp jq hi la b fi lo ll l lm ln"><strong class="la hj"><em class="ks">#PVC with selector</em></strong></span><span id="9621" class="jp jq hi la b fi lo ll l lm ln">apiVersion: v1<br/>kind: PersistentVolumeClaim<br/>metadata:<br/>  name: myclaim<br/>spec:<br/> <strong class="la hj"> accessModes:</strong><br/>    - ReadWriteMany<br/>  <strong class="la hj">resources:</strong><br/>    requests:<br/>      storage: 70Mi<br/> <strong class="la hj"> selector:</strong><br/>   <strong class="la hj"> matchLabels:</strong><br/>      storage-tier: standard</span></pre><p id="3e38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">accessModes</strong></code> <strong class="ih hj"> â€” </strong> <a class="ae kw" href="#f08a" rel="noopener ugc nofollow">åŒPVã€‚</a></p><p id="abf5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">resources</strong></code> <strong class="ih hj"> â€” </strong>åœ¨è¿™ä¸ªå­—æ®µä¸­ï¼Œpod <strong class="ih hj"> </strong>å¯ä»¥è¯·æ±‚ç‰¹å®šæ•°é‡çš„å­˜å‚¨èµ„æºã€‚</p><p id="6c55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">selector</strong></code> <strong class="ih hj"> â€” </strong>å¸¦æœ‰<code class="du kx ky kz la b"><strong class="ih hj">selector</strong></code>çš„ç´¢èµ”è¯•å›¾åŒ¹é…ç°æœ‰çš„ã€æ— äººè®¤é¢†çš„å’Œå¯ç”¨çš„PVã€‚å¸¦<code class="du kx ky kz la b"><strong class="ih hj">selector</strong></code>çš„PVCæ€»æ˜¯å£°ç§°æœ‰<code class="du kx ky kz la b"><strong class="ih hj">matchLabels</strong></code> <strong class="ih hj"> </strong>å’Œ<code class="du kx ky kz la b"><strong class="ih hj">accessModes</strong></code>ç²¾ç¡®åŒ¹é…çš„PVã€‚</p><h2 id="bb7f" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">æœ‰çº¦æŸåŠ›çš„</h2><p id="2dd4" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">ç”¨æˆ·åˆ›å»ºä¸€ä¸ªPersistentVolumeClaimï¼Œå…¶ä¸­åŒ…å«è¯·æ±‚çš„ç‰¹å®šå­˜å‚¨é‡å’ŒæŸäº›è®¿é—®æ¨¡å¼ã€‚ä¸»èŠ‚ç‚¹ä¸­çš„æ§åˆ¶å¾ªç¯æ€»æ˜¯ç›‘è§†æ–°çš„PVï¼Œæ‰¾åˆ°åŒ¹é…çš„PV(å¦‚æœå¯èƒ½)ï¼Œå¹¶å°†å®ƒä»¬ç»‘å®šåœ¨ä¸€èµ·ã€‚</p><p id="9054" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">ç»‘å®šæ ‡å‡†:</strong></p><p id="8925" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">â—<code class="du kx ky kz la b"><strong class="ih hj">accessMode</strong></code>PVå’ŒPVCä¹‹é—´å¿…é¡»åŒ¹é…ã€‚</p><p id="735f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">PVCè¯·æ±‚çš„<code class="du kx ky kz la b"><strong class="ih hj">storage</strong></code>å¿…é¡»ç­‰äºæˆ–å°äºPVçš„<code class="du kx ky kz la b"><strong class="ih hj">storage</strong></code>å®¹é‡ã€‚å¹³ç­‰çš„åŒ¹é…å°†æ€»æ˜¯è·å¾—ä¼˜å…ˆæƒã€‚ä½†æ˜¯å¦‚æœæ²¡æœ‰å®Œå…¨åŒ¹é…ï¼Œé‚£ä¹ˆPVCå°†è¦æ±‚PVå…·æœ‰æ¯”PVCæ‰€è¦æ±‚çš„æ›´å¤§çš„å­˜å‚¨å®¹é‡ã€‚</p><blockquote class="kp kq kr"><p id="3da8" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated"><em class="hi"> 50Gi PVå°†åŒ¹é…è¯·æ±‚50Giçš„PVC<br/>50Gi PVå°†åŒ¹é…è¯·æ±‚40Giçš„PVC(å¦‚æœä¸å­˜åœ¨ç²¾ç¡®åŒ¹é…)<br/> 50Gi PVå°†</em> <strong class="ih hj"> <em class="hi">è€Œé</em> </strong> <em class="hi">åŒ¹é…è¯·æ±‚100Giçš„PVC</em></p></blockquote><p id="094a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">â—å¸¦æœ‰<code class="du kx ky kz la b"><strong class="ih hj">selector</strong></code>çš„PVCæ€»æ˜¯å£°ç§°ä¸<code class="du kx ky kz la b"><strong class="ih hj">labels</strong></code>å’Œ<code class="du kx ky kz la b"><strong class="ih hj">accessModes</strong></code>åŒ¹é…çš„PVå’Œå­˜å‚¨å®¹é‡åŒ¹é…æ ‡å‡†ä¿æŒä¸å˜ã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lq"><img src="../Images/402582d484045a680448f4aac14a0710.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*SD8vXj5Tf9BmdMOTiHxzCw.png"/></div><figcaption class="lc ld et er es le lf bd b be z dx">PV binding with PVC- Image-1</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lr"><img src="../Images/c6d7629bc39d892edf27561da6805602.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*TErI6e8JGG-fxR-6B3V82w.png"/></div><figcaption class="lc ld et er es le lf bd b be z dx">PV binding with PVC- Image-2</figcaption></figure><h2 id="acc9" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">ç”¨äºPVå’ŒPVCçš„å‘½ä»¤:</h2><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="48d4" class="jp jq hi la b fi lk ll l lm ln"><strong class="la hj"># For creating PV and PVC</strong></span><span id="b9bf" class="jp jq hi la b fi lo ll l lm ln"><strong class="la hj">host~$ </strong> kubectl create -f &lt;file-name&gt;.yaml<br/><strong class="la hj">host~$ </strong> kubectl create -f pv.yaml<br/><strong class="la hj">host~$ </strong> kubectl create -f pvc.yaml<br/></span><span id="2d4e" class="jp jq hi la b fi lo ll l lm ln"><strong class="la hj"># For listing PV and PVC</strong></span><span id="e7d5" class="jp jq hi la b fi lo ll l lm ln"><strong class="la hj">host~$ </strong> kubectl get pv<br/><strong class="la hj">host~$ </strong> kubectl get pvc<br/></span><span id="509d" class="jp jq hi la b fi lo ll l lm ln"><strong class="la hj"># For viewing details of PV and PVC</strong></span><span id="dfd1" class="jp jq hi la b fi lo ll l lm ln"><strong class="la hj">host~$ </strong> kubectl describe pv &lt;pv-name&gt;<br/><strong class="la hj">host~$ </strong> kubectl describe pvc &lt;pvc-name&gt;<br/></span><span id="207b" class="jp jq hi la b fi lo ll l lm ln"><strong class="la hj"># For deleting PV and PVC (PVC should be deleted first)</strong></span><span id="d6b9" class="jp jq hi la b fi lo ll l lm ln"><strong class="la hj">host~$ </strong> kubectl delete pvc &lt;pvc-name&gt;<br/><strong class="la hj">host~$ </strong> kubectl delete pv &lt;pv-name&gt;<br/></span></pre><h2 id="b723" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">é˜¶æ®µ</h2><p id="3193" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">PVå°†å¤„äºä»¥ä¸‹é˜¶æ®µä¹‹ä¸€:</p><blockquote class="kp kq kr"><p id="5933" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated"><strong class="ih hj">å¯ç”¨</strong> â€”å°šæœªç»‘å®šåˆ°å£°æ˜çš„è‡ªç”±èµ„æºã€‚<br/> <strong class="ih hj">è£…è®¢</strong> â€”è¯¥å·è£…è®¢æˆå†Œã€‚<br/> <strong class="ih hj">å‘å¸ƒ</strong> â€”ç´¢èµ”å·²åˆ é™¤ï¼Œä½†èµ„æºå°šæœªå›æ”¶ã€‚<br/> <strong class="ih hj">å¤±è´¥</strong> â€”å·çš„è‡ªåŠ¨å›æ”¶å¤±è´¥ã€‚</p></blockquote><h2 id="925a" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated"><strong class="ak">ä½¿ç”¨PVCä½œä¸ºå·</strong></h2><p id="7b87" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">podå¯ä»¥é€šè¿‡å°†å£°æ˜ç”¨ä½œå·æ¥è®¿é—®å­˜å‚¨ã€‚å£°æ˜å¿…é¡»ä¸ä½¿ç”¨å£°æ˜çš„Podä½äºåŒä¸€å‘½åç©ºé—´ä¸­ã€‚é›†ç¾¤åœ¨Podçš„åç§°ç©ºé—´ä¸­æ‰¾åˆ°å£°æ˜ï¼Œæœç´¢åˆé€‚çš„åŒ¹é…é¡¹å¹¶ç»‘å®šå®ƒä»¬ã€‚</p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="f566" class="jp jq hi la b fi lk ll l lm ln"><strong class="la hj"><em class="ks">#Usage of PVC as a Volumes</em></strong></span><span id="5532" class="jp jq hi la b fi lo ll l lm ln">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: web-server<br/>spec:<br/>  containers:<br/>    - name: nginx-webserver<br/>      image: nginx<br/>      volumeMounts:<br/>       - name: webserver-vol01<br/>         mountPath: "/usr/share/nginx/html"<br/>  volumes:<br/>    - name: webserver-vol01<br/>      <strong class="la hj">persistentVolumeClaim:</strong><br/><strong class="la hj">        claimName: myclaim</strong></span></pre><p id="4aa9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">æ¦‚è¿°â€” PVã€PVCå’ŒPVCä½œä¸ºä¸€ä¸ªå·</strong></p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="505a" class="jp jq hi la b fi lk ll l lm ln">apiVersion: v1<br/>kind: PersistentVolume<br/>metadata:<br/>  name: pv-volume01<br/>spec:<br/><strong class="la hj">  capacity:<br/>    storage: 50Mi<br/>  accessModes:<br/>    - ReadWriteMany</strong><br/>  persistentVolumeReclaimPolicy: Retain<br/>  hostPath:<br/>      path: /var/local/data</span><span id="7ffc" class="jp jq hi la b fi lo ll l lm ln">---<br/> <br/>apiVersion: v1<br/>kind: PersistentVolumeClaim<br/>metadata:<br/><strong class="la hj">  name: myclaim</strong><br/>spec:<br/><strong class="la hj">  accessModes:<br/>    - ReadWriteMany<br/>  resources:<br/>    requests:<br/>      storage: 50Mi</strong></span><span id="bd08" class="jp jq hi la b fi lo ll l lm ln">---</span><span id="fdf5" class="jp jq hi la b fi lo ll l lm ln">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: web-server<br/>spec:<br/>  containers:<br/>    - name: nginx-webserver<br/>      image: nginx<br/>      volumeMounts:<br/>       - name: webserver-vol01<br/>         mountPath: "/usr/share/nginx/html"<br/>  volumes:<br/>    - name: webserver-vol01<br/><strong class="la hj">      persistentVolumeClaim:<br/>        claimName: myclaim</strong></span></pre></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><h2 id="eb82" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated"><strong class="ak">åŠ¨æ€é¢„é…ç½®</strong></h2><p id="45fb" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">ç›´åˆ°ç°åœ¨ï¼ŒPVéƒ½æ˜¯æˆ‘ä»¬è‡ªå·±ä»ç°æœ‰çš„å­˜å‚¨ä¸­åˆ›é€ å‡ºæ¥çš„ã€‚è¿™å°±æ˜¯æ‰€è°“çš„é™æ€ä¾›åº”ã€‚ä½†æ˜¯æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬ä½¿ç”¨AWS-EBSä½œä¸ºå­˜å‚¨è§£å†³æ–¹æ¡ˆçš„ç”Ÿäº§ç¯å¢ƒã€‚æ¯å½“ä¸€ä¸ªpodéœ€è¦å­˜å‚¨æ—¶ï¼Œæˆ‘ä»¬éƒ½éœ€è¦åœ¨AWSä¸Šæ‰‹åŠ¨æä¾›EBSå·ï¼Œç„¶åä½¿ç”¨è¯¥EBSå·é…ç½®ä¸€ä¸ªPVã€‚</p><p id="de69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚æœåœ¨podéœ€è¦æ—¶è‡ªåŠ¨é…ç½®å·ä¼šæ›´æ–¹ä¾¿ï¼Œè¿™å°±æ˜¯<strong class="ih hj">å­˜å‚¨ç±»</strong>è¿›å…¥æ˜ åƒçš„åŸå› ã€‚ä½¿ç”¨<strong class="ih hj">å­˜å‚¨ç±»</strong>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨AWSä¸ŠåŠ¨æ€é…ç½®EBSå·ï¼Œå¹¶åœ¨æå‡ºç´¢èµ”æ—¶å°†å…¶é™„åŠ åˆ°podã€‚</p><h2 id="2caa" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated"><strong class="ak">å­˜å‚¨ç±»</strong></h2><p id="6d02" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">Kuberneteså­˜å‚¨ç±»æ˜¯ä¸€ç§Kuberneteså­˜å‚¨æœºåˆ¶ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨Kubernetesé›†ç¾¤ä¸­åŠ¨æ€åœ°æä¾›æŒä¹…æ€§å·(PV)ã€‚ä½¿ç”¨å­˜å‚¨ç±»ï¼Œpodå¯ä»¥æ ¹æ®éœ€æ±‚åŠ¨æ€è¯·æ±‚ç‰¹å®šç±»å‹çš„å­˜å‚¨ã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lz"><img src="../Images/c47b126642deeffc9bd7de51dc23f229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bBu97RZLzQ4KtQFHWa9ZWQ.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx">Dynamic Provisioning</figcaption></figure><p id="39d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ¯ä¸ªStorageClasséƒ½åŒ…å«å­—æ®µ<code class="du kx ky kz la b">provisioner</code>ã€<code class="du kx ky kz la b">parameters</code>å’Œ<code class="du kx ky kz la b">reclaimPolicy</code>ï¼Œå½“å±äºè¯¥ç±»çš„æŒä¹…å·éœ€è¦åŠ¨æ€é…ç½®æ—¶ä¼šç”¨åˆ°è¿™äº›å­—æ®µã€‚</p><p id="db2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">AWS EBSå·çš„å­˜å‚¨ç±»åˆ«(ä½¿ç”¨å†…éƒ¨èµ„æºè°ƒé…å™¨)â€”â€”</strong></p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="7e66" class="jp jq hi la b fi lk ll l lm ln">apiVersion: storage.k8s.io/v1<br/><strong class="la hj">kind: StorageClass</strong><br/>metadata:<br/>  name: gp2-standard<br/><strong class="la hj">provisioner: kubernetes.io/aws-ebs </strong>  # Internal-provisioner<br/><strong class="la hj">parameters</strong>:<br/>  type: gp2<br/><strong class="la hj">reclaimPolicy</strong>: Retain<br/><strong class="la hj">volumeBindingMode</strong>: Immediate</span></pre><p id="7f34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">provisioner:</strong></code>storage classå¯¹è±¡åŒ…å«ä¸€ä¸ª<code class="du kx ky kz la b"><strong class="ih hj">provisioner</strong></code>ï¼Œå®ƒå†³å®šå“ªä¸ªå·æ’ä»¶å°†ç”¨äºæä¾›PVã€‚Kubernetesæä¾›<strong class="ih hj"> <em class="ks">å†…éƒ¨</em> </strong>å’Œ<strong class="ih hj"> <em class="ks">å¤–éƒ¨</em> </strong> provisionersã€‚<em class="ks">å†…éƒ¨</em>ç½®å¤‡ç¨‹åºä¹Ÿç§°ä¸º<em class="ks">â€œIn-treeâ€</em>å·æ’ä»¶ï¼Œè¿™æ„å‘³ç€å®ƒä»¬çš„ä»£ç æ˜¯æ ¸å¿ƒKubernetesä»£ç çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ ¸å¿ƒKubernetesäºŒè¿›åˆ¶æ–‡ä»¶ä¸€èµ·å¯¼å…¥ã€‚æˆ‘ä»¬è¿˜å¯ä»¥æŒ‡å®šå¹¶è¿è¡Œä¸€ä¸ª<em class="ks">å¤–éƒ¨</em> provisionerï¼Œå®ƒä¹Ÿè¢«å®šä¹‰ä¸ºå®¹å™¨å­˜å‚¨æ¥å£(CSI)ã€‚</p><p id="86db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">parameters:</strong></code>è¡¨ç¤ºåº•å±‚å­˜å‚¨ç³»ç»Ÿçš„å±æ€§ã€‚</p><p id="33ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">parameters:</strong></code>è¡¨ç¤ºåº•å±‚å­˜å‚¨ç³»ç»Ÿçš„å±æ€§ã€‚</p><p id="fd91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">reclaimPolicy:</strong></code> <strong class="ih hj"> </strong>å¯ä»¥æ˜¯<code class="du kx ky kz la b">Delete</code>ä¹Ÿå¯ä»¥æ˜¯<code class="du kx ky kz la b">Retain</code>ã€‚é»˜è®¤ä¸º<code class="du kx ky kz la b">Delete</code></p><p id="693f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><strong class="ih hj">volumeBindingMode:</strong></code> <strong class="ih hj"> </strong>å¯ä»¥æ˜¯<code class="du kx ky kz la b">Immediate</code>ä¹Ÿå¯ä»¥æ˜¯<code class="du kx ky kz la b">WaitForFirstConsumer</code></p><blockquote class="kp kq kr"><p id="de20" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated"><code class="du kx ky kz la b"><em class="hi">Immediate</em></code> <em class="hi"> â€”åˆ›å»ºPVCåç«‹å³é…ç½®PVã€‚<br/> </em> <code class="du kx ky kz la b"><em class="hi">WaitForFirstConsumer</em></code> <em class="hi"> â€”å°†å»¶è¿ŸPVçš„ä¾›åº”ï¼Œç›´åˆ°åˆ›å»ºäº†ä½¿ç”¨PVCçš„Podã€‚</em></p></blockquote><p id="bcd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">AWS EBSå·çš„å­˜å‚¨ç±»åˆ«(ä½¿ç”¨CSI)â€”â€”</strong></p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="5fea" class="jp jq hi la b fi lk ll l lm ln">apiVersion: storage.k8s.io/v1<br/>kind: StorageClass<br/>metadata:<br/>  name: ebs-sc<br/><strong class="la hj">provisioner: ebs.csi.aws.com  </strong>#EBS CSI as provisioner<br/>volumeBindingMode: WaitForFirstConsumer</span></pre><p id="ff26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å…³äº<a class="ae kw" href="https://kubernetes.io/docs/concepts/storage/storage-classes/" rel="noopener ugc nofollow" target="_blank">å­˜å‚¨ç±»</a>çš„æ›´å¤šä¿¡æ¯</p><p id="a74e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å­˜å‚¨ç±»ä¸ä»…å¯ä»¥åŠ¨æ€è°ƒé…PVï¼Œè¿˜å…è®¸æˆ‘ä»¬ä½¿ç”¨åº•å±‚å­˜å‚¨ç³»ç»Ÿçš„ä¸åŒå‚æ•°åˆ›å»ºä¸åŒç±»å‹çš„å­˜å‚¨ç±»ã€‚ä¾‹å¦‚å¯¹äºAWS EBSï¼Œæœ‰å„ç§ç±»å‹çš„EBSå·(<code class="du kx ky kz la b">gp2</code>ã€<code class="du kx ky kz la b">gp3</code>ã€<code class="du kx ky kz la b">io1</code>ã€<code class="du kx ky kz la b">io2</code>ç­‰)ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥è¿›è¡Œå„ç§é…ç½®ï¼Œä¾‹å¦‚ï¼Œä¸ºEBSå·å¯ç”¨åŠ å¯†ã€æŒ‡å®šæœ€å°IOPSå’Œæœ€å°ååé‡ã€‚</p><p id="76e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">å…·æœ‰ä¸åŒå‚æ•°çš„å­˜å‚¨ç±»ç¤ºä¾‹â€” </strong></p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="1456" class="jp jq hi la b fi lk ll l lm ln">---</span><span id="89d4" class="jp jq hi la b fi lo ll l lm ln">apiVersion: storage.k8s.io/v1<br/>kind: StorageClass<br/>metadata:<br/><strong class="la hj">  name: gp2-standard</strong><br/>provisioner: <!-- -->ebs.csi.aws.com<br/>parameters:<br/><strong class="la hj">  type: gp2</strong><br/>volumeBindingMode: Immediate<br/>reclaimPolicy: Retain</span><span id="cdf3" class="jp jq hi la b fi lo ll l lm ln">---</span><span id="66b3" class="jp jq hi la b fi lo ll l lm ln">apiVersion: storage.k8s.io/v1<br/>kind: StorageClass<br/>metadata:<br/><strong class="la hj">  name: io2-encrypted</strong><br/>provisioner: ebs.csi.aws.com   <br/>parameters:<br/><strong class="la hj">  type: io2<br/>  </strong><strong class="la hj">iopsPerGB</strong>: <strong class="la hj">"3000"</strong><br/>  <strong class="la hj">encrypted: "true"<br/></strong>volumeBindingMode: WaitForFirstConsumer<br/>reclaimPolicy: Delete</span></pre><p id="d7ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†æµ‹è¯•EBSå·çš„åŠ¨æ€èµ„æºè°ƒé…ã€‚éµå¾ªä»¥ä¸‹æ­¥éª¤â€”</p><p id="1f1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç”¨ä¸‹é¢çš„<a class="ae kw" href="https://raw.githubusercontent.com/shamimice03/AWS_EKS-EBS_CSI/main/Demo-storageClass.yaml" rel="noopener ugc nofollow" target="_blank"> <em class="ks">æ¸…å•æ–‡ä»¶</em> </a>åˆ›å»ºä¸€ä¸ª<em class="ks">å­˜å‚¨ç±»</em></p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="5975" class="jp jq hi la b fi lk ll l lm ln">k create -f <a class="ae kw" href="https://raw.githubusercontent.com/shamimice03/AWS_EKS-EBS_CSI/main/Demo-storageClass.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/shamimice03/AWS_EKS-EBS_CSI/main/Demo-storageClass.yaml</a></span></pre><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="0acc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">éšåï¼Œåˆ›å»ºä¸€ä¸ª<em class="ks">æŒä¹…å·å£°æ˜</em> (PVC)å¹¶å°†PVCä½œä¸ºä¸€ä¸ªå·é™„åŠ åˆ°podä¸­ã€‚ä½¿ç”¨ä¸‹é¢çš„<a class="ae kw" href="https://raw.githubusercontent.com/shamimice03/AWS_EKS-EBS_CSI/main/pvc-pod.yaml" rel="noopener ugc nofollow" target="_blank">æ¸…å•</a>æ–‡ä»¶â€”</p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="8cb3" class="jp jq hi la b fi lk ll l lm ln">kubectl create -f <a class="ae kw" href="https://raw.githubusercontent.com/shamimice03/AWS_EKS-EBS_CSI/main/pvc-pod.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/shamimice03/AWS_EKS-EBS_CSI/main/pvc-pod.yaml</a></span></pre><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ma mb l"/></div></figure><blockquote class="kp kq kr"><p id="949f" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">æ³¨æ„:</em> </strong>ç”±äºEBSå·åªé”å®šåˆ°ç‰¹å®šçš„AZã€‚å› æ­¤ï¼ŒEBSå·å’Œå°†è¿è¡Œpodçš„å·¥ä½œèŠ‚ç‚¹åº”è¯¥åœ¨åŒä¸€ä¸ªAZä¸­ã€‚</p></blockquote><p id="11ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">éªŒè¯<br/> </strong>ç°åœ¨ï¼ŒéªŒè¯æˆ‘ä»¬ä¹‹å‰éƒ¨ç½²çš„å­˜å‚¨çº§ã€PVCå’Œpodæ˜¯å¦æŒ‰é¢„æœŸå·¥ä½œã€‚</p><pre class="je jf jg jh fd lg la lh li aw lj bi"><span id="bdc6" class="jp jq hi la b fi lk ll l lm ln"><strong class="la hj">&gt;</strong> kubectl get storageclass<br/><strong class="la hj">&gt;</strong> kubectl get pvc<br/><strong class="la hj">&gt;</strong> kubectl get pods</span></pre></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><blockquote class="kp kq kr"><p id="4976" class="if ig ks ih b ii ij ik il im in io ip kt ir is it ku iv iw ix kv iz ja jb jc hb bi translated"><em class="hi"> Kuberneteså­˜å‚¨æ˜¯ä¸€ä¸ªæœ‰ç‚¹æ£˜æ‰‹çš„è¯é¢˜ã€‚æˆ‘è¯•å›¾å°½å¯èƒ½ç®€å•åœ°è§£é‡Šï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ›´æ¸…æ¥šåœ°äº†è§£Kuberneteså‚¨ç‰©ã€‚å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œè¯·ä¸è¦å¿˜è®°ç‚¹å‡»</em> <strong class="ih hj"> <em class="hi">ç‚¹å‡»</em> </strong> <em class="hi">å’Œ</em> <strong class="ih hj"> <em class="hi">ç‚¹å‡»</em> </strong> <em class="hi">æŒ‰é’®ï¼Œå¸®åŠ©æˆ‘å†™æ›´å¤šè¿™æ ·çš„æ–‡ç« ã€‚<br/>è°¢è°¢ğŸ–¤ </em></p></blockquote></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><h2 id="a7bb" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">å‚è€ƒ</h2><div class="mc md ez fb me mf"><a href="https://kubernetes.io/docs/concepts/storage/volumes/" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hj fi z dy mk ea eb ml ed ef hh bi translated">å·</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">å®¹å™¨ä¸­çš„ç£ç›˜ä¸Šçš„æ–‡ä»¶æ˜¯çŸ­æš‚çš„ï¼Œè¿™ç»™è¿è¡Œåœ¨â€¦</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">kubernetes.io</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt jn mf"/></div></div></a></div></div></div>    
</body>
</html>