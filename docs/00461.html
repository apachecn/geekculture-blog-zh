<html>
<head>
<title>How to Use ElasticSearch With Django</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨Djangoçš„ElasticSearch</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/how-to-use-elasticsearch-with-django-ff49fe02b58d?source=collection_archive---------0-----------------------#2021-02-13">https://medium.com/geekculture/how-to-use-elasticsearch-with-django-ff49fe02b58d?source=collection_archive---------0-----------------------#2021-02-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/975cd8ad1a62243a1b0c1ff8d4998d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x88CTnHtkIMYBKoopmojvA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">ElasticSearch with Django</figcaption></figure><h1 id="2a0b" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">ä»€ä¹ˆæ˜¯Elasticsearchï¼Ÿ</h1><p id="9068" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">Elasticsearchæ˜¯ä¸€ä¸ªåŸºäºLuceneåº“çš„æœç´¢å¼•æ“ã€‚å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼çš„ã€æ”¯æŒå¤šç§Ÿæˆ·çš„å…¨æ–‡æœç´¢å¼•æ“ï¼Œå¸¦æœ‰HTTP webæ¥å£å’Œæ— æ¨¡å¼çš„JSONæ–‡æ¡£ã€‚Elasticsearchæ˜¯ç”¨Javaå¼€å‘çš„ã€‚</p><h1 id="5b36" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">Elasticsearchæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Ÿ</h1><p id="5cdd" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated"><strong class="ju hj"> Elasticsearch </strong>å…è®¸æ‚¨å¿«é€Ÿã€è¿‘ä¹å®æ—¶åœ°å­˜å‚¨ã€æœç´¢å’Œåˆ†ææµ·é‡æ•°æ®ï¼Œå¹¶åœ¨å‡ æ¯«ç§’å†…ç»™å‡ºç­”æ¡ˆã€‚å®ƒèƒ½å¤Ÿå®ç°å¿«é€Ÿæœç´¢å“åº”ï¼Œå› ä¸ºå®ƒä¸æ˜¯ç›´æ¥æœç´¢æ–‡æœ¬ï¼Œè€Œæ˜¯æœç´¢ç´¢å¼•ã€‚</p><h1 id="e4ff" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">å¼¹æ€§æœç´¢â€”ä¸€äº›åŸºæœ¬æ¦‚å¿µ</h1><ul class=""><li id="dacb" class="kq kr hi ju b jv jw jz ka kd ks kh kt kl ku kp kv kw kx ky bi translated">ç´¢å¼•â€”ä¸åŒç±»å‹çš„æ–‡æ¡£å’Œæ–‡æ¡£å±æ€§çš„é›†åˆã€‚ä¾‹å¦‚ï¼Œæ–‡æ¡£é›†å¯ä»¥åŒ…å«ç¤¾äº¤ç½‘ç»œåº”ç”¨çš„æ•°æ®ã€‚</li><li id="f282" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">ç±»å‹/æ˜ å°„â€”â€”å…±äº«åŒä¸€ç´¢å¼•ä¸­ä¸€ç»„å…¬å…±å­—æ®µçš„æ–‡æ¡£é›†åˆã€‚ä¾‹å¦‚ï¼Œç´¢å¼•åŒ…å«ç¤¾äº¤ç½‘ç»œåº”ç”¨çš„æ•°æ®ï¼›å¯ä»¥æœ‰ä¸€ç§ç‰¹å®šç±»å‹çš„ç”¨æˆ·ç®€æ¡£æ•°æ®ã€å¦ä¸€ç§ç±»å‹çš„æ¶ˆæ¯æ•°æ®ä»¥åŠå¦ä¸€ç§ç±»å‹çš„è¯„è®ºæ•°æ®ã€‚</li><li id="2609" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">æ–‡æ¡£â€”â€”ä»¥ç‰¹å®šæ–¹å¼åœ¨JSONæ ¼å¼ä¸­å®šä¹‰çš„å­—æ®µé›†åˆã€‚æ¯ä¸ªæ–‡æ¡£éƒ½å±äºä¸€ç§ç±»å‹ï¼Œå¹¶é©»ç•™åœ¨ç´¢å¼•ä¸­ã€‚æ¯ä¸ªæ–‡æ¡£éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œç§°ä¸ºUIDã€‚</li><li id="d7d5" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">å­—æ®µ-å¼¹æ€§æœç´¢å­—æ®µå¯ä»¥åŒ…å«å¤šä¸ªç›¸åŒç±»å‹çš„å€¼(æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåˆ—è¡¨)ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨SQLä¸­ï¼Œä¸€åˆ—åªèƒ½åŒ…å«ä¸€ä¸ªä¸Šè¿°ç±»å‹çš„å€¼ã€‚</li></ul><h1 id="5f53" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">ä½¿ç”¨Djangoçš„Elasticsearch</h1><p id="5fa2" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated"><strong class="ju hj">å®‰è£…å’Œé…ç½®:</strong></p><ul class=""><li id="8bb4" class="kq kr hi ju b jv le jz lf kd lg kh lh kl li kp kv kw kx ky bi translated">å®‰è£…Django Elasticsearch DSL: $pipå®‰è£…django-elasticsearch-dsl</li><li id="9712" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">ç„¶åå°†<code class="du lj lk ll lm b">django_elasticsearch_dsl</code>æ·»åŠ åˆ°INSTALLED_APPSä¸­</li><li id="6df3" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">æ‚¨å¿…é¡»åœ¨djangoè®¾ç½®ä¸­å®šä¹‰<code class="du lj lk ll lm b">ELASTICSEARCH_DSL</code>ã€‚</li><li id="b8d9" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">ä¾‹å¦‚:</li></ul><pre class="ln lo lp lq fd lr lm ls lt aw lu bi"><span id="9cfd" class="lv iv hi lm b fi lw lx l ly lz">ELASTICSEARCH_DSL={<br/>    'default': {<br/>        'hosts': 'localhost:9200'<br/>    },<br/>}</span></pre><p id="08ba" class="pw-post-body-paragraph js jt hi ju b jv le jx jy jz lf kb kc kd ma kf kg kh mb kj kk kl mc kn ko kp hb bi translated"><strong class="ju hj">å‘ç´¢å¼•ç”³æŠ¥æ•°æ®:</strong></p><ul class=""><li id="1469" class="kq kr hi ju b jv le jz lf kd lg kh lh kl li kp kv kw kx ky bi translated">ç„¶åå¯¹äºä¸€ä¸ªæ¨¡å‹:</li></ul><pre class="ln lo lp lq fd lr lm ls lt aw lu bi"><span id="47fa" class="lv iv hi lm b fi lw lx l ly lz"><em class="md"># models.py</em><br/><br/>class Category(models.Model):<br/>    name = models.CharField(max_length=30)<br/>    desc = models.CharField(max_length=100, blank=True)</span><span id="46d9" class="lv iv hi lm b fi me lx l ly lz">def __str__(self):<br/>    return '%s' % (self.name)</span></pre><ul class=""><li id="3520" class="kq kr hi ju b jv le jz lf kd lg kh lh kl li kp kv kw kx ky bi translated">ä¸ºäº†è®©è¿™ä¸ªæ¨¡å‹ä¸Elasticsearchä¸€èµ·å·¥ä½œï¼Œåˆ›å»ºä¸€ä¸ª<code class="du lj lk ll lm b">django_elasticsearch_dsl.Document</code>çš„å­ç±»ï¼Œåœ¨<code class="du lj lk ll lm b">Document</code>ç±»ä¸­åˆ›å»ºä¸€ä¸ª<code class="du lj lk ll lm b">class Index</code>æ¥å®šä¹‰ä½ çš„Elasticsearchç´¢å¼•ã€åç§°ã€è®¾ç½®ç­‰ï¼Œæœ€åä½¿ç”¨<code class="du lj lk ll lm b">registry.register_document</code>è£…é¥°å™¨æ³¨å†Œè¿™ä¸ªç±»ã€‚éœ€è¦åœ¨ä½ çš„appç›®å½•çš„<code class="du lj lk ll lm b">documents.py</code>ä¸­å®šä¹‰<code class="du lj lk ll lm b">Document</code>ç±»ã€‚</li></ul><pre class="ln lo lp lq fd lr lm ls lt aw lu bi"><span id="24c0" class="lv iv hi lm b fi lw lx l ly lz"><em class="md"># documents.py</em><br/><br/><strong class="lm hj">from</strong> <strong class="lm hj">django_elasticsearch_dsl</strong> <strong class="lm hj">import</strong> Document<br/><strong class="lm hj">from</strong> <strong class="lm hj">django_elasticsearch_dsl.registries</strong> <strong class="lm hj">import</strong> registry<br/><strong class="lm hj">from</strong> <strong class="lm hj">.models</strong> <strong class="lm hj">import</strong> Category<br/><br/>@registry.register_document<br/>class CategoryDocument(Document):<br/>    class Index:<br/>        name = 'category'</span><span id="a9ad" class="lv iv hi lm b fi me lx l ly lz">    settings = {<br/>        'number_of_shards': 1,<br/>        'number_of_replicas': 0<br/>    }</span><span id="ef16" class="lv iv hi lm b fi me lx l ly lz">    class Django:<br/>         model = Category</span><span id="1f2e" class="lv iv hi lm b fi me lx l ly lz">         fields = [<br/>             'name',<br/>             'desc',<br/>         ]</span></pre><p id="7154" class="pw-post-body-paragraph js jt hi ju b jv le jx jy jz lf kb kc kd ma kf kg kh mb kj kk kl mc kn ko kp hb bi translated"><strong class="ju hj">å¡«å……:</strong></p><ul class=""><li id="6ae6" class="kq kr hi ju b jv le jz lf kd lg kh lh kl li kp kv kw kx ky bi translated">è¦åˆ›å»ºå’Œå¡«å……Elasticsearchç´¢å¼•å’Œæ˜ å°„ï¼Œè¯·ä½¿ç”¨search_indexå‘½ä»¤:$ python manage . py search _ index-rebuild</li><li id="6ecb" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">æœ‰å…³æ›´å¤šå¸®åŠ©ï¼Œè¯·ä½¿ç”¨$ python manage . py search _ index-helpå‘½ä»¤</li><li id="9b94" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">ç°åœ¨ï¼Œå½“ä½ åšè¿™æ ·çš„äº‹æƒ…æ—¶:</li></ul><pre class="ln lo lp lq fd lr lm ls lt aw lu bi"><span id="edd5" class="lv iv hi lm b fi lw lx l ly lz">category = Category(<br/>    name="Computer and Accessories",<br/>    desc="abc desc"<br/>)<br/>category.save()</span></pre><ul class=""><li id="acb8" class="kq kr hi ju b jv le jz lf kd lg kh lh kl li kp kv kw kx ky bi translated">è¯¥å¯¹è±¡ä¹Ÿå°†ä¿å­˜åœ¨Elasticsearchä¸­(ä½¿ç”¨ä¿¡å·å¤„ç†å™¨)ã€‚</li></ul><p id="2982" class="pw-post-body-paragraph js jt hi ju b jv le jx jy jz lf kb kc kd ma kf kg kh mb kj kk kl mc kn ko kp hb bi translated"><strong class="ju hj">æœç´¢:</strong></p><ul class=""><li id="9a6a" class="kq kr hi ju b jv le jz lf kd lg kh lh kl li kp kv kw kx ky bi translated">è¦è·å¾—elasticsearch-dsl-pyæœç´¢å®ä¾‹ï¼Œè¯·ä½¿ç”¨:</li></ul><pre class="ln lo lp lq fd lr lm ls lt aw lu bi"><span id="d336" class="lv iv hi lm b fi lw lx l ly lz">s = CategoryDocument.search().filter("term", name="computer")<br/><br/><em class="md"># or</em><br/><br/>s = CategoryDocument.search().query("match", description="abc")<br/><br/><strong class="lm hj">for</strong> hit <strong class="lm hj">in</strong> s:<br/>    <strong class="lm hj">print</strong>(<br/>        "Category name : {}, description {}".format(hit.name, hit.desc)<br/>    )</span></pre><ul class=""><li id="cecf" class="kq kr hi ju b jv le jz lf kd lg kh lh kl li kp kv kw kx ky bi translated">è¦å°†elastic searchç»“æœè½¬æ¢æˆä¸€ä¸ªçœŸæ­£çš„django querysetï¼Œåªéœ€æ³¨æ„è¿™éœ€è¦ä¸€ä¸ªSQLè¯·æ±‚æ¥æ£€ç´¢å¸¦æœ‰elastic searchæŸ¥è¯¢è¿”å›çš„idçš„æ¨¡å‹å®ä¾‹ã€‚</li></ul><pre class="ln lo lp lq fd lr lm ls lt aw lu bi"><span id="d861" class="lv iv hi lm b fi lw lx l ly lz">s = CategoryDocument.search().filter("term", name="computer")[:30]<br/>qs = s.to_queryset()<br/><em class="md"># qs is just a django queryset and it is called with order_by to keep</em><br/><em class="md"># the same order as the elasticsearch result.</em><br/><strong class="lm hj">for</strong> cat <strong class="lm hj">in</strong> qs:<br/>    <strong class="lm hj">print</strong>(cat.name)</span></pre><h1 id="ce4b" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">è°ç”¨Elasticsearchï¼Ÿ</h1><ul class=""><li id="b2a9" class="kq kr hi ju b jv jw jz ka kd ks kh kt kl ku kp kv kw kx ky bi translated">æ˜“è´â€”â€”å‡­å€Ÿæ— æ•°åˆ©ç”¨Elasticsearchä½œä¸ºä¸»å¹²çš„ä¸šåŠ¡å…³é”®å‹æ–‡æœ¬æœç´¢å’Œåˆ†æç”¨ä¾‹ï¼Œæ˜“è´åˆ›å»ºäº†ä¸€ä¸ªå®šåˆ¶çš„â€œElasticsearchå³æœåŠ¡â€å¹³å°ï¼Œå…è®¸åœ¨å…¶å†…éƒ¨åŸºäºOpenStackçš„äº‘å¹³å°ä¸Šè½»æ¾é…ç½®Elasticsearché›†ç¾¤ã€‚</li><li id="dd60" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">è„¸ä¹¦ä½¿ç”¨Elasticsearchå·²ç»3å¹´å¤šäº†ï¼Œå·²ç»ä»ä¸€ä¸ªç®€å•çš„ä¼ä¸šæœç´¢å‘å±•åˆ°è·¨å¤šä¸ªé›†ç¾¤çš„40å¤šç§å·¥å…·ï¼Œæ¯å¤©æœ‰6000å¤šä¸‡æ¬¡æŸ¥è¯¢ï¼Œå¹¶ä¸”è¿˜åœ¨å¢é•¿ã€‚</li><li id="e4d6" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">ä¼˜æ­¥â€”â€”elastic searchåœ¨ä¼˜æ­¥çš„Marketplace Dynamicsæ ¸å¿ƒæ•°æ®ç³»ç»Ÿä¸­å‘æŒ¥ç€å…³é”®ä½œç”¨ï¼Œå®ƒå¯ä»¥å®æ—¶æ±‡æ€»ä¸šåŠ¡æŒ‡æ ‡ä»¥æ§åˆ¶å…³é”®çš„å¸‚åœºè¡Œä¸ºï¼Œå¦‚åŠ¨æ€(æ¿€å¢)å®šä»·ã€ä¾›åº”å®šä½å’Œè¯„ä¼°æ•´ä½“å¸‚åœºè¯Šæ–­ã€‚</li><li id="a068" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">Githubä½¿ç”¨Elasticsearchç´¢å¼•è¶…è¿‡800ä¸‡ä¸ªä»£ç åº“ï¼Œä»¥åŠå…³é”®äº‹ä»¶æ•°æ®ã€‚</li><li id="6544" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">å¾®è½¯â€”â€”ä½¿ç”¨Elasticsearchæ”¯æŒå„ç§äº§å“çš„æœç´¢å’Œåˆ†æï¼ŒåŒ…æ‹¬MSNã€å¾®è½¯ç¤¾äº¤ç›‘å¬å’ŒAzure Searchã€‚</li><li id="29c8" class="kq kr hi ju b jv kz jz la kd lb kh lc kl ld kp kv kw kx ky bi translated">just Eat-elastic searchæé«˜äº†é…é€åŠå¾„çš„å‡†ç¡®æ€§ï¼Œå› ä¸ºå®ƒå¯ä»¥ç”¨äºå®šä¹‰æ›´å¤æ‚çš„é…é€è·¯çº¿ï¼Œå¹¶åœ¨é¤å…åšå‡ºæ”¹å˜æ—¶æä¾›å®æ—¶æ›´æ–°ã€‚</li></ul><p id="7b13" class="pw-post-body-paragraph js jt hi ju b jv le jx jy jz lf kb kc kd ma kf kg kh mb kj kk kl mc kn ko kp hb bi translated">æ„Ÿè°¢é˜…è¯»ã€‚å¦‚æœä½ å‘ç°è¿™ç¯‡æ–‡ç« æœ‰ç”¨ï¼Œåˆ«å¿˜äº†<strong class="ju hj">é¼“æŒ</strong>å’Œ<strong class="ju hj">T3ã€‘ä¸ä½ çš„æœ‹å‹å’ŒåŒäº‹åˆ†äº«ã€‚:)å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ã€‚<br/> <strong class="ju hj">ä¸æˆ‘æ¥é€šğŸ‘‰</strong><a class="ae mf" href="https://linkedin.com/in/hiteshmishra708" rel="noopener ugc nofollow" target="_blank"><strong class="ju hj">LinkedIn</strong></a><strong class="ju hj">ï¼Œ</strong><a class="ae mf" href="https://github.com/hiteshmishra708" rel="noopener ugc nofollow" target="_blank"><strong class="ju hj">Github</strong></a><strong class="ju hj">:)</strong></strong></p></div></div>    
</body>
</html>