<html>
<head>
<title>How to deploy a three-tier architecture in AWS using Terraform?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨Terraformåœ¨AWSä¸­éƒ¨ç½²ä¸‰å±‚æ¶æ„ï¼Ÿ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/how-to-deploy-a-three-tier-architecture-in-aws-using-terraform-e5dfd7b6d38f?source=collection_archive---------1-----------------------#2021-10-05">https://medium.com/geekculture/how-to-deploy-a-three-tier-architecture-in-aws-using-terraform-e5dfd7b6d38f?source=collection_archive---------1-----------------------#2021-10-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="9dbc" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">ä»€ä¹ˆæ˜¯Terraformï¼Ÿ</h1><p id="44c4" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">Terraformæ˜¯ä¸€ä¸ªå¼€æºçš„åŸºç¡€è®¾æ–½ä»£ç (IAC)å·¥å…·ï¼Œå…è®¸åˆ›å»ºã€ç®¡ç†å’Œéƒ¨ç½²ç”Ÿäº§å°±ç»ªç¯å¢ƒã€‚Terraformå°†äº‘APIç¼–ç æˆå£°æ˜æ€§çš„é…ç½®æ–‡ä»¶ã€‚Terraformå¯ä»¥ç®¡ç†ç°æœ‰çš„æœåŠ¡æä¾›å•†å’Œå®šåˆ¶çš„å†…éƒ¨è§£å†³æ–¹æ¡ˆã€‚</p><p id="5b30" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ä»<a class="ae kg" href="https://www.terraform.io/intro/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">è¿™é‡Œ</strong> </a>é˜…è¯»æ›´å¤šå…³äºåœ°å½¢çš„ä¿¡æ¯</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/5fa902631019022d57bad06ecc320940.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UqJYKOh7oup4qhrn.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Terraform</figcaption></figure><p id="3b22" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨Terraformåœ¨AWSä¸­éƒ¨ç½²ä¸€ä¸ªä¸‰å±‚åº”ç”¨ç¨‹åºã€‚</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kx"><img src="../Images/adbfea8134647740796c4c734b564e7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CqUoNdOwnB0ZKRfK.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Three-Tier Architecture</figcaption></figure><h1 id="1274" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">å…ˆå†³æ¡ä»¶:</h1><ul class=""><li id="1fea" class="ky kz hi jf b jg jh jk jl jo la js lb jw lc ka ld le lf lg bi translated"><strong class="jf hj"> AWS </strong> &amp; <strong class="jf hj">åœ°å½¢</strong>çš„åŸºç¡€çŸ¥è¯†</li><li id="f054" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated">AWSå¸æˆ·</li><li id="6d4d" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated"><strong class="jf hj"> AWSè®¿é—®</strong> &amp; <strong class="jf hj">å¯†é’¥</strong></li></ul><blockquote class="lm ln lo"><p id="624e" class="jd je lp jf b jg kb ji jj jk kc jm jn lq kd jq jr lr ke ju jv ls kf jy jz ka hb bi translated">åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€äº›å˜é‡ï¼Œæˆ‘å°†åœ¨æœ¬æ–‡åé¢è®¨è®ºã€‚</p></blockquote><p id="0dcf" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬ä¸€æ­¥:- </strong>ä¸º<strong class="jf hj"> VPC </strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="4b70" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åˆ›å»º<code class="du lw lx ly lz b">vpc.tf</code>æ–‡ä»¶å¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd ma lz mb mc aw md bi"><span id="c8ef" class="me ig hi lz b fi mf mg l mh mi"># Creating VPC<br/>resource "aws_vpc" "demovpc" {<br/>  cidr_block       = "${var.vpc_cidr}"<br/>  instance_tenancy = "default"tags = {<br/>    Name = "Demo VPC"<br/>  }<br/>}</span></pre><p id="7ff4" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤2:- </strong>ä¸º<strong class="jf hj">å­ç½‘</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="e2aa" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">å¯¹äºè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘å°†ä¸ºå‰ç«¯å±‚å’Œåç«¯å±‚åˆ›å»ºæ€»å…±6ä¸ªå­ç½‘ï¼Œæ··åˆä½¿ç”¨å…¬å…±å’Œç§æœ‰å­ç½‘</li><li id="7a64" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated">åˆ›å»º<code class="du lw lx ly lz b">subnet.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd ma lz mb mc aw md bi"><span id="6e2b" class="me ig hi lz b fi mf mg l mh mi"># Creating 1st web subnet <br/>resource "aws_subnet" "public-subnet-1" {<br/>  vpc_id                  = "${aws_vpc.demovpc.id}"<br/>  cidr_block             = "${var.subnet_cidr}"<br/>  map_public_ip_on_launch = true<br/>  availability_zone = "us-east-1a"</span><span id="7f6d" class="me ig hi lz b fi mj mg l mh mi">tags = {<br/>    Name = "Web Subnet 1"<br/>  }<br/>}</span><span id="9692" class="me ig hi lz b fi mj mg l mh mi"># Creating 2nd web subnet <br/>resource "aws_subnet" "public-subnet-2" {<br/>  vpc_id                  = "${aws_vpc.demovpc.id}"<br/>  cidr_block             = "${var.subnet1_cidr}"<br/>  map_public_ip_on_launch = true<br/>  availability_zone = "us-east-1b"</span><span id="8137" class="me ig hi lz b fi mj mg l mh mi">tags = {<br/>    Name = "Web Subnet 2"<br/>  }<br/>}</span><span id="0f0f" class="me ig hi lz b fi mj mg l mh mi"># Creating 1st application subnet <br/>resource "aws_subnet" "application-subnet-1" {<br/>  vpc_id                  = "${aws_vpc.demovpc.id}"<br/>  cidr_block             = "${var.subnet2_cidr}"<br/>  map_public_ip_on_launch = false<br/>  availability_zone = "us-east-1a"</span><span id="70dc" class="me ig hi lz b fi mj mg l mh mi">tags = {<br/>    Name = "Application Subnet 1"<br/>  }<br/>}</span><span id="ae55" class="me ig hi lz b fi mj mg l mh mi"># Creating 2nd application subnet <br/>resource "aws_subnet" "application-subnet-2" {<br/>  vpc_id                  = "${aws_vpc.demovpc.id}"<br/>  cidr_block             = "${var.subnet3_cidr}"<br/>  map_public_ip_on_launch = false<br/>  availability_zone = "us-east-1b"</span><span id="01a3" class="me ig hi lz b fi mj mg l mh mi">tags = {<br/>    Name = "Application Subnet 2"<br/>  }<br/>}</span><span id="666b" class="me ig hi lz b fi mj mg l mh mi"># Create Database Private Subnet<br/>resource "aws_subnet" "database-subnet-1" {<br/>  vpc_id            = "${aws_vpc.demovpc.id}"<br/>  cidr_block        = "${var.subnet4_cidr}"<br/>  availability_zone = "us-east-1a"</span><span id="d32d" class="me ig hi lz b fi mj mg l mh mi">tags = {<br/>    Name = "Database Subnet 1"<br/>  }<br/>}</span><span id="479c" class="me ig hi lz b fi mj mg l mh mi"># Create Database Private Subnet<br/>resource "aws_subnet" "database-subnet-2" {<br/>  vpc_id            = "${aws_vpc.demovpc.id}"<br/>  cidr_block        = "${var.subnet5_cidr}"<br/>  availability_zone = "us-east-1a"</span><span id="a041" class="me ig hi lz b fi mj mg l mh mi">tags = {<br/>    Name = "Database Subnet 1"<br/>  }<br/>}</span></pre><p id="83eb" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤3:- </strong>ä¸º<strong class="jf hj">äº’è”ç½‘ç½‘å…³</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="3c13" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åˆ›å»º<code class="du lw lx ly lz b">igw.tf</code>æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç </li></ul><pre class="ki kj kk kl fd ma lz mb mc aw md bi"><span id="be0b" class="me ig hi lz b fi mf mg l mh mi"># Creating Internet Gateway <br/>resource "aws_internet_gateway" "demogateway" {<br/>  vpc_id = "${aws_vpc.demovpc.id}"<br/>}</span></pre><p id="7541" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬å››æ­¥:- </strong>ä¸º<strong class="jf hj">è·¯ç”±è¡¨</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="5536" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åˆ›å»º<code class="du lw lx ly lz b">route_table_public.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd ma lz mb mc aw md bi"><span id="8c07" class="me ig hi lz b fi mf mg l mh mi"># Creating Route Table<br/>resource "aws_route_table" "route" {<br/>    vpc_id = "${aws_vpc.demovpc.id}"</span><span id="8606" class="me ig hi lz b fi mj mg l mh mi">route {<br/>        cidr_block = "0.0.0.0/0"<br/>        gateway_id = "${aws_internet_gateway.demogateway.id}"<br/>    }</span><span id="7aca" class="me ig hi lz b fi mj mg l mh mi">tags = {<br/>        Name = "Route to internet"<br/>    }<br/>}</span><span id="c06a" class="me ig hi lz b fi mj mg l mh mi"># Associating Route Table<br/>resource "aws_route_table_association" "rt1" {<br/>    subnet_id = "${aws_subnet.demosubnet.id}"<br/>    route_table_id = "${aws_route_table.route.id}"<br/>}</span><span id="7a97" class="me ig hi lz b fi mj mg l mh mi"># Associating Route Table<br/>resource "aws_route_table_association" "rt2" {<br/>    subnet_id = "${aws_subnet.demosubnet1.id}"<br/>    route_table_id = "${aws_route_table.route.id}"<br/>}</span></pre><ul class=""><li id="0d4d" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„è·¯ç”±è¡¨ï¼Œå¹¶å°†æ‰€æœ‰è¯·æ±‚è½¬å‘åˆ°<code class="du lw lx ly lz b">0.0.0.0/0</code> CIDRå—ã€‚</li><li id="918b" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated">æˆ‘è¿˜å°†è¿™ä¸ªè·¯ç”±è¡¨é™„åŠ åˆ°å‰é¢åˆ›å»ºçš„å­ç½‘ã€‚å› æ­¤ï¼Œå®ƒå°†ä½œä¸ºå…¬å…±å­ç½‘å·¥ä½œ</li></ul><p id="cc3b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬äº”æ­¥:- </strong>ä¸º<strong class="jf hj"> EC2å®ä¾‹</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="5371" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åˆ›å»º<code class="du lw lx ly lz b">ec2.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd ma lz mb mc aw md bi"><span id="bd7b" class="me ig hi lz b fi mf mg l mh mi"># Creating 1st EC2 instance in Public Subnet<br/>resource "aws_instance" "demoinstance" {<br/>  ami                         = "ami-087c17d1fe0178315"<br/>  instance_type               = "t2.micro"<br/>  count                       = 1<br/>  key_name                    = "tests"<br/>  vpc_security_group_ids      = ["${aws_security_group.demosg.id}"]<br/>  subnet_id                   = "${aws_subnet.demoinstance.id}"<br/>  associate_public_ip_address = true<br/>  user_data                   = "${file("data.sh")}"</span><span id="9887" class="me ig hi lz b fi mj mg l mh mi">tags = {<br/>    Name = "My Public Instance"<br/>  }<br/>}</span><span id="d16e" class="me ig hi lz b fi mj mg l mh mi"># Creating 2nd EC2 instance in Public Subnet<br/>resource "aws_instance" "demoinstance1" {<br/>  ami                         = "ami-087c17d1fe0178315"<br/>  instance_type               = "t2.micro"<br/>  count                       = 1<br/>  key_name                    = "tests"<br/>  vpc_security_group_ids      = ["${aws_security_group.demosg.id}"]<br/>  subnet_id                   = "${aws_subnet.demoinstance.id}"<br/>  associate_public_ip_address = true<br/>  user_data                   = "${file("data.sh")}"</span><span id="7293" class="me ig hi lz b fi mj mg l mh mi">tags = {<br/>    Name = "My Public Instance 2"<br/>  }<br/>}</span></pre><ul class=""><li id="bbd2" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">æˆ‘å·²ç»ä½¿ç”¨äº†<code class="du lw lx ly lz b">userdata</code>æ¥é…ç½®EC2å®ä¾‹ï¼Œæˆ‘å°†åœ¨æœ¬æ–‡åé¢è®¨è®º<code class="du lw lx ly lz b">data.sh</code>æ–‡ä»¶</li></ul><p id="b722" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤6:- </strong>ä¸º<strong class="jf hj">å‰ç«¯</strong> <strong class="jf hj">å±‚</strong>çš„<strong class="jf hj">å®‰å…¨ç»„</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="e5b0" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åˆ›å»º<code class="du lw lx ly lz b">web_sg.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd ma lz mb mc aw md bi"><span id="ca6c" class="me ig hi lz b fi mf mg l mh mi"># Creating Security Group <br/>resource "aws_security_group" "demosg" {<br/>  vpc_id = "${aws_vpc.demovpc.id}"</span><span id="c177" class="me ig hi lz b fi mj mg l mh mi"># Inbound Rules<br/>  # HTTP access from anywhere<br/>  ingress {<br/>    from_port   = 80<br/>    to_port     = 80<br/>    protocol    = "tcp"<br/>    cidr_blocks = ["0.0.0.0/0"]<br/>  }</span><span id="e043" class="me ig hi lz b fi mj mg l mh mi"># HTTPS access from anywhere<br/>  ingress {<br/>    from_port   = 443<br/>    to_port     = 443<br/>    protocol    = "tcp"<br/>    cidr_blocks = ["0.0.0.0/0"]<br/>  }</span><span id="979c" class="me ig hi lz b fi mj mg l mh mi"># SSH access from anywhere<br/>  ingress {<br/>    from_port   = 22<br/>    to_port     = 22<br/>    protocol    = "tcp"<br/>    cidr_blocks = ["0.0.0.0/0"]<br/>  }</span><span id="91c8" class="me ig hi lz b fi mj mg l mh mi"># Outbound Rules<br/>  # Internet access to anywhere<br/>  egress {<br/>    from_port   = 0<br/>    to_port     = 0<br/>    protocol    = "-1"<br/>    cidr_blocks = ["0.0.0.0/0"]<br/>  }</span><span id="79fc" class="me ig hi lz b fi mj mg l mh mi">tags = {<br/>    Name = "Web SG"<br/>  }<br/>}</span></pre><ul class=""><li id="b212" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">æˆ‘å·²ç»ä¸ºå…¥ç«™è¿æ¥æ‰“å¼€äº†<strong class="jf hj"> 80ï¼Œ443 &amp; 22 </strong>ä¸ªç«¯å£ï¼Œå¹¶ä¸ºå‡ºç«™è¿æ¥æ‰“å¼€äº†æ‰€æœ‰ç«¯å£</li></ul><p id="675c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤7:- </strong>ä¸º<strong class="jf hj">æ•°æ®åº“</strong> <strong class="jf hj">å±‚</strong>çš„<strong class="jf hj">å®‰å…¨ç»„</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="1af7" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åˆ›å»º<code class="du lw lx ly lz b">database_sg.tf</code>æ–‡ä»¶å¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd ma lz mb mc aw md bi"><span id="2fb1" class="me ig hi lz b fi mf mg l mh mi"># Create Database Security Group<br/>resource "aws_security_group" "database-sg" {<br/>  name        = "Database SG"<br/>  description = "Allow inbound traffic from application layer"<br/>  vpc_id      = aws_vpc.demovpc.id</span><span id="f13f" class="me ig hi lz b fi mj mg l mh mi">ingress {<br/>    description     = "Allow traffic from application layer"<br/>    from_port       = 3306<br/>    to_port         = 3306<br/>    protocol        = "tcp"<br/>    security_groups = [aws_security_group.demosg.id]<br/>  }</span><span id="9b88" class="me ig hi lz b fi mj mg l mh mi">egress {<br/>    from_port   = 32768<br/>    to_port     = 65535<br/>    protocol    = "tcp"<br/>    cidr_blocks = ["0.0.0.0/0"]<br/>  }</span><span id="96c5" class="me ig hi lz b fi mj mg l mh mi">tags = {<br/>    Name = "Database SG"<br/>  }</span></pre><ul class=""><li id="0c7e" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">æˆ‘å·²ç»ä¸ºå…¥ç«™è¿æ¥æ‰“å¼€äº†<strong class="jf hj"> 3306 </strong>ç«¯å£ï¼Œä¹Ÿä¸ºå‡ºç«™è¿æ¥æ‰“å¼€äº†æ‰€æœ‰ç«¯å£ã€‚</li></ul><p id="42a7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤8:- </strong>åˆ›å»ºæ–‡ä»¶<strong class="jf hj">åº”ç”¨è´Ÿè½½å‡è¡¡å™¨</strong></p><ul class=""><li id="a99c" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åˆ›å»º<code class="du lw lx ly lz b">alb.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd ma lz mb mc aw md bi"><span id="a6aa" class="me ig hi lz b fi mf mg l mh mi"># Creating External LoadBalancer<br/>resource "aws_lb" "external-alb" {<br/>  name               = "External LB"<br/>  internal           = false<br/>  load_balancer_type = "application"<br/>  security_groups    = [aws_security_group.demosg.id]<br/>  subnets            = [aws_subnet.public-subnet-1.id, aws_subnet.public-subnet-1.id]<br/>}</span><span id="9fc6" class="me ig hi lz b fi mj mg l mh mi">resource "aws_lb_target_group" "target-elb" {<br/>  name     = "ALB TG"<br/>  port     = 80<br/>  protocol = "HTTP"<br/>  vpc_id   = aws_vpc.demovpc.id<br/>}</span><span id="5e01" class="me ig hi lz b fi mj mg l mh mi">resource "aws_lb_target_group_attachment" "attachment" {<br/>  target_group_arn = aws_lb_target_group.external-alb.arn<br/>  target_id        = aws_instance.demoinstance.id<br/>  port             = 80</span><span id="6ce0" class="me ig hi lz b fi mj mg l mh mi">depends_on = [<br/>    aws_instance.demoinstance,<br/>  ]<br/>}</span><span id="eaa6" class="me ig hi lz b fi mj mg l mh mi">resource "aws_lb_target_group_attachment" "attachment" {<br/>  target_group_arn = aws_lb_target_group.external-alb.arn<br/>  target_id        = aws_instance.demoinstance1.id<br/>  port             = 80</span><span id="eb56" class="me ig hi lz b fi mj mg l mh mi">depends_on = [<br/>    aws_instance.demoinstance1,<br/>  ]<br/>}</span><span id="b3d0" class="me ig hi lz b fi mj mg l mh mi">resource "aws_lb_listener" "external-elb" {<br/>  load_balancer_arn = aws_lb.external-alb.arn<br/>  port              = "80"<br/>  protocol          = "HTTP"</span><span id="f862" class="me ig hi lz b fi mj mg l mh mi">default_action {<br/>    type             = "forward"<br/>    target_group_arn = aws_lb_target_group.external-alb.arn<br/>  }<br/>}</span></pre><ul class=""><li id="bac8" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">ä¸Šè¿°è´Ÿè½½å¹³è¡¡å™¨æ˜¯ç±»å‹<strong class="jf hj">å¤–éƒ¨</strong></li><li id="bf09" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated">è´Ÿè½½å¹³è¡¡å™¨ç±»å‹è®¾ç½®ä¸º<strong class="jf hj">åº”ç”¨</strong></li><li id="37d9" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated"><strong class="jf hj">AWS _ lb _ Target _ Group _ attachment</strong>èµ„æºä¼šå°†æˆ‘ä»¬çš„å®ä¾‹é™„åŠ åˆ°<strong class="jf hj">ç›®æ ‡ç»„</strong>ã€‚</li><li id="6929" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated">è´Ÿè½½å¹³è¡¡å™¨å°†ç›‘å¬<strong class="jf hj">ç«¯å£80 </strong>ä¸Šçš„è¯·æ±‚</li></ul><p id="5112" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬9æ­¥:- </strong>ä¸º<strong class="jf hj"> RDSå®ä¾‹</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="f04a" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åˆ›å»ºä¸€ä¸ª<code class="du lw lx ly lz b">rds.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd ma lz mb mc aw md bi"><span id="17b2" class="me ig hi lz b fi mf mg l mh mi"># Creating RDS Instance<br/>resource "aws_db_subnet_group" "default" {<br/>  name       = "main"<br/>  subnet_ids = [aws_subnet.database-subnet-1.id, aws_subnet.database-subnet-1.id]</span><span id="7d49" class="me ig hi lz b fi mj mg l mh mi">tags = {<br/>    Name = "My DB subnet group"<br/>  }<br/>}</span><span id="ad01" class="me ig hi lz b fi mj mg l mh mi">resource "aws_db_instance" "default" {<br/>  allocated_storage      = 10<br/>  db_subnet_group_name   = aws_db_subnet_group.default.id<br/>  engine                 = "mysql"<br/>  engine_version         = "8.0.20"<br/>  instance_class         = "db.t2.micro"<br/>  multi_az               = true<br/>  name                   = "mydb"<br/>  username               = "username"<br/>  password               = "password"<br/>  skip_final_snapshot    = true<br/>  vpc_security_group_ids = [aws_security_group.database-sg.id]<br/>}</span></pre><ul class=""><li id="69af" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œéœ€è¦æ›´æ”¹<code class="du lw lx ly lz b">username</code> &amp; <code class="du lw lx ly lz b">password</code>çš„å€¼</li><li id="7150" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated"><code class="du lw lx ly lz b">multi-az</code>è®¾ç½®ä¸ºçœŸï¼Œä»¥è·å¾—é«˜å¯ç”¨æ€§</li></ul><p id="95b3" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬åæ­¥:- </strong>ä¸º<strong class="jf hj">è¾“å‡º</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="8a11" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åˆ›å»º<code class="du lw lx ly lz b">outputs.tf</code>æ–‡ä»¶å¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd ma lz mb mc aw md bi"><span id="4df2" class="me ig hi lz b fi mf mg l mh mi"># Getting the DNS of load balancer<br/>output "lb_dns_name" {<br/>  description = "The DNS name of the load balancer"<br/>  value       = "${aws_lb.external-alb.dns_name}"<br/>}</span></pre><ul class=""><li id="032c" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">ä»ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘å°†è·å¾—åº”ç”¨ç¨‹åºè´Ÿè½½å¹³è¡¡å™¨çš„DNSã€‚</li></ul><p id="3f22" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤11:- </strong>ä¸º<strong class="jf hj">å˜é‡</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="c515" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åˆ›å»º<code class="du lw lx ly lz b">vars.tf</code>æ–‡ä»¶å¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd ma lz mb mc aw md bi"><span id="6d70" class="me ig hi lz b fi mf mg l mh mi"># Defining CIDR Block for VPC<br/>variable "vpc_cidr" {<br/>  default = "10.0.0.0/16"<br/>}<br/># Defining CIDR Block for 1st Subnet<br/>variable "subnet_cidr" {<br/>  default = "10.0.1.0/24"<br/>}<br/># Defining CIDR Block for 2nd Subnet<br/>variable "subnet1_cidr" {<br/>  default = "10.0.2.0/24"<br/>}<br/># Defining CIDR Block for 3rd Subnet<br/>variable "subnet2_cidr" {<br/>  default = "10.0.3.0/24"<br/>}<br/># Defining CIDR Block for 3rd Subnet<br/>variable "subnet2_cidr" {<br/>  default = "10.0.4.0/24"<br/>}<br/># Defining CIDR Block for 3rd Subnet<br/>variable "subnet2_cidr" {<br/>  default = "10.0.5.0/24"<br/>}<br/># Defining CIDR Block for 3rd Subnet<br/>variable "subnet2_cidr" {<br/>  default = "10.0.6.0/24"<br/>}</span></pre><p id="8dfc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤12:- </strong>ä¸º<strong class="jf hj">ç”¨æˆ·æ•°æ®</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="10c3" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">åˆ›å»º<code class="du lw lx ly lz b">data.sh</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd ma lz mb mc aw md bi"><span id="b546" class="me ig hi lz b fi mf mg l mh mi">#!/bin/bash</span><span id="60cd" class="me ig hi lz b fi mj mg l mh mi">yum update -y<br/>yum install -y httpd.x86_64<br/>systemctl start httpd.service<br/>systemctl enable httpd.service<br/>echo "Hello World from $(hostname -f)" &gt; /var/www/html/index.html</span></pre><ul class=""><li id="5d5e" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">ä¸Šé¢çš„ä»£ç å°†åœ¨<strong class="jf hj"> EC2å®ä¾‹</strong>ä¸­å®‰è£…ä¸€ä¸ª<strong class="jf hj"> apache webserver </strong></li></ul><p id="9b6f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æ‰€ä»¥ï¼Œç°åœ¨æˆ‘ä»¬çš„å…¨éƒ¨ä»£ç éƒ½å‡†å¤‡å¥½äº†ã€‚æˆ‘ä»¬éœ€è¦è¿è¡Œä»¥ä¸‹æ­¥éª¤æ¥åˆ›å»ºåŸºç¡€æ¶æ„ã€‚</p><ul class=""><li id="915f" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated"><code class="du lw lx ly lz b">terraform init</code>åˆå§‹åŒ–æä¾›è€…çš„å·¥ä½œç›®å½•å’Œä¸‹è½½æ’ä»¶</li><li id="ff5e" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated"><code class="du lw lx ly lz b">terraform plan</code>æ˜¯ä¸ºæˆ‘ä»¬çš„ä»£ç åˆ›å»ºæ‰§è¡Œè®¡åˆ’</li><li id="301e" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated"><code class="du lw lx ly lz b">terraform apply</code>æ˜¯åˆ›å»ºå®é™…çš„åŸºç¡€è®¾æ–½ã€‚å®ƒä¼šè¦æ±‚æ‚¨æä¾›<strong class="jf hj">è®¿é—®å¯†é’¥</strong>å’Œ<strong class="jf hj">ç§˜å¯†å¯†é’¥</strong>ï¼Œä»¥ä¾¿åˆ›å»ºåŸºç¡€æ¶æ„ã€‚å› æ­¤ï¼Œä¸å…¶ç¡¬ç¼–ç <strong class="jf hj">è®¿é—®å¯†é’¥</strong>å’Œ<strong class="jf hj">ç§˜å¯†å¯†é’¥ï¼Œ</strong>ä¸å¦‚åœ¨è¿è¡Œæ—¶åº”ç”¨ã€‚</li></ul><p id="61b4" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤13:- </strong>éªŒè¯th <strong class="jf hj"> eèµ„æº</strong></p><ul class=""><li id="b399" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka ld le lf lg bi translated">Terraformå°†åˆ›å»ºä»¥ä¸‹èµ„æº</li></ul><ol class=""><li id="d72a" class="ky kz hi jf b jg kb jk kc jo lt js lu jw lv ka mk le lf lg bi translated"><strong class="jf hj"> VPC </strong></li><li id="a62c" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka mk le lf lg bi translated"><strong class="jf hj">åº”ç”¨è´Ÿè½½å¹³è¡¡å™¨</strong></li><li id="f562" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka mk le lf lg bi translated"><strong class="jf hj">å…¬å…±&amp;ç§æœ‰å­ç½‘</strong></li><li id="a5eb" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka mk le lf lg bi translated"><strong class="jf hj"> EC2å®ä¾‹</strong></li><li id="c3fb" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka mk le lf lg bi translated"><strong class="jf hj">è·¯ç”±è¡¨</strong></li><li id="9284" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka mk le lf lg bi translated"><strong class="jf hj">äº’è”ç½‘ç½‘å…³</strong></li><li id="4b16" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka mk le lf lg bi translated"><strong class="jf hj"> RDSå®ä¾‹</strong></li><li id="f7d3" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka mk le lf lg bi translated"><strong class="jf hj">Webçš„å®‰å…¨ç»„&amp; RDSå®ä¾‹</strong></li></ol><p id="d0c9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">èµ„æºåˆ›å»ºå®Œæˆåï¼Œæ‚¨å¯ä»¥è·å–è´Ÿè½½å¹³è¡¡å™¨çš„DNSï¼Œå¹¶å°†å…¶ç²˜è´´åˆ°æµè§ˆå™¨ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°è´Ÿè½½å¹³è¡¡å™¨å°†å‘ä¸¤ä¸ªå®ä¾‹å‘é€è¯·æ±‚ã€‚</p><p id="483a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ç°åœ¨å°±è¿™æ ·ï¼Œä½ å·²ç»å­¦ä¼šäº†å¦‚ä½•ä½¿ç”¨Terraformåœ¨AWSä¸­åˆ›å»ºå„ç§èµ„æºã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œè¿›ä¸€æ­¥æ¢ç´¢åœ°å½¢<a class="ae kg" href="https://terraform.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jf hj"/></a></p><p id="269b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ä½ å¯ä»¥åœ¨æˆ‘çš„<a class="ae kg" href="https://github.com/DhruvinSoni30/Terraform-AWS-3tier-Architecture/tree/main" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj"> GitHub </strong> </a>è´¦å·æ‰¾åˆ°å®Œæ•´çš„ä»£ç ã€‚ä¹Ÿå¯ä»¥éšæ„æŸ¥çœ‹æˆ‘çš„å…¶ä»–åº“ã€‚</p><p id="0d51" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">å¦‚æœæ‚¨å‘ç°æ­¤æŒ‡å—æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹å‡»ğŸ‘æŒ‰é’®ï¼Œä¹Ÿå¯ä»¥éšæ„å‘è¡¨è¯„è®ºã€‚</p><p id="227f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">å…³æ³¨æ›´å¤šç±»ä¼¼çš„æ•…äº‹ğŸ˜Š</p></div></div>    
</body>
</html>