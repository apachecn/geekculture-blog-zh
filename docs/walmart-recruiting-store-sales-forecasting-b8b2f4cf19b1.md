# æ²ƒå°”ç›æ‹›è˜â€”å•†åº—é”€å”®é¢„æµ‹

> åŸæ–‡ï¼š<https://medium.com/geekculture/walmart-recruiting-store-sales-forecasting-b8b2f4cf19b1?source=collection_archive---------12----------------------->

> â€œ**é¢„æµ‹**çš„**ç›®æ ‡**ä¸æ˜¯é¢„æµ‹æœªæ¥ï¼Œè€Œæ˜¯å‘Šè¯‰ä½ ä½ éœ€è¦çŸ¥é“ä»€ä¹ˆï¼Œä»¥ä¾¿åœ¨å½“ä¸‹é‡‡å–æœ‰æ„ä¹‰çš„è¡ŒåŠ¨â€ã€‚â€”â€”**ä¿ç½—Â·è¨ä½›**

![](img/79e449e8c20ebada26ab76660da5024a.png)

**ç›®å½•:**

1.  å•†ä¸šé—®é¢˜

2.ä¸ºä»€ä¹ˆè¿™ä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼Ÿ

3.æœºå™¨å­¦ä¹ å¦‚ä½•å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ

4.ä½œä¸ºæ€§èƒ½æŒ‡æ ‡çš„åŠ æƒå¹³å‡ç»å¯¹è¯¯å·®(WMAE)

5.ä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨ WMAE ä½œä¸ºæˆ‘çš„ç»©æ•ˆæŒ‡æ ‡ï¼Ÿ

6.æ•°æ®é›†ä¿¡æ¯

7.æ¢ç´¢æ•°æ®åˆ†æ

8.åŸºçº¿æ¨¡å‹

9.æ•°æ®é¢„å¤„ç†

10.æ¨¡å‹

11.éƒ¨ç½²

12.æœªæ¥çš„å·¥ä½œ

13.å‚è€ƒ:

# 1.ç®€ä»‹å’Œç›®æ ‡:

> æ²ƒå°”ç›æ˜¯ä¸€å®¶è‘—åçš„é›¶å”®å…¬å¸ï¼Œç»è¥è¿é”è¶…å¸‚ã€‚è¿™é‡Œï¼Œæ²ƒå°”ç›æä¾›äº† 45 å®¶å•†åº—çš„æ•°æ®ç»„åˆï¼ŒåŒ…æ‹¬å•†åº—ä¿¡æ¯å’Œæœˆé”€å”®é¢ã€‚æ•°æ®æ¯å‘¨æä¾›ä¸€æ¬¡ã€‚æ²ƒå°”ç›è¯•å›¾å‘ç°å‡æœŸå¯¹å•†åº—é”€å”®çš„å½±å“ã€‚ä¸ºæ­¤ï¼Œå®ƒå°†å››ä¸ªå‡æœŸå‘¨çº³å…¥æ•°æ®é›†ï¼Œåˆ†åˆ«æ˜¯åœ£è¯èŠ‚ã€æ„Ÿæ©èŠ‚ã€è¶…çº§ç¢—ã€åŠ³åŠ¨èŠ‚ã€‚è¿™é‡Œæˆ‘ä»¬è¦åˆ†æç»™å®šçš„æ•°æ®é›†ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘æŒ‡å‡ºè¿™ä¸ªåˆ†æçš„ç›®çš„ã€‚
> 
> æˆ‘ä»¬çš„ä¸»è¦ç›®æ ‡æ˜¯é¢„æµ‹å•†åº—ä¸€å‘¨å†…çš„é”€å”®é¢ã€‚
> 
> ç”±äºæ•°æ®é›†å¤§å°å’Œæ—¶é—´ç›¸å…³æ•°æ®ä½œä¸ºç‰¹å¾ç»™å‡ºï¼Œå› æ­¤åˆ†æé”€å”®æ˜¯å¦å—åˆ°åŸºäºæ—¶é—´çš„å› ç´ å’ŒåŸºäºç©ºé—´çš„å› ç´ çš„å½±å“ã€‚
> 
> æœ€é‡è¦çš„æ˜¯ï¼Œå¦‚ä½•åœ¨ä¸€å‘¨å†…åŒ…æ‹¬å‡æœŸæ¥æé«˜å•†åº—çš„é”€å”®é¢ï¼Ÿ

## 2.ä¸ºä»€ä¹ˆè¿™ä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼Ÿ

å‡æœŸä¼šå¯¹é”€å”®äº§ç”Ÿå·¨å¤§å½±å“ã€‚å› æ­¤ï¼Œå¦‚æœå¯¹é”€å”®é¢æœ‰ä¸€ä¸ªå¥½çš„é¢„æµ‹ï¼Œæ²ƒå°”ç›å°±å¯ä»¥è®¡ç®—å‡ºå‡æœŸæœŸé—´è¦è®¢è´­å¤šå°‘äº§å“ã€‚è¿™å°†æœ‰åŠ©äºé¢„æµ‹å‡æœŸæœŸé—´éœ€è¦è´­ä¹°å“ªäº›äº§å“ã€‚å› ä¸ºè®¡åˆ’è´­ç‰©çš„é¡¾å®¢å¸Œæœ›äº§å“èƒ½ç«‹å³ä¸Šå¸‚ã€‚é€šè¿‡é¢„æµ‹ï¼Œä»–ä»¬å¯ä»¥è®¡ç®—å‡ºä»€ä¹ˆæ—¶å€™éœ€è¦ä»€ä¹ˆäº§å“ã€‚ä»è€Œæé«˜é¡¾å®¢å¯¹æ²ƒå°”ç›çš„ä¿¡ä»»åº¦ã€‚è¿™ä¸ªé—®é¢˜ä¹Ÿå¯ä»¥è§£å†³è¥é”€æ´»åŠ¨çš„é—®é¢˜ã€‚å› ä¸ºé¢„æµ‹é€šå¸¸ç”¨äºè°ƒæ•´å¹¿å‘Šå’Œè¥é”€æ´»åŠ¨ï¼Œå¹¶èƒ½å½±å“é”€å”®é¢ã€‚æ²ƒå°”ç›å…¨å¹´éƒ½ä¼šä¸¾åŠå‡ æ¬¡é™ä»·æ´»åŠ¨ã€‚è¿™äº›é™ä»·äº‹ä»¶å‘ç”Ÿåœ¨é‡è¦çš„èŠ‚å‡æ—¥ä¹‹å‰ã€‚å› æ­¤ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ²ƒå°”ç›å¯ä»¥æ›´æœ‰æ•ˆåœ°ç»„ç»‡è¿™æ ·çš„æ´»åŠ¨ã€‚

## 3.æœºå™¨å­¦ä¹ å¦‚ä½•å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ

å·²çŸ¥å…·æœ‰çº¿æ€§çš„æ—¶é—´åºåˆ—æ•°æ®ã€‚ç®€å•çš„å‡å€¼æˆ–ä¸­å€¼æ¨¡å‹ä¸èƒ½æœ‰æ•ˆæˆ–å®Œå…¨æ˜ å°„çº¿æ€§å…³ç³»ã€‚åƒ[*ã€ARIMAã€‘*](https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average)(è‡ªå›å½’ç»¼åˆç§»åŠ¨å¹³å‡çº¿)è¿™æ ·çš„æ¨¡å‹åœ¨é¢„æµ‹é”€å”®é¢æ—¶æ²¡æœ‰è€ƒè™‘åˆ°å•†åº—è§„æ¨¡ã€å•†åº—ç±»å‹ã€å‡æœŸç­‰ç‰¹å¾çš„å½±å“ã€‚å› æ­¤ï¼Œå¦‚æœæ•°æ®é›†æ»¡è¶³å…¶çº¿æ€§å‡è®¾ï¼Œåƒçº¿æ€§å›å½’æ¨¡å‹è¿™æ ·çš„æœºå™¨å­¦ä¹ æ¨¡å‹å¯ä»¥æä¾›ç¨³å¥çš„é¢„æµ‹ã€‚å†è€…ï¼Œæœºå™¨å­¦ä¹ é¢„æµ‹ä¸æ˜¯é»‘ç®±ï¼›å¯ä»¥è¡¡é‡å’Œç†è§£æ¨¡å‹è¾“å…¥çš„å½±å“ï¼Œä»è€Œä½¿é¢„æµ‹ç›´è§‚è€Œé€æ˜ã€‚æœºå™¨å­¦ä¹ æ¨¡å‹ä¹Ÿå¯ä»¥æ›´æ–°ï¼Œå¹¶é€‚åº”æ•°æ®é›†çš„å˜åŒ–ã€‚

ä¸”è¿˜é€šè¿‡æœºå™¨å­¦ä¹ å¸®åŠ©ï¼Œå¯ä»¥ä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹ä»¥æ­£ç¡®çš„æ–¹å¼åˆ©ç”¨é™ä»·äº‹ä»¶å’Œæ¯å‘¨é”€å”®ä¹‹é—´çš„å…³ç³»ã€‚

> æœºå™¨å­¦ä¹ æ¨¡å‹éœ€è¦ä¸€ä¸ªè¡¡é‡æ ‡å‡†æ¥æ£€æŸ¥æ¨¡å‹çš„è¡¨ç°æ˜¯å¥½æ˜¯åã€‚è¿™ä¸ªæŒ‡æ ‡è¢«ç§°ä¸ºæ€§èƒ½æŒ‡æ ‡ã€‚

**4ã€‚åŠ æƒå¹³å‡ç»å¯¹è¯¯å·®(WMAE)ä½œä¸ºæ€§èƒ½æŒ‡æ ‡**

![](img/e9fed686232947200a20500c74681b5e.png)

å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨é¢„æµ‹æ¯å‘¨é”€å”®é¢çš„åŒæ—¶ï¼Œå°½å¯èƒ½é™ä½è¿™ä¸€åˆ†æ•°ã€‚æˆ‘ä»¬å°†åœ¨å›å½’æ¨¡å‹ä¸­ä½¿ç”¨è¿™ä¸ªæ€§èƒ½æŒ‡æ ‡ã€‚

## **5ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨ WMAE ä½œä¸ºæˆ‘çš„ç»©æ•ˆæŒ‡æ ‡ï¼Ÿ**

é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ RMSE(å‡æ–¹æ ¹è¯¯å·®)è€Œä½¿ç”¨ MAEã€‚ç»™å®šçš„æ•°æ®é›†ä¸æ˜¯å¤§å‹æ•°æ®é›†ï¼Œå› æ­¤å¼‚å¸¸ç‚¹çš„å½±å“ä¼šæ¯”é€šå¸¸æƒ…å†µä¸‹æ›´å¤§ã€‚è€Œä½¿ç”¨ RMSE å®ƒå¯ä»¥ä½¿å†²å‡»åŠ›å¢åŠ ä¸¤å€ä»¥ä¸Šã€‚å‡è®¾æˆ‘ä»¬å¯¹ä½ çš„é—®é¢˜æœ‰ä¸¤ä¸ªæ¨¡å‹(M1 å’Œ M2)ã€‚å‡è®¾æˆ‘ä»¬æœ‰ 4 ä¸ªæ­£å¸¸ç‚¹å’Œ 1 ä¸ªå¼‚å¸¸ç‚¹ã€‚è®©æˆ‘ä»¬æœ‰å®é™…çš„é”€å”®æ˜¯æ­£å¸¸çš„ä¸€å‘¨é”€å”®æœ‰å¹³å‡å€¼çº¦ 10 å’Œç¦»ç¾¤å€¼æœ‰é”€å”® 100ã€‚æ¨¡å‹ 1 ç”¨å¹³å‡å€¼ 11 å’Œå¼‚å¸¸å€¼ 110 æ¥é¢„æµ‹æ­£å¸¸å‘¨çš„é”€å”®é¢ã€‚æ¨¡å‹ 2 é¢„æµ‹æ­£å¸¸å‘¨å¹³å‡å€¼ä¸º 14ï¼Œå¼‚å¸¸å€¼ä¸º 105ã€‚åˆ†æ¯ä¸­çš„ N æ˜¯å¸¸æ•°ï¼Œä¸¤ç§æƒ…å†µä¸‹è®¡ç®—å¼‚å¸¸ç‚¹æ¨¡å‹ 1 çš„ MAE:110â€“100 = 10 è®¡ç®—å¼‚å¸¸ç‚¹æ¨¡å‹ 1 çš„ MSE:(110â€“100)= 100

è®¡ç®—å¼‚å¸¸ç‚¹æ¨¡å‹ 1 çš„ MAE:105â€“100 = 5 è®¡ç®—å¼‚å¸¸ç‚¹æ¨¡å‹ 1 çš„ MSE:(105â€“100)= 25

æ¨¡å‹ 1 çš„ RMSE å€¼å°†ä¸º=å¹³æ–¹æ ¹(100+1+1+1+1) = 10.9ï¼Œè€Œå¯¹äºæ¨¡å‹ 2 =å¹³æ–¹æ ¹(25+3+3+3+3) = 6.08ã€‚ç”±äºæ¨¡å‹ 1 çš„ RMSE å¤§äºæ¨¡å‹ 2ï¼Œä»…ä»…å› ä¸ºå•ä¸ªå¼‚å¸¸ç‚¹ï¼Œå®ƒå°†ä¸¢å¼ƒå®é™…ä¸Šè¡¨ç°æ›´å¥½çš„æ¨¡å‹ 1ã€‚

ç„¶è€Œï¼Œæ¨¡å‹ 1 çš„ MAE = 14ï¼Œæ¨¡å‹ 2 çš„ MAE = 17

æ˜¾ç„¶ï¼Œåœ¨è¾ƒå°çš„æ•°æ®é›†ä¸­ï¼ŒMAE å—å¼‚å¸¸å€¼çš„å½±å“è¾ƒå°ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ WMAE è€Œä¸æ˜¯æ™®é€šçš„ MAEï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦å¢åŠ å‡æœŸå‘¨é”€å”®çš„å½±å“ï¼Œå› ä¸ºæ²ƒå°”ç›æ ¹æ®å³å°†åˆ°æ¥çš„å‡æœŸè®¡åˆ’æ´»åŠ¨ã€‚å¾ˆæ˜æ˜¾ï¼ŒWMAE å°±æ˜¯è¿™ä¹ˆåšçš„ï¼Œå› ä¸ºå®ƒç»™äº†æ”¾å‡çš„é‚£å‡ å‘¨ 5 å€çš„æƒé‡ã€‚

> æ³¨:æ¨¡å‹çš„ WMAE å€¼è¶Šå°ï¼Œæ¨¡å‹æ€§èƒ½è¶Šå¥½ã€‚

## 6.æ•°æ®é›†ä¿¡æ¯

*æ²ƒå°”ç›æä¾›äº†å››ä¸ªæ•°æ®é›†:è¿™é‡Œçš„æ•°æ®æºé“¾æ¥æ˜¯**ã€‚*

***Stores.csv***

å®ƒæœ‰ä¸‰åˆ—ã€‚åº—é“º:åº—é“ºç¼–å·ä» 1 åˆ° 45ï¼Œå°ºå¯¸:åº—é“ºå°ºå¯¸å·²æä¾›ï¼Œç±»å‹:åº—é“ºç±»å‹å·²æä¾›ï¼Œæœ‰ Aã€Bã€C ä¸‰ç§ç±»å‹ã€‚

***Train.csv***

å®ƒæœ‰äº”åˆ—ã€‚ Store:å•†åº—ç¼–å·ï¼ŒDept:éƒ¨é—¨ç¼–å·ï¼ŒDate:æ˜ŸæœŸï¼ŒWeekly_Sales:ç»™å®šå•†åº—ä¸­ç»™å®šéƒ¨é—¨çš„é”€å”®é¢ï¼ŒIsHoliday:è¯¥å‘¨æ˜¯å¦ä¸ºç‰¹æ®Šå‡æ—¥å‘¨

***test . CSV****ä¸ train.csv ç›¸åŒï¼Œåªæ˜¯å®ƒæ²¡æœ‰ IsHoliday åˆ—ã€‚*

***Features.csv***

å®ƒæœ‰åä¸€åˆ—ã€‚å•†åº—:å•†åº—ç¼–å·ï¼Œæ—¥æœŸ:æ˜ŸæœŸï¼Œæ¸©åº¦:è¯¥åœ°åŒºçš„å¹³å‡æ¸©åº¦ï¼Œç‡ƒæ–™ä»·æ ¼:è¯¥åœ°åŒºçš„ç‡ƒæ–™æˆæœ¬ï¼Œå‡ä»· 1â€“5:ä¸æ²ƒå°”ç›æ­£åœ¨è¿›è¡Œçš„ä¿ƒé”€å‡ä»·ç›¸å…³çš„åŒ¿åæ•°æ®ã€‚é™ä»·æ•°æ®ä»…åœ¨ 2011 å¹´ 11 æœˆåå¯ç”¨ï¼Œå¹¶éæ‰€æœ‰å•†åº—éƒ½éšæ—¶å¯ç”¨ã€‚ä»»ä½•ç¼ºå°‘çš„å€¼éƒ½æ ‡æœ‰å®‰å¨œã€‚æ•°æ®é›†ä¸­åŒ…æ‹¬é€‰å®šçš„å‡æ—¥é™ä»·äº‹ä»¶ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œè¿™äº›é™ä»·ä¼šå½±å“é”€å”®ï¼Œä½†è¦é¢„æµ‹å“ªäº›éƒ¨é—¨ä¼šå—åˆ°å½±å“ä»¥åŠå½±å“çš„ç¨‹åº¦æ˜¯å¾ˆå›°éš¾çš„ã€‚3 CPIâ€”â€”æ¶ˆè´¹è€…ä»·æ ¼æŒ‡æ•°ï¼Œå¤±ä¸š:å¤±ä¸šç‡ï¼Œå‡æ—¥:ä¸€å‘¨æ˜¯å¦æ˜¯ç‰¹æ®Šå‡æ—¥

**æ²¡æœ‰ä½å»¶è¿Ÿè¦æ±‚ï¼Œæ¨¡å‹èŠ±è´¹çš„æ—¶é—´è¶³å¤Ÿäº†ã€‚**

# 7.æ¢ç´¢æ€§æ•°æ®åˆ†æ(EDA):

> åœ¨æœºå™¨å­¦ä¹ /æ·±åº¦å­¦ä¹ ä¸­ï¼Œå½“åŠ¡ä¹‹æ€¥æ˜¯çŸ¥é“ä»€ä¹ˆæ˜¯ä»€ä¹ˆï¼Œæ€æ ·æ˜¯ä»€ä¹ˆï¼Ÿåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†é—®é¢˜çš„å®šä¹‰ï¼Œæˆ‘ä»¬ä¹Ÿæ¸…æ¥šæˆ‘ä»¬æƒ³è¦è¾¾åˆ°çš„ç›®æ ‡ã€‚ä½†æˆ‘ä»¬å¦‚ä½•å®ç°å®ƒæ‰æ˜¯æœ€é‡è¦çš„ã€‚ä¸ºäº†å‰è¿›ï¼Œæˆ‘ä»¬éœ€è¦å·²ç»æä¾›ç»™æˆ‘ä»¬çš„æ•°æ®ã€‚æˆ‘ä»¬å°†æ‰§è¡Œç§°ä¸ºæ¢ç´¢æ€§æ•°æ®åˆ†æçš„è¿‡ç¨‹ï¼Œè¿™æ˜¯ä¸€ç§åˆ†ææ•°æ®é›†ä»¥æ€»ç»“å…¶ä¸»è¦ç‰¹å¾çš„æ–¹æ³•ï¼Œé€šå¸¸é‡‡ç”¨å¯è§†åŒ–æ–¹æ³•ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å°†å¯¼å…¥æ‰€æœ‰éœ€è¦çš„åº“ã€‚

![](img/e2506e5f6a97776daca46b4adf8d1ac3.png)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åŠ è½½æ‰€æœ‰æ•°æ®é›†:

![](img/80369872a1aa2dc2959c7999a8f9b145.png)

**ç°åœ¨æˆ‘ä»¬ä» train.csv æ–‡ä»¶**çš„æ—¥æœŸç‰¹å¾ä¸­æå–ä¸€äº›æ—¶é—´ç›¸å…³ç‰¹å¾

![](img/87abe072b0322351fd324d129cff8ce2.png)

ç°åœ¨è®©æˆ‘ä»¬æ£€æŸ¥åœ¨æ‰€æä¾›çš„æ—¶é—´æ®µå†…æ˜¯å¦æœ‰ä»»ä½•è¶‹åŠ¿ã€æ³¢åŠ¨æˆ–éšæœºäº‹ä»¶å‘ç”Ÿã€‚

![](img/778aed36988dd34be9c9c9a55951cb80.png)

## è§‚å¯Ÿ:

ä»æŠ˜çº¿å›¾å¯ä»¥çœ‹å‡ºï¼Œæ²¡æœ‰å¹´åº¦è¶‹åŠ¿ï¼Œä¹Ÿæ²¡æœ‰éšæœºäº‹ä»¶åœ¨ä»»ä½•ä¸€å¹´å‘ç”Ÿã€‚

è¿˜å¯ä»¥çœ‹åˆ°ï¼Œä¸å…¶ä»–æœˆä»½ç›¸æ¯”ï¼Œå¹´åº•çš„é”€å”®é¢å¾ˆé«˜ï¼Œè¿™è¡¨æ˜åœ£è¯èŠ‚å’Œæ„Ÿæ©èŠ‚å¯¹é”€å”®é¢çš„å½±å“æ¯”è¶…çº§ç¢—å’ŒåŠ³åŠ¨èŠ‚æ›´å¤§ã€‚

æˆ‘ä»¬å¯ä»¥åˆ›å»ºåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ç»™æ¯ä¸ªå‡æœŸå•ç‹¬çš„ç±»åˆ«

**å‘¨ç‰¹å¾æŠ˜çº¿å›¾**

![](img/f1d0fa99a04bc80fd21b4c7611d90a9e.png)

**è§‚å¯Ÿ:**

è¿™å¯èƒ½æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ç‰¹æ€§ï¼Œå› ä¸º line æ¯å‘¨éƒ½åœ¨æ³¢åŠ¨ã€‚åŒæ ·ï¼Œåœ¨åœ£è¯èŠ‚å’Œæ„Ÿæ©èŠ‚åˆ°æ¥çš„æ—¶å€™ï¼Œç¬¬ 45 åˆ° 50 å‘¨çš„é”€å”®é¢æ›´é«˜ã€‚

**ç„¶åæˆ‘ä»¬å°† train.csv ä¸ stores.csv å’Œ features.csv åˆå¹¶ï¼Œä»¥è·å¾— train.csv ä¸­æ¯ä¸ªæ•°æ®ç‚¹çš„æ›´å¤šç‰¹å¾**

![](img/99f7d0e1c6a8f8250bb578e3caa71538.png)![](img/d9bfa8682d7663f9776af95b6205a104.png)

ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å“ªäº›ç‰¹æ€§ä¸ Weekly_Sales æ›´ç›¸å…³ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»è®°ä½ï¼Œæœ‰ä¸€äº›åˆ†ç±»ç‰¹å¾å’Œä¸€äº›æ•°å­—ç‰¹å¾ï¼ŒWeekly_Sales æœ¬è´¨ä¸Šä¹Ÿæ˜¯æ•°å­—çš„ã€‚å› æ­¤ï¼Œè¦æ£€æŸ¥æ•°å­—ç‰¹å¾ä¸ Weekly_Sales çš„ç›¸å…³æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨ [Pearson ç›¸å…³ç³»æ•°](https://en.wikipedia.org/wiki/Pearson_correlation_coefficient)æˆ– [Spearman ç­‰çº§ç›¸å…³ç³»æ•°](https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient)è¿™ä¸¤ç§æ–¹æ³•éƒ½å¹¿æ³›ç”¨äºæ•°å­—ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§ã€‚ä¸ºäº†æ£€æŸ¥åˆ†ç±»ç‰¹å¾å’Œæ•°å­—ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³•å«åš [eta å¹³æ–¹æ£€éªŒ](https://www.statisticshowto.com/eta-squared/)ã€‚

![](img/a6acad93a73ac118c3ff0e0fad3aac1e.png)

**åˆ†ç±»ç‰¹å¾ä¸å‘¨é”€å”®é¢çš„ç›¸å…³æ€§**

```
Correlation of store feature with Weekly_Sales
0.09320619110455744
**************************************************
Correlation of Department feature with Weekly_Sales
0.5368007370698533
**************************************************
Correlation of Type feature with Weekly_Sales
1.8841978383051284e-07
**************************************************
```

å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œéƒ¨é—¨ç‰¹å¾ä¸å‘¨é”€å”®é¢é«˜åº¦ç›¸å…³ã€‚

å•†åº—ç‰¹å¾ä¹Ÿä¸å‘¨é”€å”®é¢é€‚åº¦ç›¸å…³ã€‚

**æ•°å­—ç‰¹å¾ä¸å‘¨é”€å”®é¢çš„ç›¸å…³æ€§**

![](img/97befd2cf7d3e4e0d3e0b2a13a1bd5e7.png)

Heat Map of Correlation between Numerical Features

**è§‚å¯Ÿ:**

è§„æ¨¡ä¸å‘¨é”€å”®é¢æœ€ç›¸å…³ã€‚

å¤§å¤šæ•°ç‰¹å¾ä¸å°ºå¯¸ç›¸å…³ï¼Œè¿™åœ¨ä½¿ç”¨æœºå™¨å­¦ä¹ é¢„æµ‹é”€å”®æ—¶å¹¶ä¸å¥½(ç‚¹å‡»[æ­¤å¤„](https://datascience.stackexchange.com/questions/24452/in-supervised-learning-why-is-it-bad-to-have-correlated-features)äº†è§£åŸå› )ã€‚å› æ­¤ï¼Œå¤§å¤šæ•°åŠŸèƒ½å¯èƒ½æ˜¯æ— ç”¨çš„ï¼Œå¯ä»¥åœ¨ä»¥ååˆ é™¤ã€‚

**è®©æˆ‘ä»¬ä½¿ç”¨ç®€å•éšæœºæ£®æ—æ¨¡å‹æ¥æ£€æŸ¥å“ªäº›ç‰¹å¾æ˜¯é‡è¦çš„ã€‚**

```
Top 5 Important Features:
['Dept', 'Size', 'Store', 'Week', 'CPI']
```

å› æ­¤ï¼ŒæˆåŠŸåœ°å®Œæˆäº†ä¸Šè¿°åˆ†æã€‚

**è®©æˆ‘ä»¬åˆ†åˆ«äº†è§£æ•°æ®é›†ä¸­æ‰€æœ‰è¦ç´ çš„åˆ†å¸ƒ**

**ç±»å‹ç‰¹å¾:**

![](img/fce44cf149eb585c83df3020f7f58a1c.png)

**è§‚å¯Ÿ**:A å‹åº—å¾ˆå¤šï¼ŒC å‹åº—å¾ˆå°‘

![](img/46f97ed73c646a729c26f0554c455e77.png)

è§‚å¯Ÿ:æ¯ç±»åº—é“ºçš„ä¸­ä½æ•°ä»å·¦åˆ°å³é€’å‡ï¼Œå³**ã€‚**ï¼Œä» A åº—åˆ° c åº—ã€‚

**åº—é“ºç‰¹è‰²:**

![](img/e5c9b1e6e666fb2080bf062080989ee9.png)

**è§‚å¯Ÿ:**

å•†åº—ç‰¹å¾æ˜¯é¢„æµ‹é”€å”®çš„æœ‰ç”¨ç‰¹å¾ã€‚å› ä¸ºæ¯ä¸ªå•†åº—éƒ½æœ‰ä¸åŒå«ä¹‰ã€‚å‡è®¾:è¯¥ç‰¹å¾åŒ…æ‹¬éƒ¨é—¨ã€è§„æ¨¡æˆ–ç±»å‹ï¼Œä»¥åŠæ•°æ®é›†ä¸­æœªæä¾›çš„åœ°åŒºã€‚

**éƒ¨é—¨ç‰¹è‰²:**

![](img/020e4ceb81875a8cc152fc98cf71074d.png)

Box plot of Department feature

**è§‚å¯Ÿ:**

éƒ¨é—¨å¯èƒ½æ˜¯é¢„æµ‹é”€å”®é¢çš„ä¸€ä¸ªå› ç´ ï¼Œå› ä¸ºé€šè¿‡ç®±çº¿å›¾å¯ä»¥çœ‹å‡ºï¼Œæ¯ä¸ªéƒ¨é—¨çš„é”€å”®é¢éƒ½ä¸åŒäºå…¶ä»–éƒ¨é—¨ã€‚æ­¤å¤–ï¼Œéƒ¨é—¨ç‰¹å¾ä¸ç±»å‹ç‰¹å¾çš„ç»„åˆä¹Ÿå¢å¼ºäº†æ›´å‡†ç¡®åœ°é¢„æµ‹é”€å”®é¢çš„èƒ½åŠ›ï¼Œå› ä¸ºå¯ä»¥çœ‹å‡ºç±»å‹ A åœ¨å¤§å¤šæ•°éƒ¨é—¨ä¸­å…·æœ‰æ›´é«˜çš„é”€å”®é¢ã€‚

**CPI ç‰¹å¾(æ•°å€¼ç‰¹å¾):**

![](img/661a22c043c485c412720fec17d507a6.png)

PDF and Box plot of CPI feature

**è§‚å¯Ÿ:**

CPI åœ¨ 160 åˆ° 180 ä¹‹é—´ï¼Œå› ä¸ºæ²¡æœ‰æ•°æ®ï¼Œæ‰€ä»¥æ²¡æœ‰é”€å”®ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ç‰¹å®šæ—¶æœŸå†…æ¶ˆè´¹ä»·æ ¼æŒ‡æ•°å˜åŒ–æ²¡æœ‰å¤ªå¤§å·®åˆ«ã€‚

**å¤±ä¸šç‰¹å¾:**

![](img/1e93c621db0ecf9d3fd3674797d7253f.png)

PDF and Box plot of Unemployment feature

**è§‚å¯Ÿ:**

æ‰€æœ‰ç®±çº¿å›¾èŒƒå›´å¹³å‡å€¼ç›¸å¯¹æ¥è¯´æ˜¯ç›¸ç­‰çš„ï¼Œå› æ­¤å®ƒåœ¨ç¡®å®šå•†åº—çš„é”€å”®é¢æ—¶æ²¡æœ‰ç”¨ã€‚æ‰€ä»¥è¿™ä¸ªåŠŸèƒ½å¯ä»¥å»æ‰ã€‚

**ç‡ƒæ²¹ä»·æ ¼ç‰¹æ€§:**

![](img/a99369742a61b34df478e7f3892b1f30.png)

PDF and Box plot of Fuel Price feature

**è§‚å¯Ÿ:**

ç‡ƒæ–™ä»·æ ¼å¯¹é”€å”®çš„å½±å“å¾ˆå°ï¼Œå› ä¸ºéšç€ç‡ƒæ–™ä»·æ ¼çš„å¢åŠ ï¼Œé”€å”®æ²¡æœ‰å˜åŒ–ã€‚æ‰€ä»¥è¿™ä¸ªåŠŸèƒ½ä¹Ÿå¯ä»¥å»æ‰ã€‚

**æ¸©åº¦ç‰¹æ€§:**

![](img/5d2f39f545fce5049395e54b5e73f618.png)

PDF and Box plot of Temperature feature

**è§‚å¯Ÿ:**

è¿™ä¸€åŠŸèƒ½ä¹Ÿå¯ä»¥å–æ¶ˆï¼Œå› ä¸ºåœ¨ä»»ä½•æ¸©åº¦èŒƒå›´å†…é”€å”®éƒ½æ²¡æœ‰å˜åŒ–ã€‚

*æ³¨æ„:å› ä¸ºé”€å”®é¢ä¸èƒ½ä¸ºè´Ÿï¼Œæ‰€ä»¥åˆ é™¤é”€å”®é¢ä¸ºè´Ÿçš„æ‰€æœ‰æ•°æ®ç‚¹ã€‚*

> æˆ‘ä»¬å†æå–ä¸€äº›ç‰¹å¾ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ç”¨ã€‚

**è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŠŸèƒ½ï¼ŒæŸ¥æ‰¾ä¸€å‘¨ä¸­çš„å‡æœŸæ•°ã€‚**

![](img/793efe57bed2b6d190cb035f4251a6cc.png)![](img/a028cd48b2865c37c290941b570680ce.png)

Histogram of Holidays

**è§‚å¯Ÿ:**

å¾ˆå°‘æœ‰ä¸€å‘¨æœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„å‡æœŸï¼Œä¸€å‘¨ä¸­çš„å¤§éƒ¨åˆ†æ—¶é—´éƒ½æ²¡æœ‰å‡æœŸã€‚

![](img/38dcccf25764abe7b856d6b1c67c6c0b.png)

**è§‚å¯Ÿ:**

é”€å”®é¢éšç€ä¸€å‘¨å‡æ—¥æ•°çš„å˜åŒ–è€Œå˜åŒ–ã€‚æ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªæœ‰ç”¨ç‰¹æ€§ã€‚

**æ— æ•ˆ** **ç‰¹å¾æå–ã€‚**

æˆ‘ä»¬è¿˜å°è¯•äº†æœˆæœ«åŠŸèƒ½å’ŒæœˆåˆåŠŸèƒ½ï¼Œå› ä¸ºäººä»¬å¾€å¾€åœ¨æœˆæœ«ä¼šæœ‰è¾ƒå°‘çš„å·¥èµ„ï¼Œè€Œåœ¨æœˆåˆäººä»¬ä¼šå¾—åˆ°å·¥èµ„ï¼Œä½†è¿™äº›åŠŸèƒ½è¢«è¯æ˜æ˜¯æ— ç”¨çš„ã€‚

```
Correlation of Is_month_end feature with weekly_sales
5.109982375092706e-06
**************************************************
Correlation of Is_month_start feature with weekly_sales
1.919291806025242e-05
**************************************************
```

ç›¸å…³å€¼å¾ˆå°‘è¢«ç§°ä¸ºæœ‰ç”¨ã€‚

ä½¿ç”¨[è‡ªåŠ¨ç¼–ç å™¨](https://machinelearningmastery.com/autoencoder-for-classification/)æå–ç‰¹å¾ä¹Ÿæ²¡æœ‰ç”¨ã€‚

![](img/19360154e33ed009e70e408e4c4b42ca.png)

ä½¿ç”¨è‡ªåŠ¨ç¼–ç å™¨åŠŸèƒ½åï¼ŒWMAE å¢åŠ ï¼Œè¿™æ„å‘³ç€æ¨¡å‹æ€§èƒ½ä¸‹é™ã€‚

## æˆ‘ä»¬å‘ç°æ„Ÿæ©èŠ‚å’Œåœ£è¯èŠ‚æ¯”å…¶ä»–ä¸¤ä¸ªæ›´æœ‰å½±å“åŠ›ã€‚æ‰€ä»¥æ¯ä¸ªèŠ‚æ—¥éƒ½æœ‰ä¸åŒç¨‹åº¦çš„å½±å“ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ¶ä½œä¸€ä¸ªå‡æ—¥ç±»åˆ«ä½œä¸ºç‰¹è‰²ã€‚

**ç°åœ¨è®©æˆ‘ä»¬æ£€æŸ¥ Nan å€¼çš„å½±å“**

```
Feature         Nan values fractionStore           0.000000
Dept            0.000000
Date            0.000000
Weekly_Sales    0.000000
IsHoliday       0.000000
Year            0.000000
Month           0.000000
Week            0.000000
Day             0.000000
n_days          0.000000
Type            0.000000
Size            0.000000
Temperature     0.000000
Fuel_Price      0.000000
MarkDown1       0.642572
MarkDown2       0.736110
MarkDown3       0.674808
MarkDown4       0.679847
MarkDown5       0.640790
CPI             0.000000
Unemployment    0.000000
dtype: float64
```

é€šè¿‡è¿™ä¸€ç‚¹ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°é™ä»·ä»·å€¼å…·æœ‰é«˜ç™¾åˆ†æ¯”çš„ Nan å€¼ã€‚

**ç”±äºé™ä»·äº‹ä»¶å‘ç”Ÿåœ¨å‡æœŸä¹‹å‰ï¼Œå› æ­¤å¯èƒ½ä¼šå¯¹ Weekly_Sales äº§ç”Ÿå½±å“ã€‚æ‰€ä»¥ç®€å•åœ°ç»™ 0 æˆ–åˆ é™¤è¿™äº›åˆ—å¯èƒ½ä¼šä¸¢å¤±ä¸€äº›ä¿¡æ¯ã€‚è®©æœºå™¨å­¦ä¹ æ¨¡å‹å­¦ä¹ éšè—åœ¨å…¶ä¸­çš„æ¨¡å¼ï¼Œç„¶åå¡«å……ç©ºå€¼ã€‚**

```
Features         Nan values fractionStore            0.000000
Dept             0.000000
Date             0.000000
Weekly_Sales     0.000000
IsHoliday        0.000000
Year             0.000000
Month            0.000000
Week             0.000000
Day              0.000000
n_days           0.000000
Type             0.000000
Size             0.000000
Temperature      0.000000
Fuel_Price       0.000000
MarkDown1        0.000000
MarkDown2        0.000000
MarkDown3        0.000000
MarkDown4        0.000000
MarkDown5        0.000000
CPI              0.000000
Unemployment     0.000000
dtype: float64
```

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹é™ä»·ä»·å€¼æœ‰å¤šæœ‰ç”¨ã€‚

![](img/9a27f19740ec32350d61229e78d2b8a3.png)

Heat map of markdown values and Weekly_Sales

**è§‚å¯Ÿ:**

ç°åœ¨é™ä»·ä»·å€¼ä¸å‘¨é”€å”®é¢çš„ç›¸å…³æ€§å¾ˆå°ã€‚è€Œ markdown 1 å’Œ markdown4 ä¹Ÿæ˜¯é«˜åº¦ç›¸å…³çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ”¾å¼ƒä»–ä»¬ã€‚

# 8.åŸºçº¿æ¨¡å‹:

åŸºçº¿æ˜¯ä¸€ç§ä½¿ç”¨å¯å‘å¼ã€ç®€å•æ±‡æ€»ç»Ÿè®¡ã€éšæœºæ€§æˆ–æœºå™¨å­¦ä¹ æ¥ä¸ºæ•°æ®é›†åˆ›å»ºé¢„æµ‹çš„æ–¹æ³•ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›é¢„æµ‹æ¥è¡¡é‡åŸºçº¿çš„æ€§èƒ½(ä¾‹å¦‚ï¼ŒWMAE)ï¼Œç„¶åè¿™ä¸ªæŒ‡æ ‡å°†æˆä¸ºæ‚¨ä¸ä»»ä½•å…¶ä»–æœºå™¨å­¦ä¹ ç®—æ³•è¿›è¡Œæ¯”è¾ƒçš„æ ‡å‡†ã€‚

```
Mean = np.mean(train['Weekly_Sales'])
predicted value  = np.full((train.shape[0]), Mean)
print("Model Performance(WMAE) of Mean Model: ",WMAE(train,train['Weekly_Sales'], predicted value))Model Performance(WMAE) of Mean Model:  15350.22Median **=** np.median(train['Weekly_Sales'])
predicted_value  **=** np.full((train.shape[0]), Median)print("Model Performance(WMAE) of Median Model: ",WMAE(train,train['Weekly_Sales'], predicted_value))Model Performance(WMAE) of Median Model:  13625.26
```

# 9.æ•°æ®é¢„å¤„ç†:

**é¢„å¤„ç†æ•°æ®è¿›è¡Œè®­ç»ƒã€‚**

**å¯¹æµ‹è¯•æ•°æ®è¿›è¡Œé¢„å¤„ç†ã€‚**

# 10.å‹å·:

**è®©æˆ‘ä»¬ä½¿ç”¨ WMAE ä½œä¸ºæ€§èƒ½æŒ‡æ ‡æ¥æ£€æŸ¥å“ªäº›æ¨¡å‹æ€§èƒ½æœ€ä½³ï¼Œä»¥æ’é™¤æ‰€æœ‰ç”¨äºè¶…å‚æ•°è°ƒæ•´çš„åæ¨¡å‹ã€‚**

```
WMAE score of  linear regression  :  1.3978614345983337e+18
----------------------------------------------------------------------------------------------------
WMAE score of  SVR  :  734286.36
----------------------------------------------------------------------------------------------------
WMAE score of  RidgeCV  :  14816.99
----------------------------------------------------------------------------------------------------
WMAE score of  ElasticNet  :  14775.04
----------------------------------------------------------------------------------------------------
WMAE score of  RandomForest  :  1424.24
----------------------------------------------------------------------------------------------------
WMAE score of  XGboost  :  4244.98
----------------------------------------------------------------------------------------------------
```

RandomForest å’Œ XGboost æ˜¯æœ€å¥½çš„æ¨¡å‹ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯•è¯•å¼¹åŠ›ç½‘ã€‚

**è®©æˆ‘ä»¬è¶…è°ƒå‰é¢æåˆ°çš„æ¨¡å‹**

**éšæœºæ£®æ—å›å½’å™¨**

```
n_estimators = [100,120,140]
max_depth = [25, 27, 30]
random_forest(n_estimators, max_depth)k: 1 , n_estimators: 100 , max_depth: 25
k: 2 , n_estimators: 100 , max_depth: 25
k: 3 , n_estimators: 100 , max_depth: 25
k: 4 , n_estimators: 100 , max_depth: 25
WMAE: 1446.8874999999998
k: 1 , n_estimators: 100 , max_depth: 27
k: 2 , n_estimators: 100 , max_depth: 27
k: 3 , n_estimators: 100 , max_depth: 27
k: 4 , n_estimators: 100 , max_depth: 27
WMAE: 1406.7475000000002
k: 1 , n_estimators: 100 , max_depth: 30
k: 2 , n_estimators: 100 , max_depth: 30
k: 3 , n_estimators: 100 , max_depth: 30
k: 4 , n_estimators: 100 , max_depth: 30
WMAE: 1417.2475
k: 1 , n_estimators: 120 , max_depth: 25
k: 2 , n_estimators: 120 , max_depth: 25
k: 3 , n_estimators: 120 , max_depth: 25
k: 4 , n_estimators: 120 , max_depth: 25
WMAE: 1419.4924999999998
k: 1 , n_estimators: 120 , max_depth: 27
k: 2 , n_estimators: 120 , max_depth: 27
k: 3 , n_estimators: 120 , max_depth: 27
k: 4 , n_estimators: 120 , max_depth: 27
WMAE: 1415.1875
k: 1 , n_estimators: 120 , max_depth: 30
k: 2 , n_estimators: 120 , max_depth: 30
k: 3 , n_estimators: 120 , max_depth: 30
k: 4 , n_estimators: 120 , max_depth: 30
WMAE: 1411.4775
k: 1 , n_estimators: 140 , max_depth: 25
k: 2 , n_estimators: 140 , max_depth: 25
k: 3 , n_estimators: 140 , max_depth: 25
k: 4 , n_estimators: 140 , max_depth: 25
WMAE: 1419.2275
k: 1 , n_estimators: 140 , max_depth: 27
k: 2 , n_estimators: 140 , max_depth: 27
k: 3 , n_estimators: 140 , max_depth: 27
k: 4 , n_estimators: 140 , max_depth: 27
WMAE: 1412.5725000000002
k: 1 , n_estimators: 140 , max_depth: 30
k: 2 , n_estimators: 140 , max_depth: 30
k: 3 , n_estimators: 140 , max_depth: 30
k: 4 , n_estimators: 140 , max_depth: 30
WMAE: 1429.3125
```

*æœ€ä½³å‚æ•°æ˜¯ n_estimators = 100ï¼Œmax_depth = 27*

ç°åœ¨è®©æˆ‘ä»¬ç”¨æœ€ä½³å‚æ•°è®­ç»ƒéšæœºæ£®æ—ã€‚

```
RF = RandomForestRegressor(n_estimators= 100 , max_depth= 27)
RF.fit(data,train['Weekly_Sales'])
```

ä½¿ç”¨ Kaggle åœ¨éšæœºæ£®æ—çš„æµ‹è¯•æ•°æ®é›†ä¸Šé¢„æµ‹å‘¨é”€å”®é¢çš„ WMAE å¾—åˆ†ã€‚

![](img/4149401d1b42028c42995a65a9e97890.png)

**ç”¨ XGboost å›å½’å™¨è®­ç»ƒæ•°æ®é›†ã€‚**

```
max_depth = [20,25]
n_estimators = [6000,7000,8000]
gbdt(n_estimators, max_depth)k: 1 , n_estimators: 6000 , max_depth: 20
k: 2 , n_estimators: 6000 , max_depth: 20
k: 3 , n_estimators: 6000 , max_depth: 20
k: 4 , n_estimators: 6000 , max_depth: 20
WMAE: 1423.1125
k: 1 , n_estimators: 6000 , max_depth: 25
k: 2 , n_estimators: 6000 , max_depth: 25
k: 3 , n_estimators: 6000 , max_depth: 25
k: 4 , n_estimators: 6000 , max_depth: 25
WMAE: 1436.5400000000002
k: 1 , n_estimators: 7000 , max_depth: 20
k: 2 , n_estimators: 7000 , max_depth: 20
k: 3 , n_estimators: 7000 , max_depth: 20
k: 4 , n_estimators: 7000 , max_depth: 20
WMAE: 1416.3425000000002
k: 1 , n_estimators: 7000 , max_depth: 25
k: 2 , n_estimators: 7000 , max_depth: 25
k: 3 , n_estimators: 7000 , max_depth: 25
k: 4 , n_estimators: 7000 , max_depth: 25
WMAE: 1405.5575
k: 1 , n_estimators: 8000 , max_depth: 20
k: 2 , n_estimators: 8000 , max_depth: 20
k: 3 , n_estimators: 8000 , max_depth: 20
k: 4 , n_estimators: 8000 , max_depth: 20
WMAE: 1382.7775
k: 1 , n_estimators: 8000 , max_depth: 25
k: 2 , n_estimators: 8000 , max_depth: 25
k: 3 , n_estimators: 8000 , max_depth: 25
k: 4 , n_estimators: 8000 , max_depth: 25
WMAE: 1372.6275
```

æœ€ä½³å‚æ•°æ˜¯ n ä¼°è®¡å€¼= 8000ï¼Œæœ€å¤§æ·±åº¦= 25

ç°åœ¨è®©æˆ‘ä»¬ç”¨æœ€ä½³å‚æ•°æ¥è®­ç»ƒ XGboostã€‚

```
gb = lgb.LGBMRegressor(n_estimators=8000, max_depth=25)
gb.fit(data, train['Weekly_Sales'])
```

ä½¿ç”¨ Kaggle é¢„æµ‹ XGboost æµ‹è¯•æ•°æ®é›† Weekly_Sales çš„ WMAE å¾—åˆ†ã€‚

![](img/4c7b6880faea402c253f3716fef01280.png)

**ç”¨ ElasticNet å›å½’å™¨è®­ç»ƒæ•°æ®é›†ã€‚**

```
l1_ratio = np.linspace(0.5, 1.0, num=6)
linear regression(l1_ratio)k: 1 , l1_ratio: 0.5
k: 2 , l1_ratio: 0.5
k: 3 , l1_ratio: 0.5
k: 4 , l1_ratio: 0.5
WMAE: 15394.74
k: 1 , l1_ratio: 0.6
k: 2 , l1_ratio: 0.6
k: 3 , l1_ratio: 0.6
k: 4 , l1_ratio: 0.6
WMAE: 15340.665
k: 1 , l1_ratio: 0.7
k: 2 , l1_ratio: 0.7
k: 3 , l1_ratio: 0.7
k: 4 , l1_ratio: 0.7
WMAE: 15365.2275
k: 1 , l1_ratio: 0.8
k: 2 , l1_ratio: 0.8
k: 3 , l1_ratio: 0.8
k: 4 , l1_ratio: 0.8
WMAE: 15316.400000000001
k: 1 , l1_ratio: 0.9
k: 2 , l1_ratio: 0.9
k: 3 , l1_ratio: 0.9
k: 4 , l1_ratio: 0.9
WMAE: 15389.147500000001
k: 1 , l1_ratio: 1.0
k: 2 , l1_ratio: 1.0
k: 3 , l1_ratio: 1.0
k: 4 , l1_ratio: 1.0
WMAE: 14790.029999999999
```

**æœ€ä½³ l1_ratio = 1.0**

ç°åœ¨è®©æˆ‘ä»¬ç”¨æœ€ä½³å‚æ•°è®­ç»ƒ ElasticNetã€‚

```
lr = ElasticNet(random_state=0,normalize = True,l1_ratio = 1.0)
lr.fit(data, train['Weekly_Sales'])
```

ä½¿ç”¨ Kaggle å¯¹ ElasticNet çš„æµ‹è¯•æ•°æ®é›†é¢„æµ‹ Weekly_Sales çš„ WMAE å¾—åˆ†ã€‚

![](img/eb64cbc77a93e198825f8b0ff444026b.png)

è¿˜å°è¯•äº†[å †å ](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.StackingRegressor.html)å›å½’å™¨ã€‚

ä½¿ç”¨ Kaggle å¯¹å †å æµ‹è¯•æ•°æ®é›†é¢„æµ‹ Weekly_Sales çš„ WMAE å¾—åˆ†ã€‚

![](img/2064430368411096116bbcb3029ee92d.png)

æ‰€æœ‰å‹å·æ€§èƒ½:

![](img/c98cf32f21e5a029b8a48d4b40bb1d2a.png)

## éšæœºæ£®æ—è¢«è¯æ˜æ˜¯æœ€å¥½çš„æ¨¡å‹ã€‚

# 11.éƒ¨ç½²:

![](img/9e0ea8b62c5a70cd18e9acb2e019bb33.png)

æˆ‘ä»¬åœ¨è¿™é‡Œåšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯è¾“å…¥å•†åº—å·ã€éƒ¨é—¨å·ã€è¯¥å‘¨æ˜¯å¦æœ‰å‡æ—¥ä»¥åŠè¯¥å‘¨çš„æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ã€‚åˆ©ç”¨è¿™ä¸ªä¿¡æ¯ç½‘ç«™å·²ç»é¢„æµ‹äº†é‚£ä¸€å‘¨çš„é”€å”®é¢ã€‚

# 12.æœªæ¥å·¥ä½œ:

1.  ç”±äºèµ„æºæœ‰é™ï¼Œæˆ‘ä½¿ç”¨äº† 10 ä¸‡ä¸ªæ•°æ®ç‚¹ã€‚ä½¿ç”¨æ‰€æœ‰æ•°æ®è‚¯å®šä¼šæé«˜æ¨¡å‹çš„æ€§èƒ½ã€‚
2.  å®ç°æ·±åº¦å­¦ä¹ ã€‚

# 13.å‚è€ƒ:

[](https://www.kaggle.com/c/walmart-recruiting-store-sales-forecasting) [## æ²ƒå°”ç›æ‹›è˜-å•†åº—é”€å”®é¢„æµ‹

### ä½¿ç”¨å†å²é™ä»·æ•°æ®é¢„æµ‹å•†åº—é”€å”®é¢

www.kaggle.com](https://www.kaggle.com/c/walmart-recruiting-store-sales-forecasting) [](https://www.appliedaicourse.com/course/11/Applied-Machine-learning-course) [## åº”ç”¨è¯¾ç¨‹

### åº”ç”¨æœºå™¨å­¦ä¹ è¯¾ç¨‹æ–‡å‡­åœ¨äººå·¥æ™ºèƒ½å’Œ ML é—¨ CS æ··åˆè¯¾ç¨‹é¢è¯•å‡†å¤‡è¯¾ç¨‹äººå·¥æ™ºèƒ½å·¥ä½œåŠäººå·¥æ™ºèƒ½â€¦

www.appliedaicourse.com](https://www.appliedaicourse.com/course/11/Applied-Machine-learning-course) [](https://machinelearningmastery.com/basic-feature-engineering-time-series-data-python/) [## Python ä¸­æ—¶é—´åºåˆ—æ•°æ®çš„åŸºæœ¬ç‰¹å¾å·¥ç¨‹-æœºå™¨å­¦ä¹ ç²¾é€š

### åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹ä½¿ç”¨æœºå™¨å­¦ä¹ ä¹‹å‰ï¼Œæ—¶é—´åºåˆ—æ•°æ®å¿…é¡»é‡æ–°æ„å»ºä¸ºç›‘ç£å­¦ä¹ æ•°æ®é›†â€¦

machinelearningmastery.com](https://machinelearningmastery.com/basic-feature-engineering-time-series-data-python/) [](https://barnesanalytics.com/2017/06/14/basics-of-arima-models-with-statsmodels-in-python/) [## Python - Barnes Analytics ä¸­å¸¦ Statsmodels çš„ ARIMA æ¨¡å‹åŸºç¡€

### è®¸å¤šä¼ä¸šä¸­çš„ä¸€ä¸ªå¸¸è§é—®é¢˜æ˜¯é¢„æµ‹æœªæ¥çš„ä»·å€¼ã€‚å®ƒå¯¹è®¾å®šé¢„ç®—å¾ˆæœ‰ç”¨â€¦

barnesanalytics.com](https://barnesanalytics.com/2017/06/14/basics-of-arima-models-with-statsmodels-in-python/) 

ä½ å¯ä»¥åœ¨æˆ‘çš„ Github [**è¿™é‡Œ**](https://github.com/iaayushgupta/walmart) **æ‰¾åˆ°å®Œæ•´çš„ä»£ç ã€‚**

å¾ˆé«˜å…´åœ¨ [**linkedin**](https://www.linkedin.com/in/aayush-gupta-925442190/) ä¸Šä¸æ‚¨è¿çº¿ğŸ˜ƒ