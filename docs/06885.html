<html>
<head>
<title>Virtual Eyes â€” A simple surrounding describing app for the visually impaired</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">è™šæ‹Ÿçœ¼ç›â€”â€”ä¸ºè§†éšœäººå£«è®¾è®¡çš„ç®€å•ç¯å¢ƒæè¿°åº”ç”¨ç¨‹åº</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/virtual-eyes-a-simple-surrounding-describing-app-for-the-visually-impaired-3ac2af7e99f0?source=collection_archive---------43-----------------------#2021-08-31">https://medium.com/geekculture/virtual-eyes-a-simple-surrounding-describing-app-for-the-visually-impaired-3ac2af7e99f0?source=collection_archive---------43-----------------------#2021-08-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7584a0a34dd60781be528c9a6ebcfd23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mY36jccBQ4eTU3_AYyS0YA.jpeg"/></div></div></figure><p id="8ab2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨è¿‡å»çš„å‡ å¹´é‡Œï¼Œå›¾åƒå­—å¹•å¯¹æœºå™¨å­¦ä¹ é¢†åŸŸäº§ç”Ÿäº†å·¨å¤§çš„å½±å“ï¼Œæ–°çš„åº”ç”¨æ¯å¤©éƒ½åœ¨å‡ºç°ã€‚å›¾åƒå­—å¹•æ˜¯ä½¿ç”¨äººå·¥æ™ºèƒ½ã€è®¡ç®—æœºè§†è§‰å’Œæœºå™¨å­¦ä¹ æ¥ç”Ÿæˆå›¾åƒæè¿°çš„èƒ½åŠ›ï¼Œç±»ä¼¼äºäººç±»æè¿°å›¾åƒå†…å®¹çš„æ–¹å¼ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è®¨è®ºæˆ‘å¦‚ä½•åˆ›å»ºä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨å›¾åƒå­—å¹•å‘è§†éšœäººå£«æè¿°å‘¨å›´çš„ç¯å¢ƒã€‚</p><p id="5c63" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¸ºäº†æä¾›è¿™æ¬¾åº”ç”¨çš„æ¦‚è¿°ï¼Œå½“ç”¨æˆ·å‘å‡ºè¯­éŸ³å‘½ä»¤æ—¶ï¼Œå®ƒä½¿ç”¨æ‰‹æœºçš„ä¸»æ‘„åƒå¤´æ¥æ•æ‰ç…§ç‰‡ï¼Œå¹¶ä½¿ç”¨Azureè®¡ç®—æœºè§†è§‰æœåŠ¡ï¼Œè¯¥åº”ç”¨ç”Ÿæˆå­—å¹•ä»¥åŠå¯¹è±¡çš„ä½ç½®æ•°æ®ï¼Œå¹¶ä»¥è‡ªç„¶è¯­è¨€ä¸ç”¨æˆ·äº¤è°ˆã€‚</p><p id="584e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¦‚æœæ‚¨æ¸´æœ›è§‚çœ‹è¯¥åº”ç”¨ç¨‹åºçš„æ¼”ç¤ºï¼Œè¯·é˜…è¯»æœ¬æ–‡æœ«å°¾ã€‚</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h2 id="31f7" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jb kg kh ki jf kj kk kl jj km kn ko kp bi translated"><strong class="ak">å¼€å‘å®‰å“åº”ç”¨</strong></h2><p id="e20e" class="pw-post-body-paragraph iq ir hi is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hb bi translated">ä¸ºäº†å¼€å‘è¿™ä¸ªåº”ç”¨ç¨‹åºï¼Œæˆ‘ä½¿ç”¨äº†Unityå’ŒAzureè®¡ç®—æœºè§†è§‰æœåŠ¡ã€‚æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æ˜¯æ€ä¹ˆåšåˆ°çš„ã€‚</p><ol class=""><li id="21e4" class="kv kw hi is b it iu ix iy jb kx jf ky jj kz jn la lb lc ld bi translated">åˆ›å»ºAzureè®¡ç®—æœºè§†è§‰èµ„æºã€‚</li></ol><p id="4e28" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æˆ‘å†™äº†ä¸€æ•´ç¯‡å…³äºå¦‚ä½•åˆ›å»ºAzureè®¡ç®—æœºè§†è§‰èµ„æºå¹¶åœ¨Unity <a class="ae le" rel="noopener" href="/codex/image-captioning-in-unity-android-using-azure-computer-vision-c9424f9d1ab1">ä¸­ä½¿ç”¨å…¶æœåŠ¡çš„æ–‡ç« ã€‚ä½ å¯ä»¥å‚è€ƒå®ƒæ¥äº†è§£æ›´å¤šå…³äºè®¾ç½®Azureçš„çŸ¥è¯†ï¼Œå› ä¸ºæˆ‘ä¸ä¼šè¯¦ç»†è®¨è®ºè¿™ä¸ªã€‚</a></p><p id="fa90" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.åˆ›å»ºUnity Androidåº”ç”¨ç¨‹åº</p><p id="a7d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æˆ‘é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªç»Ÿä¸€2Dé¡¹ç›®ï¼Œæˆ‘å¿…é¡»æ”¹å˜ä¸€äº›é…ç½®ï¼Œä»¥é€‚åº”è¿™ä¸ªé¡¹ç›®ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><p id="7491" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 1ã€‚æ¢å¹³å°å®‰å“</strong></p><p id="d8c3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">(æ–‡ä»¶-&gt;æ„å»ºè®¾ç½®-&gt; Android -&gt;åˆ‡æ¢å¹³å°)</p><p id="5ba0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2ã€‚å¯¼å…¥Newtonsoft DLLæ–‡ä»¶å¹¶åœ¨Assetsä¸­è®¾ç½®csc.rspæ–‡ä»¶ã€‚</strong></p><p id="4366" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 3ã€‚æ›´æ”¹APIå…¼å®¹çº§åˆ«</strong></p><p id="939a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">'ç¼–è¾‘-&gt;é¡¹ç›®è®¾ç½®-&gt;æ’­æ”¾å™¨-&gt;å…¶ä»–è®¾ç½®-&gt; APIå…¼å®¹çº§åˆ«ä»'ã€‚NET Standard 2.0 'åˆ°'ã€‚NET 4.x '</p><p id="1a47" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨æˆ‘å…³äºä½¿ç”¨Azureè®¡ç®—æœºè§†è§‰çš„Unity Androidä¸­çš„<a class="ae le" rel="noopener" href="/codex/image-captioning-in-unity-android-using-azure-computer-vision-c9424f9d1ab1">å›¾åƒå­—å¹•çš„æ–‡ç« </a>ä¸­ï¼Œå·²ç»è§£é‡Šäº†ä¸Šè¿°æ‰€æœ‰ä»»åŠ¡(å¹¶ç»™å‡ºäº†åŸå› )ã€‚</p><p id="974c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 4ã€‚è®¾ç½®æ–‡æœ¬åˆ°è¯­éŸ³å’Œè¯­éŸ³åˆ°æ–‡æœ¬</strong></p><p id="3d7e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¸ºäº†æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ï¼Œæˆ‘åœ¨ä»–çš„<a class="ae le" href="https://github.com/j1mmyto9/Speech-And-Text-Unity-iOS-Android" rel="noopener ugc nofollow" target="_blank"> Githubåº“</a>ä¸Šä½¿ç”¨äº†<a class="ae le" href="https://github.com/j1mmyto9" rel="noopener ugc nofollow" target="_blank"> j1mmyto9 </a>æä¾›çš„æ’ä»¶ã€‚è¿™ä¸ª<a class="ae le" href="https://www.youtube.com/watch?v=XRXbVtr1fog" rel="noopener ugc nofollow" target="_blank">æ•™ç¨‹</a>è§£é‡Šäº†å¦‚ä½•åœ¨ä½ çš„unityé¡¹ç›®ä¸­ä½¿ç”¨ä¸Šè¿°æ’ä»¶ã€‚</p><p id="6146" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æˆ‘æ˜¯è¿™æ ·åšçš„:</p><ol class=""><li id="580d" class="kv kw hi is b it iu ix iy jb kx jf ky jj kz jn la lb lc ld bi translated">ä¸‹è½½Githubåº“å¹¶è§£å‹æ–‡ä»¶ã€‚</li><li id="c094" class="kv kw hi is b it lf ix lg jb lh jf li jj lj jn la lb lc ld bi translated">æ‰“å¼€â€œSpeechToText_AppleAPI/Assets/â€æ–‡ä»¶å¤¹ï¼Œå°†â€œPluginsâ€å’Œâ€œSpeechAndTextâ€æ–‡ä»¶å¤¹å¤åˆ¶åˆ°Unityé¡¹ç›®çš„Assetsæ–‡ä»¶å¤¹ä¸­ã€‚</li><li id="5c4c" class="kv kw hi is b it lf ix lg jb lh jf li jj lj jn la lb lc ld bi translated">åˆ›å»ºä¸¤ä¸ªåä¸ºâ€œSpeechToTextâ€å’Œâ€œTextToSpeechâ€çš„ç©ºæ¸¸æˆå¯¹è±¡ï¼Œå¹¶å°†åä¸ºâ€œSpeechToText.csâ€å’Œâ€œTextToSpeech.csâ€çš„C#è„šæœ¬åˆ†åˆ«ä½œä¸ºç»„ä»¶æ·»åŠ åˆ°ä¸Šè¿°æ¸¸æˆå¯¹è±¡ä¸­ã€‚</li></ol><p id="1f25" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lk">æ³¨</em> </strong> <em class="lk">:ä¸Šé¢æåˆ°çš„è¿™äº›åå­—ï¼Œè¦å®Œå…¨æŒ‰ç…§è§„å®šã€‚</em></p><p id="6ba1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¦å¤–ï¼Œåœ¨æ£€æŸ¥å™¨ä¸­å–æ¶ˆé€‰ä¸­SpeechToTextè„šæœ¬çš„â€œIsShowPopupAndroidâ€é€‰é¡¹ã€‚</p><p id="4b33" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å®ƒçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/4a233b1e521535ae404d2e463555919d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AagcW78S6tZIAlbJcpaqQw.png"/></div></div></figure><p id="7151" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.åˆ›å»ºä¸€ä¸ªç©ºçš„æ¸¸æˆå¯¹è±¡ï¼Œå¹¶å°†å…¶å‘½åä¸ºâ€œSpeechHandlerâ€(è¿™ä¸ªåç§°å¯ä»¥ä¸åŒ)ã€‚</p><p id="92cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.åˆ›å»ºä¸€ä¸ªåä¸ºâ€œSpeechHandler.csâ€çš„C#è„šæœ¬ï¼Œå¹¶å°†å…¶ä½œä¸ºç»„ä»¶æ·»åŠ åˆ°ä¸Šé¢åˆ›å»ºçš„â€œSpeechHandlerâ€æ¸¸æˆå¯¹è±¡ä¸­ã€‚è¿™ä¸ªè„šæœ¬å°†åŒ…å«å¤„ç†è¯­éŸ³ç›¸å…³åŠŸèƒ½çš„ä»£ç ã€‚</p><p id="8b8b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.åˆ›å»ºä¸€ä¸ªC#è„šæœ¬æ¥ç®¡ç†å‡½æ•°</p><p id="a78f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åˆ›å»ºä¸€ä¸ªåä¸ºâ€œcaption.csâ€çš„C#è„šæœ¬æ¥ç®¡ç†æ‰€æœ‰å…¶ä»–å‡½æ•°ï¼ŒåŒ…æ‹¬APIè°ƒç”¨ã€‚æ¥ä¸‹æ¥ï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºâ€œcaptionHandlerâ€çš„ç©ºæ¸¸æˆå¯¹è±¡ï¼Œå¹¶å°†â€œcaption.csâ€è„šæœ¬æ·»åŠ åˆ°ä¸Šé¢çš„æ¸¸æˆå¯¹è±¡ä¸­ã€‚</p><p id="dee4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 5ã€‚åœ¨Unityä¸­åˆ›å»ºUIç»„ä»¶</strong></p><p id="e6bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åˆ›å»ºä¸€ä¸ªé¢æ¿ï¼Œåœ¨é¢æ¿ä¸‹åˆ›å»ºä¸€ä¸ªRawImage(è®¾ç½®zæ—‹è½¬ä¸º-90)å’Œä¸€ä¸ªText gameobjectä½œä¸ºé¢æ¿çš„å­é¢æ¿ï¼Œåˆ†åˆ«å‘½åä¸ºâ€œCameraFeedâ€å’Œâ€œSpeechStatusâ€ã€‚å¯¹äº†ï¼Œæˆ‘ä»æ¸¸æˆçª—å£æŠŠé•¿å®½æ¯”æ”¹æˆäº†2160x1080äººåƒã€‚æ‚¨å¯èƒ½è¿˜æƒ³è°ƒæ•´UIå…ƒç´ çš„å¤§å°ã€‚</p><p id="3dc0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä»¥ä¸‹æ˜¯æˆ‘çš„è®¾ç½®:</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/21a62ff32d8a2c6904005c5112ad7654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0WSeY2KJu7Vrh-Lx-b-qHA.png"/></div></div></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="33a3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨ï¼Œè®¾ç½®è¿‡ç¨‹å·²ç»å®Œæˆã€‚æ¥ä¸‹æ¥æ˜¯ç¼–ç ä»»åŠ¡ã€‚</p><p id="f39e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">é¦–å…ˆï¼Œæˆ‘å°†è®¨è®ºâ€œcaption.csâ€è„šæœ¬ã€‚</p><p id="0802" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> caption.cs </strong></p><p id="9b06" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¯¥è„šæœ¬åŒ…å«ä»¥ä¸‹æˆå‘˜å˜é‡:</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="52b9" class="jv jw hi ls b fi lw lx l ly lz">// Add your Computer Vision subscription key and endpoint<br/>static string subscriptionKey = "PASTE_YOUR_COMPUTER_VISION_SUBSCRIPTION_KEY_HERE";</span><span id="b99f" class="jv jw hi ls b fi ma lx l ly lz">//azure endpoint<br/>static string endpoint = "PASTE_YOUR_COMPUTER_VISION_ENDPOINT_HERE";</span><span id="cdb5" class="jv jw hi ls b fi ma lx l ly lz">//azure endpoint service accessed<br/>static string captionBase = "vision/v3.2/describe?"; //endpoint to generate image captions</span><span id="e9a0" class="jv jw hi ls b fi ma lx l ly lz">static string objectBase = "vision/v3.2/analyze?"; //endpoint to get object locations</span><span id="fb91" class="jv jw hi ls b fi ma lx l ly lz">//UI Components<br/>[SerializeField] private RawImage cameraFeed;</span><span id="f27a" class="jv jw hi ls b fi ma lx l ly lz">//webcamtexture<br/>private WebCamTexture webcamTexture;</span></pre><p id="e313" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¸Šè¿°å˜é‡ç”¨äºAzureè®¢é˜…å¯†é’¥ã€Azure APIç«¯ç‚¹ã€å°†é™„åŠ åˆ°ç«¯ç‚¹çš„captionBaseå’ŒobjectBaseã€RawImage UIç»„ä»¶å’Œwebcamtextureã€‚</p><p id="e6dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ ‡é¢˜åº“å’Œå¯¹è±¡åº“æ˜¯æˆ‘å‘azureè¯·æ±‚çš„åŠŸèƒ½ã€‚â€œæè¿°â€ç‰¹å¾åŒ…æ‹¬å›¾åƒæ ‡é¢˜ï¼Œè€Œâ€œåˆ†æâ€ç‰¹å¾åŒ…æ‹¬æ£€æµ‹åˆ°çš„ç‰©ä½“ç›¸å¯¹äºå›¾åƒçš„ä½ç½®ã€‚</p><p id="9d77" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘é€‰æ‹©äº†å•ä¸€è®¾è®¡æ¨¡å¼ï¼Œå› æ­¤æˆ‘åˆ›å»ºäº†ä¸€ä¸ªç±»æœ¬èº«çš„å®ä¾‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="5f31" class="jv jw hi ls b fi lw lx l ly lz">//instance of caption class<br/>private static caption instance;</span><span id="541e" class="jv jw hi ls b fi ma lx l ly lz">public static caption Instance<br/>{<br/> get<br/> {<br/>  if (instance == null)<br/>   {<br/>    instance = FindObjectOfType&lt;caption&gt;();<br/>   }<br/>  return instance;<br/> }<br/>}</span></pre><p id="1a7f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥ï¼Œéœ€è¦åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶æ£€æŸ¥ç”¨æˆ·æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•æ¥å®Œæˆã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="4a99" class="jv jw hi ls b fi lw lx l ly lz">void CheckPermissin()<br/>{<br/> if (!Permission.HasUserAuthorizedPermission(Permission.Camera))<br/> {<br/>  Permission.RequestUserPermission(Permission.Camera);<br/> }<br/> if (!Permission.HasUserAuthorizedPermission(Permission.Microphone))<br/> {<br/>  Permission.RequestUserPermission(Permission.Microphone);<br/> }<br/> if(Permission.HasUserAuthorizedPermission(Permission.Camera) &amp;&amp; Permission.HasUserAuthorizedPermission(Permission.Microphone))<br/> {<br/>  //start camera feed if both permissions granted<br/>  startCamera();<br/>  }<br/>}</span></pre><p id="b8d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ­¤æ–¹æ³•æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æˆäºˆäº†éº¦å…‹é£å’Œæ‘„åƒæœºæƒé™ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è¦æ±‚ç”¨æˆ·æˆäºˆæƒé™ã€‚å¦‚æœä¸¤ç§æƒé™éƒ½è¢«æˆäºˆï¼Œè¯¥æ–¹æ³•å°†è°ƒç”¨â€œstartCameraâ€æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯åŠ¨æ‘„åƒæœºå¹¶å°†æ‘„åƒæœºæºåˆ†é…ç»™â€œcamera feedâ€raw imageã€‚æ˜¾ç„¶ï¼Œè¿™å¯¹è§†åŠ›å—æŸçš„äººæ¥è¯´æ²¡æœ‰ç”¨ï¼Œä½†æ˜¯ä¸ºäº†æˆ‘ä»¬çš„æ–¹ä¾¿ï¼Œæˆ‘å·²ç»å®ç°äº†è¿™ä¸€ç‚¹ã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="a728" class="jv jw hi ls b fi lw lx l ly lz">void startCamera()<br/>{<br/> //get all camera devices <br/> WebCamDevice[] cam_devices = WebCamTexture.devices;</span><span id="41d6" class="jv jw hi ls b fi ma lx l ly lz"> //Set a camera to the webcamTexture<br/> webcamTexture = new WebCamTexture(cam_devices[0].name, 480, 640, 30);</span><span id="8a41" class="jv jw hi ls b fi ma lx l ly lz"> //Set the webcamTexture to the texture of the rawimage<br/> cameraFeed.texture = webcamTexture;<br/> cameraFeed.material.mainTexture = webcamTexture;</span><span id="a3ff" class="jv jw hi ls b fi ma lx l ly lz"> //Start the camera<br/> webcamTexture.Play();<br/>}</span></pre><p id="391a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥å‡ºç°çš„é—®é¢˜æ˜¯æˆ‘åº”è¯¥åœ¨å“ªé‡Œè°ƒç”¨â€œCheckPermissionâ€æ–¹æ³•ã€‚ç”±äºæƒé™æ£€æŸ¥æ˜¯å¼‚æ­¥å®Œæˆçš„ï¼Œåº”ç”¨ç¨‹åºæ— éœ€ç­‰å¾…ç”¨æˆ·æƒé™å°±å¼€å§‹è¿è¡Œï¼Œä»è€Œå¯¼è‡´â€œç›¸æœºé¦ˆé€â€åŸå§‹å›¾åƒä¸Šå‡ºç°ç™½å±ï¼Œè€Œä¸æ˜¯æ¸²æŸ“ç›¸æœºé¦ˆé€ã€‚å› æ­¤ï¼Œåœ¨â€œstartâ€æ–¹æ³•ä¸­è°ƒç”¨æ­¤æ–¹æ³•ä¼šå¯¼è‡´æ­¤ç±»é”™è¯¯ã€‚å› æ­¤ï¼Œæˆ‘åœ¨â€œOnApplicationFocusâ€å›è°ƒä¸­è¾“å…¥äº†å¯¹â€œCheckPermissionâ€æ–¹æ³•çš„è°ƒç”¨ï¼Œè¯¥å›è°ƒåœ¨åº”ç”¨ç¨‹åºæ¯æ¬¡è¿”å›ç„¦ç‚¹æ—¶è¿è¡Œï¼Œå› æ­¤å®ƒå°†é‡å¤æ£€æŸ¥æ‰€æœ‰æƒé™ï¼Œç›´åˆ°æ‰€æœ‰æƒé™éƒ½è¢«æˆäºˆã€‚ä¸‹é¢ç»™å‡ºäº†å®ç°è¿™ä¸€ç‚¹çš„ä»£ç ã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="40d3" class="jv jw hi ls b fi lw lx l ly lz">private void OnApplicationFocus(bool focus)<br/>{<br/> //check for permission<br/> CheckPermissin();<br/>}</span></pre><p id="6d08" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªåä¸ºâ€˜save imageâ€™çš„IEnumeratoræ–¹æ³•ï¼Œä»æ‘„åƒæœºè¾“å…¥ä¸­æ•è·å›¾åƒï¼Œå¹¶å°†å›¾åƒå­—èŠ‚æ•°æ®ä¼ é€’ç»™å¦ä¸€ä¸ªå¤„ç†APIè°ƒç”¨çš„æ–¹æ³•ã€‚æ­¤æ–¹æ³•æ˜¯IEnumeratorï¼Œå› ä¸ºå®ƒä½¿ç”¨â€œyield returnâ€æ¥ç­‰å¾…å½“å‰å¸§çš„ç»“æŸã€‚æ­¤å¤–ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°å¯¹â€œRotateTextureâ€æ–¹æ³•çš„è°ƒç”¨ï¼Œè¯¥æ–¹æ³•ç”¨äºå°†Texture2Dæ—‹è½¬ç»™å®šçš„è§’åº¦ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥ä»<a class="ae le" href="https://www.programmersought.com/article/69288818191/" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>å¾—åˆ°ã€‚</p><p id="b8ec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">SaveImage()æ–¹æ³•è¿˜æ¥å—ä¸€ä¸ªå¸ƒå°”å‚æ•°â€œisDescribe â€,å¦‚æœç”¨æˆ·éœ€è¦å›¾åƒæ ‡é¢˜ï¼Œè¯¥å‚æ•°ä¸ºtrueå¦‚æœç”¨æˆ·éœ€è¦ä½ç½®æ•°æ®ï¼Œè¯¥å‚æ•°ä¸ºfalseã€‚</p><p id="447b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¸‹é¢ç»™å‡ºçš„æ˜¯è¿™ç§æ–¹æ³•:</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="ef0d" class="jv jw hi ls b fi lw lx l ly lz">public IEnumerator SaveImage(bool isDescribe)<br/>{<br/> //Create a Texture2D with the size of the rendered image on the screen.<br/> Texture2D texture = new Texture2D(webcamTexture.width, webcamTexture.height, TextureFormat.ARGB32, false);</span><span id="08fd" class="jv jw hi ls b fi ma lx l ly lz"> //wait till end of frame<br/> yield return new WaitForEndOfFrame();</span><span id="ed22" class="jv jw hi ls b fi ma lx l ly lz"> //save webcam frame to texture<br/> texture.SetPixels(webcamTexture.GetPixels());</span><span id="d1f1" class="jv jw hi ls b fi ma lx l ly lz"> //rotate texture<br/> texture = RotateTexture(texture, -90);<br/> texture.Apply();</span><span id="2ea3" class="jv jw hi ls b fi ma lx l ly lz"> //check user requirement whether caption or object position <br/> if (isDescribe)<br/> {<br/>  getCaption(texture.EncodeToPNG());<br/> }<br/> else<br/> {<br/>  getObjects(texture.EncodeToPNG());<br/> }<br/>}</span></pre><p id="fa86" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘å°†è®¨è®ºä»â€œSaveImageâ€æ–¹æ³•è°ƒç”¨çš„â€œgetCaptionâ€å’Œâ€œgetObjectsâ€æ–¹æ³•ã€‚</p><p id="3a90" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">â€œgetCaptionâ€æ–¹æ³•åŒ…å«åˆ›å»ºæœ€ç»ˆuriBaseçš„ä»£ç ä»¥åŠå¿…è¦çš„è¯·æ±‚å‚æ•°ã€‚ç„¶åï¼Œè¯¥æ–¹æ³•å°†è¿™äº›æ•°æ®ä¸å›¾åƒå­—èŠ‚æ•°ç»„ä¸€èµ·ä¼ é€’ç»™â€œMakeRequestâ€æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è°ƒç”¨APIå¹¶è¿”å›æ•°æ®ã€‚æ¥ä¸‹æ¥ï¼Œéœ€è¦å¤„ç†è¿”å›çš„æ•°æ®ä»¥æå–æ ‡é¢˜ï¼Œè¿™æ˜¯é€šè¿‡è°ƒç”¨â€œconvertCaptionâ€æ–¹æ³•å®Œæˆçš„ï¼Œç„¶åä¼ é€’ç»™SpeechHandler(å¾ˆå¿«å°±ä¼šå®ç°)ä»¥æœ—è¯»æ ‡é¢˜ã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="280c" class="jv jw hi ls b fi lw lx l ly lz">public async void getCaption(byte[] imageBytes)<br/>{<br/> //uri<br/> string uriBase = endpoint + captionBase;</span><span id="d9e8" class="jv jw hi ls b fi ma lx l ly lz"> // Request parameters<br/> var requestParameters = HttpUtility.ParseQueryString(string.Empty);<br/> requestParameters["maxCandidates"] = "1";<br/> requestParameters["language"] = "en";<br/> requestParameters["model-version"] = "latest";</span><span id="1b51" class="jv jw hi ls b fi ma lx l ly lz"> // call makeRequest method to make API call<br/> String result = await MakeRequest(uriBase, requestParameters, imageBytes);</span><span id="17fc" class="jv jw hi ls b fi ma lx l ly lz"> //extract caption<br/> string convResult = convertCaption(result);</span><span id="cc80" class="jv jw hi ls b fi ma lx l ly lz"> //speak caption<br/> SpeechHandler.Instance.StartSpeaking(convResult);<br/>}</span></pre><p id="6ed5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¸ä¸Šé¢çš„â€œgetCaptionsâ€æ–¹æ³•ç±»ä¼¼çš„æ˜¯â€œgetObjectsâ€æ–¹æ³•ï¼Œå®ƒæœ‰è‡ªå·±çš„uriBaseå’Œrequestå‚æ•°ï¼Œä»¥åŠå¯¹â€œMakeRequestâ€æ–¹æ³•å’Œâ€œconvertObjectsâ€æ–¹æ³•çš„è°ƒç”¨ï¼Œåè€…æå–ä½ç½®æ•°æ®å¹¶åˆ›å»ºä¸€ä¸ªå¥å­å¹¶å°†å…¶è¿”å›ï¼Œæœ€åè°ƒç”¨SpeechHandlerè¯´å‡ºå¸¦æœ‰ä½ç½®æ•°æ®çš„å¥å­ã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="2aa8" class="jv jw hi ls b fi lw lx l ly lz">public async void getObjects(byte[] imageBytes)<br/>{<br/> // uri<br/> string uriBase = endpoint + objectBase;</span><span id="2910" class="jv jw hi ls b fi ma lx l ly lz"> // Request parameters<br/> var requestParameters = HttpUtility.ParseQueryString(string.Empty);<br/> requestParameters["visualFeatures"] = "Objects";<br/> requestParameters["language"] = "en";<br/> requestParameters["model-version"] = "latest";</span><span id="3564" class="jv jw hi ls b fi ma lx l ly lz"> // call makeRequest method to make API call<br/> String result = await MakeRequest(uriBase, requestParameters, imageBytes);</span><span id="7794" class="jv jw hi ls b fi ma lx l ly lz"> //extract position sentence<br/> string convResult = convertObjects(result);</span><span id="6291" class="jv jw hi ls b fi ma lx l ly lz"> //speak<br/> SpeechHandler.Instance.StartSpeaking(convResult);<br/>}</span></pre><p id="9a9f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥æ˜¯â€œMakeRequestâ€æ–¹æ³•ï¼Œå®ƒåŒ…æ‹¬å¯¹Azure APIçš„è°ƒç”¨ï¼Œå¹¶è¿”å›ç”Ÿæˆçš„å“åº”ã€‚è¦äº†è§£æ›´å¤šå…³äºè¿™ç§æ–¹æ³•çš„ä¿¡æ¯ï¼Œè¯·è®¿é—®<a class="ae le" rel="noopener" href="/codex/image-captioning-in-unity-android-using-azure-computer-vision-c9424f9d1ab1">è¿™é‡Œ</a>ã€‚ä¸‹é¢æ˜¯â€œMakeRequestâ€æ–¹æ³•:</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="9d14" class="jv jw hi ls b fi lw lx l ly lz">async Task&lt;String&gt; MakeRequest(string uriBase, NameValueCollection requestParameters, byte[] byteData)<br/>{<br/> //initialize variable for result<br/> String responseText = "";<br/> try<br/> {<br/>  HttpClient client = new HttpClient();</span><span id="b236" class="jv jw hi ls b fi ma lx l ly lz">  // Request headers<br/>  client.DefaultRequestHeaders.Add("Ocp-Apim-Subscription-Key", subscriptionKey);</span><span id="86f3" class="jv jw hi ls b fi ma lx l ly lz">  // Assemble the URI for the REST API method.<br/>  string uri = uriBase + requestParameters;</span><span id="2d10" class="jv jw hi ls b fi ma lx l ly lz">  HttpResponseMessage response;</span><span id="3730" class="jv jw hi ls b fi ma lx l ly lz">  // Request body<br/>  using (var content = new ByteArrayContent(byteData))<br/>  {<br/>   content.Headers.ContentType = new MediaTypeHeaderValue("application/octet-stream");</span><span id="a07b" class="jv jw hi ls b fi ma lx l ly lz">   // Asynchronously call the REST API method.<br/>   response = await client.PostAsync(uri, content);</span><span id="fda8" class="jv jw hi ls b fi ma lx l ly lz">   // Asynchronously get the JSON response.<br/>   responseText = await response.Content.ReadAsStringAsync();<br/>  }<br/> }<br/> catch<br/> {<br/>  responseText = "";<br/> }<br/> return responseText;<br/>}</span></pre><p id="43ad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹æˆ‘ä»¬ä¹‹å‰è°ƒç”¨çš„â€œconvertCaptionâ€å’Œâ€œconvertObjectsâ€æ–¹æ³•ã€‚</p><p id="cc5c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">â€œconvertCaptionâ€æ–¹æ³•åŸºæœ¬ä¸Šä»APIæ¥æ”¶å“åº”å­—ç¬¦ä¸²ï¼Œå°†å…¶è½¬æ¢ä¸ºJSONå¯¹è±¡ï¼Œå¹¶æå–å…¶ä¸­åŒ…å«æ ‡é¢˜çš„å¦ä¸€ä¸ªJSONå¯¹è±¡ã€‚è¿™ä¸ªæ ‡é¢˜å¯¹è±¡åŒ…å«ä¸€ä¸ªæ ‡é¢˜æ•°ç»„ï¼Œå› æ­¤é¦–å…ˆéœ€è¦å°†å®ƒè§£ææˆä¸€ä¸ªJArrayï¼Œç„¶åæå–ç¬¬ä¸€ä¸ªæ ‡é¢˜ã€‚è¿™æ˜¯å¦‚ä½•åšåˆ°çš„:</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="8451" class="jv jw hi ls b fi lw lx l ly lz">public string convertCaption(string responseText)<br/>{<br/> //initialize variable for caption<br/> string textCaption = "";<br/> <br/> try<br/> {<br/>  //convert result to a dictionary<br/>  var jsonResult = JsonConvert.DeserializeObject&lt;Dictionary&lt;string, dynamic&gt;&gt;(responseText);</span><span id="93e8" class="jv jw hi ls b fi ma lx l ly lz">  //obtain captions object from jsonResult<br/>  var captionsObj = jsonResult["description"]["captions"];</span><span id="9948" class="jv jw hi ls b fi ma lx l ly lz">  //convert captionsObj to JArray<br/>  JArray captionArray = JArray.Parse(captionsObj.ToString());</span><span id="7b5e" class="jv jw hi ls b fi ma lx l ly lz">  //get caption string from array<br/>  textCaption = captionArray[0]["text"].ToString();<br/> }<br/> catch<br/> {<br/>  textCaption = "Couldn't get description, Please try again !";<br/> }<br/> return textCaption;<br/>}</span></pre><p id="d60c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">â€œconvertObjectsâ€æ–¹æ³•è¿˜ä»APIè·å–å“åº”å­—ç¬¦ä¸²ï¼Œé€šè¿‡ååºåˆ—åŒ–å°†å…¶è½¬æ¢ä¸ºå¯¹è±¡ï¼Œå¹¶æå–å…¶ä¸­çš„â€œobjectsâ€JSONå¯¹è±¡ã€‚ç„¶åå°†è¯¥å¯¹è±¡è½¬æ¢ä¸ºJArrayï¼Œä»¥è®¿é—®å›¾åƒä¸­æ¯ä¸ªæ£€æµ‹åˆ°çš„å¯¹è±¡çš„ä½ç½®å’Œå¤§å°ã€‚è¯¥æ–¹æ³•è¿˜åŒ…æ‹¬å¯¹â€œä½ç½®â€æ–¹æ³•çš„è°ƒç”¨ï¼Œè¯¥æ–¹æ³•è®¡ç®—å¯¹è±¡æ˜¯åœ¨å›¾åƒçš„å·¦è¾¹ã€å³è¾¹è¿˜æ˜¯ä¸­é—´éƒ¨åˆ†ã€‚ä½¿ç”¨æ­¤ä¿¡æ¯ï¼Œåˆ›å»ºäº†åä¸ºå·¦ã€å³å’Œå‰çš„3ä¸ªåˆ—è¡¨ï¼Œå¹¶å°†ç›¸å…³å¯¹è±¡é™„åŠ åˆ°åˆ—è¡¨ä¸­ã€‚</p><p id="58f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æœ€åï¼Œä¸ºåº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ªå¥å­ï¼Œè¯´å‡ºå¯¹è±¡çš„ä½ç½®ã€‚</p><p id="5507" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¿™æ˜¯å¦‚ä½•åšåˆ°çš„:</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="0abb" class="jv jw hi ls b fi lw lx l ly lz">public string convertObjects(string responseText)<br/>{<br/> //initialize string to store final sentence<br/> string objectsText = "";</span><span id="39fa" class="jv jw hi ls b fi ma lx l ly lz"> try<br/> {<br/>  //convert result to dictionary<br/>  var jsonResult = JsonConvert.DeserializeObject&lt;Dictionary&lt;string, dynamic&gt;&gt;(responseText);</span><span id="47d7" class="jv jw hi ls b fi ma lx l ly lz">  //obtain objects<br/>  var objects = jsonResult["objects"];</span><span id="ee09" class="jv jw hi ls b fi ma lx l ly lz">  //obtain width of image<br/>  var width = jsonResult["metadata"]["width"];</span><span id="8984" class="jv jw hi ls b fi ma lx l ly lz"> //convert width to double<br/>  double imageWidth = double.Parse(width.ToString());</span><span id="00ea" class="jv jw hi ls b fi ma lx l ly lz">  //convert objects to JArray<br/>  JArray objsArray = JArray.Parse(objects.ToString());</span><span id="e371" class="jv jw hi ls b fi ma lx l ly lz">  //initialize 3 lists to store objects in left, front, right<br/>  List&lt;string&gt; left = new List&lt;string&gt;();<br/>  List&lt;string&gt; front = new List&lt;string&gt;();<br/>  List&lt;string&gt; right = new List&lt;string&gt;();</span><span id="e350" class="jv jw hi ls b fi ma lx l ly lz">  //for each object in array<br/>  foreach (var item in objsArray)<br/>  {<br/>   //get x value<br/>   double x = double.Parse(item["rectangle"]["x"].ToString());</span><span id="ba28" class="jv jw hi ls b fi ma lx l ly lz">   //get width of object detected<br/>   double w = double.Parse(item["rectangle"]["w"].ToString());</span><span id="7826" class="jv jw hi ls b fi ma lx l ly lz">   //check where the object is located<br/>   if (position(imageWidth, x, w) == "left")<br/>   {<br/>    left.Add(item["object"].ToString());<br/>   }<br/>   if (position(imageWidth, x, w) == "front")<br/>   {<br/>    front.Add(item["object"].ToString());<br/>   }<br/>   if (position(imageWidth, x, w) == "right")<br/>   {<br/>    right.Add(item["object"].ToString());<br/>   }<br/>  }<br/>  //if lists are not empty, create sentence<br/>  if (!(left.Count == 0))<br/>  {<br/>   objectsText = string.Join(",", left) + " to your left, ";<br/>  }<br/>  if (!(front.Count == 0))<br/>  {<br/>   objectsText = objectsText + string.Join(",", front) + " in your front,  ";<br/>  }<br/>  if (!(right.Count == 0))<br/>  {<br/>   objectsText = objectsText + "and " + string.Join(",", right) + " to your right";<br/>  }<br/> }<br/> catch<br/> {<br/>  objectsText = "Couldn't get position data, Please try again !";<br/> }<br/> return objectsText;<br/>}</span></pre><p id="2ad0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æœ‰â€œä½ç½®â€æ–¹æ³•ã€‚å¦‚å‰æ‰€è¿°ï¼Œè¯¥æ–¹æ³•ç”¨äºè®¡ç®—ç‰¹å®šå¯¹è±¡ç›¸å¯¹äºå›¾åƒä½äºå“ªä¸ªéƒ¨åˆ†ã€‚è¯¥æ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œå³æ•´ä¸ªå›¾åƒçš„å®½åº¦ã€å¯¹è±¡çš„xè½´èµ·å§‹ä½ç½®å’Œå¯¹è±¡çš„å®½åº¦ã€‚</p><p id="87a0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å›¾åƒåˆ†ä¸ºå·¦ã€å‰ã€å³ä¸‰ä¸ªéƒ¨åˆ†ã€‚å°†å¯¹è±¡çš„å®½åº¦é™¤ä»¥ä¸€åŠï¼Œå¹¶ä¸xå€¼ç›¸åŠ ï¼Œä»¥è·å¾—å¯¹è±¡ä¸­ç‚¹çš„xå€¼ã€‚ä½¿ç”¨è¯¥ä¸­ç‚¹ï¼Œå¯ä»¥ç¡®å®šå¯¹è±¡ä½äºå›¾åƒçš„å“ªä¸ªéƒ¨åˆ†ã€‚è¿™æ˜¯ä½¿ç”¨ä¸‹é¢çš„ä»£ç å®Œæˆçš„:</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="50dd" class="jv jw hi ls b fi lw lx l ly lz">public string position(double width, double x, double w)<br/>{<br/> //divide image to 3 sections vertically and obtain length of one section<br/> double oneSection = width / 3;</span><span id="46bd" class="jv jw hi ls b fi ma lx l ly lz">//left section will end from oneSection length<br/> double left = oneSection;</span><span id="e1b0" class="jv jw hi ls b fi ma lx l ly lz">//front section end from 2 * oneSection length<br/> double front = oneSection * 2;</span><span id="9455" class="jv jw hi ls b fi ma lx l ly lz">//check if object's middle (x+w/2) is in which section<br/> if ((x + w / 2.0) &lt; left)<br/> {<br/>  return "left";<br/> }<br/> else if ((x + w / 2.0) &lt;= front)<br/> {<br/>  return "front";<br/> }<br/> else<br/> {<br/>  return "right";<br/> }<br/>}</span></pre><p id="494a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> SpeechHandler.cs </strong></p><p id="bb42" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘å°†è®¨è®ºå¤„ç†æ–‡æœ¬åˆ°è¯­éŸ³å’Œè¯­éŸ³åˆ°æ–‡æœ¬åŠŸèƒ½çš„SpeechHandler.csè„šæœ¬ã€‚</p><p id="d3a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ­¤ç±»åŒ…å«ç”¨äºUIæ–‡æœ¬ç»„ä»¶ã€è¯­è¨€ä»£ç å’Œå¸ƒå°”å˜é‡â€œisListeningâ€çš„å˜é‡ã€‚UIæ–‡æœ¬ç»„ä»¶ç”¨äºæ˜¾ç¤ºåº”ç”¨ç¨‹åºæ˜¯å¦åœ¨å¬è¯­éŸ³ã€‚è¿™åªæ˜¯ä¸ºäº†æˆ‘ä»¬çš„æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒå¯¹è§†åŠ›æœ‰éšœç¢çš„äººæ²¡æœ‰ç”¨ã€‚â€œisListeningâ€å˜é‡ç”¨äºè·Ÿè¸ªåº”ç”¨ç¨‹åºä½•æ—¶æ²¡æœ‰ç›‘å¬è¯­éŸ³ï¼Œå¦‚æœæ²¡æœ‰ï¼Œupdateæ–¹æ³•å°†æ£€æŸ¥è¿™ä¸€ç‚¹å¹¶å¯åŠ¨ç›‘å¬è¿‡ç¨‹ã€‚ä»¥ä¸‹æ˜¯ä¸Šè¿°å˜é‡:</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="7574" class="jv jw hi ls b fi lw lx l ly lz">//UI text<br/>[SerializeField] private Text speechStatus;</span><span id="6dee" class="jv jw hi ls b fi ma lx l ly lz">//language code constant<br/>const string LANG_CODE = "en-US";</span><span id="a408" class="jv jw hi ls b fi ma lx l ly lz">//variable to know if app is listening to voice<br/>bool isListening = true;</span></pre><p id="52c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¦‚å‰æ‰€è¿°ï¼Œè¯¥é¡¹ç›®éµå¾ªå•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œå› æ­¤ï¼Œæˆ‘åˆ›å»ºäº†è¯¥ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="8ed3" class="jv jw hi ls b fi lw lx l ly lz">private static SpeechHandler instance;</span><span id="57bd" class="jv jw hi ls b fi ma lx l ly lz">public static SpeechHandler Instance<br/>{<br/> get<br/> {<br/>  if (instance == null)<br/>  {<br/>   instance = FindObjectOfType&lt;SpeechHandler&gt;();<br/>  }<br/>  return instance;<br/> }<br/>}</span></pre><p id="8a89" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">é…ç½®TextToSpeechå’ŒSpeechToTextè®¾ç½®çš„â€œSetupâ€æ–¹æ³•è®¾ç½®æ‰¬å£°å™¨å’Œæ¥æ”¶å™¨çš„è¯­è¨€ã€éŸ³è°ƒå’Œé€Ÿç‡ã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="7442" class="jv jw hi ls b fi lw lx l ly lz">void Setup(string code)<br/>{<br/> TextToSpeech.instance.Setting(code, 1, 0.8f);<br/> SpeechToText.instance.Setting(code);<br/>}</span></pre><p id="48ee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥ï¼Œå®šä¹‰ä¸€ä¸ªåä¸ºâ€œStartSpeakingâ€çš„æ–¹æ³•æ¥å¯åŠ¨åº”ç”¨ç¨‹åºæœ—è¯»æ¶ˆæ¯ã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="3672" class="jv jw hi ls b fi lw lx l ly lz">public void StartSpeaking(string message)<br/>{<br/> TextToSpeech.instance.StartSpeak(message);<br/>}</span></pre><p id="cfa7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥ï¼Œå®šä¹‰ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å¤„ç†è®²è¯åœæ­¢æ—¶çš„æ“ä½œã€‚è¿™é‡Œï¼Œæˆ‘å°†â€œisListeningâ€è®¾ç½®ä¸ºfalseï¼Œè¿™æ ·updateæ–¹æ³•å°†ä»ä¸‹ä¸€å¸§è°ƒç”¨â€œStartListeningâ€ã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="c644" class="jv jw hi ls b fi lw lx l ly lz">public void OnSpeakStop()<br/>{<br/> //set isListening to False<br/> isListening = false;<br/>}</span></pre><p id="4624" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¸‹é¢ç»™å‡ºçš„æ˜¯â€œå¼€å§‹ç›‘å¬â€åŠŸèƒ½ã€‚è¿™é‡Œï¼ŒUIæ–‡æœ¬ç»„ä»¶ä¹Ÿè¢«æ›´æ–°ã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="5f17" class="jv jw hi ls b fi lw lx l ly lz">public void StartListening()<br/>{<br/> SpeechToText.instance.StartRecording();<br/> speechStatus.text = "Listening...";<br/>}</span></pre><p id="8be0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç±»ä¼¼åœ°ï¼ŒStopListeningæ–¹æ³•åœæ­¢ç›‘å¬è¯­éŸ³å¹¶æ›´æ–°UIæ–‡æœ¬ç»„ä»¶ã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="50d6" class="jv jw hi ls b fi lw lx l ly lz">public void StopListening()<br/>{<br/> SpeechToText.instance.StopRecording();<br/> speechStatus.text = "Stopped Listening";<br/>}</span></pre><p id="e761" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥æ˜¯â€œOnFinalSpeechResultâ€æ–¹æ³•ï¼Œå®ƒæ ¹æ®è¯†åˆ«çš„å…³é”®å­—å¤„ç†å¯¹æ ‡é¢˜ç±»å®ä¾‹çš„è°ƒç”¨ã€‚å¦‚æœåœ¨ç”¨æˆ·è¯­éŸ³è¾“å…¥ä¸­è¯†åˆ«å‡ºâ€œä½ç½®â€,åˆ™è°ƒç”¨å‚æ•°è®¾ç½®ä¸ºfalseçš„â€œä¿å­˜å›¾åƒâ€åç¨‹(æ„å‘³ç€ç”¨æˆ·ä¸éœ€è¦æè¿°ï¼Œä½†éœ€è¦ä½ç½®æ•°æ®)ã€‚å¦‚æœåœ¨ç”¨æˆ·è¾“å…¥ä¸­æ£€æµ‹åˆ°â€œæ ‡é¢˜â€å…³é”®å­—ï¼Œåˆ™ä¼šå‘ç”Ÿç›¸åçš„æƒ…å†µã€‚å¦‚æœæ²¡æœ‰æ£€æµ‹åˆ°ï¼Œåˆ™å°†â€œisListeningâ€å˜é‡è®¾ç½®ä¸ºfalseã€‚ä¸‹é¢ç»™å‡ºçš„æ˜¯â€œOnFinalSpeechResultâ€æ–¹æ³•ã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="b550" class="jv jw hi ls b fi lw lx l ly lz">void OnFinalSpeechResult(string result)<br/>{<br/> speechStatus.text = result;</span><span id="a452" class="jv jw hi ls b fi ma lx l ly lz">try<br/> {<br/>  //check if 'position' or 'desribe' words in spoken sentence by user<br/>  if (result.ToLower().Contains("placement"))<br/>  {<br/>   //set is Listening to true because otherwise, app will listen to caption spoken by itself from update method<br/>   isListening = true;</span><span id="434d" class="jv jw hi ls b fi ma lx l ly lz">   //stoplistening<br/>   StopListening();</span><span id="8851" class="jv jw hi ls b fi ma lx l ly lz">//call SaveImage<br/>   StartCoroutine(caption.Instance.SaveImage(false));<br/>  }<br/>  else if (result.ToLower().Contains("caption"))<br/>  {<br/>   //set is Listening to true because otherwise, app will listen to position sentence spoken by itself from update method<br/>   isListening = true;</span><span id="50e8" class="jv jw hi ls b fi ma lx l ly lz">   //stoplistening<br/>   StopListening();</span><span id="047e" class="jv jw hi ls b fi ma lx l ly lz">   //call SaveImage<br/>   StartCoroutine(caption.Instance.SaveImage(true));<br/>  }<br/>  else<br/>  {<br/>   //set isListening to false<br/>   isListening = false;<br/>  }<br/> }<br/> catch<br/> {<br/> }<br/>}</span></pre><p id="1ebe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥ï¼Œâ€œOnFinalSpeechResultâ€å’Œâ€œOnSpeakStopâ€å›è°ƒéƒ½åº”è¯¥æ³¨å†Œåˆ°å„è‡ªçš„ç±»ä¸­ã€‚è¿™æ˜¯åœ¨startæ–¹æ³•ä¸­å®Œæˆçš„ï¼Œè¯¥æ–¹æ³•è¿˜è°ƒç”¨â€œSetupâ€æ–¹æ³•å’Œâ€œStartListeningâ€æ–¹æ³•ã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="a8da" class="jv jw hi ls b fi lw lx l ly lz">void Start()<br/>{<br/> //call setup method<br/> Setup(LANG_CODE);</span><span id="7980" class="jv jw hi ls b fi ma lx l ly lz"> //register onResultCallback<br/> SpeechToText.instance.onResultCallback = OnFinalSpeechResult;</span><span id="05ac" class="jv jw hi ls b fi ma lx l ly lz"> //register onDoneCallback<br/> TextToSpeech.instance.onDoneCallback = OnSpeakStop;</span><span id="ef19" class="jv jw hi ls b fi ma lx l ly lz"> //start listening to voice<br/> StartListening();<br/>}</span></pre><p id="8218" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æœ€åï¼Œâ€œæ›´æ–°â€æ–¹æ³•æ£€æŸ¥å˜é‡â€œisListeningâ€æ˜¯å¦ä¸ºå‡ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è°ƒç”¨â€œStartListeningâ€æ–¹æ³•ã€‚</p><pre class="lm ln lo lp fd lr ls lt lu aw lv bi"><span id="05c5" class="jv jw hi ls b fi lw lx l ly lz">void Update()<br/>{<br/> //if not listening, start listening<br/> if (!isListening)<br/> {<br/>  StartListening();<br/> }<br/>}</span></pre><p id="7741" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¿™å°±å®Œæˆäº†è¿™ä¸ªé¡¹ç›®çš„ç¼–ç ä»»åŠ¡ã€‚</p><p id="c5c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥ï¼Œåœ¨æ„å»ºåº”ç”¨ç¨‹åºä¹‹å‰ï¼Œéœ€è¦å°†â€œcamera feedâ€raw imageå’Œâ€œSpeechStatusâ€æ–‡æœ¬UIç»„ä»¶åˆ†åˆ«åˆ†é…ç»™captionHandleræ¸¸æˆå¯¹è±¡çš„æ ‡é¢˜è„šæœ¬ç»„ä»¶å’ŒSpeechHandleræ¸¸æˆå¯¹è±¡çš„SpeechHandlerè„šæœ¬ã€‚</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/fc90fdc8f54f4ee68688292978bf342a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*ejv3dUkBnF-haNYMW1icow.png"/></div></figure><p id="734b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¿™å°±å®Œæˆäº†è¿™ä¸ªé¡¹ç›®çš„å¼€å‘ã€‚</p><p id="1d49" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¿™æ˜¯åº”ç”¨ç¨‹åºçš„æ¼”ç¤ºã€‚</p><figure class="lm ln lo lp fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="10ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¿™ä¸ªé¡¹ç›®åˆ°æ­¤ä¸ºæ­¢ã€‚è¯·è®©æˆ‘çŸ¥é“ä½ çš„åé¦ˆå’Œå»ºè®®ã€‚è°¢è°¢å¤§å®¶ï¼å¹²æ¯ï¼ğŸ˜€</p></div></div>    
</body>
</html>