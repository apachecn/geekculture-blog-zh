# æ·±åº¦å­¦ä¹  PyTorch ç®€ä»‹

> åŸæ–‡ï¼š<https://medium.com/geekculture/introduction-to-pytorch-for-deep-learning-483d4a65d594?source=collection_archive---------2----------------------->

## æ·±åº¦å­¦ä¹ æ•™ç¨‹

## åŸºäºè¿ç§»å­¦ä¹ çš„ PyTorch å›¾åƒåˆ†ç±»ã€‚

![](img/c90479d15f93d3d53c952191bb6dc10c.png)

Photo by [Aziz Acharki](https://unsplash.com/@acharki95?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

æ¨èç³»ç»Ÿã€ç½‘ç»œæœç´¢ã€è¯­è¨€ç¿»è¯‘ã€æ— äººé©¾é©¶æ±½è½¦ç­‰äººå·¥æ™ºèƒ½åº”ç”¨æ”¹å˜äº†æˆ‘ä»¬çš„ç”Ÿæ´»ã€‚äººå·¥æ™ºèƒ½æœ€çƒ­é—¨çš„å­é¢†åŸŸä¹‹ä¸€æ˜¯æ·±åº¦å­¦ä¹ ã€‚

æ·±åº¦å­¦ä¹ æ˜¯äººå·¥ç¥ç»ç½‘ç»œçš„æ‰©å±•ã€‚äººå·¥ç¥ç»ç½‘ç»œç”±ä¸€ä¸ªéšè—å±‚ç»„æˆï¼Œè€Œæ·±åº¦ç¥ç»ç½‘ç»œç”±å¤šä¸ªéšè—å±‚ç»„æˆã€‚

æ·±åº¦å­¦ä¹ åˆ†æä¸­ç”¨åˆ°å¾ˆå¤šçŸ©é˜µè¿ç®—ã€‚æ‚¨éœ€è¦ä½¿ç”¨ä¸€ä¸ªåº“æ¥å®ç°è¿™äº›æ“ä½œã€‚æ·±åº¦å­¦ä¹ ä½¿ç”¨æœ€å¤šçš„åº“æ˜¯ PyTorch å’Œ TensorFlowã€‚TensorFlow å¤šç”¨äºå·¥ä¸šï¼ŒPyTorch å¤šç”¨äºå­¦æœ¯ç ”ç©¶ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è°ˆè®ºæ·±åº¦å­¦ä¹ çš„ PyTorchã€‚æ€»è€Œè¨€ä¹‹ï¼Œ

*   PyTorch æ˜¯ä»€ä¹ˆï¼Ÿ
*   PyTorch çš„ä¼˜ç‚¹ã€‚
*   å¦‚ä½•å®‰è£… PyTorchï¼Ÿ
*   ç”¨çœŸå®ä¸–ç•Œçš„æ•°æ®é›†ç»ƒä¹ ã€‚

ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»ç½‘ä¸Šæ‹¿ä¸€å¼ å›¾ç‰‡ï¼Œç”¨ PyTorch é¢„æµ‹è¿™å¼ å›¾ç‰‡çš„ç±»åˆ«ã€‚å¯¹äºæƒ³è¦å­¦ä¹  PyTorch çš„åˆå­¦è€…æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œç¾çš„ä¾‹å­ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ä¸€å¼ ç‹—çš„å›¾ç‰‡å¹¶é¢„æµ‹ç‹—çš„å±ã€‚å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸åŒçš„å›¾ç‰‡ï¼Œå¦‚èŒ¶æˆ–èŠ±ã€‚

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ä¸è¦å¿˜è®°è®¢é˜…æˆ‘ä»¬çš„ youtube é¢‘é“ï¼Œæˆ‘ä»¬åœ¨é‚£é‡Œåˆ›å»ºå…³äºäººå·¥æ™ºèƒ½ã€æ•°æ®ç§‘å­¦ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„å†…å®¹ğŸ‘‡

[](https://www.youtube.com/channel/UCFU9Go20p01kC64w-tmFORw) [## è’‚ä¼¦è¾¾å…¹å­¦é™¢

### Tirendaz Academy æ˜¯ä¸€ä¸ªåœ¨çº¿æ•™è‚²å¹³å°ï¼Œåœ¨æ•°æ®ç§‘å­¦ã€äººå·¥æ™ºèƒ½ã€æœºå™¨â€¦

www.youtube.com](https://www.youtube.com/channel/UCFU9Go20p01kC64w-tmFORw) 

è®©æˆ‘ä»¬æ·±å…¥äº†è§£ PyTorch æ˜¯ä»€ä¹ˆã€‚

# PyTorch æ˜¯ä»€ä¹ˆ

PyTorch æ˜¯ä¸€ä¸ªç”¨ Python è¯­è¨€ç¼–å†™çš„æµè¡Œåº“ã€‚ä¸“é—¨ç”¨äºæ·±åº¦å­¦ä¹ ã€‚PyTorch ä¸»è¦æ˜¯ç”±è„¸ä¹¦å¼€å‘çš„ã€‚å®ƒåæ¥åœ¨ 2017 å¹´æˆä¸ºä¸€ä¸ªå…è´¹çš„å¼€æºåº“ã€‚

ä½¿ç”¨ PyTorchï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°æ‰§è¡Œæ•°ç»„æ“ä½œå¹¶æ„å»ºåŠ¨æ€ç¥ç»ç½‘ç»œã€‚æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ GPU æ¥åŠ é€Ÿè¿™äº›è¿‡ç¨‹ã€‚æ¢å¥è¯è¯´ï¼Œä½ å¯ä»¥ç®€å•çµæ´»åœ°ä½¿ç”¨ PyTorch æ¥åˆ¶ä½œå¿«é€Ÿçš„æ·±åº¦å­¦ä¹ é¡¹ç›®ã€‚

é‚£ä¹ˆä¸ºä»€ä¹ˆè¦é€‰æ‹© PyTorch å‘¢ï¼Ÿè®©æˆ‘ä»¬æ¥çœ‹çœ‹ PyTorch çš„ä¼˜ç‚¹ã€‚

[](https://www.youtube.com/shorts/9yD_AZeAD6A) [## æ‰¾æ•°æ®ç§‘å­¦å·¥ä½œçš„ 5 ä¸ªæŠ€å·§

### æ•°æ®ç§‘å­¦æŠ€å·§|æ•°æ®ç§‘å­¦å®¶è·¯çº¿å›¾|äººå·¥æ™ºèƒ½ä¸æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ æ•™ç¨‹(python 2022Hiâ€¦

www.youtube.com](https://www.youtube.com/shorts/9yD_AZeAD6A) 

# ä¸ºä»€ä¹ˆæ˜¯ PyTorchï¼Ÿ

å®ƒéå¸¸å—æ¬¢è¿ï¼Œå› ä¸º PyTorch æ˜“äºä½¿ç”¨ã€‚å®ƒæœ‰ä¸€ä¸ªåºå¤§çš„å¼€å‘è€…å’Œç”¨æˆ·ç¤¾åŒºã€‚è®¸å¤šå…¬å¸å’Œç ”ç©¶å°ç»„ä½¿ç”¨ PyTorch è¿›è¡Œæ·±åº¦å­¦ä¹ ã€‚å› æ­¤ï¼Œäº†è§£ PyTorch åœ¨å·¥ä¸šç•Œå’Œå­¦æœ¯ç•Œéƒ½æ˜¯ä¸€é¡¹æŠ¢æ‰‹çš„æŠ€èƒ½ã€‚

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ PyTorch è¿›è¡Œç«¯åˆ°ç«¯çš„é¡¹ç›®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¯ä»¥å°†å®ƒä¸ PyTorch ä¸€èµ·ç”¨äºæ·±åº¦å­¦ä¹ é¡¹ç›®æ­¥éª¤ï¼Œå¦‚æ•°æ®é¢„å¤„ç†ã€æ¨¡å‹æ„å»ºå’Œæ¨¡å‹éƒ¨ç½²ã€‚

å¦‚ä½ æ‰€çŸ¥ï¼ŒPython æ˜¯ä¸€ç§è§£é‡Šæ€§è¯­è¨€ã€‚åœ¨ PyTorch ä¸­ï¼Œå®ƒä»¥æ¸´æœ›æ¨¡å¼å·¥ä½œï¼Œå› ä¸ºå®ƒæ˜¯ç”¨ Python ç¼–å†™çš„ã€‚æ¢å¥è¯è¯´ï¼Œæ‚¨å¯ä»¥ç«‹å³çœ‹åˆ°æ‚¨ç”¨ PyTorch ç¼–å†™çš„ä»£ç çš„ç»“æœã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰¾åˆ°æ‚¨çš„è°ƒè¯•ä»£ç ã€‚

äº‘å¯¹äºå¤§æ•°æ®éå¸¸é‡è¦ã€‚åƒ AWS æˆ– Azure è¿™æ ·çš„äº‘æœåŠ¡è®©ä½ çš„å·¥ä½œå˜å¾—æ›´å®¹æ˜“ï¼Œå› ä¸ºæ·±åº¦å­¦ä¹ ä¸å¤§æ•°æ®ä¸€èµ·å·¥ä½œã€‚ä½ å¯ä»¥åœ¨äº‘å¹³å°ä¸Šä½¿ç”¨ PyTorchã€‚

æ·±åº¦å­¦ä¹ éœ€è¦å¼ºå¤§çš„è®¡ç®—æœºã€‚å¦‚æœä½ æ²¡æœ‰å¼ºå¤§çš„ç”µè„‘ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒã€‚ä½ å¯ä»¥åœ¨ Google Colab å’Œ Kaggle å†…æ ¸ä¸Šå…è´¹ä½¿ç”¨ PyTorchã€‚

PyTorch æ”¯æŒå¹¶è¡Œè®¡ç®—ã€‚æ‰€ä»¥ä½ å¯ä»¥åœ¨ PyTorch ä¸­ä½¿ç”¨ GPU æˆ–è€… TPU è¿›è¡Œæ•°å­¦è¿ç®—ã€‚å› æ­¤ï¼Œä½ å¯ä»¥æ›´å¿«åœ°å®Œæˆæ·±åº¦å­¦ä¹ è¿‡ç¨‹ã€‚

PyTorch æ‹¥æœ‰ä¸€ä¸ªåºå¤§çš„ç”Ÿæ€ç³»ç»Ÿä»¥åŠåŸºäº PyTorch çš„å¼€æºåº“ã€‚æ¯”å¦‚è®©æ·±åº¦å­¦ä¹ é¡¹ç›®ä»£ç ç¼–å†™å˜å¾—ç®€å•çš„ fastaiï¼Œå°±æ˜¯åŸºäº PyTorch ç¼–å†™çš„ã€‚æœ‰äº† fastaiï¼Œä½ å¯ä»¥åŒæ—¶åˆ†æè®¡ç®—æœºè§†è§‰å’Œè‡ªç„¶è¯­è¨€å¤„ç†ã€‚

å¦‚ä½ æ‰€è§ï¼ŒPyTorch æ˜¯æ·±åº¦å­¦ä¹ é¡¹ç›®çš„å®Œç¾åº“ã€‚é€‰æ‹© PyTorch çš„ç†ç”±è¿˜æœ‰å¾ˆå¤šã€‚æˆ‘åœ¨è¿™é‡Œåªæåˆ°äº†ä¸€äº›é‡è¦çš„ä¼˜åŠ¿ã€‚è®©æˆ‘ä»¬ç»§ç»­ï¼Œçœ‹çœ‹å¦‚ä½•å®‰è£… PyTorchã€‚

[](https://www.youtube.com/shorts/81r8_xrfWqc) [## æ•°æ®ç§‘å­¦çš„ 7 ä¸ªçœŸå®ä¾‹å­

### ç°å®ç”Ÿæ´»ä¸­çš„æ•°æ®ç§‘å­¦ç¤ºä¾‹|æ•°æ®ç§‘å­¦åº”ç”¨|æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ é¡¹ç›®å—¨ï¼Œä¼™è®¡ä»¬â€¦

www.youtube.com](https://www.youtube.com/shorts/81r8_xrfWqc) 

# PyTorch è£…ç½®

å¦‚æœä½ æœ‰ä¸€å°åŠŸèƒ½å¼ºå¤§çš„ç”µè„‘ï¼Œä½ å¯ä»¥åœ¨ç”µè„‘ä¸Šå®‰è£… PyTorchã€‚åœ¨ä½ çš„ç”µè„‘ä¸Šå®‰è£… PyTorch éå¸¸ç®€å•ã€‚PyTorch çš„å®˜æ–¹ç½‘ç«™é€šè¿‡å‡†å¤‡ä¸€ä¸ªç®€å•çš„ç•Œé¢ä½¿å®‰è£…å˜å¾—å®¹æ˜“ã€‚è¦å®‰è£… PyTorchï¼Œå» PyTorch çš„å®˜ç½‘ï¼Œé€‰æ‹©åˆé€‚çš„é€‰é¡¹ï¼Œç„¶åå°±åˆ›å»ºäº†ä¸€ä¸ªå‘½ä»¤ã€‚

![](img/df9feef60251121524576f90a4e2c061.png)

[PyTorch Installation](https://pytorch.org/)

ä¹‹åï¼Œåœ¨ç»ˆç«¯æˆ–æ‚¨åœ¨ anaconda ä¸­åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œè¿™ä¸ªå‘½ä»¤ã€‚è¦åœ¨ Anaconda ä¸Šå®‰è£… PyTorchï¼Œè¯·æ‰“å¼€ Anaconda æç¤ºç¬¦å¹¶è®¾ç½®ä»¥ä¸‹ä»£ç æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿç¯å¢ƒã€‚

```
conda create â€” name pytorch
```

åˆ›å»ºäº†ä¸€ä¸ªåä¸º PyTorch çš„æ–°è™šæ‹Ÿç¯å¢ƒã€‚æ¥ä¸‹æ¥ï¼Œä½ è¦æ¿€æ´»è¿™ä¸ªç¯å¢ƒã€‚ä¸ºæ­¤:

```
conda activate pytorch
```

ä¹‹åï¼Œå°†ä» PyTorch ç«™ç‚¹å¤åˆ¶çš„å‘½ä»¤ç²˜è´´åˆ°è¿™é‡Œã€‚

```
conda install pytorch torchvision torchaudio cudatoolkit=10.2 -c pytorch
```

å°±è¿™ä¹ˆç®€å•ã€‚å¦‚æœä½ çš„ç”µè„‘æœ‰ NVIDIA æ˜¾å¡ï¼Œåˆ«å¿˜äº†é€‰æ‹© GPU é€‰é¡¹ã€‚æœ‰äº† GPUï¼Œä½ å¯ä»¥æŠŠä½ çš„æ·±åº¦å­¦ä¹ åˆ†æé€Ÿåº¦æé«˜ 50 å€ã€‚

å¦‚æœä½ æ²¡æœ‰å¼ºå¤§çš„ç”µè„‘ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œä½ ä¹Ÿå¯ä»¥åˆ©ç”¨ AWS è¿™æ ·çš„äº‘å¹³å°åšæ·±åº¦å­¦ä¹ åˆ†æã€‚ä½†æ˜¯ä½¿ç”¨è¿™é¡¹æœåŠ¡æ˜¯è¦ä»˜è´¹çš„ã€‚

å¦‚æœä½ æƒ³å…è´¹åšä½ çš„æ·±åº¦å­¦ä¹ åˆ†æï¼Œä½ å¯ä»¥ç”¨ Colabã€‚Colab æ˜¯è°·æ­Œæä¾›çš„åŸºäºäº‘çš„å…è´¹æœåŠ¡ã€‚Colab çš„ç•Œé¢ç±»ä¼¼äº Jupyter ç¬”è®°æœ¬ã€‚æ‚¨å¯ä»¥åœ¨ Colab ä¸­è¿è¡Œæ‚¨çš„ Python ä»£ç ã€‚ä¹Ÿå¯ä»¥é…åˆ GPU ä½¿ç”¨ Colabã€‚

PyTorch å®‰è£…åœ¨ Colab ä¸­ï¼Œæ‰€ä»¥ä¸éœ€è¦å•ç‹¬å®‰è£…ã€‚ç°åœ¨æ¥çœ‹çœ‹ PyTorch çš„å®‰è£…ç‰ˆæœ¬ã€‚

```
import torch
print(torch.__version__)
```

Colab çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ç•Œé¢ç±»ä¼¼äº Jupyter ç¬”è®°æœ¬ã€‚å¦‚æœä½ çŸ¥é“å¦‚ä½•ä½¿ç”¨ Jupyter ç¬”è®°æœ¬ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨ Colabã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒColab ä¸æ”¯æŒ GPUã€‚æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªã€‚

```
print(torch.cuda.is_available())
```

è¾“å‡ºä¸ºå‡ã€‚è¦ä½¿ç”¨ GPUï¼Œè¯·ä»è¿è¡Œæ—¶èœå•ä¸­é€‰æ‹©æ›´æ”¹è¿è¡Œç±»å‹ï¼Œå¹¶ä»ç¡¬ä»¶åŠ é€Ÿå™¨éƒ¨åˆ†é€‰æ‹© GPUã€‚

![](img/1653f600c1942850004b71924d70e1d4.png)

Change Run Type

ç°åœ¨è®©æˆ‘ä»¬å†æ¬¡è¿è¡Œè¿™ä¸ªå‘½ä»¤ã€‚

```
print(torch.cuda.is_available())
```

true è¢«å†™åˆ°å±å¹•ä¸Šã€‚ä¹‹åï¼Œæˆ‘çš„ä»£ç åœ¨ GPU ä¸Šè¿è¡Œã€‚å¦‚æœä½ ä¹°çš„æ˜¯ Pro ç‰ˆçš„ Colabï¼Œå¯ä»¥ç”¨æ›´å¥½çš„ GPUï¼Œæ›´å¤§çš„å†…å­˜ã€‚å…è´¹ç‰ˆæœ¬è¶³ä»¥æ»¡è¶³æˆ‘åœ¨è¿™ç¯‡åšæ–‡ä¸­å°†è¦åšçš„åˆ†æã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå·²ç»å‘æˆ‘ä»‹ç»äº† PyTorch å¹¶å±•ç¤ºäº†å¦‚ä½•å®‰è£…å®ƒã€‚æˆ‘å¸Œæœ›ä¸€åˆ‡éƒ½å¥½ã€‚ä½ å¯ä»¥åœ¨è¯„è®ºåŒºå†™ä¸‹ä½ çš„é—®é¢˜ã€‚æœ€å¥½çš„å­¦ä¹ æ–¹æ³•æ˜¯é€šè¿‡åšè®©æˆ‘ä»¬ç»§ç»­åšä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºæ¥ç†è§£ PyTorchã€‚

[](https://www.youtube.com/shorts/iYSWwZeEC2c) [## 7 ä¸ªäº†ä¸èµ·çš„è®¡ç®—æœºè§†è§‰é¡¹ç›®åˆ›æ„

### è®¡ç®—æœºè§†è§‰é¡¹ç›®åˆ›æ„æœºå™¨å­¦ä¹ åº”ç”¨æ·±åº¦å­¦ä¹ äººå·¥æ™ºèƒ½é¡¹ç›® Python AIâ€¦

www.youtube.com](https://www.youtube.com/shorts/iYSWwZeEC2c) 

# Pytorch åº”ç”¨

ç°åœ¨è®©æˆ‘å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨ PyTorch è¿›è¡Œå›¾åƒåˆ†ç±»ã€‚åœ¨æœ¬ç»ƒä¹ ä¸­ï¼Œæˆ‘å°†ä»äº’è”ç½‘ä¸Šè·å–ä¸€å¼ å›¾ç‰‡ï¼Œå¹¶æŒ‡å®šè¿™å¼ å›¾ç‰‡çš„ç±»åˆ«ã€‚

åœ¨ 2000 å¹´ä»£ï¼Œå›¾åƒåˆ†ç±»æ˜¯ä¸€ä¸ªéš¾é¢˜ã€‚ä½†æ˜¯ 2010 å¹´ä»¥åï¼Œéšç€æ–°æ¶æ„çš„å‘å±•å’Œ GPU çš„æå‡ï¼Œå›¾åƒåˆ†ç±»å˜å¾—æ›´å®¹æ˜“åšäº†ã€‚

> ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æˆ‘åœ¨è¿™ç¯‡åšæ–‡[ä¸­ä½¿ç”¨çš„ç¬”è®°æœ¬ã€‚](https://github.com/TirendazAcademy/Deep-Learning-with-PyTorch/blob/main/1-Introduction_PyTorch.ipynb)

ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬ç»™ä¸€åªç‹—æ‹ç…§ã€‚å¦‚æœæ‚¨æ„¿æ„ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„å›¾åƒè¿›è¡Œåˆ†æã€‚è®©æˆ‘ä»¬ä½¿ç”¨ urlib åº“ä» web ä¸Šè·å–ä¸€ä¸ªå›¾åƒã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬å¯¼å…¥è¿™ä¸ªåº“å¹¶è¯·æ±‚ã€‚

```
import urllib.request
```

å¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬ç”¨ä¸€ä¸ª url å˜é‡ï¼ŒæŠŠæˆ‘ä»¬è¦è·å–å›¾ç‰‡çš„ç½‘ç«™çš„é“¾æ¥èµ‹ç»™è¿™ä¸ªå˜é‡ã€‚

```
url = â€œ[https://github.com/pytorch/hub/raw/master/images/dog.jpg](https://github.com/pytorch/hub/raw/master/images/dog.jpg)"
```

è®©æˆ‘ä»¬å°†åœ¨è¿™ä¸ªé“¾æ¥ä¸­æ‰¾åˆ°çš„å›¾åƒçš„åç§°èµ‹ç»™ file_name å˜é‡ã€‚

```
file_name = â€œdog.jpgâ€
```

ç°åœ¨è®©æˆ‘ä»ç½‘ä¸Šæ‰¾ä¸€å¼ å›¾ç‰‡ã€‚

```
urllib.request.urlretrieve(url, file_name)
```

ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€å¼ ç…§ç‰‡ã€‚

ç°åœ¨å…ˆç”¨æ•å¤´åº“çœ‹å›¾ï¼Œå†ç”¨ matplotlib çœ‹å›¾ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬å¯¼å…¥åº“ã€‚

```
import matplotlib.pyplot as plt
from PIL import Image
```

è®©æˆ‘ä»¬å°†å›¾åƒèµ‹ç»™ img å˜é‡ã€‚

```
img = Image.open(â€˜dog.jpgâ€™)
```

ç”¨ matplotlib æ¥çœ‹å›¾å§ã€‚

```
plt.imshow(img)
```

![](img/b71e668fcf727e82504d85c43aa8dbab.png)

[A cute dog](https://github.com/pytorch/hub/raw/master/images/dog.jpg)

æˆ‘ä»¬ç†è§£è¿™ä¸ªå›¾åƒæ˜¯ä¸€åªç‹—ã€‚ä½†æ˜¯è®¡ç®—æœºå°†å¦‚ä½•ç†è§£è¿™å¼ å›¾ç‰‡å‘¢ï¼Ÿæˆ‘è¦è°ˆè°ˆè¿™ä¸ªã€‚æˆ‘çš„ç›®æ ‡æ˜¯æ‰¾åˆ°è¿™å¼ å›¾ç‰‡çš„æ ‡ç­¾ã€‚ä¸ºæ­¤ï¼Œæˆ‘å°†ä½¿ç”¨åŸºäºç¥ç»ç½‘ç»œçš„ç®—æ³•ã€‚

åœ¨å°†å›¾åƒäº¤ç»™ç®—æ³•ä¹‹å‰ï¼Œéœ€è¦å¯¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ã€‚ç¡®ä¿å›¾ç‰‡å¯ç”¨äºç®—æ³•ã€‚æˆ‘ä»¬çš„ç…§ç‰‡æ˜¯å½©è‰²çš„ã€‚å®ƒæœ‰ 3 ä¸ªé€šé“ï¼ŒRGBï¼Œå°ºå¯¸ä¸º 1600*1200ã€‚è®°ä½ï¼ŒPytorch ä¸­çš„æ•°æ®é¢„å¤„ç†æ­¥éª¤ç§°ä¸ºè½¬æ¢ã€‚ç°åœ¨è®©æˆ‘ä»¬ç”¨å˜æ¢ä½¿å›¾åƒé€‚åˆåˆ†æã€‚

æˆ‘ä»¬å…ˆå¯¼å…¥ PyTorchï¼Œç„¶åè¿›è¡Œè½¬æ¢ã€‚

```
import torch
from torchvision import transforms
```

è®©æˆ‘ä»¬ä½¿ç”¨ compose æ–¹æ³•æ¥å®šä¹‰ä¸€ç³»åˆ—é¢„å¤„ç†æ­¥éª¤ã€‚

```
preprocess = transforms.Compose([
    transforms.Resize(256),        #1
    transforms.CenterCrop(224),    #2
    transforms.ToTensor(),         #3
    transforms.Normalize(          #4
    mean=[0.485, 0.456, 0.406],
    std=[0.229, 0.224, 0.225])])
```

è®©æˆ‘ä»¬çœ‹çœ‹è¿™äº›ä»£ç :

1.  æˆ‘ç”¨ resize æ–¹æ³•å°†å›¾åƒçš„å¤§å°è°ƒæ•´ä¸º 256ã€‚
2.  æˆ‘åº”ç”¨ä¸­å¿ƒå‰ªè¾‘æ¥æ‹Ÿåˆç¥ç»ç½‘ç»œã€‚
3.  å¦‚ä½ æ‰€çŸ¥ï¼Œç¥ç»ç½‘ç»œå¤„ç†æ•°å­—æ•°æ®ã€‚æˆ‘æŠŠè¿™ä¸ªå›¾åƒè½¬æ¢æˆå¼ é‡ã€‚å¼ é‡æ˜¯ PyTorch ä¸­çš„åŸºæœ¬æ•°æ®å¯¹è±¡ã€‚ä½ å¯ä»¥æŠŠå¼ é‡æƒ³è±¡æˆä¸€ä¸ªæœ‰é¢å¤–ç‰¹æ€§çš„ NumPy æ•°ç»„ã€‚
4.  å›¾åƒç”±åƒç´ å€¼ç»„æˆã€‚æˆ‘åœ¨ 0-1 ä¹‹é—´ç¼©æ”¾è¿™äº›åƒç´ å€¼ã€‚é€šè¿‡è¿™ç§ç¼©æ”¾ï¼Œæ‚¨å¯ä»¥åšå‡ºæ›´å¿«ã€æ›´å‡†ç¡®çš„é¢„æµ‹ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬åˆ›å»ºäº†æ•°æ®é¢„å¤„ç†æ­¥éª¤ï¼Œä½¿å›¾åƒé€‚åˆç¥ç»ç½‘ç»œï¼Œå¹¶å°†å…¶åˆ†é…ç»™é¢„å¤„ç†å˜é‡ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†è¿™äº›æ­¥éª¤åº”ç”¨åˆ°ç°æœ‰çš„å›¾ç‰‡ä¸­ã€‚

```
img_tensor = preprocess(img)
```

ä½ å¯ä»¥çœ‹åˆ°ï¼Œimg_tensor çš„å¤§å°æ˜¯ 224*224ï¼Œç”± 3 ä¸ªé€šé“ä»¥ RGB çš„å½¢å¼ç»„æˆã€‚æ·±åº¦å­¦ä¹ ç®—æ³•å¤„ç†æ•°ç™¾ä¸‡æ•°æ®ã€‚ä¸€æ¬¡ç»™æ¨¡å‹æä¾›æ‰€æœ‰è¿™äº›æ•°æ®æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚æ•°æ®ä»¥ç§°ä¸ºæ‰¹çš„ç»„çš„å½¢å¼æä¾›ç»™ç¥ç»ç½‘ç»œã€‚å¤§æ•°æ®çš„æ‰¹é‡é€šå¸¸æ˜¯ 32 æˆ– 64ã€‚æ‚¨å¯ä»¥æ ¹æ®æ‚¨çš„åˆ†ææ¥æŒ‡å®šè¿™äº›å€¼ã€‚

æˆ‘åªæœ‰ä¸€å¼ å›¾ç‰‡ï¼Œä½†æ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹æœŸæœ›æ•°æ®æ˜¯æ‰¹é‡çš„ã€‚ç°åœ¨è®©æˆ‘ä»¬å‘æ•°æ®ä¸­æ·»åŠ ä¸€ä¸ªæ‰¹å¤„ç†ã€‚æˆ‘å°†ä½¿ç”¨ unsqueeze æ–¹æ³•å‘æ•°æ®æ·»åŠ ä¸€ä¸ªç»´åº¦ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šæ·»åŠ ç»´åº¦çš„ä½ç½®ã€‚æˆ‘å°†è®¾ç½® 0ï¼Œåœ¨å¼€å§‹æ—¶æ·»åŠ ç»´åº¦ã€‚

```
batch = img_tensor.unsqueeze(0)
```

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æ•°æ®çš„å¤§å°ã€‚

```
print(batch.shape)
```

å› æ­¤ï¼Œæˆ‘çš„æ•°æ®æ˜¯ 1 æ‰¹ï¼Œ3 ä¸ªé€šé“ï¼Œ224*224 åƒç´ ã€‚ç°åœ¨å›¾åƒå‡†å¤‡è¿›å…¥ç¥ç»ç½‘ç»œã€‚

å¦‚ä½ æ‰€çŸ¥ï¼Œè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹æ—¢è´¹æ—¶åˆè´¹é’±ã€‚ä½¿ç”¨é¢„å…ˆè®­ç»ƒå¥½çš„æ¨¡å‹æ›´æœ‰æ„ä¹‰ã€‚ä½ å¯ä»¥åœ¨ PyTorch repo ä¸­æ‰¾åˆ°é¢„å…ˆè®­ç»ƒå¥½çš„æ¨¡å‹ã€‚

ä¾‹å¦‚ï¼Œç”¨ Torchvision ä¸Šä¼ ä¸€ä¸ªç”¨äºåˆ†ç±»å›¾åƒçš„æ¨¡å‹æ˜¯éå¸¸å®¹æ˜“çš„ã€‚è®©æˆ‘ä»¬ç”¨ 2012 å¹´èµ¢å¾— ImageNet æ¯”èµ›çš„ AlexNet æ¥å¯¹å›¾åƒè¿›è¡Œåˆ†ç±»ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä» torchvision å¯¼å…¥æ¨¡å‹ã€‚

```
from torchvision import models
```

AlexNet å¯¹å›¾ç‰‡è¿›è¡Œåˆ†ç±»æ•ˆæœå¾ˆå¥½ã€‚AlexNet æœ‰ä¸åŒçš„å‹å·ã€‚æ‚¨å¯ä»¥é€‰æ‹©é€‚åˆæ‚¨çš„åˆ†æçš„æ¨¡å‹ã€‚

> æ·±åº¦å­¦ä¹ ä¸å…¶è¯´æ˜¯ä¸€é—¨ç§‘å­¦ï¼Œä¸å¦‚è¯´æ˜¯ä¸€é—¨è‰ºæœ¯ã€‚

ç°åœ¨è®©æˆ‘ä»¬å®‰è£… alexnetã€‚ä½¿ç”¨ pretrained=True é€‰é¡¹ï¼ŒåŠ è½½ä¹‹å‰è®­ç»ƒçš„æ¨¡å‹ç³»æ•°ã€‚

```
model = models.alexnet(pretrained=True)
```

ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè®¾å¤‡å˜é‡ï¼Œå¦‚æœå®ƒåœ¨ GPU ä¸Šï¼Œé‚£ä¹ˆåˆ†æå°†åœ¨ GPU ä¸Šè¿è¡Œï¼Œå¦‚æœå®ƒä¸åœ¨ GPU ä¸Šï¼Œé‚£ä¹ˆåˆ†æå°†åœ¨ CPU ä¸Šè¿è¡Œã€‚

```
device = â€œcudaâ€ if torch.cuda.is_available() else â€œcpuâ€
```

å› ä¸ºæˆ‘æ­£åœ¨åˆ¶ä½œä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œæ‰€ä»¥è¿™ä¸ªåˆ†æä¸éœ€è¦ GPUã€‚æ‚¨ä¹Ÿå¯ä»¥åœ¨ CPU ä¸Šè¿è¡Œæ­¤åˆ†æã€‚ç°åœ¨è®©æˆ‘ä»¬ç”¨ model.eval é…ç½®æ¨¡å‹ã€‚

```
model.eval()
```

è®©æˆ‘ä»¬é€‰æ‹©è¿è¡Œæ¨¡å‹çš„è®¾å¤‡ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨äº†åˆšåˆšåˆ›å»ºçš„è®¾å¤‡å˜é‡ã€‚

```
model.to(device)
```

è®©æˆ‘ä»¬å°†è¿è¡Œæ¨¡å‹çš„å‘½ä»¤åˆ†é…ç»™å˜é‡ yã€‚

```
y = model(batch.to(device))
print(y.shape)
#outout : torch.Size([1, 1000])
```

æˆ‘ä»¬æ¥çœ‹ y çš„ç»´åº¦ï¼Œè¿™é‡Œ 1 ä»£è¡¨æ•°æ®çš„æ‰¹æ¬¡ã€‚å› ä¸ºæˆ‘ä»¬åªæœ‰ä¸€ä¸ªå›¾åƒï¼Œæ‰€ä»¥æ‰¹å·æ˜¯ 1ã€‚å› ä¸ºç±»çš„æ•°é‡æ˜¯ 1000ï¼Œæ‰€ä»¥ 1000 çš„å€¼å†™åœ¨å±å¹•ä¸Šã€‚ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹è·å¾—æœ€å¤§å€¼çš„ç±»ã€‚

```
y_max, index = torch.max(y,1)
```

è®©æˆ‘ä»¬æŠŠè¿™äº›å˜é‡æ‰“å°åˆ°å±å¹•ä¸Šã€‚

```
print(index, y_max)#output: tensor([258], device='cuda:0') tensor([16.8252], device='cuda:0', grad_fn=<MaxBackward0>)
```

æˆ‘çš„æ¨¡å‹æ‰¾åˆ°äº†å®˜æ–¹æœ€é«˜å€¼ä¸º 16.8252 çš„ç¬¬ 258 ä¸ªæŒ‡æ•°çš„ç±»ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“ç´¢å¼•ä¸º 258 çš„ç±»ã€‚ç°åœ¨è®©æˆ‘ä»¬ä» PyTorch çš„ç«™ç‚¹è·å–ç±»åã€‚è®©æˆ‘å…ˆåˆ›å»ºä¸€ä¸ª url å˜é‡ã€‚

```
url = â€˜[https://pytorch.tips/imagenet-labels'](https://pytorch.tips/imagenet-labels')
```

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç±»æ ‡ç­¾å˜é‡ã€‚

```
fname = â€˜imagenet_class_labels.txtâ€™
```

ç°åœ¨è®©æˆ‘ä»¬ç”¨è¿™äº›å˜é‡ä»ç½‘ä¸Šå¾—åˆ°è¿™ä¸ªåˆ—è¡¨ã€‚

```
urllib.request.urlretrieve(url, fname)
```

è®©æˆ‘ä»¬æ‰“å¼€è¿™ä¸ªåˆ—è¡¨ã€‚

```
with open("imagenet_class_labels.txt") as f:
  classes = [line.strip() for line in f.readlines()]
print(classes[258])# output: 258: 'Samoyed, Samoyede'
```

å¦‚ä½ æ‰€è§ï¼Œç‹—çš„å“ç§å†™åœ¨å±å¹•ä¸Šã€‚é‚£ä¹ˆï¼Œæ¨¡å‹è¾¾åˆ°è¿™ä¸ªç»“æœçš„æ¦‚ç‡æ˜¯å¤šå°‘å‘¢ï¼Ÿè®©æˆ‘ä»¬ä½¿ç”¨ softmax()å‡½æ•°æ¥çœ‹çœ‹è¿™ä¸€ç‚¹ã€‚

```
probe = torch.nn.functional.softmax(y, dim=1)[0] * 100
```

ç°åœ¨è®©æˆ‘å±•ç¤ºä¸€ä¸‹è¿™ç§å¯èƒ½æ€§ã€‚æˆ‘å‡†å¤‡ç”¨ tensor.item()æ–¹æ³•æ¥çœ‹æ¦‚ç‡ã€‚

```
print(classes[index[0]], probe[index[0]].item())# output: 258: 'Samoyed, Samoyede', 72.44749450683594
```

è¯¥æ¨¡å‹å¯¹ç‹—çš„å“ç§çš„é¢„æµ‹è¾¾åˆ°äº† 72%ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ sort()æ–¹æ³•æ‰“å°å‰ 5 ä¸ªé¢„æµ‹ã€‚

```
 _, indices = torch.sort(y, descending=True)
```

ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ‰“å°æœ€å¤§åˆ° 5 çš„é¢„æµ‹ã€‚

```
for idx in indices[0][:5]:
    print(classes[idx], probe[idx].item())
```

![](img/6a3ed29459279d114fb2053216cfe213.png)

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘çš„æ¨¡å‹æœ€åˆé¢„æµ‹è¨æ‘©è€¶çŠ¬ 72 %,è€Œé¢„æµ‹æ²™è¢‹é¼ çŠ¬ 13 %,åšç¾çŠ¬ 5%ã€‚

# ç»“è®º

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è°ˆåˆ°äº†æ·±åº¦å­¦ä¹ çš„ PyTorchã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘é¦–å…ˆè§£é‡Šäº† PyTorch æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒçš„ä¼˜ç‚¹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å‘æ‚¨å±•ç¤ºäº†å®‰è£…ã€‚æœ€åï¼Œæˆ‘è®²è¿°äº†å¦‚ä½•ä½¿ç”¨é¢„å…ˆè®­ç»ƒå¥½çš„ alexnet æ¥ä¼°è®¡å›¾åƒçš„ç±»åˆ«ã€‚

å°±æ˜¯è¿™æ ·ã€‚æ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚æˆ‘å¸Œæœ›ä½ å–œæ¬¢å®ƒã€‚ä½ å¯èƒ½ä¼šå¯¹ä¸‹é¢çš„æ–‡ç« æ„Ÿå…´è¶£ã€‚

[](/geekculture/6-steps-to-become-a-machine-learning-expert-5a1f155f7207) [## æˆä¸ºæœºå™¨å­¦ä¹ ä¸“å®¶çš„ 6 ä¸ªæ­¥éª¤

### æœºå™¨å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„ä¸€ä¸ªå­é¢†åŸŸï¼Œæ—¨åœ¨ä½¿ç”¨æ•°æ®è‡ªåŠ¨å»ºç«‹æ¨¡å‹ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†â€¦

medium.com](/geekculture/6-steps-to-become-a-machine-learning-expert-5a1f155f7207) [](https://levelup.gitconnected.com/top-10-python-libraries-and-5-best-books-for-data-science-fa0d0cf171a6) [## 10 å¤§ Python åº“å’Œ 5 æœ¬æœ€ä½³æ•°æ®ç§‘å­¦ä¹¦ç±

### åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è°ˆè®ºæ•°æ®ç§‘å­¦å®¶åº”è¯¥çŸ¥é“çš„ 10 ä¸ª Python åº“ã€‚æˆ‘è¿˜ä¼šæ¨è 5 æœ¬ä¹¦â€¦

levelup.gitconnected.com](https://levelup.gitconnected.com/top-10-python-libraries-and-5-best-books-for-data-science-fa0d0cf171a6) 

åˆ«å¿˜äº†å…³æ³¨æˆ‘ä»¬çš„[YouTube](https://www.youtube.com/channel/UCFU9Go20p01kC64w-tmFORw)|[GitHub](https://github.com/tirendazacademy)|[*Twitter*](https://twitter.com/TirendazAcademy)*|[ka ggle](https://www.kaggle.com/tirendazacademy)|*|*[*LinkedIn*](https://www.linkedin.com/in/tirendaz-academy)*ğŸ‘**

*****å¦‚æœè¿™ç¯‡å¸–å­æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹å‡»é¼“æŒğŸ‘æŒ‰é’®å‡ ä¸‹ï¼Œä»¥ç¤ºæ”¯æŒğŸ‘‡*****