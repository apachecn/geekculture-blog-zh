# å¦‚ä½•ç”¨ Python åˆ›å»ºåŒºå—é“¾

> åŽŸæ–‡ï¼š<https://medium.com/geekculture/blockchain-explained-and-how-to-create-d897bc20db64?source=collection_archive---------15----------------------->

![](img/fd025fe4b9af1b7577cad88f76c2df85.png)

Picture Credit: [Pierre Borthiry](https://unsplash.com/@peiobty) on [Unsplash](https://unsplash.com/)

æ‰€ä»¥è€¶ï¼çŽ°åœ¨è½®åˆ°ä½ å’Œæˆ‘ï¼Œè®¨è®ºäº’è”ç½‘ä¸Šæœ€çƒ­é—¨ã€æœ€æµè¡Œã€æœ€è€å¥—çš„è¯é¢˜ã€‚å¦‚æžœä½ ä»¥å‰å¬è¯´è¿‡è¿™ä¸ªæœ¯è¯­ï¼Œä½ ä¼šè§‰å¾—æœ‰ç‚¹ä¸å®‰å…¨ï¼Œå› ä¸ºä½ ä¸çŸ¥é“å®ƒåˆ°åº•æ˜¯ä»€ä¹ˆã€‚

ä¸ç®¡æ€Žæ ·ï¼Œè®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹â€œåŒºå—é“¾â€ã€‚å¹¶å›žç­”ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚ï¼Œä»€ä¹ˆæ˜¯åŒºå—é“¾ï¼Ÿå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿæœ‰ä»€ä¹ˆä¸åŒï¼Ÿå®ƒè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿæˆ‘ä¸ºä»€ä¹ˆè¦å…³å¿ƒè¿™ä¸ªï¼Ÿ

æˆ‘åœ¨æ–‡ç« æœ«å°¾å›žç­”äº†ä¸€ä¸ªåŠ åˆ†é¢˜ï¼Œæ‰€ä»¥ä¸€å®šè¦çœ‹å®Œæ•´ç¯‡æ–‡ç« ã€‚bee-hookï¼ï¼ï¼

# ä»€ä¹ˆæ˜¯åŒºå—é“¾ï¼Ÿ

è¿™æ˜¯è®¸å¤šåŠ å¯†è´§å¸æ‰€åŸºäºŽçš„åº•å±‚æŠ€æœ¯ï¼Œè¢«è®¤ä¸ºæ˜¯ 21 ä¸–çºªæœ€é‡è¦çš„å‘æ˜Žä¹‹ä¸€ã€‚

## æ ¹æ®è°·æ­Œçš„è¯´æ³•:

â€œåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ï¼Œç”¨æ¯”ç‰¹å¸æˆ–å¦ä¸€ç§åŠ å¯†è´§å¸è¿›è¡Œçš„äº¤æ˜“è®°å½•åœ¨å‡ å°è¿žæŽ¥åœ¨å¯¹ç­‰ç½‘ç»œä¸­çš„è®¡ç®—æœºä¸Šè¿›è¡Œç»´æŠ¤ã€‚â€

## æ®æˆ‘è¯´:

ä¸€ä¸ª**çº¿æ€§å—é“¾**ï¼Œæ¯ä¸ª**å—**åŒ…å«ä¸€äº›ä¿¡æ¯ã€‚è¯¥é“¾æ˜¯ä¸å¯å˜çš„ï¼Œè¿™æ„å‘³ç€æ²¡æœ‰äººèƒ½å¤Ÿå·å·æºœè¿›æ¥å¹¶æ”¹å˜ä»»ä½•å—ä¸­çš„æ•°æ®ã€‚

æˆ‘çš„ç¨å¾®å®¹æ˜“ä¸€ç‚¹ï¼Œå¯¹å—ï¼ŸðŸ˜„

# å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ

åŒºå—é“¾ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯ç”±å¤šä¸ªåŒºå—é“¾æŽ¥åœ¨ä¸€èµ·å½¢æˆä¸€æ¡é“¾ã€‚

![](img/68ff5f962dc13b66c73fe649c5d3c460.png)

æ¯ä¸ªå—é€šå¸¸åŒ…å«ä»¥ä¸‹ä¿¡æ¯:

*   **æ•°æ®**:è¿™å¯ä»¥æ˜¯ä»»ä½•ç±»ä¼¼äº¤æ˜“æ•°æ®çš„ä¸œè¥¿ã€‚
*   **å“ˆå¸Œå€¼**:è¿™åŸºæœ¬ä¸Šå°±æ˜¯å—çš„ IDã€‚
*   **å‰ä¸€ä¸ªå“ˆå¸Œå€¼**:è·Ÿè¸ªå‰ä¸€ä¸ªå— IDã€‚çŽ°åœ¨ï¼Œä½ åªéœ€è¦çŸ¥é“æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªå€¼åœ¨å½“å‰å—å’Œå‰ä¸€ä¸ªå—ä¹‹é—´å½¢æˆä¸€ä¸ªé“¾ã€‚æˆ‘å°†åœ¨æœ¬æ–‡çš„åŽé¢è§£é‡Šä¸ºä»€ä¹ˆè¿™ä¸ªå€¼å¾ˆé‡è¦ã€‚
*   **æ—¶é—´æˆ³**:è¿™å‘Šè¯‰æˆ‘ä»¬å—æ˜¯ä½•æ—¶åˆ›å»ºçš„ã€‚
*   **å·¥ä½œè¯æ˜Ž**:è¿™æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºæ‰¾åˆ°å½“å‰å—çš„å“ˆå¸Œå€¼æ‰€ä»˜å‡ºçš„åŠªåŠ›ã€‚å¦‚æžœä½ å¬è¯´è¿‡æŒ–æŽ˜ï¼Œè¿™ä¸ªå€¼ä»£è¡¨æœºå™¨è®¡ç®—æ•£åˆ—å€¼éœ€è¦å¤šé•¿æ—¶é—´(ä»¥æ•°å­—çš„å½¢å¼)ã€‚

åœ¨çŽ°å®žä¸–ç•Œä¸­ï¼Œå—è¦æ¯”è¿™å¤æ‚å¾—å¤šï¼Œä½†æˆ‘æƒ³ä¿æŒç®€å•:)

è®©æˆ‘ä»¬è¿›å…¥æœ‰è¶£çš„éƒ¨åˆ†ï¼Œç¼–ç ï¼

åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œæˆ‘æƒ³æŒ‡å‡ºï¼Œå¦‚æžœä½ äº†è§£ä¸€äº›åŸºæœ¬çš„ç¼–ç¨‹ï¼Œè¿™ç¯‡æ–‡ç« ä¼šæ›´å®¹æ˜“ç†è§£ã€‚ä½†æ˜¯ï¼Œå¦‚æžœä½ ä¸æ‹…å¿ƒï¼Œå› ä¸ºæˆ‘ä¼šå°½åŠ›è¯¦ç»†è§£é‡Šæ¯ä¸€æ®µä»£ç ã€‚

# è®©æˆ‘ä»¬ç”¨ Python åˆ›å»ºä¸€ä¸ªåŒºå—é“¾

## å¯¼å…¥å¿…è¦çš„æ¨¡å—

è®©æˆ‘ä»¬åœ¨`blockchain.py`çš„é¡¶éƒ¨å¯¼å…¥ä¸€äº›æ¨¡å—

![](img/51e82ab501df67c9379e71e40474a40b.png)

## åˆ›å»ºå—ç±»

![](img/4802cdbdcbc53973b99bd4c085dcbe9e.png)

è¿™ä¸ªç±»æŽ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªæ˜¯å‰ä¸€ä¸ªå—çš„å“ˆå¸Œå€¼ï¼Œç¬¬äºŒä¸ªæ˜¯å½“å‰å—çš„æ•°æ®ã€‚

åœ¨`__init__()`å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ç”¨æž„é€ å‡½æ•°å‚æ•°åˆå§‹åŒ–å—æ•°æ®ã€‚æˆ‘ä»¬å°†`timeStamp`è®¾ç½®ä¸ºå½“å‰æ—¶é—´ï¼Œå°†`proofOfWork`è®¾ç½®ä¸º 0ã€‚

è¿˜è®°å¾—æˆ‘è¯´è¿‡æˆ‘ä»¬éœ€è¦è®¡ç®—å“ˆå¸Œå€¼å—ï¼Ÿæ˜¯çš„ï¼Œå“ˆå¸Œå€¼ä¸ä»…ä»…æ˜¯ä¸€ä¸ªéšæœºçš„å­—ç¬¦ä¸²ï¼Œä¸ºäº†å®‰å…¨èµ·è§ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å½“å‰æ•°æ®å’Œä»¥å‰çš„å“ˆå¸Œå€¼æ‰¾åˆ°å½“å‰çš„å“ˆå¸Œå€¼ã€‚

å¦‚æžœé»‘å®¢æ”¹å˜äº†ä¸€ä¸ªæ•°æ®å—çš„æ•°æ®ï¼Œä»–ä»¬è¿˜å¿…é¡»é‡æ–°è®¡ç®—å‰é¢æ‰€æœ‰æ•°æ®å—çš„å“ˆå¸Œå€¼ï¼Œä»¥ä½¿æ•°æ®é“¾æœ‰æ•ˆ(å¦‚æžœä»–ä»¬å’Œæˆ‘ä½¿ç”¨åŒä¸€å°è®¡ç®—æœºï¼Œè¿™å¯èƒ½éœ€è¦å‡ åƒå¹´)

å¯¹äºŽé‚£äº›ä¸äº†è§£æ•£åˆ—çš„äººæ¥è¯´ï¼Œå®ƒåŸºæœ¬ä¸Šå°±æ˜¯æˆ‘ä»¬å¦‚ä½•å°†æ•°æ®è½¬æ¢æˆä¸€ä¸²éšæœºå­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œå•è¯â€œhelloâ€å¯ä»¥è¢«æ•£åˆ—æˆâ€œe2d48e7bcâ€¦â€ã€‚å› ä¸ºå“ˆå¸Œåªåœ¨ ***ä¸€ä¸ªæ–¹å‘*** *èµ·ä½œç”¨ï¼Œç»™å®šè¾“å…¥å¾ˆå®¹æ˜“æ‰¾åˆ°å“ˆå¸Œè¾“å‡ºï¼Œä½†æ˜¯ä»Žå“ˆå¸Œè¾“å‡ºé¢„æµ‹è¾“å…¥å´éžå¸¸å›°éš¾ã€‚*

æˆ‘ä»¬æ¥çœ‹çœ‹`calculateHash`çš„æ–¹æ³•ã€‚

![](img/1d45412133cf1a87b26a4b7537afaa89.png)

è¿™ä¸ªå‡½æ•°åŸºæœ¬ä¸ŠåŸºäºŽä»¥å‰çš„æ•£åˆ—ã€å½“å‰æ•°æ®ã€å½“å‰æ—¶é—´æˆ³å’Œå·¥ä½œè¯æ˜Žçš„ç»„åˆç”Ÿæˆä¸€ä¸ªæ•£åˆ—å€¼ã€‚

æˆ‘ä»¬ä½¿ç”¨`hashlib`å†…ç½®åº“ä¸­çš„`sha256`å‡½æ•°ã€‚è¿™ä¸ªåº“åŸºæœ¬ä¸Šå…è®¸æˆ‘ä»¬ä½¿ç”¨å‡ ç§æ•£åˆ—æ–¹æ³•ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å®‰å…¨æ•£åˆ—ç®—æ³• 256 (SHA 256)ã€‚å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬åœ¨æ–‡ä»¶é¡¶éƒ¨å¯¼å…¥äº†`hash`ã€‚

æˆ‘ä»¬æ¥çœ‹çœ‹`Block`ç±»çš„æœ€åŽä¸€ä¸ªå‡½æ•°ã€‚`mine`åŠŸèƒ½ã€‚

![](img/5c6afbf12f39802e05eb3d966826e3f2.png)

è¿™ä¸ª`mine`å‡½æ•°ä¸æ–­å¢žåŠ `proofOfWork`ï¼Œç›´åˆ°æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªä»Žæˆ‘ä»¬æƒ³è¦çš„æ•°å­— 0 å¼€å§‹çš„æ•£åˆ—(æˆ‘ä»¬ç§°ä¹‹ä¸º`difficulty`)ã€‚éš¾åº¦è¶Šé«˜ï¼Œåˆ›å»ºå“ˆå¸Œæ‰€éœ€çš„æ—¶é—´å°±è¶Šé•¿ã€‚è¿™æ˜¯å› ä¸ºä»Žæ•£åˆ—è¾“å‡ºä¸­æ‰¾åˆ°è¾“å…¥çš„å”¯ä¸€æ–¹æ³•æ˜¯é€ä¸ªå°è¯•ä¸åŒçš„è¾“å…¥ã€‚

ä¸‹ä¸€æ­¥æ˜¯åˆ›å»ºåŒºå—é“¾æ¥å­˜å‚¨æ‰€æœ‰çš„åŒºå—ã€‚

## åˆ›å»ºåŒºå—é“¾ç±»

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`Blockchain`ç±»

![](img/c03a09f6930777d423a6a3634280705f.png)

æˆ‘ä»¬çš„åŒºå—é“¾å­˜å‚¨ 1 æ•°ç»„å«åš`chain`ã€‚æˆ‘ä»¬è¿˜å°†åœ¨é“¾ä¸­æ·»åŠ ä¸€ä¸ª`genesisBlock`ã€‚åˆ›ä¸–çºªåŒºå—åŸºæœ¬ä¸Šæ˜¯é“¾ä¸­çš„ç¬¬ä¸€ä¸ªåŒºå—ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ é€’â€œ0â€ä½œä¸ºå‰ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œå› ä¸ºæ²¡æœ‰å‰ä¸€ä¸ªå—ã€‚

æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å®žçŽ°`addBlock`æ–¹æ³•ï¼Œå‘é“¾ä¸­æ·»åŠ ä¸€ä¸ªæ–°å—ã€‚

![](img/39dfd31dc5873a8d277d020a346ba06b.png)

è¯¥å‡½æ•°æŽ¥å— new `data`ä½œä¸ºå‚æ•°ï¼Œå¹¶åŸºäºŽè¯¥æ•°æ®å’Œå‰ä¸€ä¸ªå—çš„æ•£åˆ—åˆ›å»ºä¸€ä¸ªæ–°å—ã€‚

è®°ä½ï¼Œå½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„å—æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨`mine`å‡½æ•°æ¥è®¡ç®—å®ƒçš„å“ˆå¸Œå€¼ã€‚ä¸ºäº†æ›´å¿«ï¼Œæˆ‘åªå°†`diffifulty`è®¾ç½®ä¸º 2ï¼Œæ‰€ä»¥æ–°çš„å“ˆå¸Œå€¼å¿…é¡»ä»¥ 2 ä¸ªé›¶å¼€å§‹ã€‚

æ‰¾åˆ°å“ˆå¸Œå€¼åŽï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ–°çš„å—æ·»åŠ åˆ°é“¾ä¸­ã€‚

æœ€åŽï¼Œæˆ‘ä»¬éœ€è¦`isValid`å‡½æ•°æ¥éªŒè¯å½“å‰é“¾æ˜¯å¦æœ‰æ•ˆã€‚

![](img/3942c5f30224edec992aaf8823c4669c.png)

è¿™ä¸ªå‡½æ•°åŸºæœ¬ä¸ŠéåŽ†æ¯ä¸ªå—(é™¤äº† genesis å—)ï¼Œå¹¶æ£€æŸ¥å“ˆå¸Œå€¼ä¸­æ˜¯å¦æœ‰ä»»ä½•è¿è§„ã€‚å¦‚æžœæ²¡æœ‰è¿åï¼Œå®ƒè¿”å›ž`true`ã€‚

## èŽ·å–æœ€æ–°çš„å—

![](img/830f4b86ae1a794aae3f1c2011dadc64.png)

è¿™ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯æ‚¨ä¹Ÿå¯ä»¥æ·»åŠ ä¸€ä¸ª`getLatestBlock`æ–¹æ³•æ¥å°†æœ€åŽä¸€ä¸ªå—æ·»åŠ åˆ°é“¾ä¸­ã€‚

æ­å–œä½ ï¼ä½ å·²ç»æˆåŠŸå»ºé€ äº†ä¸€ä¸ªåŒºå—é“¾ã€‚

è®©æˆ‘ä»¬åœ¨ä¸‹é¢çš„ç¤ºä¾‹éƒ¨åˆ†çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

## ç”¨æ³•ç¤ºä¾‹

![](img/a89de723c118a1bce4be9d2d36de2823.png)

å¦‚æžœä½ è¯»åˆ°è¿™é‡Œï¼Œæˆ‘ä¸éœ€è¦è§£é‡Šä»€ä¹ˆæ˜¯ Python ç±»ã€‚æˆ‘æœ‰å—ï¼Ÿåªéœ€æ£€æŸ¥æ‰“å°çš„ç±»å¯¹è±¡ï¼Œå¹¶åœ¨æ‚¨æœ€è¿‘çš„é¡¹ç›®ä¸­å®žçŽ°å®ƒã€‚

å°±è¿™æ ·ï¼ŒçŽ°åœ¨åŽ»ç‚«è€€ä½ çš„æœ‹å‹è¯´ä½ ä»¬åœ¨è®¨è®ºä»€ä¹ˆï¼Œæˆ‘å¯ä»¥å»ºç«‹ï¼

ä½†æ˜¯ç­‰ç­‰ï¼Œè¿˜æœ‰æ›´å¤šâ€¦

# å®ƒè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ

å®ƒè§£å†³çš„æœ€å¤§å’Œæœ€ä¸»æµçš„é—®é¢˜æ˜¯å®ƒæä¾›äº†ä¸€ä¸ª**åŽ»ä¸­å¿ƒåŒ–çš„æ•°æ®å…±äº«å¹³å°**ã€‚

![](img/1dc2d6af096cb8d36687ebd730242cb3.png)

ä»¥ä¸Šæ˜¯ä¸€ä¸ª**é›†ä¸­å¼**å’Œ**åˆ†æ•£å¼**ç½‘ç»œåŸºç¡€è®¾æ–½çš„æ¼”ç¤ºã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿæ­£å› ä¸ºå¦‚æ­¤â€¦â€¦åŒºå—é“¾è§£å†³äº†
å­˜å‚¨å’Œå®‰å…¨é—®é¢˜ï¼Œ
æ•°æ®ä¼ è¾“â€”â€”å°†æ›´å¿«ï¼Œ
ç”µå­æŠ•ç¥¨ã€æ…ˆå–„ã€ä¼—ç­¹â€”â€”å°†æ›´å®¹æ˜“(å› ä¸ºæ²¡æœ‰äººæŽ§åˆ¶æµé‡)

# æˆ‘ä¸ºä»€ä¹ˆè¦å…³å¿ƒè¿™ä¸ªï¼Ÿ

å›žç­”æˆ‘è¿™ä¸ªé—®é¢˜:

*   æ‚¨ä¸Šä¸€æ¬¡å…³å¿ƒ XYZ é“¶è¡Œçš„æ”¯ä»˜ç½‘å…³æ˜¯å¦‚ä½•å·¥ä½œçš„æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ
*   è°·æ­Œå¦‚ä½•é€šè¿‡ç¬¬ä¸‰æ–¹æœåŠ¡è®¤è¯å…¶ç”¨æˆ·ï¼Ÿ
*   æœ‰æ²¡æœ‰æƒ³è¿‡ Instagram å¦‚ä½•/åœ¨å“ªé‡Œå­˜å‚¨æ•°æ®ï¼Ÿ

å¦‚æžœä½ ä¸èƒ½å›žç­”è¿™äº›é—®é¢˜ï¼Œå°±æ²¡æœ‰å¿…è¦äº†è§£åŒºå—é“¾ã€‚æˆ‘çš„æ„æ€æ˜¯ä½ å¯ä»¥ï¼Œä½†æ²¡æœ‰å¿…è¦ã€‚

å°±åƒä½ ä¸éœ€è¦æ‡‚ JavaScript å°±èƒ½ä½¿ç”¨ Instagram ä¸€æ ·ã€‚ä½ ä¸éœ€è¦åŒºå—é“¾å°±èƒ½æŠ•èµ„æ¯”ç‰¹å¸ã€‚

çŽ°åœ¨æ˜¯å¥–é‡‘æ—¶é—´ã€‚

# åŒºå—é“¾ä¸æ˜¯æ¯”ç‰¹å¸

å¦‚æžœä½ æ˜¯ä¸€ä¸ª Python çˆ±å¥½è€…ï¼Œä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ä¸Šé¢çš„æ ‡é¢˜æ˜¯ä¸€ä¸ªåˆæ³•çš„ä»£ç è¯­å¥ðŸ˜…

åŸºæœ¬ä¸Šï¼Œæˆ‘è¦è¯´çš„æ˜¯ï¼Œå¦‚æžœä½ æ˜Žæ™ºåœ°ä½¿ç”¨åŒºå—é“¾ï¼Œå®ƒæ˜¯ä¸€é¡¹æœ‰å¾ˆå¤§æ½œåŠ›çš„æŠ€æœ¯ã€‚

åŸºäºŽåŒºå—é“¾çš„å®žçŽ°ï¼Œäººä»¬å‡ ä¹Žå¯ä»¥åšå‡ºä»»ä½•ä¸œè¥¿ã€‚ä»ŽåŠ å¯†è´§å¸åˆ°äº‘å­˜å‚¨ã€ç¤¾äº¤åª’ä½“ã€æœç´¢å¼•æ“Žå’Œä¸€å¤§å †ä¸œè¥¿ã€‚

è®©æˆ‘ä»¬ä¸è¦é¥±å’Œï¼ŒæŠŠåŒºå—é“¾é™åˆ¶åœ¨åªæœ‰æ¯”ç‰¹å¸ã€‚

> åŒºå—é“¾æ˜¯ä¸€ç§åŸºäºŽå¯†ç å­¦çš„æŠ€æœ¯ã€‚
> æ¯”ç‰¹å¸æ˜¯ä¸€ç§åˆ©ç”¨åŒºå—é“¾æž„å»ºçš„åŠ å¯†è´§å¸ã€‚

> æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æžœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œä½ å¯ä»¥ä¸ºå®ƒé¼“æŽŒã€‚
> æˆ‘ä¹Ÿå¸Œæœ›æœ‰å…³æ³¨:)