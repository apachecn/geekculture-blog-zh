# åœ¨ APU2 ä¸Šå®‰è£… OPNSense

> åŸæ–‡ï¼š<https://medium.com/geekculture/install-opnsense-on-apu2-5e67303d08b?source=collection_archive---------1----------------------->

## PCEngines APU2 å•æ¿ OPNSense å®‰è£…æ¼”ç»ƒ

## å¦‚ä½•åœ¨ APU2 æ¿ä¸Šå®‰è£… OPNSenseï¼Ÿ

![](img/f8a791450ba87b61316e3ac53fac32cf.png)

Photo by [Misha Feshchak](https://unsplash.com/@extaf_ms?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

# ä»‹ç»

åœ¨æˆ‘ä¹‹å‰çš„æ–‡ç« ã€Šè§„åˆ’æˆ‘çš„å®¶åº­å®éªŒå®¤ã€‹ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¯¹ä½ çš„å®éªŒå®¤æœ‰ä¸€ä¸ªè®¡åˆ’æˆ–æ„¿æ™¯çš„é‡è¦æ€§ã€‚å®ƒè®©ä½ æœç€ä½ çš„ç›®æ ‡å‰è¿›ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å¼€å§‹å®ç°æˆ‘çš„å®¶åº­å®éªŒå®¤ã€‚æˆ‘ä»¬å°†å®‰è£…å’Œé…ç½®æˆ‘çš„æ–°å®¶ç”¨è·¯ç”±å™¨ã€‚è¿™å°†æ˜¯ä¸‹ä¸€æ­¥çš„åŸºç¡€ã€‚åœ¨è¿™å°è·¯ç”±å™¨ä¸Šï¼Œæˆ‘è‡³å°‘éœ€è¦é…ç½® DNS å’Œ DHCPã€‚æˆ‘è¿˜ä¼šç”¨ç”µè§†ã€æ¸¸æˆæœºç­‰ä¼‘é—²è®¾å¤‡å°†æˆ‘çš„ç½‘ç»œåˆ†æˆä¸¤éƒ¨åˆ†ã€‚åœ¨å¦ä¸€éƒ¨åˆ†ï¼Œæˆ‘å°†æœ‰æˆ‘çš„å®éªŒå®¤ã€‚

# å¼€å§‹ä¹‹å‰

## ä»€ä¹ˆæ˜¯ OPNSenseï¼Ÿ

> **OPNsense** æ˜¯ä¸€æ¬¾å¼€æºã€æ˜“ç”¨ä¸”æ˜“äºæ„å»ºçš„åŸºäº HardenedBSD çš„é˜²ç«å¢™å’Œè·¯ç”±å¹³å°ã€‚OPNsense åŒ…æ‹¬æ˜‚è´µçš„å•†ä¸šé˜²ç«å¢™çš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹è¿˜æœ‰æ›´å¤šçš„åŠŸèƒ½ã€‚å®ƒå¸¦æ¥äº†å•†ä¸šäº§å“çš„ä¸°å¯Œç‰¹æ€§é›†ï¼Œä»¥åŠå¼€æ”¾å’Œå¯éªŒè¯æ¥æºçš„å¥½å¤„ã€‚â€” [OPNSense ç½‘ç«™](https://opnsense.org/about/about-opnsense/)

åœ¨è¿™æ ·çš„è®¾å¤‡ä¸Šå®‰è£…æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„å¼€æºè½¯ä»¶ã€‚å®ƒå¯ä»¥å–ä»£æ‚¨çš„äº’è”ç½‘æä¾›å•†çš„è°ƒåˆ¶è§£è°ƒå™¨è·¯ç”±å™¨ã€‚

## APU2 å•æ¿æ˜¯ä»€ä¹ˆï¼Ÿ

> PC Engines ä¸ºæ‚¨çš„ç½‘ç»œå®‰å…¨ã€æ— çº¿ç½‘ç»œæˆ–åµŒå…¥å¼åº”ç”¨æä¾›å°å‹ã€ä½åŠŸè€—çš„æœåŠ¡å™¨ã€‚â€” [PCEngines ç½‘ç«™](https://www.pcengines.ch/)

PCEngines ç½‘ç«™ä¸Šçš„è§£é‡Šæ˜¯ç‹¬ç«‹çš„ï¼Œè¶³å¤Ÿæ¸…æ¥šğŸ˜„ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸é€‚åˆçš„ç¡¬ä»¶ï¼Œå¯ä»¥åƒä½ çš„äº’è”ç½‘æä¾›å•†è°ƒåˆ¶è§£è°ƒå™¨è·¯ç”±å™¨ã€‚

# APU2 æ¿ç»„ä»¶

åœ¨æˆ‘ä»¬å¼€å§‹å®‰è£…ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå‡†å¤‡å¥½æ‰€æœ‰çš„ææ–™ã€‚æˆ‘ä»¬å¿…é¡»ç»„è£…è·¯ç”±å™¨ç¡¬ä»¶ã€‚ä½ å¯ä»¥ä¹°ä¸€ä¸ªå·²ç»é€ å¥½çš„è®¾å¤‡ï¼Œä½†æ˜¯å®ƒæ²¡é‚£ä¹ˆå¥½ç©ã€‚

![](img/5e5c1924829f196e512b730f9c32cea5.png)

Photo by [Michael Dziedzic](https://unsplash.com/@lazycreekimages?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

é¦–å…ˆï¼Œè¿™é‡Œæ˜¯è¦ç»„è£…çš„æ‰€æœ‰é›¶ä»¶:

*   [APU2 â€” apu4d4](https://www.pcengines.ch/apu4d4.htm) (æˆ‘å»äº†å››ä¸ª eth å£)
*   [æœºæŸœ 4 LAN USB é»‘è‰²](https://www.pcengines.ch/case1d4blku.htm)(çº¢è‰²å’Œè“è‰²æ˜¯å¦å¤–ä¸¤ä¸ªé€‰é¡¹)
*   [å¸¦æ¬§å¼æ’å¤´çš„äº¤æµé€‚é…å™¨](https://www.pcengines.ch/ac12veur3.htm)(å…¶ä»–å‹å·ä¹Ÿå­˜åœ¨äº PCEngines ä¸Š)
*   [120GB mSATA SSD æ¨¡å—](https://www.pcengines.ch/msata120b.htm)(å½“ç„¶æ˜¯å¤§æå°ç”¨)
*   [æ•£çƒ­å™¨æ”¾ç½®å¤¹å…·](https://www.pcengines.ch/apufix1a0.htm)(æ”¾ç½®çƒ­æ¿çš„å¯é€‰é™„ä»¶)

æ­¤å¤–ï¼Œæˆ‘éœ€è¦å°†æˆ‘çš„ Mac Book Pro ä¸ APU2 è¿æ¥èµ·æ¥ã€‚æˆ‘çš„ç¬”è®°æœ¬ç”µè„‘åªæœ‰ USB-C ç«¯å£ã€‚APU2 æä¾›ä¸€ä¸ª [DB9](https://en.wikipedia.org/wiki/Null_modem) ç«¯å£ã€‚PCEngines å‡ºå”® USB-A è½¬ DB9 çº¿ã€‚æ‰€ä»¥ï¼Œæˆ‘éœ€è¦ä¸€ä¸ª USB-C è½¬ USB-A çš„é€‚é…å™¨ã€‚

*   [USB è½¬ DB9F ä¸²è¡Œé€‚é…å™¨](https://www.pcengines.ch/usbcom1a.htm)
*   [LC-Power USB é€‚é…å™¨ C è½¬ A](https://www.digitec.ch/en/s1/product/lc-power-usb-adapter-c-to-a-usb-cables-7042038)

å¯¹äºæ‰€æœ‰çš„é›¶ä»¶ï¼Œæˆ‘å¿…é¡»æŒ‰ç…§æ–‡æ¡£æ¥ç»„è£…å®ƒä»¬ã€‚ç”±äºæˆ‘æœ‰ä¸€ä¸ª APU2 æ¿ï¼Œæˆ‘åªæœ‰ä¸€ä¸ªå¯¼çƒ­ç‰‡ç²˜è´´åœ¨ CPU ä¸Šã€‚ç¬¬äºŒä¸ªç¯èŠ‚å®Œæˆäº†è¯´æ˜ï¼Œé‡ç‚¹æ˜¯é“æ¿çš„æ”¾ç½®ã€‚

[](https://www.pcengines.ch/apucool.htm) [## PC å‘åŠ¨æœº apu å†·å´ç»„ä»¶

### apucool apu å†·å´ç»„ä»¶æ³¨æ„æ•£çƒ­å¥—ä»¶åŒ…æ‹¬åœ¨ apu æ¿ä¸Šï¼Œä¸éœ€è¦å•ç‹¬è®¢è´­ï¼Œé™¤éâ€¦

www.pcengines.ch](https://www.pcengines.ch/apucool.htm) [](https://www.pcengines.ch/apufix1a.htm) [## PC å¼•æ“ apufix1a äº§å“æ–‡ä»¶

### PC å‘åŠ¨æœº apufix1a æ•£çƒ­å™¨æ”¾ç½®å¤¹å…·

www.pcengines.ch](https://www.pcengines.ch/apufix1a.htm) 

ç»¼ä¸Šï¼Œä»¥ä¸‹æ˜¯æˆ‘åšçš„æ“ä½œ:

1.  æ‹†ä¸‹ DB9 å…­è§’èºæ¯
2.  åœ¨ CPU ä¸Šç²˜è´´ä¸€ä¸ªæ•£çƒ­æ¡ã€‚
3.  ä½¿ç”¨æ•£çƒ­å™¨æ”¾ç½®æŒ‡å—å°†é“æ¿ç²˜è´´åˆ°å¤–å£³ä¸Š
4.  å°† APU2 æ¿æ”¾å…¥è£…æœ‰ CPU æ•£çƒ­æ¡çš„æœºç®±ä¸­ã€‚è¯¥æ¡å°†ä¸é“æ¿æ¥è§¦ã€‚
5.  å°† mSATA SSD æ¨¡å—æ”¾åœ¨ä¸»æ¿çš„å·¦ä¾§ã€‚è®°ä¸‹æ–‡æ¡£ä¸­çš„å¤‡æ³¨ï¼Œä¸è¦å¿˜è®°æ‹§å…¥æ‚¨çš„ mSATA SSD æ¨¡å—ã€‚
6.  æœ€åï¼Œå…³é—­å¹¶æ‹§å…¥å¤–å£³é¡¶éƒ¨ã€‚

![](img/fac1fa82cd671eb536811bbcd90c1d68.png)

APU2 CPU (Screenshot from [PCEngines](https://www.pcengines.ch/pic/apu4b4_2.jpg))

![](img/56f1f9c404a1bef617ca96dcb4d1c725.png)

Left mSATA connector for the SSD module â€” [APU2 Documentation](https://www.pcengines.ch/pdf/apu4.pdf)

ç‰©ç†ç»„è£…ç»“æŸã€‚æ˜¯æ—¶å€™ç¬¬ä¸€æ¬¡å¼€æœºï¼Œè¯•ç€ç”¨è¿™å—æ¿åšç‚¹ä»€ä¹ˆäº†ã€‚

# å‡†å¤‡

å®‰è£…éœ€è¦ä¸€äº›å‡†å¤‡å·¥ä½œã€‚æˆ‘ä»¬éœ€è¦ä¸‹è½½å¹¶å®‰è£…ä¸€äº›å·¥å…·ã€‚

*   [OPNSense](https://opnsense.org/) ä¸²è¡Œå®‰è£…
*   [èš€åˆ»æœº](https://www.balena.io/etcher/)è½¬ u ç›˜

Etcher å°†å…è®¸æˆ‘ä»¬ç”¨ OPNSense å®‰è£…ç¨‹åºåˆ·æ–° u ç›˜ã€‚æˆ‘ä»¬ç¨åå°†ä» u ç›˜å¯åŠ¨è¿›è¡Œå®‰è£…ã€‚

è¦å®‰è£… Etcherï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚å®ƒå‡è®¾ä½ è¿è¡Œåœ¨ Mac OS X ä¸‹ï¼Œå¹¶ä¸”ä½ å·²ç»åœ¨ä½¿ç”¨[å®¶é…¿](https://brew.sh/)ã€‚

```
â¯ brew cask install balenaetcher
```

æˆ‘ä¸æ˜¯é‚£ç§ç»å¸¸éªŒè¯æˆ‘ä¸‹è½½çš„ä¸œè¥¿çš„äººã€‚ä¸‹è½½æŸå/åŒ…å«çš„æ–‡ä»¶æ—¶ï¼Œæˆ‘æ‰¿æ‹…é£é™©ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘æƒ³éµå¾ªæœ€ä½³å®è·µã€‚OPNSense [å®‰è£…æ–‡æ¡£](https://docs.opnsense.org/manual/install.html#download-and-verification)è§£é‡Šäº†å¦‚ä½•æ£€æŸ¥ä¸‹è½½ã€‚

# ä¸‹è½½å¹¶éªŒè¯ OPNSense

ä¸‹è½½ [OPNSense for Serial](https://opnsense.org/download/) å®‰è£…ç¨‹åºã€‚æˆ‘ä¸ºæˆ‘çš„[ä¸‹è½½](https://mirror-opnsense.serverbase.ch/releases/mirror/OPNsense-20.7-OpenSSL-serial-amd64.img.bz2)é€‰äº†ä¸€é¢[ç‘å£«é•œ](https://mirror-opnsense.serverbase.ch/releases/mirror/)ã€‚

![](img/59ed3ad613aa271792837c897341ad2c.png)

OPNSense [download](https://opnsense.org/download/) page

æˆ‘æ£€ç´¢äº†[å…¬é’¥](https://forum.opnsense.org/index.php?topic=18314.msg83193#msg83193)(æ‚¨æœ‰å„ç§æ¥æºå¯ä»¥æ‰¾åˆ°å…¬é’¥)ã€‚é¿å…ä»é•œåƒä¸‹è½½å…¬é’¥ã€‚æ–‡ä»¶æåˆ°äº†è¿™ä¸€ç‚¹ã€‚é•œåƒä¸Šçš„æ‰€æœ‰æ–‡ä»¶éƒ½å¯èƒ½é­åˆ°ç ´åã€‚

è¿˜å¾—åˆ°äº†[ç­¾å](https://mirror-opnsense.serverbase.ch/releases/mirror/OPNsense-20.7-OpenSSL-serial-amd64.img.bz2.sig)å’Œ[æ ¡éªŒå’Œ](https://mirror-opnsense.serverbase.ch/releases/mirror/OPNsense-20.7-OpenSSL-checksums-amd64.sha256)(è¿˜æ˜¯é‚£å¥è¯ï¼Œçœ‹ä½ æŒ‘çš„é•œå­)ã€‚ç„¶åï¼Œæˆ‘è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å¤„ç†ç­¾å:

```
â¯ openssl base64 -d -i <signature_file>.sig -out /tmp/image.sig
```

ä¸ºäº†éªŒè¯å›¾åƒï¼Œæˆ‘è¿è¡Œäº†ä»¥ä¸‹å‘½ä»¤:

```
â¯ openssl dgst -sha256 -verify <key>.pub \
  -signature /tmp/image.sig <image>.img.bz2
```

è¿™æ˜¯ä½ å¯ä»¥æœŸå¾…çš„çœŸå®ä¾‹å­:

```
â¯ openssl base64 -d \
  -in OPNsense-20.7-OpenSSL-serial-amd64.img.bz2.sig \
  -out /tmp/image.sig
â¯ openssl dgst -sha256 -verify opnsense.pub -signature \
  /tmp/image.sig OPNsense-20.7-OpenSSL-serial-amd64.img.bz2

  Verified OK
```

# å‡†å¤‡ USB å¯åŠ¨æ˜ åƒåŒ…

å¯¹äºå®‰è£…ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ªå¸¦æœ‰ OPNSense æ˜ åƒçš„ USB é©±åŠ¨å™¨ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè‡³å°‘ 2Gb çš„é©±åŠ¨å™¨ã€‚åœ¨æ“ä½œè¿‡ç¨‹ä¸­ï¼Œé©±åŠ¨å™¨ä¸Šçš„æ‰€æœ‰æ•°æ®éƒ½å°†ä¸¢å¤±ã€‚ä½¿ç”¨æœ€æ–°çš„ u ç›˜è¿›è¡Œæ­¤æ“ä½œã€‚æˆ‘åœ¨å®‰è£… OPNSense çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†å‡ ä¸ªé—®é¢˜ã€‚æˆ‘çš„ u ç›˜çš„å¹´é¾„æ²¡æœ‰å¸®åŠ©ã€‚

æˆ‘ä»¬éœ€è¦è§£å‹ç¼©å›¾åƒæ–‡ä»¶ã€‚ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥å®Œæˆã€‚

```
â¯ bzip2 -d OPNsense-20.7-OpenSSL-serial-amd64.img.bz2
```

ä¸‹é¢æ˜¯ä½ å¦‚ä½•åˆ·æ–°ä½ çš„ u ç›˜ã€‚è¿æ¥å®ƒï¼Œå¹¶æ‰“å¼€èš€åˆ»æœºåº”ç”¨ç¨‹åºã€‚ç‚¹å‡»â€œä»æ–‡ä»¶åˆ·æ–°â€æŒ‰é’®ã€‚é€‰æ‹©ä½ è§£å‹çš„å›¾åƒæ–‡ä»¶ã€‚

![](img/df579ba1448a30df417596bae4c61e02.png)

Etcher screenshot

ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ OPNSense é€‰æ‹©è¦ç”¨ä½œå¯åŠ¨é©±åŠ¨å™¨çš„ USB é©±åŠ¨å™¨ã€‚æœ€åï¼Œç‚¹å‡»â€œé—ªå…‰â€æŒ‰é’®ã€‚

![](img/d2eb6d28df1357b5db7c8f90cd923b00.png)![](img/e12bb34a2c09b73fdebf285fc2e929d8.png)![](img/df4a923f19df5f7d9e78e4c49d1551c1.png)

Etcher screenshots

ç­‰å¾…ï¼Œç›´åˆ°å®Œæˆåˆ·æ–°è¿‡ç¨‹ã€‚

![](img/792b2ff181c134803f8d74002adf1bf0.png)![](img/7ef954c04bebe4ed9be2790288d63c6c.png)

Etcher screenshots

ä½ çš„ USB å¯åŠ¨é©±åŠ¨å™¨å‡†å¤‡å¥½äº†ã€‚æ‚¨å¯ä»¥å°†å…¶æ–­å¼€ï¼Œç„¶åç»§ç»­ä¸‹ä¸€æ­¥ã€‚

# å®‰è£… OPNSense

å¯¹äºç¬¬ä¸€æ¬¡å¯åŠ¨ï¼Œå‡†å¤‡ä¸æ¿çš„ç‰©ç†è¿æ¥ã€‚å°† USB-C è½¬ USB-A é€‚é…å™¨è¿æ¥åˆ° USB-A è½¬ DB9 ç”µç¼†å’Œé€‚é…å™¨ã€‚ç„¶åå°† USB-C è¿æ¥åˆ°æ‚¨çš„è®¡ç®—æœºï¼Œä»¥åŠ(æ˜¾ç„¶)æ‚¨çš„ä¸»æ¿ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡æ’å…¥ç”µæºè¿æ¥å™¨æ¥å¯åŠ¨ä¸»æ¿ã€‚

æ‰“å¼€ä¸€ä¸ªç»ˆç«¯çª—å£æ¥æŸ¥æ‰¾æ‚¨å¯ä»¥è¿æ¥çš„è®¾å¤‡ã€‚ä¸ºæ­¤ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
â¯ ls -laht /dev/*usbserial* 
  crw-rw-rw- ... /dev/cu.usbserial-01E7357C 
  crw-rw-rw- ... /dev/tty.usbserial-01E7357C
```

å¦‚æœä»€ä¹ˆä¹Ÿæ²¡æ‰¾åˆ°ï¼Œå¯èƒ½éœ€è¦å®‰è£…ä¸²å£æ§åˆ¶å°èŠ¯ç‰‡é©±åŠ¨ã€‚æ‚¨å¯ä»¥åœ¨ [Silicon Labs ç½‘ç«™](https://www.silabs.com/products/development-tools/software/usb-to-uart-bridge-vcp-drivers)ä¸Šæ‰¾åˆ° CP2104 èŠ¯ç‰‡ç»„çš„é©±åŠ¨ç¨‹åºã€‚Teklager ç½‘ç«™ä¸Šçš„ä¸€äº›è¡¥å……ä¿¡æ¯ã€‚é©±åŠ¨ç¨‹åºçš„å®‰è£…å¾ˆç®€å•ã€‚

æ‰¾åˆ°è®¾å¤‡åï¼Œæ‚¨å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥è¿æ¥ APU2:

```
â¯ screen /dev/cu.usbserial-01E7357C 115200,8n1
```

ç»“æœä¼šæ˜¯è¿™æ ·çš„:

![](img/e6b40852ca58034479e3384ed67f2acb.png)

OPNSense â€” Screen connection ([https://asciinema.org/a/ohlTGY9unrIzCknMfMAzDDwN5](https://asciinema.org/a/ohlTGY9unrIzCknMfMAzDDwN5))

æŒ‰`F10`ä» u ç›˜å¯åŠ¨ã€‚

æˆ‘ç¬¬ä¸€æ¬¡å°è¯•ä» u ç›˜å¯åŠ¨æ—¶ï¼Œé‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ã€‚å°±åƒæˆ‘çš„ u ç›˜ä¸å¯è¯»ã€‚APU2 æ¿ä¸èƒ½è¯»å–å®ƒã€‚è¯·çœ‹ä¸‹é¢ä¸¤å¼ æˆªå›¾ä¸­çš„é”™è¯¯ã€‚

![](img/aeec4657eb70146a62ebdb43b9cc6582.png)

CCB request retries

![](img/b58c304452022ee9c5bd1f0d51a94386.png)

Boot failure

åœ¨è¿™é‡Œï¼Œè¿™æ„å‘³ç€ä½ çš„ u ç›˜ä¸è¢« APU2 æ”¯æŒã€‚å¯¹æˆ‘æ¥è¯´ï¼Œå¯èƒ½æ˜¯å› ä¸ºæˆ‘çš„ u ç›˜æ—§äº†ã€‚å› æ­¤ï¼Œæ‚¨æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆ:

1.  ä½¿ç”¨æœ€æ–°çš„ u ç›˜
2.  å°½å¯èƒ½é¢‘ç¹åœ°é‡è¯•å¼•å¯¼ã€‚æˆ‘èŠ±äº† 2-3 æ¬¡æ‰æ­£ç¡®å¯åŠ¨ã€‚æˆ‘ä¼šå°½å¿«é€‰æ‹©ç¬¬ä¸€ä¸ªé€‰é¡¹ï¼Œä½†åŒæ—¶ï¼Œç¬¬äºŒä¸ªé€‰é¡¹ä¹Ÿå¯ä»¥ğŸ˜ã€‚

å¯¹äºç¬¬äºŒä¸ªé€‰é¡¹ï¼Œå½“æç¤ºç¬¦å¯ç”¨æ—¶ï¼Œæ‚¨å¯ä»¥é”®å…¥`reboot`ã€‚

![](img/8a4ddfcfd60361c0cbc27d5e980e19f1.png)

APU2 reboot command

ä¸€æ—¦æ‚¨å®Œæˆäº†ä» u ç›˜å¯åŠ¨ OPNSenseï¼Œæ‚¨å°±å¯ä»¥å®‰è£…å®ƒäº†ã€‚åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¿ç•™äº†æ‰€æœ‰é€‰é¡¹çš„é»˜è®¤å€¼ã€‚æ‚¨å¯ä»¥åœ¨è¿™ä¸ª cast ä¸­è§‚å¯Ÿåˆ°å®Œæ•´çš„å¼•å¯¼åºåˆ—:

[](https://asciinema.org/a/SaGnAeDg3Gdrhop1cC1PzQM5q) [## OPNSense å®‰è£…â€”å®‰è£…å‰å¯åŠ¨â€” 1 åˆ† 31 ç§’

### ç”± Prevole è®°å½•

asciinema.org](https://asciinema.org/a/SaGnAeDg3Gdrhop1cC1PzQM5q) 

ç„¶åæˆ‘ä½¿ç”¨äº†ç”¨æˆ·`installer`å’Œå¯†ç `opnsense`ã€‚OPNSense æ–‡æ¡£ä¸­æä¾›äº†å‡­æ®ã€‚

![](img/3f7bd14c5185ff9252176ba811ba70c5.png)

Login to the OPNSense installer

ä¹‹åï¼ŒæŒ‰ä¸‹æ–‡æœ¬`< Ok, letâ€™s go >`ä¸Šçš„`enter`å¼€å§‹å®‰è£…ã€‚

![](img/7ca60786fc1000bdfade626a451f9d2a.png)

Install start

æ‚¨å¯ä»¥é…ç½®æŒ‰é”®æ˜ å°„å’Œè§†é¢‘è®¾ç½®ã€‚æˆ‘ä¿ç•™äº†é»˜è®¤å€¼ã€‚æˆ‘æŒ‰ä¸‹äº†`< Accept these Settings >`ä¸Šçš„`enter`ã€‚

![](img/7b4f936e6cc6a42b56b18e28ef99d15c.png)

Keymap and Video Settings

ä¹‹åï¼Œæˆ‘å›ç­”äº†å¦‚ä½•å®‰è£… OPNSense çš„ä¸åŒé€‰é¡¹ã€‚æˆ‘æŒ‰ä¸‹äº†`< Guided installation >`ä¸Šçš„`enter`ã€‚

![](img/d3004a0bbdb7813f63609522dc65b6cf.png)

Guided Installation

ä¸¥è‚ƒçš„äº‹æƒ…å¼€å§‹äº†ã€‚é€‰æ‹©å®‰è£…çš„ç›®çš„åœ°ã€‚æˆ‘åœ¨`< ada0: 114473MB (234441648 512 byte sectors) >`ä¸ŠæŒ‰äº†`enter`ï¼Œè¿™æ˜¯æˆ‘çš„ SSD å­˜å‚¨ã€‚

![](img/5fd3a9da6600f7290a07bcf2f67548a1.png)

Installation Target

ç„¶åï¼Œæ‚¨å¯ä»¥é€‰æ‹©å®‰è£…æ¨¡å¼ã€‚æˆ‘æŒ‰ä¸‹äº†é»˜è®¤æ¨¡å¼`< GPT/UEFI mode >`ä¸Šçš„`enter`é”®ã€‚

![](img/521c56d16316d4181bff7a8f0212263c.png)

Installation Mode

æœ€åï¼Œå®‰è£…å¼€å§‹ã€‚å®šä¹‰äº¤æ¢å¤§å°ã€‚æˆ‘é€šè¿‡æŒ‰ä¸‹`< yes >`ä¸Šçš„`enter`ç¦»å¼€äº†é»˜è®¤é…ç½®ã€‚

![](img/31abd5019c3cd26c4d87a77e339c6878.png)

Swap Partition Size

ä¹‹åï¼Œå®ƒä¼šå¤åˆ¶æ–‡ä»¶ã€‚å®‰è£…éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ã€‚ç„¶åï¼Œæ‚¨å°†çœ‹åˆ°è®¾ç½® root å¯†ç çš„æç¤ºã€‚å¡«å†™å¯†ç å­—æ®µå¹¶æŒ‰ä¸‹`enter`ã€‚æŒ‰ä¸‹`< Accept and Set Password >`ä¸Šçš„`enter`ã€‚

![](img/e60010e7e2a103f65d6fd964f38b22f7.png)

Root Password Setup

æœ€åï¼Œåœ¨æ‰€æœ‰è¿™äº›æ­¥éª¤ä¹‹åï¼Œé‡æ–°å¯åŠ¨æˆ–é€‰æ‹©å¦ä¸€ä¸ªä»»åŠ¡ã€‚æˆ‘é€šè¿‡æŒ‰ä¸‹`< Reboot >`ä¸Šçš„`enter`æ¥é‡å¯ã€‚

![](img/35c57574eeb4ecca855388e884158115.png)

Reboot after Installation

åœ¨é‡å¯è¿‡ç¨‹ä¸­ï¼Œæ‚¨ä¼šå¾—åˆ°å¦‚ä½•è¿æ¥åˆ°è®¾å¤‡çš„ä¿¡æ¯ã€‚

![](img/1498249d158a89f231371d8e8ff27f5a.png)

Post Install Instructions

å¦‚æœæ‚¨æƒ³æŸ¥çœ‹æ•´ä¸ªå®‰è£…è¿‡ç¨‹ï¼Œæ‚¨å¯ä»¥è¿›å…¥å±å¹•å½•åˆ¶(5 åˆ†é’Ÿå½•åˆ¶)ã€‚ä¸Šé¢æ˜¾ç¤ºçš„æ‰€æœ‰æˆªå›¾éƒ½æ¥è‡ªè¿™ä¸ªå±å¹•è®°å½•ã€‚

[](https://asciinema.org/a/iJU90iAlXbq1qGdfH6sWhhTIf) [## OPNSense å®‰è£…â€” 5 åˆ†é’Ÿ

### ç”± Prevole è®°å½•

asciinema.org](https://asciinema.org/a/iJU90iAlXbq1qGdfH6sWhhTIf) 

æˆ‘çš„ APU2 æ¿ç°åœ¨å®‰è£…äº† OPNSenseã€‚è€å®è¯´ï¼Œè¿™å¹¶ä¸é‚£ä¹ˆå¾®ä¸è¶³é“ã€‚é€šè¿‡å±å¹•è¿æ¥çš„ä¸²è¡Œæ§åˆ¶å°å¯¹æˆ‘æ¥è¯´æ˜¯ç¬¬ä¸€æ¬¡ã€‚æˆ‘ç¬¬ä¸€æ¬¡å°è¯•é€šè¿‡ä¸²è¡Œè¿æ¥åœ¨è®¾å¤‡ä¸Šå®‰è£… OPNSenseã€‚æˆ‘å…è®¸ä½ ä¸ºæ­¤å˜²ç¬‘æˆ‘ã€‚æˆ‘æ„è¯†åˆ°æˆ‘çš„é”™è¯¯ï¼Œä»¥ 115200 bit/s çš„é€Ÿåº¦ä¼ è¾“ 2Gb éœ€è¦æ—¶é—´ã€‚2Gb æ˜¯ 2e+9 ä½ã€‚åœ¨è¿™ä¸ªé€Ÿåº¦ä¸‹ï¼Œéœ€è¦ 17361 ç§’â†’å¤§çº¦ã€‚4 å°æ—¶ğŸ˜…ã€‚

æˆ‘ä¸æ¸…æ¥š OPNSense å®‰è£…çš„æ–‡æ¡£ã€‚æˆ‘ä¸æ˜ç™½æˆ‘å¿…é¡»å‡†å¤‡ä¸€ä¸ªå¸¦æœ‰ OPNSense å›¾åƒçš„ u ç›˜ã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å®‰è£…è¿™ç§è½¯ä»¶ã€‚åœ¨æ–‡æ¡£ä¸­ï¼Œä»–ä»¬æœ‰ä¸€äº› dd å‘½ä»¤ã€‚è¿™æ˜¯å‡†å¤‡ u ç›˜çš„å‘½ä»¤è¡Œæ–¹æ³•ã€‚æˆ‘æ›´å–œæ¬¢ç”¨èš€åˆ»æœºä»£æ›¿ã€‚

# ç»“è®º

ä»å¤´å¼€å§‹å®‰è£…æ€»æ˜¯æ¯”è¿ç§»å®¹æ˜“ã€‚æˆ‘ä»¥å‰æ²¡æœ‰å®‰è£…è¿‡ OPNSenseã€‚å› æ­¤ï¼Œæˆ‘æ²¡æœ‰æ—§çš„é…ç½®æ–‡ä»¶å¯ä»¥ä½¿ç”¨ã€‚ä¸ä»ç°æœ‰è®¾ç½®å¼€å§‹ç›¸æ¯”ï¼Œä»å¤´å¼€å§‹æ€»æ˜¯æ›´å®¹æ˜“ã€‚

ç°åœ¨æˆ‘å·²ç»å®‰è£…äº†å®ƒï¼Œæˆ‘éœ€è¦ç”¨ä¸åŒçš„æœåŠ¡(DNSï¼ŒDHCPï¼Œâ€¦)é…ç½®æˆ‘çš„è·¯ç”±å™¨ã€‚æˆ‘å°†åœ¨ä»¥åçš„æ–‡ç« ä¸­è®¨è®ºæ‰€æœ‰è¿™äº›å†…å®¹ã€‚ä½†æ˜¯åœ¨å¼€å§‹é…ç½®ä¹‹å‰ï¼Œæˆ‘æƒ³æ›´æ–°ä¸€ä¸‹å›ºä»¶ã€‚ä¸è¿™æ¬¡å®‰è£…ç›¸æ¯”ï¼Œè¿™å°†æ›´å…·æŒ‘æˆ˜æ€§ã€‚

# å‚è€ƒ

æˆ‘ç”¨ asciinema è®°å½•äº†æˆ‘çš„ç»ˆç«¯ä¼šè¯ã€‚å®ƒå¯ä»¥æ•æ‰æˆ‘æ­£åœ¨åšçš„äº‹æƒ…ï¼Œå¹¶åœ¨ç¨åæˆªå›¾ã€‚å»¶æœŸå·¥ä½œæ˜¯ä¸€ç§ä¾¿æ·çš„æ–¹å¼ã€‚

[](https://asciinema.org/) [## asci NEMAâ€”ä»¥æ­£ç¡®çš„æ–¹å¼è®°å½•å’Œåˆ†äº«æ‚¨çš„ç»ˆç«¯ä¼šè¯

### å°±åœ¨ä½ å·¥ä½œçš„åœ°æ–¹å½•éŸ³â€”â€”åœ¨ç»ˆç«¯é‡Œã€‚è¦å¼€å§‹ï¼Œåªéœ€è¿è¡Œ asciinema recï¼Œè¦å®Œæˆï¼Œè¯·æŒ‰ Ctrl-D æˆ–é”®å…¥ exitã€‚è·å¾—â€¦

asciinema.org](https://asciinema.org/) 

ä¸å¹¸çš„æ˜¯ï¼Œåœ¨ä»‹è´¨ä¸Šæ²¡æœ‰å†…åµŒçš„ asciinemaã€‚æ‰€ä»¥ï¼Œæˆ‘æ‰¾åˆ°çš„æœ€ç®€å•çš„è§£å†³åŠæ³•å°±æ˜¯æŠŠæˆ‘çš„ä¸€äº›å±å¹•å½•åƒè½¬æ¢æˆ gifã€‚ä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨äº†å·¥å…· asciicast2gifã€‚å®ƒå¾—åˆ°äº† asciinema çš„æ”¯æŒã€‚

[](https://github.com/asciinema/asciicast2gif) [## asciinema/asciicast2gif

### asciicast2gif æ˜¯ä¸€ä¸ªä» asciinema è®°å½•çš„ asciicast æ–‡ä»¶ç”Ÿæˆ gif åŠ¨ç”»çš„å·¥å…·ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•â€¦

github.com](https://github.com/asciinema/asciicast2gif) 

æˆ‘è¿˜ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·æ¥ç¼–è¾‘æˆ‘çš„å±å¹•è®°å½•ã€‚ä¾‹å¦‚ï¼Œæˆ‘å¯ä»¥å‡å°‘ä¸¤ä¸ªè¾“å‡ºä¹‹é—´çš„å»¶è¿Ÿï¼Œæˆ‘å¯ä»¥åˆ å‡éƒ¨åˆ†å½•éŸ³ã€‚æˆ‘çš„ OPNSense å®‰è£…è®°å½•æŒç»­äº†å¤§çº¦ 25 åˆ†é’Ÿã€‚æˆ‘å‹ç¼©åˆ° 5 åˆ†é’Ÿã€‚

[](https://github.com/cirocosta/asciinema-edit) [## Ciro Costa/asci inema-ç¼–è¾‘

### ç¼–è¾‘æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå®ƒçš„ç›®çš„æ˜¯å¯¹å­—ç¬¦ä¸²è¿›è¡Œåå¤„ç†â€¦

github.com](https://github.com/cirocosta/asciinema-edit) 

è¿™ç¯‡ä¸­å‹æ–‡ç« å¸®åŠ©æˆ‘åœ¨æ–‡ç« ä¸­åµŒå…¥äº†ç»ˆç«¯ä¼šè¯ã€‚

[](/dac-technology-blog/how-to-embed-recorded-terminal-sessions-asciicasts-in-your-posts-c25ac30019c3) [## å¦‚ä½•åœ¨ä½ çš„æ–‡ç« ä¸­åµŒå…¥è®°å½•çš„ç»ˆç«¯ä¼šè¯

### é€šè¿‡ä¸‰ä¸ªç®€å•çš„æ­¥éª¤å­¦ä¹ å¦‚ä½•ç”¨å½•åˆ¶çš„ç»ˆç«¯ä¼šè¯æ¥è¡¥å……ä½ çš„åª’ä½“æ–‡ç« ã€‚

medium.com](/dac-technology-blog/how-to-embed-recorded-terminal-sessions-asciicasts-in-your-posts-c25ac30019c3) 

å®¶é…¿æ˜¯ Mac OS X ä¸Šä½¿ç”¨æœ€å¤šçš„åŒ…ç®¡ç†å™¨ï¼Œä»¥å‰æˆ‘éƒ½æ˜¯ç”¨ Mac ç«¯å£ã€‚ç°åœ¨ï¼Œæˆ‘åªä½¿ç”¨è‡ªåˆ¶è½¯ä»¶ï¼Œå› ä¸ºå®ƒè¿˜èƒ½å®‰è£…ä¸°å¯Œçš„åº”ç”¨ç¨‹åºã€‚

[](https://brew.sh/) [## å…¬å¸è‡ªäº§è‡ªç”¨

### macOS(æˆ– Linux)ç¼ºå¤±çš„è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚

brew.sh](https://brew.sh/) 

æˆ‘ç”¨æ¥æ³¨é‡Šæˆªå›¾çš„å¦ä¸€ä¸ªå·¥å…·æ˜¯ Evernote çš„ Skitchã€‚å®ƒå…è´¹ä¸”æ˜“äºä½¿ç”¨ã€‚å®ƒåšäº†æˆ‘éœ€è¦çš„å·¥ä½œï¼Œæ²¡æœ‰å¤ªå¤šçš„é€‰æ‹©ã€‚ä» app æ‹–æ”¾åˆ° finder ä¸­çš„æ–‡ä»¶å¤¹ï¼Œå°±è¶³ä»¥ä»æˆªå›¾ç”Ÿæˆ PNG æ–‡ä»¶ã€‚

[](https://evernote.com/products/skitch) [## Skitch | Evernote

### Evernote ä½¿ç”¨ cookies æ¥å¯ç”¨ Evernote æœåŠ¡ï¼Œå¹¶æ”¹å–„æ‚¨çš„ä½“éªŒã€‚è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹â€¦

evernote.com](https://evernote.com/products/skitch) 

ä¸ºäº†åˆ·æ–°æˆ‘çš„ u ç›˜ï¼Œæˆ‘ç”¨äº† Balena çš„ Etcherã€‚è¿™æ˜¯ä¸€ä¸ªå®¹æ˜“ä½¿ç”¨çš„å·¥å…·ã€‚å®ƒå¯ä»¥ä¸€æ¬¡é—ªç°å¾ˆå¤šæ ¹æ£å­ã€‚

[](https://www.balena.io/etcher/) [## balenaEtcher â€”å°†æ“ä½œç³»ç»Ÿæ˜ åƒé—ªå­˜åˆ° SD å¡å’Œ USB é©±åŠ¨å™¨

### Electron åŸºäº Gtk2ï¼Œæ— æ³•åœ¨ Wayland ä¸ŠåŸç”Ÿè¿è¡Œã€‚å¹¸è¿çš„æ˜¯ï¼ŒXWayland æœåŠ¡å™¨æä¾›äº†å‘åâ€¦

www.balena.io](https://www.balena.io/etcher/) 

TekLager å•†ä¸šç½‘ç«™è‡´åŠ›äº APU/ALIX æ¿æˆ–ç±»ä¼¼çš„äº§å“ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„çŸ¥è¯†åº“ã€‚æˆ‘æ‰¾åˆ°ä¸€ç¯‡å…³äºä¸²è¡Œæ§åˆ¶å°çš„æ–‡ç« ä½œä¸ºä¾‹å­ã€‚å®ƒè¿˜åŒ…å«å…³äº PFSense å’Œ OPNSense çš„æ–‡ç« ã€‚

[](https://teklager.se/en/knowledge-base/) [## TekLager â€”çŸ¥è¯†åº“

### åœ¨ APU æ¿ä¸Šå®‰è£… pfSenseï¼ŒIPFireï¼ŒOPNSenseã€‚APU VPN æ€§èƒ½ã€‚pfSense ä¸ OPNSense

teklager.se](https://teklager.se/en/knowledge-base/) 

æœ€åæ˜¯ OPNSense å’Œ PCEngines çš„å®˜ç½‘ã€‚

 [## OPNsense æ˜¯ä¸€ä¸ªçœŸæ­£çš„å¼€æºå®‰å…¨å¹³å°ï¼Œç­‰ç­‰â€” OPNsense æ˜¯ä¸€ä¸ªçœŸæ­£çš„å¼€æºé˜²ç«å¢™â€¦

### â€œä¸æˆ‘ä»¬å¼€å‘çš„ä»»ä½•å…¶ä»–å•†ç”¨é˜²ç«å¢™äº§å“ç›¸æ¯”ï¼ŒOPNsense æä¾›äº†æ›´å¤šçš„åŠŸèƒ½ã€æ›´é«˜çš„å¯é æ€§å’Œæ›´å¥½çš„æ€§èƒ½â€¦â€¦

opnsense.org](https://opnsense.org/) [](https://pcengines.ch/) [## ç”µè„‘å¼•æ“ä¸»é¡µ

### ç”µè„‘å¼•æ“ä¸»é¡µ

PC å¼•æ“ homepcengines.ch](https://pcengines.ch/)