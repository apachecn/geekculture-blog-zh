<html>
<head>
<title>How To Perform Map Reduce In Mongo DB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•åœ¨Mongo DBä¸­æ‰§è¡ŒMap Reduce</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/how-to-perform-map-reduce-in-mongo-db-abe35dc0ef78?source=collection_archive---------43-----------------------#2021-07-04">https://medium.com/geekculture/how-to-perform-map-reduce-in-mongo-db-abe35dc0ef78?source=collection_archive---------43-----------------------#2021-07-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/292d024a743c523d6a41133f6625b449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lIrkCPt-eniN53H0"/></div></div></figure><p id="e84f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å˜¿ï¼Œä¼™è®¡ä»¬ï¼Œå¸Œæœ›ä½ ä»¬åœ¨ä»Šå¤©çš„æ–‡ç« ä¸­æ‰€åšçš„äº‹æƒ…ã€‚æˆ‘ä»¬å°†å¯¹mongoæ•°æ®åº“é›†ç¾¤ä¸­çš„æ•°æ®è¿›è¡Œæ’åºï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼æ¥å®Œæˆè¿™é¡¹å·¥ä½œï¼Œä½†ä»Šå¤©æˆ‘ä»¬å°†ä½¿ç”¨map-reduceå¯¹mongoæ•°æ®åº“é›†ç¾¤ä¸­çš„æ•°æ®è¿›è¡Œæ’åºã€‚</p><p id="5596" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨map-reduceä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªç”¨äºæ˜ å°„æ•°æ®ï¼Œæ— å¤„æ˜ å°„æ˜¯æŒ‡å‡è®¾æ‚¨æœ‰1000ä¸ªæ–‡æ¡£(åœ¨mongoæ–‡æ¡£ä¸­æ˜¯æŒ‡æˆ‘ä»¬ä»ç”¨æˆ·é‚£é‡Œè·å¾—çš„æ¯ä¸ªæ•°æ®) å‡è®¾åœ¨è¯¥æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬æœ‰è®¸å¤šå…·æœ‰ç›¸åŒå®¢æˆ·idçš„å®¢æˆ·ï¼Œä½†ä»–ä»¬æ¯æ¬¡éƒ½è´­ä¹°æ–°äº§å“ï¼Œå¹¶ä¸”æ¯æ¬¡å®¢æˆ·è´­ä¹°å®¢æˆ·æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ¡ç›®ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¸Œæœ›åˆ¶ä½œä¸€ä¸ªä»¥å®¢æˆ·idå‘½åçš„åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«è¯¥å®¢æˆ·idèŠ±è´¹çš„æ‰€æœ‰ä»·æ ¼ï¼Œä¸€æ—¦æˆ‘ä»¬è·å¾—æ¯ä¸ªå®¢æˆ·çš„ä»·æ ¼åˆ—è¡¨ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰§è¡ŒåŠ æ³•è¿ç®—(è¿™å–å†³äºæ‚¨æƒ³è¦åšä»€ä¹ˆ æœ‰äº†è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬åªéœ€ç¼–å†™å‡½æ•°)æ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡Œç¼–å†™reduceå‡½æ•°ï¼Œå®ƒå¤„ç†æˆ‘ä»¬åœ°å›¾æ•°æ®å¹¶ç»™å‡ºæˆ‘ä»¬æƒ³è¦çš„æœ€ç»ˆè¾“å‡ºã€‚</p><p id="cc58" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æˆ‘å¸Œæœ›ä½ èƒ½äº†è§£ä»€ä¹ˆæ˜¯map-reduceç¨‹åºï¼Œç°åœ¨è®©æˆ‘ä»¬å¼€å§‹å®è·µï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£ã€‚</p><p id="d3a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤åˆ›å»ºä¸€ä¸ªç¤ºä¾‹é›†åˆï¼Œå®ƒåŒ…å«æ‚¨æƒ³è¦çš„ä»»ä½•æ•°æ®åº“ä¸­çš„åç§°é¡ºåºã€‚</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1522" class="jx jy hi jt b fi jz ka l kb kc">use [database name]<br/>db.orders.insertMany([ { _id: 1, cust_id: â€œAnt O. Kneeâ€, ord_date: new Date(â€œ2020â€“03â€“01â€), price: 25, items: [ { sku: â€œorangesâ€, qty: 5, price: 2.5 }, { sku: â€œapplesâ€, qty: 5, price: 2.5 } ], status: â€œAâ€ }, { _id: 2, cust_id: â€œAnt O. Kneeâ€, ord_date: new Date(â€œ2020â€“03â€“08â€), price: 70, items: [ { sku: â€œorangesâ€, qty: 8, price: 2.5 }, { sku: â€œchocolatesâ€, qty: 5, price: 10 } ], status: â€œAâ€ }, { _id: 3, cust_id: â€œBusby Beeâ€, ord_date: new Date(â€œ2020â€“03â€“08â€), price: 50, items: [ { sku: â€œorangesâ€, qty: 10, price: 2.5 }, { sku: â€œpearsâ€, qty: 10, price: 2.5 } ], status: â€œAâ€ }, { _id: 4, cust_id: â€œBusby Beeâ€, ord_date: new Date(â€œ2020â€“03â€“18â€), price: 25, items: [ { sku: â€œorangesâ€, qty: 10, price: 2.5 } ], status: â€œAâ€ }, { _id: 5, cust_id: â€œBusby Beeâ€, ord_date: new Date(â€œ2020â€“03â€“19â€), price: 50, items: [ { sku: â€œchocolatesâ€, qty: 5, price: 10 } ], status: â€œAâ€}, { _id: 6, cust_id: â€œCam Elotâ€, ord_date: new Date(â€œ2020â€“03â€“19â€), price: 35, items: [ { sku: â€œcarrotsâ€, qty: 10, price: 1.0 }, { sku: â€œapplesâ€, qty: 10, price: 2.5 } ], status: â€œAâ€ }, { _id: 7, cust_id: â€œCam Elotâ€, ord_date: new Date(â€œ2020â€“03â€“20â€), price: 25, items: [ { sku: â€œorangesâ€, qty: 10, price: 2.5 } ], status: â€œAâ€ }, { _id: 8, cust_id: â€œDon Quisâ€, ord_date: new Date(â€œ2020â€“03â€“20â€), price: 75, items: [ { sku: â€œchocolatesâ€, qty: 5, price: 10 }, { sku: â€œapplesâ€, qty: 10, price: 2.5 } ], status: â€œAâ€ }, { _id: 9, cust_id: â€œDon Quisâ€, ord_date: new Date(â€œ2020â€“03â€“20â€), price: 55, items: [ { sku: â€œcarrotsâ€, qty: 5, price: 1.0 }, { sku: â€œapplesâ€, qty: 10, price: 2.5 }, { sku: â€œorangesâ€, qty: 10, price: 2.5 } ], status: â€œAâ€ }, { _id: 10, cust_id: â€œDon Quisâ€, ord_date: new Date(â€œ2020â€“03â€“23â€), price: 25, items: [ { sku: â€œorangesâ€, qty: 10, price: 2.5 } ], status: â€œAâ€ }])</span></pre><p id="4af1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨ä¸Šé¢çš„å‘½ä»¤ä¸­ï¼Œé¡ºåºåªæ˜¯ä¸€ä¸ªé›†åˆåç§°ï¼Œä½ å¯ä»¥æŠŠå®ƒæ”¹æˆä½ æƒ³è¦çš„ä»»ä½•åç§°ã€‚</p><p id="6dce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Mongo DBä¸­ä¸€äº›æœ‰åŠ©äºä¸€èˆ¬æ“ä½œçš„å‘½ä»¤ã€‚</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="af3e" class="jx jy hi jt b fi jz ka l kb kc">use dbname to change dbname<br/>show collections to get collection in db<br/>db.collectionnaame.find()=&gt; To see all data of collection</span></pre><p id="bc55" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨æˆ‘ä»¬å‡†å¤‡åˆ¶ä½œæ˜ å°„å™¨å‡½æ•°æ¥æ˜ å°„æ•°æ®ã€‚</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="5002" class="jx jy hi jt b fi jz ka l kb kc">var mapFunction1 = function() {</span><span id="18f9" class="jx jy hi jt b fi kd ka l kb kc">emit(this.cust_id, this.price);</span><span id="30d3" class="jx jy hi jt b fi kd ka l kb kc">};<br/></span></pre><p id="a147" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨ä¸Šé¢çš„æ˜ å°„å™¨å‡½æ•°ä¸­ï¼Œè¿™æ˜¯æŒ‡ç‰¹å®šæ–‡æ¡£çš„åœ°å€ï¼Œå¹¶å‘å‡ºtake key: valueå¯¹ï¼Œä»¥åœ¨ä¸Šé¢çš„å‘½ä»¤ä¸­å¯¹é›†åˆä¸­çš„é¡¹ç›®è¿›è¡Œåˆ†ç»„ï¼Œcust_idæ˜¯æˆ‘ä»¬çš„é”®ï¼Œpriceæ˜¯å€¼ã€‚åœ¨åç«¯è¿è¡Œè¯¥å‘½ä»¤åï¼Œæ¯ä¸ªå®¢æˆ·çš„æ•°æ®å°†ç±»ä¼¼äº{"cust_id":[price1ï¼Œprice 2ï¼Œetc]}ã€‚</p><p id="385e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥åˆ›å»ºæˆ‘ä»¬çš„reducerå‡½æ•°äº†ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå¸¦æœ‰ä¸¤ä¸ªå‚æ•°cust_idå’Œpriceï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨mapperå‡½æ•°ä¸­åˆ›å»ºçš„ï¼Œå¹¶è¿”å›æ•°ç»„ä¸­çš„ä¸€äº›å…ƒç´ ã€‚</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c0ae" class="jx jy hi jt b fi jz ka l kb kc">var reduceFunction1 = function(keyCustId, valuesPrices) {</span><span id="de1b" class="jx jy hi jt b fi kd ka l kb kc">return Array.sum(valuesPrices);</span><span id="ed44" class="jx jy hi jt b fi kd ka l kb kc">};</span></pre><p id="e4a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥ä»ä¸‹é¢çš„å‘½ä»¤ä¸­è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="d002" class="jx jy hi jt b fi jz ka l kb kc">db.[collection name].mapReduce(</span><span id="fe55" class="jx jy hi jt b fi kd ka l kb kc">[mapfunction name],</span><span id="3160" class="jx jy hi jt b fi kd ka l kb kc">[mapfunction name],</span><span id="e96d" class="jx jy hi jt b fi kd ka l kb kc">{ out: <strong class="jt hj">[any collection name you want output want to be save]</strong> }</span><span id="8adc" class="jx jy hi jt b fi kd ka l kb kc">)</span><span id="e4e9" class="jx jy hi jt b fi kd ka l kb kc">Eg:-db.orders.mapReduce(</span><span id="86fa" class="jx jy hi jt b fi kd ka l kb kc">mapFunction1,</span><span id="f7bd" class="jx jy hi jt b fi kd ka l kb kc">reduceFunction1,</span><span id="ea2e" class="jx jy hi jt b fi kd ka l kb kc">{ out: <strong class="jt hj">â€œmap_reduce_exampleâ€</strong> }</span><span id="483e" class="jx jy hi jt b fi kd ka l kb kc">)</span></pre><p id="3567" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¦‚æœæƒ³çŸ¥é“æ›´å¤šå…³äºä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„mongoå®˜æ–¹ç½‘ç«™é“¾æ¥ã€‚</p><div class="ke kf ez fb kg kh"><a href="https://docs.mongodb.com/manual/tutorial/map-reduce-examples/" rel="noopener  ugc nofollow" target="_blank"><div class="ki ab dw"><div class="kj ab kk cl cj kl"><h2 class="bd hj fi z dy km ea eb kn ed ef hh bi translated">åœ°å›¾ç¼©å°ç¤ºä¾‹</h2><div class="ko l"><h3 class="bd b fi z dy km ea eb kn ed ef dx translated">èšåˆç®¡é“ä½œä¸ºå¤–å£³ä¸­Map-Reduceçš„æ›¿ä»£ã€‚æ”¶è—ã€‚MapReduce()æ–¹æ³•æ˜¯ä¸€ä¸ªåŒ…è£…å™¨â€¦</h3></div><div class="kp l"><p class="bd b fp z dy km ea eb kn ed ef dx translated">docs.mongodb.com</p></div></div><div class="kq l"><div class="kr l ks kt ku kq kv io kh"/></div></div></a></div><p id="cf16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¼™è®¡ä»¬ï¼Œè¿™ä¸ªåšå®¢åˆ°æ­¤ç»“æŸï¼Œæˆ‘å¸Œæœ›ä½ ä»¬éƒ½å–œæ¬¢å®ƒï¼Œå¹¶å‘ç°å®ƒå†…å®¹ä¸°å¯Œã€‚å¦‚æœæœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·éšæ—¶è”ç³»æˆ‘:)</p><blockquote class="kw kx ky"><p id="c159" class="iq ir kz is b it iu iv iw ix iy iz ja la jc jd je lb jg jh ji lc jk jl jm jn hb bi translated">ä¼™è®¡ä»¬å…³æ³¨æˆ‘çš„åšå®¢ï¼Œå¦‚æœæœ‰ä»»ä½•è¯„è®ºï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œä¸‹æ¬¡å†™åšå®¢æ—¶æˆ‘ä¼šè®°ä½è¿™äº›è§‚ç‚¹ã€‚å¦‚æœæƒ³é˜…è¯»æ›´å¤šè¿™æ ·çš„åšå®¢æ¥äº†è§£æˆ‘ï¼Œè¿™é‡Œæ˜¯æˆ‘çš„ç½‘ç«™é“¾æ¥<a class="ae ld" href="https://sites.google.com/view/adityvgupta/home" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="hi"/></strong></a><strong class="is hj"><em class="hi">ã€‚ä¼™è®¡ä»¬ï¼Œè¯·ä¸è¦çŠ¹è±«ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘å¯¹äºå®ƒ(ä¸€ä¸ªå…¬å¼€çš„ç§˜å¯†:ä½ å¯ä»¥ä¸ºä¸€ä¸ªå¸–å­é¼“æŒ50æ¬¡ï¼Œæœ€æ£’çš„æ˜¯ï¼Œå®ƒä¸ä¼šèŠ±è´¹ä½ ä»»ä½•ä¸œè¥¿)ï¼Œä¹Ÿå¯ä»¥éšæ„åˆ†äº«ã€‚è¿™å¯¹æˆ‘çœŸçš„å¾ˆé‡è¦ã€‚</em>T13ã€‘</strong></p></blockquote></div></div>    
</body>
</html>