<html>
<head>
<title>How to manage Public and Private subnets in AWS with Terraform?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ç”¨Terraformç®¡ç†AWSä¸­çš„å…¬æœ‰å’Œç§æœ‰å­ç½‘ï¼Ÿ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/how-to-manage-public-and-private-subnets-in-aws-with-terraform-69c272003c81?source=collection_archive---------4-----------------------#2021-09-28">https://medium.com/geekculture/how-to-manage-public-and-private-subnets-in-aws-with-terraform-69c272003c81?source=collection_archive---------4-----------------------#2021-09-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="bc14" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">ä»€ä¹ˆæ˜¯Terraformï¼Ÿ</h1><p id="bbfa" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">Terraformæ˜¯ä¸€ä¸ªå¼€æºçš„åŸºç¡€è®¾æ–½ä»£ç (IAC)å·¥å…·ï¼Œå…è®¸åˆ›å»ºã€ç®¡ç†å’Œéƒ¨ç½²ç”Ÿäº§å°±ç»ªç¯å¢ƒã€‚Terraformå°†äº‘APIç¼–ç æˆå£°æ˜æ€§çš„é…ç½®æ–‡ä»¶ã€‚Terraformå¯ä»¥ç®¡ç†ç°æœ‰çš„æœåŠ¡æä¾›å•†å’Œå®šåˆ¶çš„å†…éƒ¨è§£å†³æ–¹æ¡ˆã€‚</p><p id="9a5b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ä»<a class="ae kg" href="https://www.terraform.io/intro/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">è¿™é‡Œ</strong> </a>é˜…è¯»æ›´å¤šå…³äºåœ°å½¢çš„ä¿¡æ¯</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/46449f99156487e5470d50e56ef98934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kqAq4IqZj8aNuNP2_Dd53w.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Terraform</figcaption></figure><h1 id="9d8f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">ä»€ä¹ˆæ˜¯å­ç½‘ï¼Ÿ</h1><p id="13d8" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">å­ç½‘æ˜¯IPç½‘ç»œçš„é€»è¾‘ç»†åˆ†ã€‚å°†ä¸€ä¸ªç½‘ç»œåˆ’åˆ†æˆä¸¤ä¸ªæˆ–æ›´å¤šçš„ç½‘ç»œç§°ä¸ºå­ç½‘åˆ’åˆ†ã€‚ä¸€éƒ¨åˆ†æ ‡è¯†ä¸»æœºéƒ¨åˆ†ï¼Œå¦ä¸€éƒ¨åˆ†æ ‡è¯†ç½‘ç»œéƒ¨åˆ†ã€‚</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kx"><img src="../Images/4e4bbdc330b7db9b9947b45fea309e42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*launqOhjQLLm3m8P89EV-g.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Subnet</figcaption></figure><h1 id="0728" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">å­ç½‘ç±»å‹:</h1><ul class=""><li id="69ed" class="ky kz hi jf b jg jh jk jl jo la js lb jw lc ka ld le lf lg bi translated"><strong class="jf hj">å…¬å…±å­ç½‘:</strong> <br/>å…¬å…±å­ç½‘æ˜¯ä¸è·¯ç”±è¡¨ç›¸å…³è”çš„å­ç½‘ï¼Œè¯¥è·¯ç”±è¡¨å…·æœ‰åˆ°äº’è”ç½‘ç½‘å…³çš„è·¯ç”±ã€‚è¿™å°†VPCè¿æ¥åˆ°äº’è”ç½‘å’Œå…¶ä»–è‡ªåŠ¨æ°”è±¡ç«™æœåŠ¡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨å…¬å…±å­ç½‘ä¸­å¯åŠ¨çš„å®ä¾‹å°†åˆ†é…IPåœ°å€ã€‚</li><li id="cc28" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated"><strong class="jf hj">ä¸“ç”¨å­ç½‘:<br/> </strong>ä¸“ç”¨å­ç½‘ä¸­çš„å®ä¾‹é€šå¸¸æ˜¯åç«¯æœåŠ¡å™¨ï¼Œä¸éœ€è¦æ¥å—æ¥è‡ªäº’è”ç½‘çš„ä¼ å…¥æµé‡ï¼Œå› æ­¤æ²¡æœ‰å…¬å…±IPåœ°å€ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬å¯ä»¥ä½¿ç”¨NATç½‘å…³æˆ–NATå®ä¾‹å‘äº’è”ç½‘å‘é€è¯·æ±‚ã€‚</li></ul><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lm"><img src="../Images/0bb867fd9dbcb45036a041672ea8ed9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IfE_uUqvwIJO-OiPLrCFbA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Public/Private Subnet</figcaption></figure><p id="25b1" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è§£é‡Šå¦‚ä½•ä½¿ç”¨terraformåˆ›å»ºå’Œç®¡ç†å…¬å…±å’Œç§æœ‰å­ç½‘ã€‚</p><h1 id="e05f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">å…ˆå†³æ¡ä»¶:</h1><ul class=""><li id="7f63" class="ky kz hi jf b jg jh jk jl jo la js lb jw lc ka ld le lf lg bi translated"><strong class="jf hj">AWS</strong>T42<strong class="jf hj">terra form</strong>çš„åŸºç¡€çŸ¥è¯†</li><li id="8222" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated">AWSå¸æˆ·</li><li id="a0ca" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated"><strong class="jf hj"> AWSè®¿é—®</strong> &amp; <strong class="jf hj">å¯†é’¥</strong></li></ul><blockquote class="ln lo lp"><p id="f592" class="jd je lq jf b jg kb ji jj jk kc jm jn lr kd jq jr ls ke ju jv lt kf jy jz ka hb bi translated">åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€äº›å˜é‡ï¼Œæˆ‘å°†åœ¨æœ¬æ–‡åé¢è®¨è®ºã€‚</p></blockquote><p id="b70f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬ä¸€æ­¥:- </strong>ä¸º<strong class="jf hj"> VPC </strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="fd35" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»º<code class="du lx ly lz ma b">vpc.tf</code>æ–‡ä»¶å¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="8962" class="mf ig hi ma b fi mg mh l mi mj"># Creating VPC<br/>resource "aws_vpc" "demovpc" {<br/>  cidr_block       = "${var.vpc_cidr}"<br/>  instance_tenancy = "default"</span><span id="96aa" class="mf ig hi ma b fi mk mh l mi mj">tags = {<br/>    Name = "Demo VPC"<br/>  }<br/>}</span></pre><p id="49cd" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤2:- </strong>ä¸º<strong class="jf hj">å…¬å…±å­ç½‘</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="4b88" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»º<code class="du lx ly lz ma b">public_subnet.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="d2e4" class="mf ig hi ma b fi mg mh l mi mj"># Creating Public Subnet for EC2 instance<br/>resource "aws_subnet" "demosubnet" {<br/>  vpc_id                  = "${aws_vpc.demovpc.id}"<br/>  cidr_block             = "${var.subnet_cidr}"<br/>  availability_zone = "us-east-1a"<br/>  map_public_ip_on_launch = true</span><span id="2da7" class="mf ig hi ma b fi mk mh l mi mj">tags = {<br/>    Name = "Public Subnet"<br/>  }<br/>}</span></pre><ul class=""><li id="eff4" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¸ªå­ç½‘ä¸ä¼šå……å½“å…¬å…±å­ç½‘ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»º<code class="du lx ly lz ma b">internet gateway</code>ï¼Œè¿˜éœ€è¦æ›´æ–°è·¯ç”±è¡¨ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ã€‚</li></ul><p id="459f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬ä¸‰æ­¥:- </strong>ä¸º<strong class="jf hj">äº’è”ç½‘ç½‘å…³</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="6f62" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»º<code class="du lx ly lz ma b">igw.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="bbd8" class="mf ig hi ma b fi mg mh l mi mj"># Creating Internet Gateway <br/>resource "aws_internet_gateway" "demogateway" {<br/>  vpc_id = "${aws_vpc.demovpc.id}"<br/>}</span></pre><p id="bb58" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤4:- </strong>ä¸º<strong class="jf hj">å…¬å…±å­ç½‘</strong>çš„<strong class="jf hj">è·¯ç”±è¡¨</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="abef" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»º<code class="du lx ly lz ma b">route_table_public.tf</code>æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç </li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="9a1e" class="mf ig hi ma b fi mg mh l mi mj"># Creating Route Table for Public Subnet<br/>resource "aws_route_table" "rt" {<br/>    vpc_id = aws_vpc.demovpc.id</span><span id="7ff0" class="mf ig hi ma b fi mk mh l mi mj">route {<br/>        cidr_block = "0.0.0.0/0"<br/>        gateway_id = aws_internet_gateway.demogateway.id<br/>    }</span><span id="d46e" class="mf ig hi ma b fi mk mh l mi mj">tags = {<br/>        Name = "Public Subnet Route Table"<br/>    }<br/>}</span><span id="d7ac" class="mf ig hi ma b fi mk mh l mi mj">resource "aws_route_table_association" "rt_associate_public" {<br/>    subnet_id = aws_subnet.demosubnet.id<br/>    route_table_id = aws_route_table.rt.id<br/>}</span></pre><ul class=""><li id="0b1d" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„è·¯ç”±è¡¨ï¼Œå¹¶å°†æ‰€æœ‰è¯·æ±‚è½¬å‘åˆ°<code class="du lx ly lz ma b">0.0.0.0/0</code> CIDRå—ã€‚</li><li id="d167" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated">æˆ‘è¿˜å°†è¿™ä¸ªè·¯ç”±è¡¨é™„åŠ åˆ°å‰é¢åˆ›å»ºçš„å­ç½‘ã€‚å› æ­¤ï¼Œå®ƒå°†ä½œä¸ºå…¬å…±å­ç½‘å·¥ä½œ</li></ul><p id="f0f7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤5:- </strong>ä¸º<strong class="jf hj">å®‰å…¨ç»„</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="5eeb" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»º<code class="du lx ly lz ma b">sg.tf</code>æ–‡ä»¶å¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="78f5" class="mf ig hi ma b fi mg mh l mi mj"># Creating Security Group <br/>resource "aws_security_group" "demosg" {</span><span id="7282" class="mf ig hi ma b fi mk mh l mi mj">vpc_id      = "${aws_vpc.demovpc.id}"</span><span id="9286" class="mf ig hi ma b fi mk mh l mi mj"># Inbound Rules<br/>  # HTTP access from anywhere<br/>  ingress {<br/>    from_port   = 80<br/>    to_port     = 80<br/>    protocol    = "tcp"<br/>    cidr_blocks = ["0.0.0.0/0"]<br/>  }</span><span id="db1c" class="mf ig hi ma b fi mk mh l mi mj"># HTTPS access from anywhere<br/>  ingress {<br/>    from_port   = 443<br/>    to_port     = 443<br/>    protocol    = "tcp"<br/>    cidr_blocks = ["0.0.0.0/0"]<br/>  }</span><span id="a800" class="mf ig hi ma b fi mk mh l mi mj"># SSH access from anywhere<br/>  ingress {<br/>    from_port   = 22<br/>    to_port     = 22<br/>    protocol    = "tcp"<br/>    cidr_blocks = ["0.0.0.0/0"]<br/>  }</span><span id="e8b2" class="mf ig hi ma b fi mk mh l mi mj"># Outbound Rules<br/>  # Internet access to anywhere<br/>  egress {<br/>    from_port   = 0<br/>    to_port     = 0<br/>    protocol    = "-1"<br/>    cidr_blocks = ["0.0.0.0/0"]<br/>  }<br/>}</span></pre><ul class=""><li id="05b0" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">æˆ‘å·²ç»ä¸ºå…¥ç«™è¿æ¥æ‰“å¼€äº†<strong class="jf hj"> 80ï¼Œ443 &amp; 22 </strong>ä¸ªç«¯å£ï¼Œå¹¶ä¸ºå‡ºç«™è¿æ¥æ‰“å¼€äº†æ‰€æœ‰ç«¯å£</li></ul><p id="9683" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬6æ­¥:- </strong>ä¸º<strong class="jf hj">å…¬å…±EC2å®ä¾‹</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="9a0b" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»º<code class="du lx ly lz ma b">ec2_public.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="fd6f" class="mf ig hi ma b fi mg mh l mi mj"># Creating EC2 instance in Public Subnet<br/>resource "aws_instance" "demoinstance" {<br/>  ami           = "ami-087c17d1fe0178315"<br/>  instance_type = "t2.micro"<br/>  key_name = "tests"<br/>  vpc_security_group_ids = [ aws_security_group.allow_ssh.id ]<br/>  subnet_id = aws_subnet.demoinstance.id<br/>  associate_public_ip_address = true</span><span id="b76c" class="mf ig hi ma b fi mk mh l mi mj">tags = {<br/>    Name = "My Public Instance"<br/>  }<br/>}</span></pre><p id="3dff" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬ä¸ƒæ­¥:- </strong>ä¸º<strong class="jf hj">å…¬å…±</strong>å­ç½‘åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç”¨äº<strong class="jf hj"> NATç½‘å…³</strong></p><ul class=""><li id="b571" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»º<code class="du lx ly lz ma b">public_subnet_NAT.tf</code>æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç </li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="ae22" class="mf ig hi ma b fi mg mh l mi mj"># Creating Public subnet for NAT Gateway <br/>resource "aws_subnet" "demosubnet1" {<br/>  vpc_id                  = "${aws_vpc.demovpc.id}"<br/>  cidr_block             = "${var.subnet1_cidr}"<br/>  availability_zone = "us-east-1b"</span><span id="54fe" class="mf ig hi ma b fi mk mh l mi mj">tags = {<br/>    Name = "Public Subnet for NAT Gateway"<br/>  }<br/>}</span></pre><p id="b677" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬å…«æ­¥:- </strong>ä¸º<strong class="jf hj"> EIP </strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="1956" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">æ²¡æœ‰å¼¹æ€§IPåœ°å€ï¼Œæ‚¨æ— æ³•å¯åŠ¨<strong class="jf hj"> NATç½‘å…³</strong>ï¼Œå› æ­¤ï¼Œè®©æˆ‘ä»¬å…ˆåˆ›å»ºå®ƒ</li><li id="cf65" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated">åˆ›å»º<code class="du lx ly lz ma b">eip.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="f35b" class="mf ig hi ma b fi mg mh l mi mj"># Creating EIP<br/>resource "aws_eip" "eip" {<br/>  vpc = true<br/>}</span></pre><p id="f8a7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬9æ­¥:- </strong>ä¸º<strong class="jf hj"> NATç½‘å…³</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="916c" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»º<code class="du lx ly lz ma b">nat.tf</code>æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç </li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="9ae6" class="mf ig hi ma b fi mg mh l mi mj"># Creating NAT Gateway<br/>resource "aws_nat_gateway" "gw" {<br/>  allocation_id = aws_eip.eip.id<br/>  subnet_id     = aws_subnet.demosubnet.id<br/>}</span></pre><p id="a3c4" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤10:- </strong>ä¸º<strong class="jf hj"> NATç½‘å…³</strong>çš„<strong class="jf hj">è·¯ç”±è¡¨</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="2021" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»º<code class="du lx ly lz ma b">route_table_private.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="8818" class="mf ig hi ma b fi mg mh l mi mj"># Creating Route Table for NAT Gateway<br/>resource "aws_route_table" "rt_NAT" {<br/>    vpc_id = aws_vpc.demovpc.id</span><span id="0af4" class="mf ig hi ma b fi mk mh l mi mj">route {<br/>        cidr_block = "0.0.0.0/0"<br/>        nat_gateway_id = aws_nat_gateway.gw.id<br/>    }</span><span id="4a1f" class="mf ig hi ma b fi mk mh l mi mj">tags = {<br/>        Name = "Main Route Table for Private subnet"<br/>    }<br/>}</span><span id="8782" class="mf ig hi ma b fi mk mh l mi mj">resource "aws_route_table_association" "rt_associate_private" {<br/>    subnet_id = aws_subnet.demosubnet1.id<br/>    route_table_id = aws_route_table.rt_private.id<br/>}</span></pre><p id="e27c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤11:- </strong>ä¸º<strong class="jf hj">ç§æœ‰å­ç½‘</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="1271" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»º<code class="du lx ly lz ma b">private_subnet.tf</code>æ–‡ä»¶å¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="1d6e" class="mf ig hi ma b fi mg mh l mi mj"># Creating Private subnet <br/>resource "aws_subnet" "demosubnet2" {<br/>  vpc_id                  = "${aws_vpc.demovpc.id}"<br/>  cidr_block             = "${var.subnet1_cidr}"<br/>  availability_zone = "us-east-1b"</span><span id="dad1" class="mf ig hi ma b fi mk mh l mi mj">tags = {<br/>    Name = "Private Subnet"<br/>  }<br/>}</span></pre><ul class=""><li id="24fe" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¸ªå­ç½‘ä¸ä¼šä½œä¸ºç§æœ‰å­ç½‘ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›ä¿®æ”¹ã€‚</li></ul><p id="c206" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤12:- </strong>ä¸º<strong class="jf hj">ç§æœ‰å­ç½‘</strong>çš„<strong class="jf hj">è·¯ç”±è¡¨</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="b276" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»ºä¸€ä¸ª<code class="du lx ly lz ma b">route_table_private.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­ã€‚</li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="a2f0" class="mf ig hi ma b fi mg mh l mi mj"># Creating Route table for Private Subnet<br/>resource "aws_route_table" "rt_private" {<br/>    vpc_id = aws_vpc.my_vpc.id</span><span id="864c" class="mf ig hi ma b fi mk mh l mi mj">tags = {<br/>        Name = "Route Table for the Private Subnet"<br/>    }<br/>}</span><span id="fc3e" class="mf ig hi ma b fi mk mh l mi mj">resource "aws_route_table_association" "rt_associate_private_2" {<br/>    subnet_id = aws_subnet.demosubnet2.id<br/>    route_table_id = aws_route_table.rt_private.id<br/>}</span></pre><ul class=""><li id="f289" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘åˆ›å»ºäº†æ²¡æœ‰è·¯ç”±å£°æ˜çš„è·¯ç”±è¡¨ï¼Œå¹¶å°†å…¶ä¸æˆ‘ä»¬çš„<code class="du lx ly lz ma b">private</code>å­ç½‘ç›¸å…³è”</li></ul><p id="34a7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤13:- </strong>ä¸º<strong class="jf hj">ç§æœ‰å­ç½‘</strong>ä¸­çš„<strong class="jf hj"> EC2å®ä¾‹</strong>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><ul class=""><li id="67c1" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»ºä¸€ä¸ª<code class="du lx ly lz ma b">ec2_private.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="7095" class="mf ig hi ma b fi mg mh l mi mj"># Creating EC2 instance in Private Subnet<br/>resource "aws_instance" "demoinstance1" {<br/>  ami           = "ami-087c17d1fe0178315"<br/>  instance_type = "t2.micro"<br/>  key_name = "tests"<br/>  vpc_security_group_ids = [ aws_security_group.allow_ssh.id ]<br/>  subnet_id = aws_subnet.demosubnet2.id</span><span id="ee7f" class="mf ig hi ma b fi mk mh l mi mj">tags = {<br/>    Name = "My Private Instance"<br/>  }<br/>}</span></pre><p id="ed41" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤14:- </strong>åˆ›å»ºä¸€ä¸ª<strong class="jf hj">å˜é‡</strong>æ–‡ä»¶</p><ul class=""><li id="a9ae" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">åˆ›å»º<code class="du lx ly lz ma b">vars.tf</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li></ul><pre class="ki kj kk kl fd mb ma mc md aw me bi"><span id="fef5" class="mf ig hi ma b fi mg mh l mi mj"># Defining CIDR Block for VPC<br/>variable "vpc_cidr" {<br/>  default = "10.0.0.0/16"<br/>}</span><span id="3fa5" class="mf ig hi ma b fi mk mh l mi mj"># Defining CIDR Block for 1st Subnet<br/>variable "subnet_cidr" {<br/>  default = "10.0.1.0/24"<br/>}</span><span id="8627" class="mf ig hi ma b fi mk mh l mi mj"># Defining CIDR Block for 2nd Subnet<br/>variable "subnet1_cidr" {<br/>  default = "10.0.2.0/24"<br/>}</span><span id="4333" class="mf ig hi ma b fi mk mh l mi mj"># Defining CIDR Block for 3rd Subnet<br/>variable "subnet2_cidr" {<br/>  default = "10.0.3.0/24"<br/>}</span></pre><p id="4222" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æ‰€ä»¥ï¼Œç°åœ¨æˆ‘ä»¬çš„å…¨éƒ¨ä»£ç éƒ½å‡†å¤‡å¥½äº†ã€‚æˆ‘ä»¬éœ€è¦è¿è¡Œä»¥ä¸‹æ­¥éª¤æ¥åˆ›å»ºåŸºç¡€æ¶æ„ã€‚</p><ul class=""><li id="9979" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated"><code class="du lx ly lz ma b">terraform init</code>åˆå§‹åŒ–æä¾›è€…çš„å·¥ä½œç›®å½•å’Œä¸‹è½½æ’ä»¶</li><li id="e3b5" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated"><code class="du lx ly lz ma b">terraform plan</code>æ˜¯ä¸ºæˆ‘ä»¬çš„ä»£ç åˆ›å»ºæ‰§è¡Œè®¡åˆ’</li><li id="0ac6" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated"><code class="du lx ly lz ma b">terraform apply</code>æ˜¯åˆ›é€ å®é™…çš„åŸºç¡€è®¾æ–½ã€‚å®ƒä¼šè¦æ±‚æ‚¨æä¾›<strong class="jf hj">è®¿é—®å¯†é’¥</strong>å’Œ<strong class="jf hj">ç§˜å¯†å¯†é’¥</strong>ï¼Œä»¥ä¾¿åˆ›å»ºåŸºç¡€è®¾æ–½ã€‚å› æ­¤ï¼Œä¸å…¶ç¡¬ç¼–ç <strong class="jf hj">è®¿é—®å¯†é’¥</strong>å’Œ<strong class="jf hj">ç§˜å¯†å¯†é’¥ï¼Œ</strong>ä¸å¦‚åœ¨è¿è¡Œæ—¶åº”ç”¨ã€‚</li></ul><p id="414c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤15:- </strong>éªŒè¯th <strong class="jf hj"> eèµ„æº</strong></p><ul class=""><li id="8fef" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ld le lf lg bi translated">Terraformå°†åˆ›å»ºä»¥ä¸‹èµ„æº</li></ul><ol class=""><li id="2a6e" class="ky kz hi jf b jg kb jk kc jo lu js lv jw lw ka ml le lf lg bi translated"><strong class="jf hj"> VPC </strong></li><li id="5c46" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ml le lf lg bi translated"><strong class="jf hj">EC2å®ä¾‹çš„å…¬å…±å­ç½‘&amp; NATç½‘å…³</strong></li><li id="802a" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ml le lf lg bi translated"><strong class="jf hj">EC2å®ä¾‹çš„ä¸“ç”¨å­ç½‘</strong></li><li id="3e96" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ml le lf lg bi translated"><strong class="jf hj">å…¬æœ‰&amp;ç§æœ‰å­ç½‘å’ŒNATç½‘å…³</strong>è·¯ç”±è¡¨</li><li id="b674" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ml le lf lg bi translated"><strong class="jf hj">äº’è”ç½‘ç½‘å…³</strong></li><li id="bd58" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ml le lf lg bi translated"><strong class="jf hj"> EIP </strong></li><li id="8ec7" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ml le lf lg bi translated"><strong class="jf hj"> NATç½‘å…³</strong></li><li id="03d7" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ml le lf lg bi translated"><strong class="jf hj">å®‰å…¨ç»„</strong></li><li id="e557" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ml le lf lg bi translated"><strong class="jf hj"> EC2å®ä¾‹</strong></li></ol><p id="a80a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ç°åœ¨å°±è¿™æ ·ï¼Œä½ å·²ç»å­¦ä¼šäº†å¦‚ä½•ä½¿ç”¨Terraformåœ¨AWSä¸­åˆ›å»ºå„ç§èµ„æºã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œ è¿›ä¸€æ­¥æ¢ç´¢Terraform <a class="ae kg" href="https://terraform.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj"/></a></p><p id="b4b2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ä½ å¯ä»¥åœ¨æˆ‘çš„<a class="ae kg" href="https://github.com/DhruvinSoni30/Terraform-AWS-Subnets" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj"> GitHub </strong> </a>è´¦å·æ‰¾åˆ°å®Œæ•´çš„ä»£ç ã€‚ä¹Ÿå¯ä»¥éšæ„æŸ¥çœ‹æˆ‘çš„å…¶ä»–åº“ã€‚</p><p id="d000" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">å¦‚æœæ‚¨å‘ç°æ­¤æŒ‡å—æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹å‡»ğŸ‘æŒ‰é’®ï¼Œä¹Ÿå¯ä»¥éšæ„å‘è¡¨è¯„è®ºã€‚</p><p id="03e2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">å…³æ³¨æ›´å¤šç±»ä¼¼çš„æ•…äº‹ğŸ˜Š</p></div></div>    
</body>
</html>