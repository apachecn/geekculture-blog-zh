<html>
<head>
<title>EDA for Image Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨äºå›¾åƒåˆ†ç±»çš„EDA</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/eda-for-image-classification-dcada9f2567a?source=collection_archive---------1-----------------------#2021-04-11">https://medium.com/geekculture/eda-for-image-classification-dcada9f2567a?source=collection_archive---------1-----------------------#2021-04-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/bce86d9d374652d886755552b2ec878e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*orwXjJmNu28EcJX3"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@corinarainer?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Corina Rainer</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ba8c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">åœ¨æˆ‘ä»äº‹æ•°æ®ç§‘å­¦é¡¹ç›®æœŸé—´ï¼Œå›¾åƒåˆ†ç±»ä¸€ç›´æ˜¯æˆ‘æœ€å–œæ¬¢çš„é¡¹ç›®ï¼Œä½†EDAä¸åƒå…¶ä»–æ¨¡å‹é‚£æ ·ç®€å•ã€‚æˆ‘å’Œæˆ‘çš„åŒä¼´å‘ç°è‡ªå·±åœ¨è°·æ­Œä¸Šæœç´¢æƒ³æ³•ï¼Œé˜…è¯»åšå®¢æ–‡ç« ï¼Œä¸çŸ¥é“å¦‚ä½•å‰è¿›ã€‚æˆ‘ä»¬åº”è¯¥å¦‚ä½•åˆ†ææˆåƒä¸Šä¸‡çš„å›¾åƒæ¥å¯»æ‰¾æ¨¡å¼æˆ–å­¦ä¹ â€¦å¥½å§ï¼Œå…³äºæ•°æ®é›†çš„ä»»ä½•æˆ‘ä»¬ä¸çŸ¥é“çš„ä¸œè¥¿ï¼Ÿ</p><p id="3ea0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è¿™éœ€è¦å›åˆ°åŸºç¡€ã€‚æŠŠæˆ‘ä»¬å­¦è¿‡çš„æœ‰è¶£çš„ã€æ—¶é«¦çš„EDAæ”¾åœ¨ä¸€è¾¹ï¼Œè€Œæ˜¯æŠŠæ³¨æ„åŠ›æ”¾åœ¨ä¼šå½±å“æ•´ä¸ªæ¨¡å‹çš„ä¸œè¥¿ä¸Šã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“ä»€ä¹ˆæ¥ç¡®ä¿æˆ‘ä»¬çš„CNNå°½å¯èƒ½å¥½åœ°è¿è¡Œï¼Ÿä½œä¸ºæ•°æ®ç§‘å­¦å®¶ï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£æ¨¡å‹æœ¬èº«ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£å“ªäº›æ•°æ®ï¼Ÿ</p><p id="f12d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">è¯†åˆ«é˜¶çº§ä¸å¹³è¡¡</strong></p><p id="2a6a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è¯†åˆ«é˜¶çº§ä¸å¹³è¡¡æ˜¯ç®€å•çš„ç¬¬ä¸€æ­¥ã€‚æˆ‘ä»¬å°†æ‰¾åˆ°åˆ†é…ç»™æ¯ä¸ªç±»åˆ«çš„å›¾åƒæ•°é‡ï¼Œå¹¶å°†å…¶ç»˜åˆ¶åœ¨æ¡å½¢å›¾ä¸­ï¼Œä»¥ä¾¿è½»æ¾è¯†åˆ«ä»»ä½•ä¸å¹³è¡¡ã€‚CNNä¸­çš„ä¸å¹³è¡¡å¯èƒ½å¯¼è‡´ä»£è¡¨æ€§è¾ƒä½çš„ç±»çš„è¾ƒå·®æ€§èƒ½ï¼Œä»è€Œå½±å“æ•´ä½“æ€§èƒ½ã€‚</p><p id="872b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">* *ä»¥ä¸‹ä»£ç å‡è®¾æ‚¨å·²ç»æ ¹æ®ç±»åˆ«å°†å›¾åƒæ‹†åˆ†åˆ°æ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ä¸ºæ¯ä¸ªç›®å½•åˆ›å»ºäº†å˜é‡ã€‚</p><p id="56b8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå­—å…¸ï¼Œä»¥ç±»åä½œä¸ºé”®ï¼Œä»¥å›¾ç‰‡æ•°é‡ä½œä¸ºå€¼ã€‚ä¸‹é¢æˆ‘ä»¬ä»å­˜å‚¨å›¾ç‰‡çš„æ–‡ä»¶å¤¹ä¸­ç›´æ¥æå–ä¸€äº›å›¾ç‰‡ã€‚</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="ac66" class="kc kd hi jy b fi ke kf l kg kh">number_classes = {'Class_0': len(os.listdir(healthy_dir)),</span><span id="5e1e" class="kc kd hi jy b fi ki kf l kg kh">'Class_1': len(os.listdir(blight_dir)),</span><span id="9aee" class="kc kd hi jy b fi ki kf l kg kh">'Class_2': len(os.listdir(gray_dir)),</span><span id="0ebd" class="kc kd hi jy b fi ki kf l kg kh">'Class_3': len(os.listdir(rust_dir))}</span></pre><p id="063d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ¥ä¸‹æ¥ï¼Œä½¿ç”¨è½´çš„é”®å’Œå€¼ç»˜åˆ¶ä¸€ä¸ªç®€å•çš„æ¡å½¢å›¾ã€‚</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="6387" class="kc kd hi jy b fi ke kf l kg kh">plt.bar(number_classes.keys(), number_classes.values(), width = .5);</span><span id="5047" class="kc kd hi jy b fi ki kf l kg kh">plt.title("Number of Images by Class");</span><span id="4d4e" class="kc kd hi jy b fi ki kf l kg kh">plt.xlabel('Class Name');</span><span id="b7fe" class="kc kd hi jy b fi ki kf l kg kh">plt.ylabel('# Images');</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/3a3113c7fa6133ba82a7020026e01967.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*4AENzwL1JZFyQPvWA2O-cw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">A simple bar chart to quickly identify class imbalance.</figcaption></figure><p id="2306" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">æ ‡ç»˜å›¾åƒå°ºå¯¸</strong></p><p id="5d00" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ä¸€è‡´çš„å›¾åƒå¤§å°å¯¹æ·±åº¦å­¦ä¹ è‡³å…³é‡è¦ï¼Œä¸åŒ¹é…çš„çŸ©é˜µä¼šè®©ä½ çš„é¡¹ç›®å¿«é€Ÿåœæ­¢ã€‚å¯è§†åŒ–åŸå§‹å›¾åƒå¤§å°è¿˜å¯ä»¥å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£æ•°æ®é›†ã€‚æ‰€ä»¥è®©æˆ‘ä»¬å¼€å§‹å§ï¼</p><p id="558f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘ä»¬å°†åˆ›å»ºå¦ä¸€ä¸ªç®€å•çš„å­—å…¸â€”æ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªå­—å…¸ç”¨äºä¸Šé¢çš„å›¾è¡¨å’Œä¸‹é¢çš„å›¾è¡¨ï¼Œä½†æˆ‘æƒ³å±•ç¤ºä¸€ä¸ªä¸åŒçš„é€‰é¡¹ï¼Œå®ƒä¸éœ€è¦æ¯ä¸ªæ–‡ä»¶å¤¹ç›®å½•éƒ½æœ‰å˜é‡ã€‚æˆ‘ä»¬è¿˜å°†è®¾ç½®ä¸€ä¸ªè¿”å›å›¾åƒå°ºå¯¸çš„å‡½æ•°ã€‚</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="d26f" class="kc kd hi jy b fi ke kf l kg kh">directories = {'Class_0': 'data/Class_0/',</span><span id="d292" class="kc kd hi jy b fi ki kf l kg kh">'Class_1': 'data/Class_1/',</span><span id="e112" class="kc kd hi jy b fi ki kf l kg kh">'Class_2': 'data/Class_2/',</span><span id="b6d6" class="kc kd hi jy b fi ki kf l kg kh">'Class_3': 'data/Class_3/'}</span><span id="0341" class="kc kd hi jy b fi ki kf l kg kh"><br/>def get_dims(file):</span><span id="3e44" class="kc kd hi jy b fi ki kf l kg kh">'''Returns dimenstions for an RBG image'''</span><span id="7309" class="kc kd hi jy b fi ki kf l kg kh">im = Image.open(file)</span><span id="889a" class="kc kd hi jy b fi ki kf l kg kh">arr = np.array(im)</span><span id="787e" class="kc kd hi jy b fi ki kf l kg kh">h,w,d = arr.shape</span><span id="1241" class="kc kd hi jy b fi ki kf l kg kh">return h,w</span></pre><p id="7a90" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ä¸‹ä¸€æ­¥å°†åˆ›å»ºä¸€ä¸ªå¾ªç¯ï¼Œè¯¥å¾ªç¯å°†éå†å­—å…¸ä¸­çš„æ–‡ä»¶å¤¹ï¼Œå¹¶è¿”å›æ¯ä¸ªå›¾åƒçš„å°ºå¯¸ï¼Œè¿™äº›å°ºå¯¸å°†è¢«æ·»åŠ åˆ°æ•°æ®å¸§ä¸­ä»¥ä¾›ç»˜åˆ¶ã€‚</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="f83f" class="kc kd hi jy b fi ke kf l kg kh">for n,d in directories.items():</span><span id="ba15" class="kc kd hi jy b fi ki kf l kg kh">filepath = d</span><span id="b5c9" class="kc kd hi jy b fi ki kf l kg kh">filelist = [filepath + f for f in os.listdir(filepath)]</span><span id="4746" class="kc kd hi jy b fi ki kf l kg kh">dims = bag.from_sequence(filelist).map(get_dims)</span><span id="fc78" class="kc kd hi jy b fi ki kf l kg kh">with diagnostics.ProgressBar():</span><span id="591d" class="kc kd hi jy b fi ki kf l kg kh">dims = dims.compute()<br/></span><span id="bd4e" class="kc kd hi jy b fi ki kf l kg kh">dim_df = pd.DataFrame(dims, columns=['height', 'width'])</span><span id="74a5" class="kc kd hi jy b fi ki kf l kg kh">sizes = dim_df.groupby(['height', 'width']).size().reset_index().rename(columns={0:'count'})</span><span id="73ba" class="kc kd hi jy b fi ki kf l kg kh">sizes.plot.scatter(x='width', y='height');</span><span id="fa0b" class="kc kd hi jy b fi ki kf l kg kh">plt.title('Image Sizes (pixels) | {}'.format(n))</span></pre><div class="jt ju jv jw fd ab cb"><figure class="kk ij kl km kn ko kp paragraph-image"><img src="../Images/c7bee66a74f666a796050bc04bb909a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*CzwIW_gNUuGhy8x8-U_T5Q.png"/></figure><figure class="kk ij kq km kn ko kp paragraph-image"><img src="../Images/865ae1c26ab6408614d7c33580647ec0.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*y7s_7i2vwMzNunpY8g2a2Q.png"/></figure></div><div class="ab cb"><figure class="kk ij kr km kn ko kp paragraph-image"><img src="../Images/5114855c1b02d2f7aeef5e1ac5f68989.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*MAadL1crg9y3IN3-M5WJHQ.png"/></figure><figure class="kk ij kr km kn ko kp paragraph-image"><img src="../Images/a2174ec78127a4d005f232ff424636c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*Oi-L6fBSKqR8iDI-XF24-w.png"/></figure></div><p id="596b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">æŸ¥çœ‹å›¾åƒæ ·æœ¬</strong></p><p id="df00" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æœ€åï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æ¯ä¸ªç­çº§çš„ä¸€äº›å›¾ç‰‡ã€‚å°½ç®¡è¿™å¯¹æ¨¡å‹æœ¬èº«å¹¶ä¸é‡è¦ï¼Œä½†å®ƒå°†å¸®åŠ©æ‚¨ç†Ÿæ‚‰æ•°æ®ã€‚æ‚¨å¯¹æ•°æ®è¶Šç†Ÿæ‚‰ï¼Œæ‚¨å°±è¶Šèƒ½ç†è§£æ¨¡å‹è¾“å‡ºï¼Œä»è€Œå…è®¸æ™ºèƒ½è¿­ä»£ï¼Œå¹¶æœ€ç»ˆå¾—åˆ°æ›´æ™ºèƒ½çš„æ¨¡å‹ã€‚</p><p id="9407" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æˆ‘æƒ³è¯´çš„æ˜¯ï¼Œæˆ‘çš„ä¸€ä¸ªäº†ä¸èµ·çš„åŒäº‹å†™äº†ä¸‹é¢çš„ä»£ç ï¼Œçœ‹çœ‹å¥¹çš„ä¸­é—´é¡µé¢<a class="ae iu" href="https://diane-tunnicliffe.medium.com/" rel="noopener">è¿™é‡Œ</a>ğŸ˜Š</p><p id="1aaa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è®¾ç½®å°†è¿­ä»£æ–‡ä»¶å¤¹ä¸­å›¾åƒçš„å˜é‡ã€‚éœ€è¦ä¸ºæ¯ä¸ªç±»åˆ›å»ºä¸€ä¸ªå˜é‡ã€‚</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="be8e" class="kc kd hi jy b fi ke kf l kg kh"># Show images displayed 4x4</span><span id="c2dd" class="kc kd hi jy b fi ki kf l kg kh">nrows = 4</span><span id="cf35" class="kc kd hi jy b fi ki kf l kg kh">ncols = 4</span><span id="7e43" class="kc kd hi jy b fi ki kf l kg kh"># Index for iterating over images</span><span id="01c3" class="kc kd hi jy b fi ki kf l kg kh">pic_index = 0</span><span id="4464" class="kc kd hi jy b fi ki kf l kg kh">pic_index += 8</span><span id="7e24" class="kc kd hi jy b fi ki kf l kg kh">next_blight_pix = [os.path.join(blight_dir, fname)</span><span id="aa60" class="kc kd hi jy b fi ki kf l kg kh">for fname in train_blight_names[pic_index-8:pic_index]]</span></pre><p id="def4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å¹¶è®¾ç½®ä¸€ä¸ªå‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ªæƒ…èŠ‚æ¥æŸ¥çœ‹æˆ‘ä»¬çš„å›¾åƒã€‚</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="4492" class="kc kd hi jy b fi ke kf l kg kh">def show_image_sample(pic_directory):<br/>'''display 4x4 images'''</span><span id="0fca" class="kc kd hi jy b fi ki kf l kg kh">fig = plt.gcf()</span><span id="609b" class="kc kd hi jy b fi ki kf l kg kh">fig.set_size_inches(ncols * 4, nrows * 4)</span><span id="82ed" class="kc kd hi jy b fi ki kf l kg kh">for i, img_path in enumerate(pic_directory):</span><span id="6e8f" class="kc kd hi jy b fi ki kf l kg kh">sp = plt.subplot(nrows, ncols, i + 1)</span><span id="5dd1" class="kc kd hi jy b fi ki kf l kg kh">sp.axis('Off')</span><span id="ad32" class="kc kd hi jy b fi ki kf l kg kh">img = mpimg.imread(img_path)</span><span id="3907" class="kc kd hi jy b fi ki kf l kg kh">plt.imshow(img)</span><span id="698e" class="kc kd hi jy b fi ki kf l kg kh">plt.show()</span><span id="7925" class="kc kd hi jy b fi ki kf l kg kh">show_image_sample(Class_0)</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ks"><img src="../Images/685948db6b92d35fc3064e0ba9412425.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cSS9t6fgSAKml6eWRIQmXQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">A sampling of images for each class can teach us a lot! This particular project was to identify disease in corn leaves.</figcaption></figure><p id="14af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ­£å¦‚æˆ‘ä»¬ä¸Šé¢çœ‹åˆ°çš„ï¼Œå•ä¸ªç±»çš„å°æ ·æœ¬å¯ä»¥æ•™ä¼šæˆ‘ä»¬å¾ˆå¤šå…³äºæ•°æ®é›†çš„ä¸œè¥¿ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å›¾åƒæœ‰ä¸åŒçš„å¤§å°å’Œå½¢çŠ¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°åœ¨è¿™ä¸ªç±»ä¸­æœ‰ç›¸å½“å¤šçš„å˜åŒ–ã€‚èƒŒæ™¯ã€äº®åº¦ã€æ–¹å‘ç­‰çš„å˜åŒ–ä¼šå¯¼è‡´æ·±åº¦å­¦ä¹ ä¸­çš„å‡ ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹æ•°æ®é›†çš„è¿™ä¸ªæ ·æœ¬æ¥åšå¥½å‡†å¤‡ã€‚</p><p id="0bf5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å¸Œæœ›è¿™å·²ç»ç»™äº†ä½ ä¸€ä¸ªå›¾åƒåˆ†ç±»EDAçš„è‰¯å¥½å¼€ç«¯ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œç¥ä½ å¥½è¿ï¼</p></div></div>    
</body>
</html>