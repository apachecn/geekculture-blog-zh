<html>
<head>
<title>How to run an ansible playbook using GitLab CI/CD?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨GitLab CI/CDè¿è¡Œansibleå‰§æœ¬ï¼Ÿ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/how-to-run-an-ansible-playbook-using-gitlab-ci-cd-2135f76d7f1e?source=collection_archive---------0-----------------------#2021-09-06">https://medium.com/geekculture/how-to-run-an-ansible-playbook-using-gitlab-ci-cd-2135f76d7f1e?source=collection_archive---------0-----------------------#2021-09-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="e389" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">ä»€ä¹ˆæ˜¯GitLab CI/CDï¼Ÿ</h1><p id="7ed5" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj"> GitLab CI/CD </strong>æ˜¯<strong class="jf hj">git lab</strong>çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºæ‰€æœ‰çš„<strong class="jf hj">è¿ç»­æ–¹æ³•(è¿ç»­é›†æˆã€äº¤ä»˜å’Œéƒ¨ç½²)</strong>ã€‚ä½¿ç”¨<strong class="jf hj"> GitLab CI/CD </strong>ï¼Œæ‚¨å¯ä»¥<strong class="jf hj">æµ‹è¯•</strong>ï¼Œ<strong class="jf hj">æ„å»º</strong>ï¼Œä»¥åŠ<strong class="jf hj">å‘å¸ƒ</strong>æ‚¨çš„ä»£ç ï¼Œæ— éœ€ç¬¬ä¸‰æ–¹åº”ç”¨æˆ–é›†æˆã€‚</p><p id="c4b6" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ç‚¹å‡» é˜…è¯»æ›´å¤šå…³äº<strong class="jf hj"> GitLab CI/CD </strong> <a class="ae kg" href="https://docs.gitlab.com/ee/ci/" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">ã€‚</strong></a></p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/36bc925ddae227ba98db348014bdd2cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KpZOSdvsgRNN3zA4pXtn7Q.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">GitLab CI/CD</figcaption></figure><h1 id="5dd3" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">ä»€ä¹ˆæ˜¯Ansibleï¼Ÿ</h1><p id="08df" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj"> Ansible </strong>æ˜¯ä¸€æ¬¾å¼€æºçš„<strong class="jf hj">è½¯ä»¶é…ç½®</strong>ã€<strong class="jf hj">é…ç½®</strong>ã€<strong class="jf hj">ç®¡ç†</strong>ã€<strong class="jf hj">éƒ¨ç½²</strong>å·¥å…·ã€‚å®ƒè¿è¡Œåœ¨è®¸å¤šç±»Unixç³»ç»Ÿä¸Šï¼Œå¯ä»¥é…ç½®ç±»Unixç³»ç»Ÿå’ŒMicrosoft Windowsã€‚Ansibleä½¿ç”¨SSHåè®®æ¥é…ç½®è¿œç¨‹æœåŠ¡å™¨ã€‚Ansibleéµå¾ªåŸºäºæ¨çš„æœºåˆ¶æ¥é…ç½®è¿œç¨‹æœåŠ¡å™¨ã€‚</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kx"><img src="../Images/e7795ee3abe3c42891f742d5e8d9bfde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sfIV0M_n1XYafJSq.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Ansible</figcaption></figure><h1 id="46a5" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">ä»€ä¹ˆæ˜¯å¯æ—‹è½¬æ‹±é¡¶ï¼Ÿ</h1><p id="e1f5" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj"> Ansible Vault </strong>æ˜¯Ansibleçš„ä¸€é¡¹åŠŸèƒ½ï¼Œå®ƒå…è®¸æ‚¨å°†å¯†ç æˆ–å¯†é’¥ç­‰æ•æ„Ÿæ•°æ®ä¿å­˜åœ¨åŠ å¯†æ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯ä»¥æ˜æ–‡å½¢å¼ä¿å­˜åœ¨å‰§æœ¬æˆ–è§’è‰²ä¸­ã€‚æ‚¨å¯ä»¥åˆ›å»ºæ–°çš„åŠ å¯†æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹ç°æœ‰çš„åŠ å¯†æ–‡ä»¶ã€‚</p><p id="6e5e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†<strong class="jf hj"> Ansible </strong>ä¸<strong class="jf hj"> GitLab CI/CD </strong>é›†æˆåœ¨ä¸€èµ·ï¼Œå¹¶åœ¨<strong class="jf hj"> AWS </strong>ä¸Šåˆ›å»ºäº†å„ç§èµ„æºã€‚</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ky"><img src="../Images/21caa5e286f3959d2eb52f5509fa7a21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LCj84PuqnLl-LnIl.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">GitLab CI/CD + Ansible</figcaption></figure><h1 id="69f0" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">å…ˆå†³æ¡ä»¶:</h1><ul class=""><li id="ef0c" class="kz la hi jf b jg jh jk jl jo lb js lc jw ld ka le lf lg lh bi translated"><strong class="jf hj"> AWS &amp; GitLabè´¦æˆ·</strong></li><li id="f7e6" class="kz la hi jf b jg li jk lj jo lk js ll jw lm ka le lf lg lh bi translated"><a class="ae kg" href="https://docs.aws.amazon.com/" rel="noopener ugc nofollow" target="_blank"><strong class="jf hj">AWS</strong></a><a class="ae kg" href="https://docs.ansible.com/" rel="noopener ugc nofollow" target="_blank"><strong class="jf hj">ansi ble</strong></a><strong class="jf hj">&amp;</strong><a class="ae kg" href="https://docs.gitlab.com/ee/ci/" rel="noopener ugc nofollow" target="_blank"><strong class="jf hj">git lab CI/CD</strong></a></li><li id="41d4" class="kz la hi jf b jg li jk lj jo lk js ll jw lm ka le lf lg lh bi translated">åœ¨<strong class="jf hj"> AWS </strong>ä¸­åˆ›å»ºçš„<strong class="jf hj">è®¿é—®å¯†é’¥</strong> &amp; <strong class="jf hj">ç§˜å¯†å¯†é’¥</strong></li><li id="b9cc" class="kz la hi jf b jg li jk lj jo lk js ll jw lm ka le lf lg lh bi translated"><strong class="jf hj"> Ansible Vault </strong>å¯¹æ–‡ä»¶è¿›è¡ŒåŠ å¯†</li></ul><p id="d51f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">è®©æˆ‘ä»¬ä»é¡¹ç›®çš„é…ç½®å¼€å§‹</p><p id="c3de" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤1:- </strong>åˆ›å»ºä¸€ä¸ª<strong class="jf hj">å­˜å‚¨åº“</strong></p><ul class=""><li id="791d" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">åœ¨ä½ çš„GitLabå¸æˆ·ä¸­åˆ›å»ºä¸€ä¸ªå­˜å‚¨åº“ï¼Œå¹¶ç»™å®ƒèµ·ä¸€ä¸ªä½ è‡ªå·±é€‰æ‹©çš„åå­—</li></ul><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lq"><img src="../Images/e72ff2917628d310980609bee29adef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dXPfbfdBMPYFi1CXORAsoA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">GitLab Repository</figcaption></figure><p id="4402" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤2:- </strong>ä¸ºèµ„æºåˆ›å»ºåˆ›å»ºä¸€ä¸ª<strong class="jf hj">å¯è§£æçš„</strong>æ–‡ä»¶</p><ul class=""><li id="9f04" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª<code class="du lr ls lt lu b">.yml</code>æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ ä¸‹é¢çš„ä»£ç ã€‚</li><li id="75ce" class="kz la hi jf b jg li jk lj jo lk js ll jw lm ka le lf lg lh bi translated">ä¸‹é¢çš„ä»£ç å°†åœ¨AWSä¸Šåˆ›å»ºå„ç§èµ„æºã€‚å¦‚æœä½ ä¸èƒ½ç†è§£ä»£ç ä¸­çš„ä»»ä½•å†…å®¹ï¼Œä½ å¯ä»¥ä»<a class="ae kg" href="https://devopsquare.com/a-complete-overview-of-ansible-264bb0cceafe" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">è¿™é‡Œ</strong> </a>æ›´å¥½åœ°ç†è§£</li></ul><pre class="ki kj kk kl fd lv lu lw lx aw ly bi"><span id="8efe" class="lz ig hi lu b fi ma mb l mc md">---<br/>- hosts: localhost  # Place where we are running Ansible<br/>  connection: local # Connection <br/>  gather_facts: no<br/>  vars_files:<br/>  - cred.yml<br/><br/>  # Variables<br/>  vars:<br/>    ansible_python_interpreter: /usr/bin/python3<br/>    # Default Names<br/>    title: "Demo"<br/>    vpc_name: "{{ title }} VPC"<br/>    igw_name: "{{ title }} IGW"<br/>    subnet_name: "{{ title }} Subnet"<br/>    acl_name: "{{ title }} ACL"<br/>    instance_name: "{{ title }} Instance" <br/>    security_group_name: "{{ title }} Security Group"<br/>    route_table_name: "{{ title }} Route Table"<br/><br/>    # Default values for CIDR Blocks<br/>    vpcCidrBlock: "10.0.0.0/16"<br/>    subNetCidrBlock: "10.0.1.0/24"<br/>    portCidrBlock: "0.0.0.0/0"<br/>    destinationCidrBlock: "0.0.0.0/0"<br/><br/>    # State<br/>    state: "present"<br/><br/>    # Default value of AZ &amp; Regio<br/>    zone: "us-west-1a"<br/>    region: "us-west-1"<br/><br/>  # List of tasks<br/>  tasks:<br/>    <br/>  # Creating VPC<br/>  - name: Create VPC<br/>    ec2_vpc_net:<br/>      aws_access_key: "{{ aws_access_key }}"<br/>      aws_secret_key: "{{ aws_secret_key }}"<br/>      name: "{{ vpc_name }}"<br/>      cidr_block: "{{ vpcCidrBlock }}"<br/>      region: "{{ region }}"<br/>      dns_support: "yes"<br/>      dns_hostnames: "yes"<br/>      tenancy: "default"<br/>      state: "{{ state }}"<br/>      resource_tags:<br/>        Name: "{{ vpc_name }}"<br/>    register: vpc_result<br/>  <br/>  # Creating Internate Gateway<br/>  - name: Create Internet Gateway<br/>    ec2_vpc_igw:<br/>      aws_access_key: "{{ aws_access_key }}"<br/>      aws_secret_key: "{{ aws_secret_key }}"<br/>      vpc_id: "{{ vpc_result.vpc.id }}" <br/>      region: "{{ region }}"<br/>      state: "{{ state }}" <br/>      tags:<br/>        Name: "{{ igw_name }}"<br/>    register: igw_result<br/><br/>  # Creating Subnet<br/>  - name: Create Subnet<br/>    ec2_vpc_subnet:<br/>      aws_access_key: "{{ aws_access_key }}"<br/>      aws_secret_key: "{{ aws_secret_key }}"<br/>      vpc_id: "{{ vpc_result.vpc.id }}" <br/>      region: "{{ region }}"<br/>      state: "{{ state }}"<br/>      az: "{{ zone }}"  <br/>      cidr: "{{ subNetCidrBlock }}"<br/>      map_public: "yes"<br/>      resource_tags:<br/>        Name: "{{ subnet_name }}"<br/>    register: subnet_result<br/>  <br/>  # Creating Security Group<br/>  - name: Create Security Group<br/>    ec2_group:  <br/>      name: "{{ security_group_name }}"<br/>      description: "{{ security_group_name }}"<br/>      aws_access_key: "{{ aws_access_key }}"<br/>      aws_secret_key: "{{ aws_secret_key }}"<br/>      vpc_id: "{{ vpc_result.vpc.id }}" <br/>      region: "{{ region }}"<br/>      state: "{{ state }}"<br/>      tags:<br/>        Name: "{{ security_group_name  }}"<br/>      rules:<br/>        - proto: tcp<br/>          from_port: 80<br/>          to_port: 80<br/>          cidr_ip: "{{ portCidrBlock }}"<br/>        - proto: tcp<br/>          from_port: 443<br/>          to_port: 443<br/>          cidr_ip: "{{ portCidrBlock }}"<br/>        - proto: tcp<br/>          from_port: 22<br/>          to_port: 22<br/>          cidr_ip: "{{ portCidrBlock }}"<br/><br/>      rules_egress:<br/>        - proto: tcp<br/>          from_port: 80<br/>          to_port: 80<br/>          cidr_ip: "{{ portCidrBlock }}"<br/>        - proto: tcp<br/>          from_port: 443<br/>          to_port: 443<br/>          cidr_ip: "{{ portCidrBlock }}"<br/>        - proto: tcp<br/>          from_port: 22<br/>          to_port: 22<br/>          cidr_ip: "{{ portCidrBlock }}"<br/>    register: security_group_result<br/><br/>  # Creating NACLs for subnet   <br/>  - name: Create Network ACLs<br/>    ec2_vpc_nacl:<br/>      name: "{[ acl_name }}"<br/>      aws_access_key: "{{ aws_access_key }}"<br/>      aws_secret_key: "{{ aws_secret_key }}"<br/>      vpc_id: "{{ vpc_result.vpc.id }}" <br/>      region: "{{ region }}"<br/>      state: "{{ state }}" <br/>      subnets: [ "{{ subnet_result.subnet.id }}" ]<br/>      tags:<br/>        Name: "{{ acl_name }}"<br/>      ingress:<br/>      # rule no, protocol, allow/deny, cidr, icmp_type, icmp_code, port from, port to<br/>        - [100, 'tcp', 'allow', '0.0.0.0/0', null, null, 0, 65535]<br/>        <br/>      # rule no, protocol, allow/deny, cidr, icmp_type, icmp_code, port from, port to<br/>      egress:<br/>        - [100, 'all', 'allow', '0.0.0.0/0', null, null, 0, 65535]<br/><br/>  # Creating Route Table for subnet<br/>  - name: Create Route Table<br/>    ec2_vpc_route_table:<br/>      aws_access_key: "{{ aws_access_key }}"<br/>      aws_secret_key: "{{ aws_secret_key }}"<br/>      vpc_id: "{{ vpc_result.vpc.id }}" <br/>      region: "{{ region }}"<br/>      state: "{{ state }}" <br/>      tags:<br/>        Name: "{{ route_table_name }}"<br/>      subnets: [ "{{ subnet_result.subnet.id }}" ]<br/>      routes:<br/>        - dest: "{{ destinationCidrBlock }}" <br/>          gateway_id: "{{ igw_result.gateway_id }}"<br/>    register: public_route_table<br/>  <br/>  # Creating EC2 Instance<br/>  - name: Create EC2 Instance<br/>    ec2:<br/>      aws_access_key: "{{ aws_access_key }}"<br/>      aws_secret_key: "{{ aws_secret_key }}"<br/>      instance_type: t2.micro<br/>      image: ami-04b6c97b14c54de18<br/>      wait: yes<br/>      region: "{{ region }}"<br/>      group: "{{ security_group_name }}"<br/>      key_name: tests<br/>      count: 1<br/>      vpc_subnet_id:  "{{ subnet_result.subnet.id }}" <br/>      assign_public_ip: yes<br/>      instance_tags:<br/>        Name: "{{ instance_name }}"<br/>    register: ec2_result</span></pre><p id="dcc6" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤3:- </strong>ä¸ºAWSå‡­è¯åˆ›å»ºä¸€ä¸ª<strong class="jf hj">å¯å›å¤çš„</strong>æ–‡ä»¶</p><ul class=""><li id="790e" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘å·²ç»ä½¿ç”¨<strong class="jf hj"> ansible vault </strong>ä¸ºAWS <strong class="jf hj">è®¿é—®å¯†é’¥</strong> &amp; <strong class="jf hj">ç§˜å¯†å¯†é’¥</strong>åˆ›å»ºäº†å‡­è¯æ–‡ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°ç®¡ç†å®ƒã€‚</li></ul><blockquote class="me mf mg"><p id="5eda" class="jd je mh jf b jg kb ji jj jk kc jm jn mi kd jq jr mj ke ju jv mk kf jy jz ka hb bi translated">è¦ä½¿ç”¨ansible vaultåˆ›å»ºæ–°çš„åŠ å¯†æ–‡ä»¶ï¼Œæ‚¨éœ€è¦è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚å®ƒä¼šè¦æ±‚è¾“å…¥å¯†ç ï¼Œæ‰€ä»¥è¯·è¾“å…¥ä¸€ä¸ªå®¹æ˜“è®°ä½çš„å¯†ç </p></blockquote><pre class="ki kj kk kl fd lv lu lw lx aw ly bi"><span id="fac6" class="lz ig hi lu b fi ma mb l mc md">ansible-vault create cred.yml</span></pre><ul class=""><li id="d400" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">åœ¨å…¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹</li></ul><pre class="ki kj kk kl fd lv lu lw lx aw ly bi"><span id="2df2" class="lz ig hi lu b fi ma mb l mc md">aws_access_key: &lt;your aws access key&gt;<br/>aws_secret_key: &lt;your aws secret key&gt;</span></pre><p id="afdb" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬å››æ­¥:- </strong>åˆ›å»ºä¸€ä¸ª<strong class="jf hj">å¯†ç </strong>æ–‡ä»¶</p><ul class=""><li id="7bd5" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">åˆ›å»ºä¸€ä¸ªåä¸º<code class="du lr ls lt lu b">password.txt</code>çš„æ–°æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ‚¨çš„ansible vaultå¯†ç ï¼Œä»¥ä¾¿æˆ‘ä»¬ç¨åä½¿ç”¨ã€‚</li></ul><p id="e759" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">ç¬¬å››æ­¥:- </strong>åˆ›å»ºä¸€ä¸ª<strong class="jf hj">å·¥ä½œæµ</strong>æ–‡ä»¶</p><ul class=""><li id="1438" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">ç°åœ¨ï¼Œä¸ºäº†è‡ªåŠ¨åˆ›å»ºèµ„æºï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå·¥ä½œæµæ–‡ä»¶</li><li id="4fee" class="kz la hi jf b jg li jk lj jo lk js ll jw lm ka le lf lg lh bi translated">åˆ›å»º<code class="du lr ls lt lu b">.gitlab-ci.yml</code>æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°å…¶ä¸­</li><li id="d4f4" class="kz la hi jf b jg li jk lj jo lk js ll jw lm ka le lf lg lh bi translated">ä»¥ä¸‹ä½œä¸šå°†åœ¨ä¸»åˆ†æ”¯ä¸Šå‘ç”Ÿçš„æ¯ä¸ª<strong class="jf hj">æ¨</strong>å’Œ<strong class="jf hj">æ‹‰è¯·æ±‚</strong>ä¸Šè¿è¡Œã€‚åœ¨æ„å»ºéƒ¨åˆ†ï¼Œæˆ‘å·²ç»åœ¨è„šæœ¬éƒ¨åˆ†æŒ‡å®šäº†æ˜ åƒåç§°å’Œå‘½ä»¤ã€‚</li></ul><pre class="ki kj kk kl fd lv lu lw lx aw ly bi"><span id="f892" class="lz ig hi lu b fi ma mb l mc md">stages:<br/>  - run<br/><br/>image:<br/>  name: registry.gitlab.com/torese/docker-ansible<br/><br/>variables:<br/>    ANSIBLE_HOST_KEY_CHECKING: 'false'<br/>    ANSIBLE_FORCE_COLOR: 'true'<br/>    ANSIBLE_PYTHON_INTERPRRTER: /usr/bin/python3<br/><br/>before_script:<br/>  - yum install httpd -y<br/>  - yum install -y python3<br/>  - ansible --version<br/><br/>run:<br/>  stage: run<br/>  script:<br/>    - ansible-playbook main.yml --vault-password-file=password.txt</span></pre><p id="dcb6" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">æˆ‘ä»¬æ¥ç†è§£ä¸€ä¸‹ä¸Šé¢çš„ä»£ç ã€‚</p><ul class=""><li id="709f" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">ä¸‹é¢çš„ä»£ç ç”¨äºå£°æ˜é˜¶æ®µçš„åç§°</li></ul><pre class="ki kj kk kl fd lv lu lw lx aw ly bi"><span id="95c9" class="lz ig hi lu b fi ma mb l mc md">stages:<br/>  - run</span></pre><ul class=""><li id="87f2" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">æˆ‘ä»¬ä½¿ç”¨<code class="du lr ls lt lu b">ansible</code>å›¾åƒæ¥è¿è¡Œansibleå‰§æœ¬</li></ul><pre class="ki kj kk kl fd lv lu lw lx aw ly bi"><span id="da9d" class="lz ig hi lu b fi ma mb l mc md">image:<br/>  name: registry.gitlab.com/torese/docker-ansible</span></pre><ul class=""><li id="95f1" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">åœ¨<code class="du lr ls lt lu b">variable</code>éƒ¨åˆ†ï¼Œæˆ‘ä»¬å®šä¹‰äº†ç¯å¢ƒå˜é‡</li></ul><pre class="ki kj kk kl fd lv lu lw lx aw ly bi"><span id="b6bc" class="lz ig hi lu b fi ma mb l mc md">variables:<br/>    ANSIBLE_HOST_KEY_CHECKING: 'false'<br/>    ANSIBLE_FORCE_COLOR: 'true'<br/>    ANSIBLE_PYTHON_INTERPRRTER: /usr/bin/python3</span></pre><ul class=""><li id="e37d" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">åœ¨<code class="du lr ls lt lu b">before_script</code>éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ­£åœ¨å®‰è£…<code class="du lr ls lt lu b">httpd</code>å’Œ<code class="du lr ls lt lu b">python3</code>å¹¶æ£€æŸ¥<code class="du lr ls lt lu b">ansible</code>ç‰ˆæœ¬</li></ul><pre class="ki kj kk kl fd lv lu lw lx aw ly bi"><span id="8cb6" class="lz ig hi lu b fi ma mb l mc md">before_script:<br/>  - yum install httpd -y<br/>  - yum install -y python3<br/>  - ansible --version</span></pre><ul class=""><li id="9540" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">åœ¨<code class="du lr ls lt lu b">run</code>éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ­£åœ¨è¿è¡Œansibleè¡ŒåŠ¨æ‰‹å†Œ</li></ul><pre class="ki kj kk kl fd lv lu lw lx aw ly bi"><span id="82b6" class="lz ig hi lu b fi ma mb l mc md">run:<br/>  stage: run<br/>  script:<br/>    - ansible-playbook main.yml --vault-password-file=password.txt</span></pre><p id="dd19" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤5:- </strong>æ£€æŸ¥<strong class="jf hj">è¾“å‡º</strong></p><ul class=""><li id="d6da" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">ç°åœ¨ï¼Œåªè¦ä½ æäº¤ä½ çš„å·¥ä½œæµæ–‡ä»¶ï¼ŒGitLabå°±ä¼šè§¦å‘è¿™ä¸ªåŠ¨ä½œï¼Œèµ„æºå°±ä¼šåœ¨AWSå¸æˆ·ä¸Šåˆ›å»ºã€‚</li><li id="0fc4" class="kz la hi jf b jg li jk lj jo lk js ll jw lm ka le lf lg lh bi translated">è¿è¡Œä½œä¸šåï¼Œæ‚¨å°†çœ‹åˆ°æ‰€æœ‰æ­¥éª¤éƒ½è¿è¡Œè‰¯å¥½ï¼Œæ²¡æœ‰é”™è¯¯ã€‚å› æ­¤ï¼Œå½“æ¯ä¸ªæ­¥éª¤å·¥ä½œæˆåŠŸæ—¶ï¼Œæ‚¨å°†æ‹¥æœ‰ç”¨ç»¿è‰²ä¹¦å†™çš„<code class="du lr ls lt lu b">passed</code>ã€‚</li></ul><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ml"><img src="../Images/48696361e08a8c881839040b9a7dbb24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bueDHrHtr-yqzCvSLCBRUw.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Jobs</figcaption></figure><ul class=""><li id="eac7" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">æ‚¨è¿˜å¯ä»¥é€šè¿‡å•å‡»æ¥æ£€æŸ¥æ¯ä¸ªæ­¥éª¤çš„è¾“å‡º</li></ul><p id="ce88" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">æ­¥éª¤6:- </strong>æ£€æŸ¥<strong class="jf hj"> AWS </strong>ä¸Šçš„èµ„æº</p><ul class=""><li id="1b20" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka le lf lg lh bi translated">ä¸€æ—¦ä½œä¸šè¿è¡Œå®Œæˆï¼Œæ‚¨å°±å¯ä»¥å¯¼èˆªåˆ°AWSå¹¶æ£€æŸ¥æ‰€æœ‰èµ„æº</li><li id="57e7" class="kz la hi jf b jg li jk lj jo lk js ll jw lm ka le lf lg lh bi translated">Ansibleå°†åˆ›å»ºä»¥ä¸‹èµ„æº</li></ul><ol class=""><li id="6ab7" class="kz la hi jf b jg kb jk kc jo ln js lo jw lp ka mm lf lg lh bi translated"><strong class="jf hj"> VPC </strong></li></ol><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ml"><img src="../Images/d5b89e5ff74c839042b68fd462ce5258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*asedyRLvJWN8gn3NFOFixg.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">VPC</figcaption></figure><p id="ac07" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 2ã€‚å­ç½‘</strong></p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ml"><img src="../Images/1e46515052a3838436dd7c92ba188b7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_vivLx_BWB4YNtl1sT9bw.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Subnets</figcaption></figure><p id="361e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 3ã€‚äº’è”ç½‘ç½‘å…³</strong></p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ml"><img src="../Images/c0c2b9872d60b15721a0f83d9adbaf4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1DEhoC7mOrldY-6tsGEpg.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Internet Gateway</figcaption></figure><p id="4c09" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 4ã€‚Rouetè¡¨</strong></p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ml"><img src="../Images/51988442848755f4dfcfb7f53d73da26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iU8V-f6YvWgCycE66ZnHJQ.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Route Table</figcaption></figure><p id="eb63" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 5ã€‚å®‰å…¨ç»„</strong></p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mn"><img src="../Images/fe6c0f89a65b59e09b17b0746eb54428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gre25hzHQA2_Ia4riCk3pQ.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Security Group</figcaption></figure><p id="99ea" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 6ã€‚å¯†é’¥å¯¹</strong></p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ml"><img src="../Images/8e9acd2e943b274dabea7fbb4c936de6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-pbYC21DaMvPA8TdLXef2A.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Key Pair</figcaption></figure><p id="b739" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 7ã€‚EC2å®ä¾‹</strong></p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ml"><img src="../Images/223659661787f435c7ffbb61c1f5b151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bkAbuFTFKfS0HwxEl3TFPw.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">EC2 Instance</figcaption></figure><p id="9300" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">ç°åœ¨å°±è¿™æ ·ï¼Œä½ å·²ç»å­¦ä¼šäº†å¦‚ä½•å°†Ansibleä¸GitLab CI/CDé›†æˆã€‚æ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨å®ƒå¹¶å¯¹å…¶è¿›è¡Œç›¸åº”çš„ä¿®æ”¹ã€‚</p><p id="d169" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">å¦‚æœæ‚¨è§‰å¾—æœ¬æŒ‡å—å¾ˆæœ‰å¸®åŠ©ï¼Œè¯·ç‚¹å‡»ğŸ‘æŒ‰é’®ï¼Œä¹Ÿå¯ä»¥éšæ„å‘è¡¨è¯„è®ºã€‚</p><p id="d3ea" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">å…³æ³¨æ›´å¤šç±»ä¼¼çš„æ•…äº‹ğŸ˜Š</p></div></div>    
</body>
</html>