# é€’å½’ç¥ç»ç½‘ç»œçš„ç›´è§‰

> åŸæ–‡ï¼š<https://medium.com/geekculture/the-intuition-of-recurrent-neural-networks-906a846e20b0?source=collection_archive---------13----------------------->

![](img/cc5049b9b096e07b771ef31c34706099.png)

remember those memories? ML does too ğŸ™Œ | Photo by [Jon Tyson](https://unsplash.com/@jontyson?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

> è¿™æ˜¯ä¸€ç¯‡ä»‹ç»æ€§æ–‡ç« ã€‚å»ºè®®ä½ äº†è§£ä¸€ä¸‹[æ¢¯åº¦ä¸‹é™](/geekculture/gradient-descent-simplified-631a7ce38cb6)ã€[åé¢çš„ä½œå“ä¸€äº›çº¿æ€§ä»£æ•°](https://www.deeplearningbook.org/)ã€[å’ŒåŸºæœ¬çš„ DL çŸ¥è¯†](https://www.deeplearningbook.org/)ğŸ™‚ã€‚ç„¶è€Œï¼Œå®ƒéå¸¸ç®€å•ï¼Œæœ‰è®¸å¤šè§†è§‰æ•ˆæœï¼Œæ‰€ä»¥ä»»ä½•æ°´å¹³çš„çŸ¥è¯†éƒ½å¯ä»¥ä½¿ç”¨ï¼

æˆ‘ä¸€ç›´å¾ˆçæƒœé€’å½’ç¥ç»ç½‘ç»œä¸­çš„ä¸€ç§é­”åŠ›ã€‚æˆ‘è®°å¾—ä¸ä¹…å‰çœ‹è¿‡å®‰å¾·çƒˆÂ·å¡å¸•è¥¿çš„ã€Šå“è¯„åŠ©ç† LSTMã€‹æ¨¡å‹ã€‚åœ¨è®­ç»ƒä»–çš„æ¨¡å‹(ä½¿ç”¨ç›¸å½“éšæ„é€‰æ‹©çš„è¶…å‚æ•°)çš„å‡ ååˆ†é’Ÿå†…ï¼Œå®ƒå¼€å§‹äº§ç”Ÿå³å°†æœ‰æ„ä¹‰çš„æ„ä¹‰ã€‚

> æ€ä¹ˆå¯èƒ½æå–ä»¥å‰æœ¯è¯­çš„ç²¾åæ¥çŒœæµ‹æœªæ¥çš„è¯ï¼Ÿ

æˆ‘å¾ˆéœ‡æƒŠã€‚ä»æˆ‘çš„æœºå™¨å­¦ä¹ ç»éªŒæ¥çœ‹ï¼Œæˆ‘ç†Ÿæ‚‰ä¸€ä¸ªæ¨¡å‹åœ¨**çº¿æ€§**æ•°æ®ä¸­å¯»æ‰¾å’Œæå–å…³ç³»çš„èƒ½åŠ›ï¼Œä½†æ˜¯ç†è§£å¥å­çš„ä¸»é¢˜ã€è¯­æ³•å’Œé£æ ¼æœ‰ä»€ä¹ˆé­”åŠ›å‘¢ï¼Ÿ

Juergen Schmidhuber å‘ç°äº†è¿™ä¸ªç¥å¥‡çš„æ¦‚å¿µï¼Œä»–åœ¨ä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œä¸­åŠ å…¥äº†ä¸€ç§å¾®å¦™çš„è®°å¿†æ„Ÿã€‚è¿™äº›å°±æ˜¯æˆ‘ä»¬ä»Šå¤©çœ‹åˆ°çš„ä¼ ç»Ÿ rnnã€‚

> é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œä½ å°†äº†è§£ LSTM å’Œ RNN åŠå…¶å˜ç§èƒŒåçš„æ•°å­¦è¿ç®—ã€‚

## TLï¼›é€Ÿåº¦ä¸‰è§’å½¢å®šä½æ³•(dead reckoning)

*   **RNNs ç®€ä½“:**ç¼©å†™ä»£è¡¨ä»€ä¹ˆï¼ŸRNNs å’Œå‰é¦ˆç½‘ç»œæœ‰ä»€ä¹ˆä¸åŒï¼Ÿç®—æ³•çš„æ¶æ„æ˜¯ä»€ä¹ˆï¼Ÿ
*   **æ·±å…¥æ¦‚å¿µ:**RNN æœ‰å“ªäº›å“ç§ï¼ŸLSTMs æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿä½ çš„ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿ

# ç®€åŒ–çš„ RNNs

## ä»‹ç»æ€§ç¤ºä¾‹

è®©æˆ‘ä»¬å‡è®¾æ‚¨ç¼–å†™äº†ä¸€ä¸ªå¯¹è±¡æ£€æµ‹æ¨¡å‹ï¼Œå…¶ä¸­è¾“å…¥æ˜¯é‡ç”ŸåŠ¨ç‰©çš„çºªå½•ç‰‡ã€‚

ç»“æœæ˜¯å‡†ç¡®çš„ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¯¥æ¨¡å‹å°†ç‹¼å½’ç±»ä¸ºç‹—â€”â€”å› ä¸ºå®ƒä»¬å±äºåŒä¸€å®¶æ—ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå…·æœ‰æ®‹å·®çš„ç¥ç»ç½‘ç»œå°†è¡¨ç°è‰¯å¥½ã€‚å¦‚æœè®¡ç®—æœºç†è§£ç»™å®šçš„çºªå½•ç‰‡å›´ç»•é‡ç”ŸåŠ¨ç‰©â€”â€”ä»ä»¥å‰çš„ç‰©ä½“æ£€æµ‹è¿è¡Œä¸­â€”â€”å®ƒå°±å¯ä»¥ç®€å•åœ°ä½¿ç”¨è¿™ä¸€çŸ¥è¯†æ¥æ­£ç¡®é¢„æµ‹ç‹¼çš„ç§ç±»ã€‚è¿™æ˜¯ RNN äººåšçš„äº‹ã€‚

> åœ¨ RNNs ä¸­ï¼Œå½“å‰è¾“å‡ºå–å†³äºå…¶å½“å‰å€¼ï¼Œä½†ä¹Ÿå–å†³äºè¿‡å»çš„è¾“å…¥ã€‚

åœ¨è¿™ç§ç±»å‹çš„ç¥ç»ç½‘ç»œä¸­æœ‰å·¨å¤§çš„åŠ›é‡ã€‚å®ƒå¯ä»¥è¯†åˆ«æƒ…æ„Ÿåˆ†æçš„ä¸Šä¸‹æ–‡ï¼Œä»è¯­è¨€å’Œå…¶ä»–è‡ªç„¶è¯­è¨€çš„å¯èƒ½æ€§ä¸­è¿›è¡Œç¿»è¯‘â€”â€”é€šè¿‡è®°ä½ä»¥å‰çš„è¯ä¹‰ã€‚

## ä»è¿‡å»çš„è¾“å…¥ä¸­è·å–è®°å¿†

åœ¨ä¼ ç»Ÿçš„å¯†é›†åˆ†å±‚å‰é¦ˆç½‘ç»œä¸­ï¼Œæœ‰ä¸‰ä¸ªä¸åŒçš„å±‚ã€‚

*   **è¾“å…¥å±‚:**ç¥ç»å…ƒæ•°é‡ä¸è¾“å…¥çš„æ•°æ®ç‰¹å¾æ•°é‡ç›¸å…³ã€‚
*   **éšè—å±‚:**æ·±åº¦å­¦ä¹ è®¡ç®—å®Œæˆã€‚è¶…å‚æ•°å¦‚å±‚çš„å¤§å°å’Œå±‚æ•°å–å†³äºå…·ä½“é—®é¢˜ã€‚
*   **è¾“å‡ºå±‚:**æˆ‘ä»¬é€šè¿‡ä¸€ä¸ª softmax å‡½æ•°å¾—å‡ºè§£æˆ–æ¦‚ç‡ã€‚

![](img/b847711bdfe8c4351e118c61fc891209.png)

Weights (w_ii) are constants that are tuned through gradient descent | [Source](https://matlab4engineers.com/lesson/feed-forward-networks/?lang=en&v=3a52f3c22ed6)

å¦ä¸€æ–¹é¢ï¼ŒRNNs é€šè¿‡å¼•å…¥å¾ªç¯æœºåˆ¶å…è®¸è®°å¿†åœ¨å‰é¦ˆç¥ç»ç½‘ç»œä¸­æŒç»­ã€‚è¿™ä¸ªå·¥å…·åå¤åœ°å°†å…ˆå‰çš„è¾“å‡ºä¼ é€’åˆ°å½“å‰ä½ç½®ï¼Œå……å½“è®°å¿†çš„é«˜é€Ÿå…¬è·¯ã€‚

> ä¸å‰é¦ˆç½‘ç»œç›¸åï¼ŒRNNs å…è®¸ä¿¡æ¯å¾ªç¯ã€‚

å¦‚æœæˆ‘ä»¬å°†è¿™ä¸ªä¿¡æ¯å¾ªç¯å½¢è±¡åŒ–ï¼Œå›¾è¡¨å°†å¦‚ä¸‹æ‰€ç¤ºã€‚

![](img/32050bdad98f28626faade5bb4b4c597.png)

Information is recurrently recycled back into the hidden layer

åœ¨è¿™é‡Œï¼Œéšè—çŠ¶æ€æ˜¯è¡¨è¾¾ä¿¡æ¯é«˜é€Ÿå…¬è·¯çš„å¦ä¸€ç§æ–¹æ³•ã€‚è¯·æ³¨æ„ï¼Œå¦‚æœæœ‰å¤šæ¡ä¿¡æ¯éœ€è¦é€šè¿‡ RNN è¿›è¡Œå¤„ç†ï¼Œè¿™æ¡é«˜é€Ÿå…¬è·¯å°†ä¼šä¸æ–­æ›´æ–°ã€‚

ä¸ºäº†æ›´å¥½åœ°äº†è§£å¾ªç¯æœºåˆ¶ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨æ–‡æœ¬é¢„æµ‹ NLP æ¨¡å‹ä½œä¸ºæŒ‡å¯¼ã€‚è¯¥æ¨¡å‹æ ¹æ®ä¹‹å‰çš„è¯ä¹‰é¢„æµ‹å¥å­ä¸­çš„ä¸‹ä¸€ä¸ªå•è¯ã€‚

> rnn ç”¨äº NLPï¼Œå› ä¸ºå®ƒä»¬åœ¨é¢„æµ‹å’Œåˆ†æä¿¡æ¯åºåˆ—æ–¹é¢è¡¨ç°è‰¯å¥½ã€‚

> è¯·åŠ¡å¿…è§‚çœ‹æ­¤æ¼”ç¤ºï¼Œäº†è§£[æ–‡æœ¬é¢„æµ‹](https://www.youtube.com/watch?v=5DSfFDdybzg)æ¨¡å‹çš„åŠŸèƒ½ã€‚*ğŸ˜‰*

åœ¨æˆ‘ä»¬çš„æ¨¡å‹ä¸­ï¼Œç¬¬ä¸€æ­¥æ˜¯å°†è¾“å…¥çš„å¥å­åˆ†å‰²æˆå•ä¸ªçš„å•è¯ï¼Œè¿™äº›å•è¯è¢«è½¬æ¢æˆè®¡ç®—æœºå¯è¯»çš„æ•°å­—å‘é‡ã€‚è¿™äº›å‘é‡ä¾æ¬¡å•ç‹¬è¿›å…¥ç¥ç»ç½‘ç»œã€‚

å¦‚æœé‚£å¥è¯æ˜¯*â€œæ±¤å¥½å–ï¼â€*ã€*ã€ã€æ±¤ã€‘*çš„çŸ¢é‡åŒ–å½¢å¼è®¡ç®—åä¼ é€’ç»™éšè—å±‚ã€‚

![](img/deb564f31eec34d296aef6efe5eb8d64.png)

word to vector transformation occurs through the one-hot encoding process

ç¬¬äºŒä¸ªå•è¯â€œinâ€åŒæ ·è¢«ä¼ é€’ï¼Œå°½ç®¡æœ‰ä¸€ä¸ªé¢å¤–çš„å‘é‡**â€˜y _ soupâ€™**ã€‚è¿™ä¸ªå’Œå½¢æˆäº†å‘é‡**â€˜y _ inâ€™**ï¼Œè¯¥å‘é‡å…·æœ‰å½“å‰å•è¯ä»¥åŠå…ˆå‰å•è¯çš„å«ä¹‰ã€‚

![](img/368e070ed3eed68c7a658d40e4d586e4.png)

åœ¨å¯¹å¥å­ä¸­çš„æ¯ä¸ªå•è¯è¿›è¡Œäº†æ— æ•°æ¬¡è¿™æ ·çš„æ·»åŠ ä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªå‘é‡ï¼Œè¯¥å‘é‡æè¿°äº†å¥å­ä½œä¸ºä¸€ä¸ªæ•´ä½“çš„å«ä¹‰å’Œç›¸å…³æ€§ï¼Œè¯¥å‘é‡å¯ä»¥ç”¨äºé¢„æµ‹å¥å­ä¸­çš„å…¶ä»–å•è¯ã€‚

![](img/0640c7a56be9f0effac7071251cf9fca.png)

y_sentence can then be used for paraphrasing and other NLP uses | tanh is the activation function used

è¯·æ³¨æ„ï¼Œä¸Šé¢æ˜¾ç¤ºçš„éšè—å±‚ä¸æ˜¯å•ç‹¬çš„å±‚ã€‚å®ƒä»¬æ˜¯ä¸€ä¸ªå±‚ï¼Œå‰©ä½™éƒ¨åˆ†åœ¨å…¶ä¸­å¾ªç¯ã€‚å¦‚æœæœ‰å¤šä¸ªå±‚ï¼Œåˆ™[æ¢¯åº¦ä¸‹é™](/geekculture/gradient-descent-simplified-631a7ce38cb6)è¿‡ç¨‹å°†ä¼šåæ–œã€‚

è¿™æ ·ï¼Œæˆ‘ä»¬å°±çŸ¥é“äº†é€’å½’ç¥ç»ç½‘ç»œçš„å·¥ä½œè¿‡ç¨‹ï¼ç„¶è€Œï¼Œè¿™ç§é€»è¾‘å¾ˆå°‘æœ‰å‡ºé”™çš„åœ°æ–¹ã€‚

# RNN å“ç§

äº‹å®ä¸Šï¼Œä½¿ç”¨æ‰€ç¤ºçš„ RNN é€»è¾‘è¿›è¡Œæ–‡æœ¬é¢„æµ‹å°†ä¸ä¼šåƒé¢„æœŸçš„é‚£æ ·èµ·ä½œç”¨ã€‚è¿™æ˜¯å› ä¸º **y_sentence** çš„è¯å½±å“åŠ›åˆ†å¸ƒä¸å‡ã€‚

ä¾‹å¦‚ï¼Œåæ¥çš„å•è¯å¦‚â€œå¥½åƒï¼â€è€Œâ€œæ±¤å¥½å–ï¼â€å¯¹æ¨¡å‹æœªæ¥çš„æ–‡æœ¬é¢„æµ‹æœ‰æ›´å¤§çš„å½±å“ã€‚å› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„æ¨¡å‹ä¸­æœ‰ä¸€ä¸ªçŸ­æœŸçš„å•è¯åå·®ã€‚

![](img/3fc4a6106d6b6942f465f5aa4313a808.png)

the degree of a sentenceâ€™s influence on the modelâ€™s prediction is biased

åœ¨æ–¹ç¨‹ä¸­å¼•å…¥é•¿æ—¶è®°å¿†ï¼Œå¯ä»¥å¹³è¡¡æ¯ä¸ªå•è¯çš„å½±å“ç¨‹åº¦ã€‚å®ƒä¹Ÿå°†å¯¹æŠ—[æ¶ˆå¤±æ¢¯åº¦é—®é¢˜](https://medium.datadriveninvestor.com/how-do-lstm-networks-solve-the-problem-of-vanishing-gradients-a6784971a577)å…è®¸æ›´é•¿çš„å•è¯åºåˆ—ï¼Œä»ä¸­æå–å‡†ç¡®çš„æ„æ€ã€‚

> è¿ç”¨çŸ­æœŸå’Œé•¿æœŸè®°å¿†çš„æŠ€æœ¯è¢«ç§°ä¸º LSTMã€‚

## é•¿çŸ­æœŸè®°å¿†

LSTMs æ˜¯å¼ºå¤§çš„å·¥å…·ã€‚å®ƒå¹¿æ³›ç”¨äºæ‰©å±•çš„æ•°æ®åºåˆ—ï¼Œå¦‚æ®µè½å’Œ DNAï¼Œå¹¶ä¸ºä¼ ç»Ÿ rnn çš„è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸå¥ å®šäº†åŸºç¡€ã€‚

> å°½ç®¡ LSTM çš„æ¶æ„ä¸åŒäºç»å…¸çš„ RNNï¼Œä½†å®ƒæœ¬èº«çš„è®°å¿†èƒ½åŠ›å´è¢«è®¤ä¸ºæ˜¯ RNNã€‚

LSTM æ¶æ„ç”±å››ä¸ªé—¨ç»„æˆï¼Œé•¿æœŸå’ŒçŸ­æœŸè®°å¿†(æ¥è‡ªè¾“å…¥åºåˆ—)é€šè¿‡å…¶ä¸­ï¼Œä»¥è·å¾—é¢„æµ‹å’Œæ›´æ–°çš„é•¿æœŸå’ŒçŸ­æœŸè®°å¿†ã€‚

![](img/0d004551913ae94c19d50ba5be788c67.png)

note that the text prediction process includes more steps including word embeddings, character embedding, and others.

æ³¨æ„åˆ°çš„å››ä¸ªé—¨åŒ…æ‹¬:

*   é—å¿˜é—¨:æ— ç”¨çš„æ•°æ®ä»**é•¿æœŸè®°å¿†**ä¸­è¢«ä¸¢å¼ƒï¼Œæœ‰ç”¨çš„æ•°æ®è¢«ä¿ç•™ã€‚
*   å­¦ä¹ é—¨:åŒæ ·çš„ï¼Œåºåˆ—ä¸­çš„**å½“å‰äº‹ä»¶**å’Œ**çŸ­æ—¶è®°å¿†**è¢«åŠ å…¥ä»¥ç§»é™¤æ— ç”¨æ•°æ®ã€‚
*   è®°å¿†é—¨:å°†**é—å¿˜é—¨**å’Œ**å­¦ä¹ é—¨**åä¿å­˜çš„ä¿¡æ¯ç»„åˆèµ·æ¥ï¼Œå½¢æˆæ›´æ–°çš„é•¿æœŸè®°å¿†ã€‚è¿™äº›ä¿¡æ¯å°†è¢«ä¿ç•™ä»¥å¤‡å°†æ¥äº‹ä»¶ä½¿ç”¨ã€‚
*   ä½¿ç”¨é—¨:è®¡ç®—æ¥è‡ª**é—å¿˜é—¨**å’Œ**å­¦ä¹ é—¨**çš„è¾“å‡ºï¼Œç”¨äºä»¥ä¸‹é¢„æµ‹ã€‚

![](img/7ff9d15c65cabc1149507db63835c746.png)

and the process continuesâ€¦

# åç»­æ­¥éª¤å’Œæœªæ¥é˜…è¯»

æ—¢ç„¶æˆ‘ä»¬ç†è§£äº†**è®°å¿†**å’Œ**é€’å½’ç¥ç»ç½‘ç»œ**çš„æ€æƒ³ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯ç†è§£å®ƒä»¬èƒŒåçš„æ•°å­¦è¿ç®—ã€‚

è€ƒè™‘é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œäº†è§£æ›´å¤šå…³äºå››ä¸ªé—¨çš„åŠŸèƒ½ã€‚å¦‚æœä½ å¯¹ LSTM å’Œ RNN çš„é¡¹ç›®æ„Ÿå…´è¶£ï¼Œä½¿ç”¨è¿™ä¸ªå›¾åƒå­—å¹•æ•™ç¨‹æ¥åˆ›å»ºä½ è‡ªå·±çš„é¡¹ç›®å§ï¼

> ç¥ä½ åœ¨é€šå¾€æœºå™¨å­¦ä¹ é«˜å³°çš„æ—…é€”ä¸­å¥½è¿ï¼

# åœ¨ä½ èµ°ä¹‹å‰â€¦

> æœºå™¨å­¦ä¹ ä¸€ç›´æ˜¯æˆ‘çš„ç ”ç©¶çƒ­ç‚¹ã€‚æ— è®ºæ˜¯åœ¨ snapchat è¿‡æ»¤å™¨è¿˜æ˜¯åƒåœ¾é‚®ä»¶åˆ†ç±»å™¨ä¸­ï¼Œåˆ°å¤„éƒ½åœ¨ä½¿ç”¨**ã€‚ä»Šå¤©ï¼Œå®ƒæ›´åƒæ˜¯ä¸€ç§ç”Ÿæ´»æ–¹å¼ï¼Œè€Œä¸æ˜¯æµè¡Œè¯­ã€‚**
> 
> *è¿™å°±æ˜¯æˆ‘è¿›å…¥æ•°æ®ç§‘å­¦é¢†åŸŸçš„åŸå› ã€‚ä»ä¸€å¼€å§‹ï¼Œæˆ‘å°±ä¸Šç˜¾äº†ï¼Œæˆ‘å¸Œæœ›æˆ‘ä¼šä¸€ç›´ä¸Šç˜¾ã€‚*
> 
> **å¦‚æœä½ å–œæ¬¢é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œè¯·è”ç³»æˆ‘çš„ç¤¾äº¤ç½‘ç«™ğŸ¤—(é™„è¨€:æƒ³æ‰¾ç‚¹é—®é¢˜è§£å†³:æœ‰æ—¶é—´ç»™æˆ‘å‘å‡ ä¸ªè¿‡æ¥)* [*LinkedIn*](https://www.linkedin.com/in/arjun-mahes-a46200220/)*|*[*ç®€è®¯*](https://arjunmahes.substack.com/) *|* [*æ¨ç‰¹*](https://twitter.com/mahes_arjun)*