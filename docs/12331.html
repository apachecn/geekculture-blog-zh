<html>
<head>
<title>Open-Faas on Centos 7</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Centos 7ä¸Šçš„å¼€æ”¾å¼Faas</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/open-faas-on-centos-7-c4dc629f28fe?source=collection_archive---------13-----------------------#2022-05-07">https://medium.com/geekculture/open-faas-on-centos-7-c4dc629f28fe?source=collection_archive---------13-----------------------#2022-05-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0bd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½ å¥½ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä»‹ç»ä½¿ç”¨minikubeé›†ç¾¤åœ¨centos 7æœºå™¨ä¸Šå®‰è£…OpenFaasçš„æ­¥éª¤ï¼Œç„¶ååœ¨æ­¤è®¾ç½®çš„åŸºç¡€ä¸Šéƒ¨ç½²å’Œè¿è¡Œgo-microserviceã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/594769c81d1b7a0daac2c716a3661570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hJuGnLGMeqooCSl8"/></div></div></figure><p id="0501" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¯¹äºè¿™ä¸ªè®¾ç½®ï¼Œæˆ‘ä¸€ç›´åœ¨å…³æ³¨<a class="ae jp" href="https://github.com/openfaas/workshop/" rel="noopener ugc nofollow" target="_blank"> OpenFaasç ”è®¨ä¼š</a>çš„æ–‡æ¡£ï¼Œä»¥åŠ<a class="ae jp" href="https://www.openfaas.com/blog/golang-serverless/" rel="noopener ugc nofollow" target="_blank"> OpenFaasåšå®¢</a>ã€‚</p><h2 id="17e7" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">å…ˆå†³æ¡ä»¶</h2><ol class=""><li id="a8ab" class="kl km hi ih b ii kn im ko iq kp iu kq iy kr jc ks kt ku kv bi translated">Docker:è¯´æ˜å¯ä»¥ä»å®˜æ–¹<a class="ae jp" href="https://docs.docker.com/engine/install/centos/" rel="noopener ugc nofollow" target="_blank"> Dockeræ–‡æ¡£</a>ä¸­æ‰¾åˆ°ã€‚</li><li id="9f97" class="kl km hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">OpenFaas CLI:æ¥è‡ª<a class="ae jp" href="https://github.com/openfaas/workshop/blob/master/lab1.md#openfaas-cli" rel="noopener ugc nofollow" target="_blank">å®˜æ–¹githubæ–‡æ¡£</a>ã€‚<br/>$ curl-sLSf<a class="ae jp" href="https://cli.openfaas.com" rel="noopener ugc nofollow" target="_blank">https://cli.openfaas.com</a></li><li id="43bc" class="kl km hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">Minikube:æˆ‘éµå¾ªäº†æœ¬æ–‡æ¡£ä¸­<a class="ae jp" href="https://phoenixnap.com/kb/install-minikube-on-centos" rel="noopener ugc nofollow" target="_blank">çš„æ­¥éª¤ã€‚</a></li><li id="6669" class="kl km hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">dockeræ³¨å†Œä¸­å¿ƒ:åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä½¿ç”¨äº†æˆ‘çš„Harbor imageæ³¨å†Œä¸­å¿ƒï¼Œä½†æ˜¯ä½ å¯ä»¥æŒ‰ç…§æˆ‘çš„å‰ä¸€ç¯‡æ–‡ç« åˆ›å»ºä½ è‡ªå·±çš„dockeræ³¨å†Œä¸­å¿ƒã€‚(å¯ä»¥ä½¿ç”¨minikube Dockeræ³¨å†Œè¡¨:<code class="du lb lc ld le b">eval $(minikube docker-env)</code>)</li><li id="3fd7" class="kl km hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">Helm: <a class="ae jp" href="https://helm.sh/docs/intro/install/" rel="noopener ugc nofollow" target="_blank">å®˜æ–¹å®‰è£…æŒ‡å—</a>ã€‚</li><li id="7bae" class="kl km hi ih b ii kw im kx iq ky iu kz iy la jc ks kt ku kv bi translated">å»</li></ol><h2 id="cd3b" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">è£…ç½®</h2><p id="c575" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»æ”¶é›†äº†æˆ‘ä»¬çš„å…ˆå†³æ¡ä»¶ï¼Œè®©æˆ‘ä»¬ç»§ç»­éƒ¨ç½²OpenFaasã€‚</p><p id="1bd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">é¦–å…ˆè®©æˆ‘ä»¬å¼€å§‹minikubeã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="e9ea" class="jq jr hi le b fi lm ln l lo lp">minikube start</span></pre><p id="aa53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘å·²ç»ä¸ºOpenFaaså®‰è£…ä½¿ç”¨äº†èˆµå›¾ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="3f79" class="jq jr hi le b fi lm ln l lo lp">helm repo add openfaas <a class="ae jp" href="https://openfaas.github.io/faas-netes/" rel="noopener ugc nofollow" target="_blank">https://openfaas.github.io/faas-netes/</a></span><span id="e0ce" class="jq jr hi le b fi lq ln l lo lp">kubectl apply -f <a class="ae jp" href="https://raw.githubusercontent.com/openfaas/faas-netes/master/namespaces.yml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/openfaas/faas-netes/master/namespaces.yml</a></span><span id="f13c" class="jq jr hi le b fi lq ln l lo lp">helm repo update \<br/> &amp;&amp; helm upgrade openfaas --install openfaas/openfaas \<br/>    --namespace openfaas  \<br/>    --set functionNamespace=openfaas-fn \<br/>    --set generateBasicAuth=true</span></pre><p id="d84d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¿™å°†åœ¨kubernetesé›†ç¾¤ä¸­åˆ›å»ºä¸¤ä¸ªåç§°ç©ºé—´ï¼Œåä¸ºopenfaaså’Œopenfaas-fnã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ£€æŸ¥ä¸‹é¢çš„podçŠ¶æ€æ¥æ£€æŸ¥æˆ‘ä»¬çš„å®‰è£…æ˜¯å¦æˆåŠŸã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="2a21" class="jq jr hi le b fi lm ln l lo lp">kubectl get pods -n openfaas -w</span></pre><p id="6e71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‰€æœ‰å•å…ƒéƒ½åº”å¤„äºè¿è¡ŒçŠ¶æ€ã€‚</p><p id="ccbc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ£€æŸ¥ç½‘å…³æ˜¯å¦å‡†å¤‡å¥½äº†ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="955b" class="jq jr hi le b fi lm ln l lo lp">kubectl rollout status -n openfaas deploy/gateway</span></pre><p id="e6b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä»é›†ç¾¤ä¸­è·å–æˆ‘ä»¬çš„èº«ä»½éªŒè¯è¯¦ç»†ä¿¡æ¯ã€‚ä¸‹é¢çš„å‘½ä»¤å°†æ‰“å°openfaasç™»å½•çš„ç®¡ç†å‘˜å¯†ç ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="a370" class="jq jr hi le b fi lm ln l lo lp">PASSWORD=$(kubectl -n openfaas get secret basic-auth -o jsonpath="{.data.basic-auth-password}" | base64 --decode) &amp;&amp; \<br/>echo "OpenFaaS admin password: $PASSWORD"</span></pre><p id="a96a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç„¶åæˆ‘ä»¬éœ€è¦ç«¯å£è½¬å‘è¿™ä¸ªç«¯å£ï¼Œä»æˆ‘ä»¬çš„æœºå™¨è®¿é—®ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="ff36" class="jq jr hi le b fi lm ln l lo lp">export OPENFAAS_URL=<a class="ae jp" href="http://127.0.0.1:31112" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:</a>31112<br/>kubectl port-forward -n openfaas svc/gateway 31112:8080 &amp;</span></pre><p id="fa85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸ºäº†æ·»åŠ æ™®ç½—ç±³ä¿®æ–¯(metrics)ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="ea10" class="jq jr hi le b fi lm ln l lo lp">kubectl --namespace openfaas port-forward deployment/prometheus 31119:9090</span></pre><p id="351b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸ºäº†æ·»åŠ grafanaç›‘æ§ï¼Œè®©æˆ‘ä»¬è¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="d9b2" class="jq jr hi le b fi lm ln l lo lp">kubectl -n openfaas run \<br/>--image=stefanprodan/faas-grafana:4.6.3 \<br/>--port=3000 \<br/>grafana</span><span id="9978" class="jq jr hi le b fi lq ln l lo lp">kubectl -n openfaas expose pod grafana \<br/>--type=NodePort \<br/>--name=grafana</span><span id="7faf" class="jq jr hi le b fi lq ln l lo lp">GRAFANA_PORT=$(kubectl -n openfaas get svc grafana -o jsonpath="{.spec.ports[0].nodePort}")<br/>GRAFANA_URL=<a class="ae jp" href="http://IP_ADDRESS:$GRAFANA_PORT/dashboard/db/openfaas" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:$GRAFANA_PORT/dashboard/db/openfaas</a></span><span id="f2fb" class="jq jr hi le b fi lq ln l lo lp">kubectl port-forward pod/grafana 3000:3000 -n openfaas</span></pre><p id="fca0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥è®¿é—®openfaas uiçš„url http://127.0.0.1:31112(ç®¡ç†å‘˜/ç”Ÿæˆçš„å¯†ç )ï¼ŒPrometheus uiçš„<a class="ae jp" href="http://127.0.0.1:31119" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:31119 </a>å’ŒGrafana uiçš„<a class="ae jp" href="http://127.0.0.1:31119" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 0 . 1:3</a>000(ç®¡ç†å‘˜/ç®¡ç†å‘˜)ã€‚</p><p id="cac1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸ºäº†è¿›è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥è½¬åˆ°openfaas uiå¹¶ç‚¹å‡»deploy new functionã€‚åœ¨åˆ—è¡¨ä¸­é€‰æ‹©â€œfigletâ€ã€‚åœ¨å°†å®ƒæ·»åŠ åˆ°å·¦çª—æ ¼ä¹‹åï¼Œå°†ä»»ä½•æ–‡æœ¬æ·»åŠ åˆ°è¯·æ±‚æ­£æ–‡ç©ºé—´å¹¶ç‚¹å‡»invokeæŒ‰é’®ã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lr"><img src="../Images/c9b9d4ce1024d495d99e589e48123310.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bv5-jiq2qZZGLxJIQIfUsg.png"/></div></div></figure><p id="1657" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¾ˆé…·å§ï¼</p><h2 id="17f9" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated">éƒ¨ç½²Go-å¾®æœåŠ¡</h2><p id="70f6" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»å®Œæˆäº†å®‰è£…ï¼Œè®©æˆ‘ä»¬åœ¨OpenFaasä¸­éƒ¨ç½²ä¸€ä¸ªç®€å•çš„go-microserviceã€‚</p><p id="f41f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">OpenFaasæœ‰å‡ ä¸ªæ¨¡æ¿å¯ä»¥ç”¨äºæˆ‘ä»¬çš„ä»»åŠ¡ã€‚ä»–ä»¬åœ¨è‡ªå·±çš„æ¨¡æ¿åº“ä¸­ç»´æŠ¤æ¨¡æ¿ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="a3a8" class="jq jr hi le b fi lm ln l lo lp">faas-cli template pull</span></pre><p id="b2aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤æ£€æŸ¥å¯ç”¨çš„æ¨¡æ¿ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="32c4" class="jq jr hi le b fi lm ln l lo lp">faas-cli template store pull</span></pre><p id="1631" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æ‹‰ä»»ä½•æ¨¡æ¿ï¼Œæˆ‘ä»¬éœ€è¦å¦‚ä¸‹ã€‚è¿™å°†æå–golang-httpçš„æ¨¡æ¿ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ¨¡æ¿ï¼Œå¹¶æ ¹æ®éœ€è¦è¿›è¡Œç›¸åº”çš„æ›´æ”¹ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="5f2c" class="jq jr hi le b fi lm ln l lo lp">faas-cli template store pull golang-http</span></pre><p id="cb3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè‡ªå·±çš„å‡½æ•°ï¼Œå¦‚ä¸‹ä¸€èŠ‚æ‰€è¿°ã€‚</p><p id="3be8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">é¦–å…ˆæˆ‘ä»¬å¿…é¡»ç”¨Dockerfileåˆ›å»ºæˆ‘ä»¬çš„å‡½æ•°yamlæ–‡ä»¶ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="92a7" class="jq jr hi le b fi lm ln l lo lp">faas-cli new --lang dockerfile go-microservice</span></pre><p id="0d4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½ ä¼šå¾—åˆ°ä¸€ä¸ªgo-microservice.yamlæ–‡ä»¶ï¼Œå’Œgo-microserviceç›®å½•ã€‚åœ¨yamlæ–‡ä»¶ä¸­ï¼Œæ‚¨å¯ä»¥éšæ„æ›´æ”¹å†…å®¹ã€‚æˆ‘çš„ymlæ–‡ä»¶å¦‚ä¸‹ã€‚æˆ‘å·²ç»ç›¸åº”åœ°æ·»åŠ äº†æˆ‘çš„ç½‘å…³å’Œå›¾åƒURLã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="37d3" class="jq jr hi le b fi lm ln l lo lp">version: 1.0<br/>provider:<br/>  name: openfaas<br/>  gateway: <a class="ae jp" href="http://127.0.0.1:31112" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:31112</a><br/>functions:<br/>  go-microservice:<br/>    lang: dockerfile<br/>    handler: ./go-microservice<br/>    image: localhost:5000/go-microservice:1.0</span></pre><p id="a359" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å¯ä»¥ä¸ºç”Ÿæˆçš„dockeræ–‡ä»¶æ·»åŠ ä»»ä½•å†…å®¹ï¼Œä»¥ä¾¿åœ¨æˆ‘ä»¬çš„å‡½æ•°ä¸­ä½¿ç”¨ã€‚æˆ‘ä½¿ç”¨äº†ä¸‹é¢çš„å†…å®¹ï¼Œè¿™äº›å†…å®¹æ‘˜è‡ª<a class="ae jp" href="https://www.openfaas.com/blog/golang-serverless/" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œçš„</a>ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="26f4" class="jq jr hi le b fi lm ln l lo lp">FROM<em class="ls"> golang:1.10.4-alpine3.8 as build</em><br/><br/>RUN mkdir -p /go/src/handler<br/>WORKDIR<em class="ls"> /go/src/handler</em><br/>COPY<em class="ls"> . .</em><br/><br/>RUN CGO_ENABLED=0 GOOS=linux \<br/>    go build --ldflags <em class="ls">"-s -w"</em> -a -installsuffix cgo -o handler . &amp;&amp; \<br/>    go test <em class="ls">$(</em>go list ./... | grep -v /vendor/<em class="ls">)</em> -cover<br/><br/>FROM<em class="ls"> alpine:3.9</em><br/><em class="ls"># Add non root user and certs</em><br/>RUN apk --no-cache add ca-certificates \<br/>    &amp;&amp; addgroup -S app &amp;&amp; adduser -S -g app app \<br/>    &amp;&amp; mkdir -p /home/app \<br/>    &amp;&amp; chown app /home/app<br/><br/>WORKDIR<em class="ls"> /home/app</em><br/><br/>COPY<em class="ls"> --from=build /go/src/handler/handler    .</em><br/><br/>RUN chown -R app /home/app<br/><br/>RUN touch /tmp/.lock <em class="ls">#  Write a health check for OpenFaaS here or in the HTTP server start-up</em><br/><br/>USER<em class="ls"> app</em><br/><br/>CMD<em class="ls"> ["/home/app/handler"]</em></span></pre><p id="3cc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç„¶åæˆ‘ä»¬å¿…é¡»ä¸ºæ­¤æ·»åŠ ä¸­é—´ä»¶ã€‚åœ¨go-microserviceç›®å½•ä¸­ï¼Œæ·»åŠ main.goç±»ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="56b0" class="jq jr hi le b fi lm ln l lo lp">package main<br/><br/>import (<br/>	<em class="ls">"fmt"</em><br/>	<em class="ls">"log"</em><br/>	<em class="ls">"net/http"</em><br/>	<em class="ls">"time"</em><br/>)<br/><br/>func addServedHeader(w http.ResponseWriter, r *http.Request) {<br/>	w.Header().Add(<em class="ls">"X-Served-Date"</em>, time.Now().String())<br/>}<br/><br/>func makeRequestHandler(middleware http.HandlerFunc) func(http.ResponseWriter, *http.Request) {<br/>	return func(w http.ResponseWriter, r *http.Request) {<br/>		middleware(w, r)<br/><br/>		w.Write([]byte(<em class="ls">"OK"</em>))<br/>	}<br/>}<br/><br/>func main() {<br/>	s := &amp;http.Server{<br/>		Addr:           fmt.Sprintf(<em class="ls">":%d"</em>, 8080),<br/>		ReadTimeout:    3 * time.Second,<br/>		WriteTimeout:   3 * time.Second,<br/>		MaxHeaderBytes: 1 &lt;&lt; 20, <em class="ls">// Max header of 1MB</em><br/>	}<br/><br/>	next := addServedHeader<br/>	http.HandleFunc(<em class="ls">"/"</em>, makeRequestHandler(next))<br/>	log.Fatal(s.ListenAndServe())<br/>}</span></pre><p id="1c66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥è¿è¡Œå®ƒã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="a92e" class="jq jr hi le b fi lm ln l lo lp">faas-cli up -f go-microservice.yml</span></pre><p id="9dc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">â€”ä½ çš„å›ç­”ä¼šæ˜¯è¿™æ ·çš„ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="7284" class="jq jr hi le b fi lm ln l lo lp">$  faas-cli up -f go-microservice.yml<br/>[0] &gt; Building go-microservice.<br/>Clearing temporary build folder: ./build/go-microservice/<br/>Preparing: ./go-microservice/ ./build/go-microservice/<br/>Building: localhost:5000/go-microservice:1.0 with dockerfile template. Please wait..<br/>Sending build context to Docker daemon   7.68kB<br/>Step 1/13 : FROM golang:1.10.4-alpine3.8 as build<br/> ---&gt; bd36346540f3<br/>Step 2/13 : RUN mkdir -p /go/src/handler<br/> ---&gt; Using cache<br/> ---&gt; 41771b742138<br/>Step 3/13 : WORKDIR /go/src/handler<br/> ---&gt; Using cache<br/> ---&gt; ac151ca23319<br/>Step 4/13 : COPY . .<br/> ---&gt; Using cache<br/> ---&gt; 0a3341d2af2e<br/>Step 5/13 : RUN CGO_ENABLED=0 GOOS=linux     go build --ldflags "-s -w" -a -installsuffix cgo -o handler . &amp;&amp;     go test $(go list ./... | grep -v /vendor/) -cover<br/> ---&gt; Using cache<br/> ---&gt; 92991031eb2b<br/>Step 6/13 : FROM alpine:3.9<br/> ---&gt; 78a2ce922f86<br/>Step 7/13 : RUN apk --no-cache add ca-certificates     &amp;&amp; addgroup -S app &amp;&amp; adduser -S -g app app     &amp;&amp; mkdir -p /home/app     &amp;&amp; chown app /home/app<br/> ---&gt; Using cache<br/> ---&gt; 0859da0160a9<br/>Step 8/13 : WORKDIR /home/app<br/> ---&gt; Using cache<br/> ---&gt; 5f1498c7bbb0<br/>Step 9/13 : COPY --from=build /go/src/handler/handler    .<br/> ---&gt; Using cache<br/> ---&gt; 232b70435105<br/>Step 10/13 : RUN chown -R app /home/app<br/> ---&gt; Using cache<br/> ---&gt; d45c326c6576<br/>Step 11/13 : RUN touch /tmp/.lock #  Write a health check for OpenFaaS here or in the HTTP server start-up<br/> ---&gt; Using cache<br/> ---&gt; 1f8118c3b271<br/>Step 12/13 : USER app<br/> ---&gt; Using cache<br/> ---&gt; 616b2b430d95<br/>Step 13/13 : CMD ["/home/app/handler"]<br/> ---&gt; Using cache<br/> ---&gt; 4f002caa7740<br/>Successfully built 4f002caa7740<br/>Successfully tagged localhost:5000/go-microservice:1.0<br/>Image: localhost:5000/go-microservice:1.0 built.<br/>[0] &lt; Building go-microservice done in 0.30s.<br/>[0] Worker done.</span><span id="9018" class="jq jr hi le b fi lq ln l lo lp">Total build time: 0.30s</span><span id="c0d4" class="jq jr hi le b fi lq ln l lo lp">[0] &gt; Pushing go-microservice [localhost:5000/go-microservice:1.0].<br/>The push refers to repository [localhost:5000/go-microservice]<br/>84b6a101f13e: Layer already exists <br/>24bb6e3aa142: Layer already exists <br/>8f7644cfa0e9: Layer already exists <br/>f67c1d81b066: Layer already exists <br/>89ae5c4ee501: Layer already exists <br/>1.0: digest: sha256:47c504fea63aecbd70b6f29f41d18f9b6ac3e36b0bf74b6a3e9e86072cdf6628 size: 1367<br/>[0] &lt; Pushing go-microservice [localhost:5000/go-microservice:1.0] done.<br/>[0] Worker done.</span><span id="b514" class="jq jr hi le b fi lq ln l lo lp">Deploying: go-microservice.</span><span id="fc94" class="jq jr hi le b fi lq ln l lo lp">Deployed. 202 Accepted.<br/>URL: <a class="ae jp" href="http://127.0.0.1:31112/function/go-microservice" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:31112/function/go-microservice</a></span></pre><p id="11d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å¯ä»¥é€šè¿‡å°è¯•ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥è¯¥åŠŸèƒ½æ˜¯å¦éƒ¨ç½²æ­£ç¡®ã€‚å®ƒå°†æ˜¾ç¤ºæˆ‘ä»¬éƒ¨ç½²çš„çŠ¶æ€ã€‚(çŠ¶æ€åº”ä¸ºæ­£åœ¨è¿è¡Œ)ã€‚æˆ–è€…æˆ‘ä»¬å¯ä»¥ä»ç”¨æˆ·ç•Œé¢æ£€æŸ¥çŠ¶æ€ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="de06" class="jq jr hi le b fi lm ln l lo lp">$ kubectl get pods -n openfaas-fn <br/>NAME                              READY   STATUS    RESTARTS      AGE<br/>go-microservice-8466b7fdb-l9lwb   1/1     Running   0             12m</span></pre><p id="5987" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç„¶åæˆ‘ä»¬å¯ä»¥å¼¯æ›²æˆ‘ä»¬çš„ç«¯ç‚¹å¹¶å¾—åˆ°å“åº”ã€‚</p><pre class="je jf jg jh fd li le lj lk aw ll bi"><span id="0574" class="jq jr hi le b fi lm ln l lo lp">curl -i <a class="ae jp" href="http://127.0.0.1:31112/function/go-microservice" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:31112/function/go-microservice</a> ;echo<br/>HTTP/1.1 200 OK<br/>Content-Length: 2<br/>Content-Type: text/plain; charset=utf-8<br/>Date: Mon, 09 May 2022 20:06:38 GMT<br/>X-Call-Id: e9b5af76-2a95-4107-8d7c-e51c752d3005<br/>X-Served-Date: 2022-05-09 20:06:38.482143283 +0000 UTC m=+465.848986153<br/>X-Start-Time: 1652126798479241355</span><span id="fc8c" class="jq jr hi le b fi lq ln l lo lp">OK</span></pre><p id="fdbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¿™ä¸ªè°ƒç”¨å¯ä»¥åƒå‰é¢çš„ä¾‹å­ä¸€æ ·ä½¿ç”¨uiæ¥å®Œæˆã€‚</p><p id="87a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å¯ä»¥åœ¨OpenFaas UIä¸­æ£€æŸ¥æˆ‘ä»¬çš„éƒ¨ç½²ï¼Œä¹Ÿå¯ä»¥åœ¨æˆ‘ä»¬ä¹‹å‰å…¬å¼€çš„Prometheus UIä¸­æ£€æŸ¥æŒ‡æ ‡ã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/da417cecf319e62ad995ed20d3ffefb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8flUQbML8y8xp5C_vK9QTg.png"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx">Prometheus Graph</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/7884d104b23f1bb4a1fa96f3a9c441ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pLHyiL-hL8QjHxQ9n_Xv8g.png"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx">Grafana Graph</figcaption></figure><p id="e9d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»è®¾ç½®äº†openfaasç¯å¢ƒï¼Œå¹¶éƒ¨ç½²äº†ç®€å•çš„go-langå¾®æœåŠ¡ã€‚</p><p id="546d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„å¸–å­ä¸­ä»‹ç»ä¸€äº›å…¶ä»–ä¸OpenFaasç›¸å…³çš„å­¦ä¹ å†…å®¹ã€‚ğŸ˜</p></div></div>    
</body>
</html>