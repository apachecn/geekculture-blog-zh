<html>
<head>
<title>Evaluating Metrics for Multi-class Classification and Implementations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">è¯„ä¼°å¤šç±»åˆ†ç±»å’Œå®ç°çš„åº¦é‡</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/evaluating-metrics-for-multi-class-classification-and-implementations-be389cb17e65?source=collection_archive---------5-----------------------#2022-02-20">https://medium.com/geekculture/evaluating-metrics-for-multi-class-classification-and-implementations-be389cb17e65?source=collection_archive---------5-----------------------#2022-02-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c994c0a676a07b34d6689741a018196d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gCxPWQCSIp90cGyH.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Image from Google</figcaption></figure><p id="4680" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿™ç¯‡åšå®¢æ˜¯è¿™ç¯‡æ–‡ç« çš„å»¶ç»­ã€‚</p><p id="d27c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å·²ç»äº†è§£äº†äºŒè¿›åˆ¶åˆ†ç±»æŒ‡æ ‡ã€‚ä»ç°åœ¨å¼€å§‹ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¤šç±»åˆ†ç±»çš„åº¦é‡ï¼Œåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¤šæ ‡ç­¾åˆ†ç±»åŠå…¶åº¦é‡ã€‚</p><p id="03ec" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¤šç±»åˆ†ç±»æ— éæ˜¯è§£å†³ä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼Œå…¶ä¸­æˆ‘ä»¬åœ¨ç›®æ ‡åˆ—ä¸­æœ‰å¤šä¸ªç±»(ç±»çš„æ•°é‡&gt; 2)ã€‚ä¾‹å¦‚ï¼Œå°†æ°´æœå›¾åƒåˆ†ç±»ä¸ºè‹¹æœã€æ¡”å­å’Œé¦™è•‰ã€‚</p><p id="1576" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘åœ¨è¿™é‡Œé™„ä¸Šä¸€ä¸ªç¤ºä¾‹æ•°æ®é›†<a class="ae js" href="https://github.com/VishnuVardhanVarapalli/Classification-Metrics/blob/main/Development%20Index.csv" rel="noopener ugc nofollow" target="_blank"/>ã€‚åœ¨è¯¥æ•°æ®é›†ä¸­ï¼Œå‘å±•æŒ‡æ•°åˆ—æ˜¯å…·æœ‰å¤šä¸ªç±»çš„ç›®æ ‡(ç±»çš„æ•°é‡&gt; 2)ã€‚</p><p id="c90d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ­£å¦‚æˆ‘ä»¬åœ¨äºŒè¿›åˆ¶åˆ†ç±»åº¦é‡å­¦è¿‡çš„é‚£æ ·ï¼Œæœ‰äº†å®ƒä»¬ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ¶å®šå¤šåˆ†ç±»åº¦é‡ã€‚</p><p id="2dc0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åœ¨å¤šåˆ†ç±»æŒ‡æ ‡ä¸­ï¼Œæ¯ä¸ªäºŒå…ƒåˆ†ç±»æŒ‡æ ‡æœ‰3ç§å®ç°æ–¹å¼ã€‚æˆ‘å†™çš„æ—¶å€™ä½ å¯èƒ½ä¼šæ˜ç™½â€¦</p><p id="d0fe" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¯¹äºç²¾ç¡®äºŒè¿›åˆ¶åˆ†ç±»åº¦é‡ï¼Œåœ¨å¤šåˆ†ç±»åº¦é‡ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªç‰ˆæœ¬ï¼Œ</p><ol class=""><li id="9034" class="jt ju hi iw b ix iy jb jc jf jv jj jw jn jx jr jy jz ka kb bi translated">å¾®å¹³å‡ç²¾åº¦</li><li id="d722" class="jt ju hi iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">å®è§‚å¹³å‡ç²¾åº¦</li><li id="34d0" class="jt ju hi iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">åŠ æƒç²¾åº¦</li></ol><p id="acc8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä½œä¸ºç²¾åº¦ï¼Œæˆ‘ä»¬åœ¨å¤šç±»åˆ†ç±»ä¸­æœ‰3ä¸ªç‰ˆæœ¬çš„å¬å›äºŒè¿›åˆ¶åˆ†ç±»åº¦é‡ã€‚</p><ol class=""><li id="bb53" class="jt ju hi iw b ix iy jb jc jf jv jj jw jn jx jr jy jz ka kb bi translated">å¾®è§‚å¹³å‡å›å¿†</li><li id="b0ba" class="jt ju hi iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">å®è§‚å¹³å‡å›å¿†</li><li id="d71f" class="jt ju hi iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">åŠ æƒå›å¿†</li></ol><p id="bf37" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¯ä¸ªäºŒè¿›åˆ¶åˆ†ç±»åº¦é‡åˆ†ä¸º3ä¸ªç‰ˆæœ¬ï¼Œå¹¶å°†å…¶å‘½åä¸ºå¤šåˆ†ç±»åº¦é‡ã€‚</p><p id="7c84" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨ï¼Œæˆ‘å°†è®¨è®ºç²¾åº¦ï¼Œå¹¶æ·»åŠ å¬å›ä»£ç ï¼Œæ‰€æœ‰å‰©ä½™çš„æŒ‡æ ‡å°†ä»¥ç›¸åŒçš„æ–¹å¼æ„å»º(ä¸‹é¢çš„ç²¾åº¦éµå¾ªç›¸åŒçš„è¿‡ç¨‹)ã€‚åœ¨æœªæ¥çš„å¸–å­ä¸­ï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•åœ¨å¤šç±»åˆ†ç±»ä¸­å½¢æˆROC-AUCã€‚</p><p id="cb04" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ³¨æ„:-ä¸è¦è·³è¿›ä»»ä½•ä¸œè¥¿ï¼Œé™¤éä½ çŸ¥é“åŸºæœ¬çŸ¥è¯†ã€‚å› ä¸ºå®ƒå¯èƒ½ä¼šåå™¬ä½ çš„ä¿¡å¿ƒå’Œä¿¡å¿µã€‚</p><p id="92c6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹precisionçš„3ä¸ªç‰ˆæœ¬ã€‚</p><ol class=""><li id="fc50" class="jt ju hi iw b ix iy jb jc jf jv jj jw jn jx jr jy jz ka kb bi translated"><strong class="iw hj">å¾®å¹³å‡ç²¾åº¦:- </strong>åœ¨è¿™é‡Œï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬å°†æ‰¾åˆ°æ‰€æœ‰ç±»çš„æ‰€æœ‰çœŸé˜³æ€§ï¼Œå¹¶å°†å®ƒä»¬ç›¸åŠ ï¼Œä»¥è·å¾—æ‰€æœ‰ç±»çš„æ€»çœŸé˜³æ€§ã€‚ä¹‹åï¼Œæˆ‘ä»¬å°†æ‰¾åˆ°æ‰€æœ‰ç±»çš„æ‰€æœ‰è¯¯æŠ¥ï¼Œå¹¶å°†å®ƒä»¬ç›¸åŠ ï¼Œå¾—åˆ°æ‰€æœ‰ç±»çš„æ€»è¯¯æŠ¥ã€‚ç°åœ¨ï¼Œè®¡ç®—çœŸé˜³æ€§å’Œå‡é˜³æ€§æ€»æ•°çš„ç²¾åº¦ã€‚</li></ol><p id="2cec" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">2.<strong class="iw hj">å®å¹³å‡ç²¾åº¦</strong> :-è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ‰¾åˆ°ç›®æ ‡åˆ—ä¸­ä¸åŒç±»çš„ç²¾åº¦ï¼Œç„¶åå¯¹å®ƒä»¬è¿›è¡Œå¹³å‡ä»¥è·å¾—æœ€ç»ˆç²¾åº¦ã€‚</p><p id="ce94" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">3.<strong class="iw hj">åŠ æƒç²¾åº¦</strong> :-è¿™é‡Œï¼ŒåŠ æƒç²¾åº¦ä¸å®å¹³å‡ç²¾åº¦ç›¸åŒï¼Œä½†åŒºåˆ«å°±åœ¨è¿™é‡Œï¼Œå®ƒå–å†³äºæ¯ç±»ä¸­å­˜åœ¨çš„æ ·æœ¬æ•°å¹¶æ ¹æ®æ ·æœ¬æ•°è¿›è¡ŒåŠ æƒã€‚</p><p id="c512" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘çŸ¥é“ï¼Œæˆ‘å·²ç»ä¸ºæ¯ä¸€ä¸ªç»™å‡ºäº†å°çš„å®šä¹‰ï¼Œä½†è¿™å°±æ˜¯å®šä¹‰ï¼Œä»£ç è§£é‡Šäº†ä¸€åˆ‡ã€‚æ‰€ä»¥ï¼Œæ£€æŸ¥å®šä¹‰ï¼Œçœ‹çœ‹å®šä¹‰æ‰€éœ€çš„ä»£ç ï¼Œäº†è§£ä»£ç ä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä½ å°±ä¼šæ˜ç™½äº‹æƒ…ã€‚</p><p id="76da" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¯·è®°ä½ï¼Œå½“æ•°æ®å¹³è¡¡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®è§‚ç‰ˆæœ¬ï¼Œä½†å½“æ•°æ®ä¸å¹³è¡¡æ—¶ï¼Œå¾®è§‚å’ŒåŠ æƒç‰ˆæœ¬æ›´å¯å–ã€‚</p><p id="fbd7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¯·æ³¨æ„ï¼Œä¸‹é¢çš„ä»£ç ç”±precisionçš„æ‰€æœ‰3ä¸ªç‰ˆæœ¬ç»„æˆã€‚</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="9593" class="kq kr hi km b fi ks kt l ku kv">import pandas<br/>import argparse<br/>import numpy<br/>from collections import Counter</span><span id="073c" class="kq kr hi km b fi kw kt l ku kv">from sklearn.linear_model import LogisticRegression<br/>from sklearn.model_selection import train_test_split<br/>from sklearn import metrics</span><span id="5eb5" class="kq kr hi km b fi kw kt l ku kv">#there are 3 Types of precision in case of Multi-class classification. <br/>#1. Macro averaged precision<br/>#2. Micro averaged precision<br/>#3. Weighted precision</span><span id="6a94" class="kq kr hi km b fi kw kt l ku kv">def true_positive(y_true, y_pred):<br/>    tp = 0<br/>    for yt, yp in zip(y_true, y_pred):<br/>        if yt == 1 and yp == 1:<br/>            tp += 1<br/>    return tp<br/>    <br/>def true_negative(y_true, y_pred):<br/>    tn = 0<br/>    for yt, yp in zip(y_true, y_pred):<br/>        if yt == 0 and yp == 0:<br/>            tn += 1<br/>    return tn<br/>    <br/>def false_positive(y_true, y_pred):<br/>    fp = 0<br/>    for yt, yp in zip(y_true, y_pred):<br/>        if yt == 0 and yp == 1:<br/>            fp += 1<br/>    return fp<br/>    <br/>def false_negative(y_true, y_pred):<br/>    fn = 0<br/>    for yt, yp in zip(y_true, y_pred):<br/>        if yt == 1 and yp == 0:<br/>            fn += 1<br/>    return fn</span><span id="6b4d" class="kq kr hi km b fi kw kt l ku kv">def precision(y_test, y_pred):<br/>    tp =true_positive(y_test, y_pred)<br/>    fp = false_positive(y_test, y_pred)<br/>    try:<br/>        return(tp/(tp+fp))<br/>    except ZeroDivisionError:<br/>        return 0</span><span id="c1d5" class="kq kr hi km b fi kw kt l ku kv">def Macro_averaged_precision(y_test, predictions):<br/>    precisions = []<br/>    for i in range(1,5):<br/>        temp_ytest = [1 if x == i else 0 for x in y_test]<br/>        temp_ypred = [1 if x == i else 0 for x in predictions]<br/>        print(temp_ypred)<br/>        print(temp_ytest)<br/>        prec = precision(temp_ytest, temp_ypred)<br/>        precisions.append(prec)<br/>    <br/>    return (sum(precisions)/len(precisions))<br/>         <br/>def Micro_averaged_precision(y_test, predictions):<br/>    tp = 0<br/>    fp = 0<br/>    for i in range(1,5):<br/>        temp_ytest = [1 if x == i else 0 for x in y_test]<br/>        temp_ypred = [1 if x == i else 0 for x in predictions]</span><span id="d852" class="kq kr hi km b fi kw kt l ku kv">        tp += true_positive(temp_ytest, temp_ypred)<br/>        fp += false_positive(temp_ytest, temp_ypred)</span><span id="67b0" class="kq kr hi km b fi kw kt l ku kv">    precisions = tp / (tp + fp)</span><span id="f36a" class="kq kr hi km b fi kw kt l ku kv">    return precisions</span><span id="1667" class="kq kr hi km b fi kw kt l ku kv">def weighted_precision(y_test, predictions):<br/>    num_classes = len(numpy.unique(y_test))<br/>    #coutns for every class<br/>    precision = 0<br/>    for i in range(1, num_classes):<br/>        temp_ytest = [1 if x == i else 0 for x in y_test]<br/>        temp_ypred = [1 if x == i else 0 for x in predictions]</span><span id="0ff5" class="kq kr hi km b fi kw kt l ku kv">        tp = true_positive(temp_ytest, temp_ypred)<br/>        fp = false_positive(temp_ytest, temp_ypred)<br/>        <br/>        try:<br/>            preai = tp / (tp+fp)<br/>        except ZeroDivisionError:<br/>            preai = 0</span><span id="5d3e" class="kq kr hi km b fi kw kt l ku kv">        weighted = preai*sum(temp_ytest)</span><span id="7fe7" class="kq kr hi km b fi kw kt l ku kv">        precision += weighted</span><span id="882a" class="kq kr hi km b fi kw kt l ku kv">    precision = precision/len(y_test)<br/>    return precision</span><span id="643e" class="kq kr hi km b fi kw kt l ku kv">if __name__ == "__main__":<br/>    <br/>    data = pandas.read_csv("C:\\Users\\iamvi\\OneDrive\\Desktop\\Metrics_in_Machine_Learning\\development-index\\Development Index.csv")<br/>    <br/>    train = data.drop(['Development Index'], axis = 1).values<br/>    test = data["Development Index"].values</span><span id="a5c4" class="kq kr hi km b fi kw kt l ku kv">model = LogisticRegression()</span><span id="b28c" class="kq kr hi km b fi kw kt l ku kv">X_train, X_test, y_train, y_test = train_test_split(train, test, stratify = test)</span><span id="c0d0" class="kq kr hi km b fi kw kt l ku kv">model.fit(X_train, y_train)<br/>    predictions = model.predict(X_test)</span><span id="51f7" class="kq kr hi km b fi kw kt l ku kv">print("Macro precision is:", Macro_averaged_precision(y_test, predictions))<br/>    print("Micro precision is:", Micro_averaged_precision(y_test, predictions))<br/>    print("Weighted precision is:", weighted_precision(y_test, predictions))<br/>    print("sklearn Macro", metrics.precision_score(y_test, predictions, average = "macro"))<br/>    print("sklearn Micro", metrics.precision_score(y_test, predictions, average = "micro"))<br/>    print("sklearn weighted", metrics.precision_score(y_test, predictions, average = "weighted"))</span></pre><p id="8faa" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä½ å¯èƒ½ä¼šå‘ç°ç”±äºä»‹è´¨æ¥å£å¯¼è‡´çš„ä¸ä¸€è‡´çš„ç¼©è¿›ï¼Œå¾ˆéš¾çœ‹åˆ°ä»£ç ï¼Œç‚¹å‡»<a class="ae js" href="https://github.com/VishnuVardhanVarapalli/Classification-Metrics/blob/main/Multi_class_classification_precision.py" rel="noopener ugc nofollow" target="_blank">æ­¤å¤„</a>æŸ¥çœ‹Githubä¸­çš„ä»£ç ã€‚</p><p id="0847" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿™å°±æ˜¯æ‰€æœ‰å¤šç±»åˆ†ç±»åº¦é‡æ˜¯å¦‚ä½•ä»äºŒè¿›åˆ¶åˆ†ç±»åº¦é‡äº§ç”Ÿçš„ã€‚</p><p id="e9e3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ­£å¦‚æˆ‘æ‰€è¯´çš„ï¼Œæˆ‘ä¼šç»™ä½ çš„ä»£ç å¬å›ç±»ä¼¼ç²¾åº¦ï¼Œä»¥åŠæ‰€æœ‰å…¶ä½™çš„æŒ‡æ ‡ã€‚</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="b569" class="kq kr hi km b fi ks kt l ku kv">import pandas<br/>import argparse<br/>import numpy<br/>from collections import Counter</span><span id="ced1" class="kq kr hi km b fi kw kt l ku kv">from sklearn.linear_model import LogisticRegression<br/>from sklearn.model_selection import train_test_split<br/>from sklearn import metrics</span><span id="375d" class="kq kr hi km b fi kw kt l ku kv">#there are 3 Types of recall in case of Multi-class classification. <br/>#1. Macro averaged recall<br/>#2. Micro averaged recall<br/>#3. Weighted recall</span><span id="5ec1" class="kq kr hi km b fi kw kt l ku kv">def true_positive(y_true, y_pred):<br/>    tp = 0<br/>    for yt, yp in zip(y_true, y_pred):<br/>        if yt == 1 and yp == 1:<br/>            tp += 1<br/>    return tp<br/>    <br/>def true_negative(y_true, y_pred):<br/>    tn = 0<br/>    for yt, yp in zip(y_true, y_pred):<br/>        if yt == 0 and yp == 0:<br/>            tn += 1<br/>    return tn<br/>    <br/>def false_positive(y_true, y_pred):<br/>    fp = 0<br/>    for yt, yp in zip(y_true, y_pred):<br/>        if yt == 0 and yp == 1:<br/>            fp += 1<br/>    return fp<br/>    <br/>def false_negative(y_true, y_pred):<br/>    fn = 0<br/>    for yt, yp in zip(y_true, y_pred):<br/>        if yt == 1 and yp == 0:<br/>            fn += 1<br/>    return fn</span><span id="efed" class="kq kr hi km b fi kw kt l ku kv">def recall(y_test, y_pred):<br/>    tp = true_positive(y_test, y_pred)<br/>    fn = false_negative(y_test, y_pred)<br/>    return(tp/(tp+fn))</span><span id="b353" class="kq kr hi km b fi kw kt l ku kv">def Macro_averaged_recall(y_test, predictions):<br/>    recalls = []<br/>    for i in range(1,5):<br/>        temp_ytest = [1 if x == i else 0 for x in y_test]<br/>        temp_ypred = [1 if x == i else 0 for x in predictions]<br/>        print(temp_ypred)<br/>        print(temp_ytest)<br/>        rec = recall(temp_ytest, temp_ypred)<br/>        recalls.append(rec)<br/>    <br/>    return (sum(recalls)/len(recalls))<br/>         <br/>def Micro_averaged_recall(y_test, predictions):<br/>    tp = 0<br/>    tn = 0<br/>    for i in range(1,5):<br/>        temp_ytest = [1 if x == i else 0 for x in y_test]<br/>        temp_ypred = [1 if x == i else 0 for x in predictions]</span><span id="0702" class="kq kr hi km b fi kw kt l ku kv">        tp += true_positive(temp_ytest, temp_ypred)<br/>        tn += true_negative(temp_ytest, temp_ypred)</span><span id="0b53" class="kq kr hi km b fi kw kt l ku kv">    recall = tp / (tp + tn)</span><span id="8258" class="kq kr hi km b fi kw kt l ku kv">    return recall</span><span id="f3a7" class="kq kr hi km b fi kw kt l ku kv">def weighted_recall(y_test, predictions):<br/>    num_classes = len(numpy.unique(y_test))<br/>    #counts for every class<br/>    recall = 0<br/>    for i in range(1, num_classes):<br/>        temp_ytest = [1 if x == i else 0 for x in y_test]<br/>        temp_ypred = [1 if x == i else 0 for x in predictions]</span><span id="dc19" class="kq kr hi km b fi kw kt l ku kv">tp = true_positive(temp_ytest, temp_ypred)<br/>        tn = true_negative(temp_ytest, temp_ypred)<br/>        <br/>        try:<br/>            rec = tp / (tp+tn)<br/>        except ZeroDivisionError:<br/>            rec = 0</span><span id="4820" class="kq kr hi km b fi kw kt l ku kv">weighted = rec*sum(temp_ytest)</span><span id="5513" class="kq kr hi km b fi kw kt l ku kv">recall += weighted</span><span id="35c1" class="kq kr hi km b fi kw kt l ku kv">recall = recall/len(y_test)<br/>    return recall</span><span id="614a" class="kq kr hi km b fi kw kt l ku kv">if __name__ == "__main__":<br/>    <br/>    data = pandas.read_csv("C:\\Users\\iamvi\\OneDrive\\Desktop\\Metrics_in_Machine_Learning\\development-index\\Development Index.csv")<br/>    <br/>    train = data.drop(['Development Index'], axis = 1).values<br/>    test = data["Development Index"].values</span><span id="ce93" class="kq kr hi km b fi kw kt l ku kv">model = LogisticRegression()</span><span id="82ef" class="kq kr hi km b fi kw kt l ku kv">X_train, X_test, y_train, y_test = train_test_split(train, test, stratify = test)</span><span id="8230" class="kq kr hi km b fi kw kt l ku kv">model.fit(X_train, y_train)<br/>    predictions = model.predict(X_test)</span><span id="63ee" class="kq kr hi km b fi kw kt l ku kv">print("Macro recall is:", Macro_averaged_recall(y_test, predictions))<br/>    print("Micro recall is:", Micro_averaged_recall(y_test, predictions))<br/>    print("Weighted recall is:", weighted_recall(y_test, predictions))<br/>    print("sklearn Macro", metrics.recall_score(y_test, predictions, average = "macro"))<br/>    print("sklearn Micro", metrics.recall_score(y_test, predictions, average = "micro"))<br/>    print("sklearn weighted", metrics.recall_score(y_test, predictions, average = "weighted"))</span></pre><p id="4fe2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">precisionçš„3ä¸ªç‰ˆæœ¬çš„å®šä¹‰ä¹Ÿå°†åº”ç”¨äºå¬å›ã€‚</p><p id="c464" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å½“ä½ åœ¨3ä¸ªç‰ˆæœ¬ä¸­å®ç°äº†æˆ‘ä¸Šé¢æ‰€è¯´çš„æ‰€æœ‰å¤šç±»åˆ†ç±»åº¦é‡æ ‡å‡†ä¹‹åï¼Œä½ å¯ä»¥è‡ªä¿¡åœ°è¯´â€œæˆ‘çŸ¥é“å¤šç±»åˆ†ç±»â€ã€‚ğŸ˜‰</p><p id="d99d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ£€æŸ¥<a class="ae js" href="https://github.com/VishnuVardhanVarapalli/Classification-Metrics" rel="noopener ugc nofollow" target="_blank">åˆ†ç±»-åº¦é‡åº“</a>ä»¥è·å¾—æˆ‘è§£é‡Šçš„æ‰€æœ‰æ¦‚å¿µçš„ä»£ç ã€‚å½“æˆ‘åœ¨è¿™é‡Œå†™æ–‡ç« æ—¶ï¼ŒGitHubå°†ä¼šæ›´æ–°ä»£ç ã€‚æ‰€ä»¥ï¼ŒæŠŠå‰å­æ”¾åœ¨ä¸Šé¢ã€‚</p><p id="dfa3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¦‚æœä½ æƒ³åœ¨è¿™é‡Œè¡¥å……ä»€ä¹ˆï¼Œæˆ–è€…æƒ³è®©æˆ‘è§£é‡Šè¿™é‡Œé—æ¼çš„æ¦‚å¿µï¼Œè®©æˆ‘ä»<a class="ae js" href="https://iamvishnuvarapally.wixsite.com/port-folio" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>çŸ¥é“ã€‚</p><p id="ad8c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¯ä»¥åœ¨ä¸åŒå¹³å°<a class="ae js" href="https://www.linkedin.com/in/vishnu-vardhan-varapalli-b6b454150/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>ã€<a class="ae js" href="https://github.com/VishnuVardhanVarapalli" rel="noopener ugc nofollow" target="_blank"> Github </a>ã€<a class="ae js" href="https://iamvishnu-varapally.medium.com/" rel="noopener"> medium </a>å…³æ³¨æˆ‘ã€‚</p><p id="6a2d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¿«ä¹çš„LearningâœŒ.</p></div></div>    
</body>
</html>