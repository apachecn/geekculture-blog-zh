<html>
<head>
<title>Spring Security Authentication Process : Authentication Flow Behind the Scenes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Springå®‰å…¨è®¤è¯è¿‡ç¨‹:å¹•åçš„è®¤è¯æµç¨‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/spring-security-authentication-process-authentication-flow-behind-the-scenes-d56da63f04fa?source=collection_archive---------1-----------------------#2021-06-17">https://medium.com/geekculture/spring-security-authentication-process-authentication-flow-behind-the-scenes-d56da63f04fa?source=collection_archive---------1-----------------------#2021-06-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/cae089d4ee101721c3ee023af1d9dee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_fNgMJRQTi29QAvT"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@lianhao?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Lianhao Qu</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="86a9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">åœ¨æ¯ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œèº«ä»½éªŒè¯æ˜¯ç¬¬ä¸€å±‚ä¿æŠ¤ã€‚å› æ­¤ï¼Œè®¤è¯æ˜¯åº”ç”¨ç¨‹åºå®‰å…¨æ€§çš„ä¸»è¦éƒ¨åˆ†ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨<strong class="ix hj"> Spring Security </strong>ç”¨äº<strong class="ix hj">è®¤è¯çš„æ¶æ„ã€‚</strong></p><blockquote class="jt ju jv"><p id="3147" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated"><strong class="ix hj">ä»€ä¹ˆæ˜¯è®¤è¯ï¼Ÿ</strong>è®¤è¯å°±æ˜¯è¯æ˜ä½ æ˜¯è°ã€‚ä¾‹å¦‚ï¼Œæ‚¨çš„èº«ä»½è¯ç”¨äºåœ¨æ‚¨çš„å­¦æ ¡/å­¦é™¢/åŠå…¬å›­åŒºâ€œéªŒè¯â€æ‚¨çš„èº«ä»½ã€‚</p></blockquote><p id="be6f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Securityä¸ºèº«ä»½éªŒè¯æä¾›äº†å‡ºè‰²çš„æ”¯æŒã€‚æœ‰ç‚¹åƒå³æ’å³ç”¨çš„é£æ ¼ã€‚ç®€å•çš„èº«ä»½éªŒè¯å·¥ä½œæµéå¸¸å®¹æ˜“è®¾ç½®ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æƒ³è¦ä¸€ä¸ªå®Œæ•´çš„å®šåˆ¶å®ç°ï¼Œé‚£ä¹ˆæ‚¨éœ€è¦ç†è§£èº«ä»½éªŒè¯æµç¨‹ï¼Œå¹¶ä¸”ç†è§£å½“æœåŠ¡å™¨æ”¶åˆ°èº«ä»½éªŒè¯è¯·æ±‚æ—¶ï¼Œåœ¨å¹•åå‘ç”Ÿäº†ä»€ä¹ˆã€‚</p></div><div class="ab cl ka kb gp kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hb hc hd he hf"><h1 id="37f3" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">å¹•å:ç†è®º</h1><h2 id="da2b" class="lf ki hi bd kj lg lh li kn lj lk ll kr jg lm ln kv jk lo lp kz jo lq lr ld ls bi translated">ç»„ä»¶:</h2><ol class=""><li id="cef8" class="lt lu hi ix b iy lv jc lw jg lx jk ly jo lz js ma mb mc md bi translated"><strong class="ix hj">è®¤è¯è¿‡æ»¤å™¨</strong>:å®ƒæ˜¯<strong class="ix hj">è¿‡æ»¤å™¨é“¾</strong>ä¸­çš„<strong class="ix hj">è¿‡æ»¤å™¨</strong>ï¼Œæ£€æµ‹è®¤è¯å°è¯•å¹¶å°†å…¶è½¬å‘ç»™<strong class="ix hj">è®¤è¯ç®¡ç†å™¨</strong>ã€‚</li></ol><p id="b2de" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2ã€‚è®¤è¯</strong>:è¯¥ç»„ä»¶æŒ‡å®šè¦è¿›è¡Œçš„è®¤è¯ç±»å‹ã€‚å®ƒæ˜¯ä¸€ä¸ªæ¥å£ã€‚å®ƒçš„å®ç°æŒ‡å®šäº†<code class="du me mf mg mh b">Authentication</code>çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œ<code class="du me mf mg mh b">UsernamePasswordAuthenticationToken</code>æ˜¯<code class="du me mf mg mh b">Authentication</code>æ¥å£çš„å®ç°ï¼Œå®ƒæŒ‡å®šç”¨æˆ·å¸Œæœ›ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œèº«ä»½éªŒè¯ã€‚å…¶ä»–ä¾‹å­è¿˜æœ‰<code class="du me mf mg mh b">OpenIDAuthenticationToken</code>ã€<code class="du me mf mg mh b">RememberMeAuthenticationToken</code>ã€‚</p><p id="ed5d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 3ã€‚è®¤è¯ç®¡ç†å™¨</strong>:è¯¥ç»„ä»¶çš„ä¸»è¦å·¥ä½œæ˜¯å°†authenticate()è°ƒç”¨å§”æ‰˜ç»™æ­£ç¡®çš„<code class="du me mf mg mh b">AuthenticationProvider</code>ã€‚ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥æœ‰å¤šä¸ª<code class="du me mf mg mh b">AuthenticationProvider </code>ï¼Œå…¶ä¸­å¾ˆå°‘æ˜¯<code class="du me mf mg mh b"><strong class="ix hj">DaoAuthenticationProvider</strong></code>ã€<code class="du me mf mg mh b"><strong class="ix hj">LdapAuthenticationProvider</strong></code>ã€<code class="du me mf mg mh b"><strong class="ix hj">OpenIDAuthenticationProvider</strong></code>ç­‰ã€‚).èº«ä»½éªŒè¯ç®¡ç†å™¨é€šè¿‡åœ¨æ¯ä¸ªå¯ç”¨çš„Authentication Providerä¸Šè°ƒç”¨supports()æ–¹æ³•æ¥å†³å®šå°†è°ƒç”¨å§”æ‰˜ç»™å“ªä¸ªèº«ä»½éªŒè¯æä¾›è€…ã€‚å¦‚æœsupports()æ–¹æ³•è¿”å›trueï¼Œé‚£ä¹ˆ<code class="du me mf mg mh b">AuthenticationProvider </code>æ”¯æŒ<code class="du me mf mg mh b"><strong class="ix hj">Authentication </strong></code>ç±»å‹å¹¶ç”¨äºæ‰§è¡Œè®¤è¯ã€‚</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/fe9327b3b59516041f4b7eb0f635bb53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2JAQPfbjCrqXEd6AJbD85w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><strong class="bd kj">AuthenticationManager</strong></figcaption></figure><p id="5258" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">åœ¨æ­¤å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ªèº«ä»½è®¤è¯æä¾›è€…ã€‚å…¶ä¸­ï¼Œ<strong class="ix hj">èº«ä»½éªŒè¯æä¾›è€…2 </strong>æ”¯æŒä¼ å…¥èº«ä»½éªŒè¯çš„ç±»å‹ï¼Œå› ä¸ºå®ƒçš„supports()æ–¹æ³•è¿”å›trueã€‚ç„¶åï¼Œå®ƒæ‰§è¡Œèº«ä»½éªŒè¯ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ç›¸åŒç±»å‹çš„èº«ä»½éªŒè¯å¯¹è±¡ï¼Œauthenticatedå±æ€§è®¾ç½®ä¸ºtrueï¼ŒåŒæ—¶è¿”å›ä¸€äº›å…¶ä»–ç›¸å…³å±æ€§ã€‚</p><p id="18b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 4ã€‚è®¤è¯æä¾›è€…</strong>:å®ƒæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå…¶å®ç°å¤„ç†æŸç§ç±»å‹çš„è®¤è¯ã€‚ä¸€ä¸ª<code class="du me mf mg mh b">AuthenticaionProvider</code>æœ‰ä¸€ä¸ªauthenticateæ–¹æ³•ï¼Œå®ƒæ¥å—<code class="du me mf mg mh b">Authentication</code>ç±»å‹å¹¶å¯¹å…¶æ‰§è¡Œèº«ä»½éªŒè¯ã€‚è®¤è¯æˆåŠŸåï¼Œ<code class="du me mf mg mh b">AuthenticationProvider</code>è¿”å›ä¸€ä¸ªç›¸åŒç±»å‹çš„<code class="du me mf mg mh b">Authentication</code>å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è¢«ä½œä¸ºauthenticatedå±æ€§è®¾ç½®ä¸ºtrueçš„è¾“å…¥ã€‚å¦‚æœè®¤è¯å¤±è´¥ï¼Œé‚£ä¹ˆå®ƒæŠ›å‡ºä¸€ä¸ªè®¤è¯å¼‚å¸¸ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†é€šç”¨çš„AuthenticationProvider:</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/d8d735a5def9f6d7e24235999ec6c3a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*idqERUvfYgP6wnt2xF5SHw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">AuthenticationProvider</figcaption></figure><p id="a75b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">åœ¨å¤§å¤šæ•°åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œç”¨æˆ·åå’Œå¯†ç éªŒè¯ï¼Œå› æ­¤ï¼Œåœ¨æ‰§è¡ŒéªŒè¯ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»è·å–<strong class="ix hj">ç”¨æˆ·è¯¦ç»†ä¿¡æ¯</strong>(ç”¨æˆ·å/ç”µå­é‚®ä»¶ã€å¯†ç ã€è§’è‰²ç­‰)..)åœ¨<strong class="ix hj">ç”¨æˆ·æœåŠ¡</strong>çš„å¸®åŠ©ä¸‹ä»<strong class="ix hj">â€œæ•°æ®æºâ€</strong>å¦‚æ•°æ®åº“ä¸­è·å–ï¼Œç„¶åå¯¹ç…§å®é™…æ•°æ®éªŒè¯æ‰€æä¾›çš„æ•°æ®ã€‚ä¸‹å›¾æ¼”ç¤ºäº†DaoAuthenticationProviderçš„æµç¨‹(è¿™æ˜¯AuthenticationProvideræ¥å£çš„ä¸€ä¸ªå®ç°ï¼Œä¸»è¦å¤„ç†ç”¨æˆ·åå¯†ç éªŒè¯):</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/a23b8923202c324b02cf009412f1438f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f9us6ZfoaMD0DA7dcKcbOA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">DaoAuthenticationProvider</figcaption></figure><p id="1db3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 5ã€‚UserDetailsService: </strong>è¿™æ˜¯ä¸€ä¸ªæœåŠ¡ï¼Œå®ƒè´Ÿè´£ä»ä¸€ä¸ª<strong class="ix hj"> "datasource "ã€</strong>å¾ˆå¯èƒ½æ˜¯ä¸€ä¸ªä½¿ç”¨<strong class="ix hj">loaduserbysusername(String username)</strong>æ–¹æ³•çš„æ•°æ®åº“ä¸­è·å–ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯¥æ–¹æ³•å°†ç”¨æˆ·åä½œä¸ºä¸€ä¸ªå‚æ•°ã€‚ç„¶åï¼Œå®ƒè¿”å›ä¸€ä¸ª<strong class="ix hj"> UserDetails </strong>å¯¹è±¡ï¼Œå…¶ä¸­å¡«å……äº†ä»æ•°æ®æº(æ•°æ®åº“)è·å–çš„ç”¨æˆ·æ•°æ®ã€‚UserDetailså¯¹è±¡çš„ä¸‰ä¸ªä¸»è¦å­—æ®µæ˜¯ç”¨æˆ·åã€å¯†ç å’Œè§’è‰²/æƒé™ã€‚</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/2fbfd713d190d878ccfd796961abc1b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*g7vtp1nz1_6h9Zlu1UN0IQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">UserDetailsService</figcaption></figure><h2 id="9855" class="lf ki hi bd kj lg lh li kn lj lk ll kr jg lm ln kv jk lo lp kz jo lq lr ld ls bi translated">å¤§å±€</h2><p id="650e" class="pw-post-body-paragraph iv iw hi ix b iy lv ja jb jc lw je jf jg mq ji jj jk mr jm jn jo ms jq jr js hb bi translated">æ˜¯æ—¶å€™æŠŠæ‰€æœ‰ä¸œè¥¿æ”¾åœ¨ä¸€èµ·äº†ã€‚æˆ‘ä»¬å°†å€ŸåŠ©å›¾è¡¨æ¥äº†è§£ç”¨æˆ·åå’Œå¯†ç è®¤è¯çš„æ•´ä¸ªæµç¨‹ã€‚è¿™æ˜¯ä¸€ä¸ªç›¸å½“å¤§çš„å›¾è¡¨ï¼Œæ‰€ä»¥æˆ‘å°†æŠŠå®ƒåˆ†æˆä¸¤éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æ ¹æ®æˆ‘ä»¬åˆšåˆšäº†è§£åˆ°çš„ç»„ä»¶ï¼ŒæŠŠæ•´ä¸ªæµç¨‹åˆ†æˆè¯¦ç»†çš„æ­¥éª¤â€”â€”</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/52dc916a4a6a19b4898cd5e3c4cd5301.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*Two5Tuev8rLNsbYFn4uEWg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Authentication Flow ( Pt. 1 )</figcaption></figure><p id="887f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">æ­¥éª¤1 </strong>:å½“æœåŠ¡å™¨æ”¶åˆ°è®¤è¯è¯·æ±‚ï¼Œæ¯”å¦‚ç™»å½•è¯·æ±‚ï¼Œé¦–å…ˆè¢«è¿‡æ»¤å™¨é“¾ä¸­çš„è®¤è¯è¿‡æ»¤å™¨æ‹¦æˆªã€‚</p><p id="6641" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">æ­¥éª¤2 </strong>:ä½¿ç”¨ç”¨æˆ·æä¾›çš„ç”¨æˆ·åå’Œå¯†ç åˆ›å»ºä¸€ä¸ª<strong class="ix hj">ç”¨æˆ·åå¯†ç è®¤è¯ä»¤ç‰Œ</strong>ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œ<strong class="ix hj">usernamepasswordtauthenticationtoken</strong>æ˜¯<strong class="ix hj">èº«ä»½éªŒè¯</strong>æ¥å£çš„ä¸€ä¸ªå®ç°ï¼Œåœ¨ç”¨æˆ·æƒ³è¦ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œèº«ä»½éªŒè¯æ—¶ä½¿ç”¨ã€‚æœ‰ç‚¹ä¸è¨€è‡ªæ˜ï¼Œä¸æ˜¯å—ï¼Ÿ</p><p id="5ec7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">æ­¥éª¤3 </strong>:å°†<strong class="ix hj">usernamepasswordtauthenticationtoken</strong>ä¼ é€’ç»™<strong class="ix hj"> AuthenticationManager </strong>ä»¥ä¾¿å¯¹ä»¤ç‰Œè¿›è¡Œè®¤è¯ã€‚</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/711a9dcd8b64dc5ea925e7b9a82764e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u3PFjictd9JhodMGvapAUA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Authentication Flow ( Pt. 2 )</figcaption></figure><p id="637f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">æ­¥éª¤4</strong>:<strong class="ix hj">AuthenticationManager</strong>å°†è®¤è¯å§”æ‰˜ç»™é€‚å½“çš„<strong class="ix hj"> AuthenticationProviderã€‚</strong>å¦‚å‰æ‰€è¿°ï¼Œè¿™æ˜¯é€šè¿‡è°ƒç”¨<strong class="ix hj"> AuthenticationProviderä¸Šçš„<strong class="ix hj"> supports() </strong>æ–¹æ³•æ¥å®Œæˆçš„ã€‚</strong></p><p id="d4a4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">æ­¥éª¤5:</strong><strong class="ix hj">AuthenticationProvider</strong>è°ƒç”¨<strong class="ix hj"> UserDetailsService </strong>çš„<strong class="ix hj">loaduserbysusername(username)</strong>æ–¹æ³•ï¼Œå–å›åŒ…å«ç”¨æˆ·æ‰€æœ‰æ•°æ®çš„<strong class="ix hj"> UserDetails </strong>å¯¹è±¡ã€‚æœ€é‡è¦çš„æ•°æ®æ˜¯å¯†ç ï¼Œå› ä¸ºå®ƒå°†ç”¨äºæ£€æŸ¥æ‰€æä¾›çš„å¯†ç æ˜¯å¦æ­£ç¡®ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°å…·æœ‰ç»™å®šç”¨æˆ·åçš„ç”¨æˆ·ï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª<strong class="ix hj">UsernameNotFoundException</strong>ã€‚</p><p id="e649" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">æ­¥éª¤6:</strong><strong class="ix hj">AuthenticationProvider</strong>æ”¶åˆ°<strong class="ix hj"> UserDetails </strong>åæ£€æŸ¥å¯†ç å¹¶è®¤è¯ç”¨æˆ·ã€‚ç»ˆäºï¼ï¼ï¼ã€‚å¦‚æœå¯†ç ä¸åŒ¹é…ï¼Œå®ƒæŠ›å‡ºä¸€ä¸ª<strong class="ix hj">è®¤è¯å¼‚å¸¸ã€‚</strong>ç„¶è€Œï¼Œå¦‚æœè®¤è¯æˆåŠŸï¼Œåˆ™åˆ›å»ºä¸€ä¸ª<strong class="ix hj">usernamepasswordtauthenticationtoken</strong>ï¼Œå¹¶ä¸”å­—æ®µ<strong class="ix hj">ä¸»ä½“</strong>ã€<strong class="ix hj">å‡­è¯</strong>å’Œ<strong class="ix hj">è®¤è¯</strong>è¢«è®¾ç½®ä¸ºé€‚å½“çš„å€¼ã€‚è¿™é‡Œï¼Œä¸»ä½“æŒ‡çš„æ˜¯æ‚¨çš„ç”¨æˆ·åæˆ–<strong class="ix hj">ç”¨æˆ·è¯¦ç»†ä¿¡æ¯</strong>ï¼Œå‡­è¯æŒ‡çš„æ˜¯å¯†ç ï¼Œè®¤è¯å­—æ®µè®¾ç½®ä¸ºtrueã€‚è¿™ä¸ªä»¤ç‰Œè¢«è¿”å›ç»™<strong class="ix hj">è®¤è¯ç®¡ç†å™¨</strong>ã€‚</p><p id="2641" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">æ­¥éª¤7: </strong>è®¤è¯æˆåŠŸåï¼Œ<strong class="ix hj"> SecurityContext </strong>ä¼šæ›´æ–°å½“å‰è®¤è¯ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ã€‚å¯ä»¥åœ¨åº”ç”¨ç¨‹åºçš„å‡ ä¸ªéƒ¨åˆ†ä½¿ç”¨SecurityContext æ¥æ£€æŸ¥å½“å‰æ˜¯å¦æœ‰ä»»ä½•ç”¨æˆ·é€šè¿‡äº†èº«ä»½éªŒè¯ï¼Œå¦‚æœæ˜¯ï¼Œç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯æ˜¯ä»€ä¹ˆã€‚</p><p id="56c4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è¿™å°±æ˜¯æ•´ä¸ªè¿‡ç¨‹ï¼ï¼ï¼ï¼ï¼</p><p id="fa7f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ‰€ä»¥æˆ‘ä»¬éå¸¸è¯¦ç»†åœ°ç ”ç©¶äº†ç†è®ºæ–¹é¢ã€‚ç°åœ¨è®©æˆ‘ä»¬åšä¸€äº›åŠ¨æ‰‹ç»ƒä¹ ï¼Œçœ‹çœ‹æˆ‘ä»¬åœ¨å®è·µä¸­å­¦åˆ°äº†ä»€ä¹ˆã€‚</p></div><div class="ab cl ka kb gp kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hb hc hd he hf"><h1 id="9d33" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">å¹•å:å®ç”¨</h1><h2 id="471b" class="lf ki hi bd kj lg lh li kn lj lk ll kr jg lm ln kv jk lo lp kz jo lq lr ld ls bi translated">ç›®æ ‡</h2><p id="4f8f" class="pw-post-body-paragraph iv iw hi ix b iy lv ja jb jc lw je jf jg mq ji jj jk mr jm jn jo ms jq jr js hb bi translated">æˆ‘ä»¬å°†ä½¿ç”¨Spring Bootæ„å»ºä¸€ä¸ªREST APIã€‚æˆ‘ä»¬å°†å…¬å¼€ä¸€ä¸ªç«¯ç‚¹â€œ/auth/login â€,å®ƒå°†ç”¨æˆ·åå’Œå¯†ç ä½œä¸ºè¯·æ±‚ä½“ã€‚è®¤è¯æˆåŠŸåï¼ŒAPIå°†è¿”å›ä¸€ä¸ªJSONå¯¹è±¡ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå­—æ®µâ€”â€”authenticatedï¼Œè®¾ç½®ä¸ºtrueã€‚</p><h2 id="1db9" class="lf ki hi bd kj lg lh li kn lj lk ll kr jg lm ln kv jk lo lp kz jo lq lr ld ls bi translated">è®¾ç½®</h2><ol class=""><li id="32d0" class="lt lu hi ix b iy lv jc lw jg lx jk ly jo lz js ma mb mc md bi translated">è½¬åˆ°<a class="ae iu" href="https://start.spring.io/" rel="noopener ugc nofollow" target="_blank"> start.sring.io </a>å¹¶åˆ›å»ºä¸€ä¸ªSpring Booté¡¹ç›®ã€‚æ·»åŠ ä»¥ä¸‹ä¾èµ–é¡¹:</li></ol><ul class=""><li id="a033" class="lt lu hi ix b iy iz jc jd jg mv jk mw jo mx js my mb mc md bi translated">å¼¹ç°§ç½‘</li><li id="a77a" class="lt lu hi ix b iy mz jc na jg nb jk nc jo nd js my mb mc md bi translated">æ˜¥å¤©å®‰å…¨</li></ul><p id="de4b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ä½ çš„é¡µé¢åº”è¯¥åƒè¿™æ ·ã€‚</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/20691179cec3c828f6338d034c759440.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jlvSk3w-E8RYS-2WATWkGg.png"/></div></div></figure><p id="bfad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.ç”Ÿæˆé¡¹ç›®å¹¶è§£å‹ç¼©ä¸‹è½½çš„ZIPæ–‡ä»¶å¤¹ã€‚</p><p id="39ea" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.æ‰“å¼€Eclipse(æˆ–æ‚¨æœ€å–œæ¬¢çš„IDE)å¹¶å°†é¡¹ç›®ä½œä¸ºMavené¡¹ç›®å¯¼å…¥ã€‚</p><h2 id="df9c" class="lf ki hi bd kj lg lh li kn lj lk ll kr jg lm ln kv jk lo lp kz jo lq lr ld ls bi translated">ç¼–ç </h2><ol class=""><li id="b1d3" class="lt lu hi ix b iy lv jc lw jg lx jk ly jo lz js ma mb mc md bi translated">pom.xml</li></ol><pre class="mj mk ml mm fd nf mh ng nh aw ni bi"><span id="54af" class="lf ki hi mh b fi nj nk l nl nm">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span id="2758" class="lf ki hi mh b fi nn nk l nl nm">&lt;project  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</span><span id="8964" class="lf ki hi mh b fi nn nk l nl nm">xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;</span><span id="bbfb" class="lf ki hi mh b fi nn nk l nl nm">&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><span id="8296" class="lf ki hi mh b fi nn nk l nl nm">&lt;parent&gt;</span><span id="010c" class="lf ki hi mh b fi nn nk l nl nm">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><span id="84d8" class="lf ki hi mh b fi nn nk l nl nm">&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><span id="e500" class="lf ki hi mh b fi nn nk l nl nm">&lt;version&gt;2.5.1&lt;/version&gt;</span><span id="c316" class="lf ki hi mh b fi nn nk l nl nm">&lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><span id="65f5" class="lf ki hi mh b fi nn nk l nl nm">&lt;/parent&gt;</span><span id="b436" class="lf ki hi mh b fi nn nk l nl nm">&lt;groupId&gt;com.example&lt;/groupId&gt;</span><span id="767f" class="lf ki hi mh b fi nn nk l nl nm">&lt;artifactId&gt;demo&lt;/artifactId&gt;</span><span id="f610" class="lf ki hi mh b fi nn nk l nl nm">&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</span><span id="183a" class="lf ki hi mh b fi nn nk l nl nm">&lt;name&gt;demo&lt;/name&gt;</span><span id="07b3" class="lf ki hi mh b fi nn nk l nl nm">&lt;description&gt;Demo project for Spring Boot&lt;/description&gt;</span><span id="4b65" class="lf ki hi mh b fi nn nk l nl nm">&lt;properties&gt;</span><span id="d1c5" class="lf ki hi mh b fi nn nk l nl nm">&lt;java.version&gt;11&lt;/java.version&gt;</span><span id="93cb" class="lf ki hi mh b fi nn nk l nl nm">&lt;/properties&gt;</span><span id="ab6f" class="lf ki hi mh b fi nn nk l nl nm">&lt;dependencies&gt;</span><span id="0302" class="lf ki hi mh b fi nn nk l nl nm">&lt;dependency&gt;</span><span id="87a1" class="lf ki hi mh b fi nn nk l nl nm">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><span id="79ec" class="lf ki hi mh b fi nn nk l nl nm">&lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;</span><span id="40d7" class="lf ki hi mh b fi nn nk l nl nm">&lt;/dependency&gt;</span><span id="d55d" class="lf ki hi mh b fi nn nk l nl nm">&lt;dependency&gt;</span><span id="bfb8" class="lf ki hi mh b fi nn nk l nl nm">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><span id="7549" class="lf ki hi mh b fi nn nk l nl nm">&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><span id="677f" class="lf ki hi mh b fi nn nk l nl nm">&lt;/dependency&gt;</span><span id="d6dc" class="lf ki hi mh b fi nn nk l nl nm">&lt;dependency&gt;</span><span id="e8fc" class="lf ki hi mh b fi nn nk l nl nm">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><span id="8713" class="lf ki hi mh b fi nn nk l nl nm">&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><span id="5129" class="lf ki hi mh b fi nn nk l nl nm">&lt;scope&gt;test&lt;/scope&gt;</span><span id="a3ce" class="lf ki hi mh b fi nn nk l nl nm">&lt;/dependency&gt;</span><span id="b0c5" class="lf ki hi mh b fi nn nk l nl nm">&lt;dependency&gt;</span><span id="2340" class="lf ki hi mh b fi nn nk l nl nm">&lt;groupId&gt;org.springframework.security&lt;/groupId&gt;</span><span id="b443" class="lf ki hi mh b fi nn nk l nl nm">&lt;artifactId&gt;spring-security-test&lt;/artifactId&gt;</span><span id="bfef" class="lf ki hi mh b fi nn nk l nl nm">&lt;scope&gt;test&lt;/scope&gt;</span><span id="f9b5" class="lf ki hi mh b fi nn nk l nl nm">&lt;/dependency&gt;</span><span id="a86e" class="lf ki hi mh b fi nn nk l nl nm">&lt;/dependencies&gt;</span><span id="1e59" class="lf ki hi mh b fi nn nk l nl nm">&lt;build&gt;</span><span id="7275" class="lf ki hi mh b fi nn nk l nl nm">&lt;plugins&gt;</span><span id="cbbd" class="lf ki hi mh b fi nn nk l nl nm">&lt;plugin&gt;</span><span id="2e30" class="lf ki hi mh b fi nn nk l nl nm">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><span id="584e" class="lf ki hi mh b fi nn nk l nl nm">&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><span id="52b4" class="lf ki hi mh b fi nn nk l nl nm">&lt;/plugin&gt;</span><span id="4669" class="lf ki hi mh b fi nn nk l nl nm">&lt;/plugins&gt;</span><span id="654a" class="lf ki hi mh b fi nn nk l nl nm">&lt;/build&gt;</span><span id="0332" class="lf ki hi mh b fi nn nk l nl nm">&lt;/project&gt;</span></pre><p id="4fdc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.åˆ›å»ºä»¥ä¸‹åŒ…â€”â€”æ¨¡å‹ã€restã€å®‰å…¨å’ŒæœåŠ¡ã€‚</p><p id="df1a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.åœ¨AuthReqBody.javaå’ŒAuthResBody.java<strong class="ix hj">çš„<strong class="ix hj">æ¨¡å‹</strong>åŒ…ä¸­åˆ›å»ºä¸¤ä¸ªç±»<strong class="ix hj">ã€‚</strong></strong></p><ul class=""><li id="6b84" class="lt lu hi ix b iy iz jc jd jg mv jk mw jo mx js my mb mc md bi translated">AuthReqBody.javaâ€”è¯·æ±‚ä½“æ¨¡å‹</li></ul><pre class="mj mk ml mm fd nf mh ng nh aw ni bi"><span id="e946" class="lf ki hi mh b fi nj nk l nl nm">package com.example.demo.models;</span><span id="57fb" class="lf ki hi mh b fi nn nk l nl nm">public class AuthReqBody {</span><span id="09ac" class="lf ki hi mh b fi nn nk l nl nm">private String username;</span><span id="43c5" class="lf ki hi mh b fi nn nk l nl nm">private String password;</span><span id="3012" class="lf ki hi mh b fi nn nk l nl nm">public AuthReqBody(String username, String password) {</span><span id="314b" class="lf ki hi mh b fi nn nk l nl nm">this.username = username;</span><span id="9288" class="lf ki hi mh b fi nn nk l nl nm">this.password = password;</span><span id="0e02" class="lf ki hi mh b fi nn nk l nl nm">}</span><span id="dec1" class="lf ki hi mh b fi nn nk l nl nm">public String getUsername() {</span><span id="9d3b" class="lf ki hi mh b fi nn nk l nl nm">return username;</span><span id="f090" class="lf ki hi mh b fi nn nk l nl nm">}</span><span id="a1d5" class="lf ki hi mh b fi nn nk l nl nm">public void setUsername(String username) {</span><span id="3ae8" class="lf ki hi mh b fi nn nk l nl nm">this.username = username;</span><span id="94b6" class="lf ki hi mh b fi nn nk l nl nm">}</span><span id="b208" class="lf ki hi mh b fi nn nk l nl nm">public String getPassword() {</span><span id="706c" class="lf ki hi mh b fi nn nk l nl nm">return password;</span><span id="bf59" class="lf ki hi mh b fi nn nk l nl nm">}</span><span id="4802" class="lf ki hi mh b fi nn nk l nl nm">public void setPassword(String password) {</span><span id="f89d" class="lf ki hi mh b fi nn nk l nl nm">this.password = password;</span><span id="5389" class="lf ki hi mh b fi nn nk l nl nm">}</span><span id="4822" class="lf ki hi mh b fi nn nk l nl nm">@Override</span><span id="662a" class="lf ki hi mh b fi nn nk l nl nm">public String toString() {</span><span id="5fcf" class="lf ki hi mh b fi nn nk l nl nm">return "AuthReqBody [username=" + username + ", password=" + password + "]";</span><span id="1666" class="lf ki hi mh b fi nn nk l nl nm">}</span><span id="69b0" class="lf ki hi mh b fi nn nk l nl nm">}</span></pre><ul class=""><li id="0166" class="lt lu hi ix b iy iz jc jd jg mv jk mw jo mx js my mb mc md bi translated">AuthResBody.javaâ€”â€”è¯·æ±‚å“åº”æ¨¡å‹</li></ul><pre class="mj mk ml mm fd nf mh ng nh aw ni bi"><span id="80bf" class="lf ki hi mh b fi nj nk l nl nm">package com.example.demo.models;</span><span id="3987" class="lf ki hi mh b fi nn nk l nl nm">public class AuthResBody {</span><span id="19b2" class="lf ki hi mh b fi nn nk l nl nm">private final Boolean authenticated;</span><span id="d8ca" class="lf ki hi mh b fi nn nk l nl nm">public AuthResBody(Boolean authenticated) {</span><span id="d6c9" class="lf ki hi mh b fi nn nk l nl nm">this.authenticated = authenticated;</span><span id="a9d8" class="lf ki hi mh b fi nn nk l nl nm">}</span><span id="9c8e" class="lf ki hi mh b fi nn nk l nl nm">public Boolean getAuthenticated() {</span><span id="c241" class="lf ki hi mh b fi nn nk l nl nm">return authenticated;</span><span id="3a53" class="lf ki hi mh b fi nn nk l nl nm">}</span><span id="3f7c" class="lf ki hi mh b fi nn nk l nl nm">}</span></pre><p id="dfb7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">4.åœ¨<strong class="ix hj">å®‰å…¨</strong>åŒ…ä¸­åˆ›å»ºä¸¤ä¸ªç±»<strong class="ix hj">WebSecurityConfig.java</strong>å’Œ<strong class="ix hj">MyAuthProvider.java</strong></p><ul class=""><li id="9f79" class="lt lu hi ix b iy iz jc jd jg mv jk mw jo mx js my mb mc md bi translated">WebSecurityConfig.javaâ€”ç¦ç”¨csrfä¿æŠ¤ã€å¯ç”¨corså’Œæ‰“å¼€æ‰€æœ‰è·¯ç”±çš„å®‰å…¨é…ç½®ç±»ã€‚</li></ul><pre class="mj mk ml mm fd nf mh ng nh aw ni bi"><span id="3b6d" class="lf ki hi mh b fi nj nk l nl nm">package com.example.demo.security;</span><span id="cc55" class="lf ki hi mh b fi nn nk l nl nm">import org.springframework.context.annotation.Bean;<br/>import org.springframework.context.annotation.Configuration;<br/>import org.springframework.security.authentication.AuthenticationManager;<br/>import org.springframework.security.config.annotation.web.builders.HttpSecurity;<br/>import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;<br/>import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</span><span id="03ae" class="lf ki hi mh b fi nn nk l nl nm"><a class="ae iu" href="http://twitter.com/Configuration" rel="noopener ugc nofollow" target="_blank">@Configuration</a><br/><a class="ae iu" href="http://twitter.com/EnableWebSecurity" rel="noopener ugc nofollow" target="_blank">@EnableWebSecurity</a><br/>public class WebSecurityConfig extends WebSecurityConfigurerAdapter {<br/> <br/> <a class="ae iu" href="http://twitter.com/Override" rel="noopener ugc nofollow" target="_blank">@Override</a><br/> protected void configure(HttpSecurity http) throws Exception {<br/>  http.csrf()<br/>   .disable()<br/>   .cors()<br/>   .and()<br/>   .authorizeRequests().antMatchers("/**").permitAll();<br/> }<br/> <br/> <a class="ae iu" href="http://twitter.com/Override" rel="noopener ugc nofollow" target="_blank">@Override</a><br/> <a class="ae iu" href="http://twitter.com/Bean" rel="noopener ugc nofollow" target="_blank">@Bean</a><br/> public AuthenticationManager authenticationManagerBean() throws Exception {<br/>  return super.authenticationManagerBean();<br/> }</span><span id="f217" class="lf ki hi mh b fi nn nk l nl nm">}</span></pre><ul class=""><li id="ecaf" class="lt lu hi ix b iy iz jc jd jg mv jk mw jo mx js my mb mc md bi translated">MyAuthProvider.javaâ€”è¿™æ˜¯æˆ‘ä»¬çš„è‡ªå®šä¹‰AuthProviderç±»ã€‚åœ¨è¿™ä¸ªç±»ä¸­ï¼Œæˆ‘ä»¬è¦†ç›–äº†authenticateæ–¹æ³•ã€‚æˆ‘ä»¬é€šè¿‡ç”¨æˆ·åä»UserDetailsServiceè·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶æ¯”è¾ƒå¯†ç ã€‚å¦‚æœå¯†ç åŒ¹é…ï¼Œæˆ‘ä»¬å°†è¿”å›usernamepasswordtauthenticationtokenï¼Œå…¶ä¸­authenticatedè®¾ç½®ä¸ºtrueã€‚å¦‚æœä¸æ˜¯ï¼Œæˆ‘ä»¬æŠ›å‡ºä¸€ä¸ªRuntimeExceptionã€‚</li></ul><pre class="mj mk ml mm fd nf mh ng nh aw ni bi"><span id="81f5" class="lf ki hi mh b fi nj nk l nl nm">package com.example.demo.security;</span><span id="805d" class="lf ki hi mh b fi nn nk l nl nm">import org.springframework.beans.factory.annotation.Autowired;<br/>import org.springframework.security.authentication.AuthenticationProvider;<br/>import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;<br/>import org.springframework.security.core.Authentication;<br/>import org.springframework.security.core.AuthenticationException;<br/>import org.springframework.security.core.userdetails.UserDetails;<br/>import org.springframework.stereotype.Component;</span><span id="9ed9" class="lf ki hi mh b fi nn nk l nl nm">import com.example.demo.service.MyUserDetailsService;</span><span id="f588" class="lf ki hi mh b fi nn nk l nl nm"><a class="ae iu" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank">@Component</a><br/>public class MyAuthProvider implements AuthenticationProvider {</span><span id="4e60" class="lf ki hi mh b fi nn nk l nl nm"><a class="ae iu" href="http://twitter.com/Autowired" rel="noopener ugc nofollow" target="_blank">@Autowired</a><br/> private MyUserDetailsService userDetailsService;</span><span id="8d26" class="lf ki hi mh b fi nn nk l nl nm"><a class="ae iu" href="http://twitter.com/Override" rel="noopener ugc nofollow" target="_blank">@Override</a><br/> public Authentication authenticate(Authentication authentication) throws AuthenticationException {<br/>  <br/>  System.out.println("\nIn MyAuthProvider.authenticate(): "); <br/>  <br/>  // Get the User from UserDetailsService<br/>  String providedUsername = authentication.getPrincipal().toString();<br/>  UserDetails user = userDetailsService.loadUserByUsername(providedUsername);<br/>  System.out.println("User Details from UserService based on username-" + providedUsername + " : " + user);<br/>  <br/>  String providedPassword = authentication.getCredentials().toString();<br/>  String correctPassword = user.getPassword();<br/>  <br/>  System.out.println("Provided Password - " + providedPassword + " Correct Password: " + correctPassword);<br/>  <br/>  // Authenticate <br/>  // If Passwords don't match throw and exception<br/>  if(!providedPassword.equals(correctPassword))<br/>   throw new RuntimeException("Incorrect Credentials");<br/>  <br/>  System.out.println("Passwords Match....\n");<br/>  <br/>  // return Authentication Object<br/>  Authentication authenticationResult = <br/>    new UsernamePasswordAuthenticationToken(user, authentication.getCredentials(), user.getAuthorities());<br/>  return authenticationResult;<br/> }</span><span id="2b42" class="lf ki hi mh b fi nn nk l nl nm"><a class="ae iu" href="http://twitter.com/Override" rel="noopener ugc nofollow" target="_blank">@Override</a><br/> public boolean supports(Class&lt;?&gt; authentication) {<br/>  System.out.println("\nIn MyAuthProvider.supports(): "); <br/>  System.out.println("Checking whether MyAuthProvider supports Authentication type\n");<br/>  return authentication.equals(UsernamePasswordAuthenticationToken.class);<br/> }</span><span id="41cb" class="lf ki hi mh b fi nn nk l nl nm">}</span></pre><p id="0e62" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">5.åœ¨<strong class="ix hj"> rest </strong>åŒ…ä¸­åˆ›å»ºä¸€ä¸ªç±»<strong class="ix hj">AuthController.java</strong></p><p id="d1f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">åœ¨è¿™ä¸ªç±»ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†POSTâ€œ/auth/log inâ€ç«¯ç‚¹çš„å¤„ç†ç¨‹åºã€‚æˆ‘ä»¬ä½¿ç”¨æ¥è‡ªè¯·æ±‚ä½“çš„æ•°æ®åˆ›å»ºä¸€ä¸ªusernamepasswordtauthenticationtokenï¼Œå¹¶å°†å…¶ä¼ é€’ç»™AuthenticationManagerçš„authenticateæ–¹æ³•ã€‚</p><pre class="mj mk ml mm fd nf mh ng nh aw ni bi"><span id="0f5f" class="lf ki hi mh b fi nj nk l nl nm">package com.example.demo.rest;</span><span id="b6f0" class="lf ki hi mh b fi nn nk l nl nm">import org.springframework.beans.factory.annotation.Autowired;<br/>import org.springframework.security.authentication.AuthenticationManager;<br/>import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;<br/>import org.springframework.security.core.Authentication;<br/>import org.springframework.security.core.context.SecurityContextHolder;<br/>import org.springframework.web.bind.annotation.PostMapping;<br/>import org.springframework.web.bind.annotation.RequestBody;<br/>import org.springframework.web.bind.annotation.RequestMapping;<br/>import org.springframework.web.bind.annotation.RestController;</span><span id="2485" class="lf ki hi mh b fi nn nk l nl nm">import com.example.demo.models.AuthReqBody;<br/>import com.example.demo.models.AuthResBody;</span><span id="479e" class="lf ki hi mh b fi nn nk l nl nm"><a class="ae iu" href="http://twitter.com/RestController" rel="noopener ugc nofollow" target="_blank">@RestController</a><br/><a class="ae iu" href="http://twitter.com/RequestMapping" rel="noopener ugc nofollow" target="_blank">@RequestMapping</a>("/auth")<br/>public class AuthController {</span><span id="f4f2" class="lf ki hi mh b fi nn nk l nl nm"><a class="ae iu" href="http://twitter.com/Autowired" rel="noopener ugc nofollow" target="_blank">@Autowired</a><br/> private AuthenticationManager authManager;<br/> <br/> <a class="ae iu" href="http://twitter.com/PostMapping" rel="noopener ugc nofollow" target="_blank">@PostMapping</a>("/login")<br/> public AuthResBody authenticate(<a class="ae iu" href="http://twitter.com/RequestBody" rel="noopener ugc nofollow" target="_blank">@RequestBody</a> AuthReqBody authReqBody) {<br/>  System.out.println("Auth Details: " + authReqBody);<br/>    <br/>  UsernamePasswordAuthenticationToken token = new <br/>    UsernamePasswordAuthenticationToken(<br/>      authReqBody.getUsername(), <br/>      authReqBody.getPassword());<br/>  <br/>  System.out.println("\nAuthentication Token Before Authentication: " + token);<br/>  <br/>  Authentication authResult = authManager.authenticate(token);<br/>  <br/>  System.out.println();<br/>  System.out.println("Authentication Token After Authentication: " + authResult);<br/>  System.out.println();<br/>  <br/>  System.out.println("Authentication Token in Security Context: " + SecurityContextHolder.getContext().getAuthentication());<br/>  <br/>  System.out.println();<br/>  if(authResult.isAuthenticated())<br/>   System.out.println("User is Authenticated");<br/>  <br/>  return new AuthResBody(true);<br/> }</span><span id="2cad" class="lf ki hi mh b fi nn nk l nl nm">}</span></pre><p id="7477" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">6.åœ¨<strong class="ix hj">æœåŠ¡</strong>åŒ…ä¸­åˆ›å»ºä¸€ä¸ªç±»<strong class="ix hj">MyUserDetailsService.java</strong></p><p id="9b25" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">åœ¨è¿™ä¸ªç±»ä¸­ï¼Œæˆ‘ä»¬è¦†ç›–loadUserByUsernameæ–¹æ³•å¹¶è¿”å›ä¸€ä¸ªUserDetailså¯¹è±¡ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¿”å›ä¸€ä¸ªç¡¬ç¼–ç çš„ç”¨æˆ·ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯æ‚¨ä»æ•°æ®åº“ä¸­è·å–ç”¨æˆ·çš„åœ°æ–¹ã€‚å¦‚æœç”¨æˆ·åä¸æ­£ç¡®ï¼Œæˆ‘ä»¬æŠ›å‡ºä¸€ä¸ªUsernameNotFoundExceptionã€‚</p><pre class="mj mk ml mm fd nf mh ng nh aw ni bi"><span id="d868" class="lf ki hi mh b fi nj nk l nl nm">package com.example.demo.service;</span><span id="96f5" class="lf ki hi mh b fi nn nk l nl nm">import java.util.ArrayList;</span><span id="64c5" class="lf ki hi mh b fi nn nk l nl nm">import org.springframework.security.core.userdetails.User;<br/>import org.springframework.security.core.userdetails.UserDetails;<br/>import org.springframework.security.core.userdetails.UserDetailsService;<br/>import org.springframework.security.core.userdetails.UsernameNotFoundException;<br/>import org.springframework.stereotype.Service;</span><span id="8061" class="lf ki hi mh b fi nn nk l nl nm"><a class="ae iu" href="http://twitter.com/Service" rel="noopener ugc nofollow" target="_blank">@Service</a><br/>public class MyUserDetailsService implements UserDetailsService {</span><span id="1edf" class="lf ki hi mh b fi nn nk l nl nm">public MyUserDetailsService() {<br/> }</span><span id="2159" class="lf ki hi mh b fi nn nk l nl nm"><a class="ae iu" href="http://twitter.com/Override" rel="noopener ugc nofollow" target="_blank">@Override</a><br/> public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {<br/>  if(!username.equals("sayan"))<br/>   throw new UsernameNotFoundException("User with username - " + username + " not found");<br/>  return new User("sayan", "password", new ArrayList&lt;&gt;());<br/> }</span><span id="b3f2" class="lf ki hi mh b fi nn nk l nl nm">}</span></pre><h2 id="66ab" class="lf ki hi bd kj lg lh li kn lj lk ll kr jg lm ln kv jk lo lp kz jo lq lr ld ls bi translated">æµ‹è¯•</h2><p id="7a92" class="pw-post-body-paragraph iv iw hi ix b iy lv ja jb jc lw je jf jg mq ji jj jk mr jm jn jo ms jq jr js hb bi translated">è¿è¡Œ<strong class="ix hj">DemoApplication.java</strong>(ä½œä¸ºJavaåº”ç”¨ç¨‹åº)ã€‚</p><p id="4122" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ‚¨çš„æ§åˆ¶å°åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es no"><img src="../Images/d802d7abae5080754d671df4ddec371a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LmRFR2RSNEhcYTecixiOLQ.png"/></div></div></figure><p id="5202" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ‰“å¼€é‚®é€’å‘˜æˆ–ä»»ä½•å…¶ä»–å®¢æˆ·ã€‚ä½¿ç”¨ä»¥ä¸‹JSONè¯·æ±‚ä½“å‘<strong class="ix hj">http://localhost:8080/auth/log in</strong>å‘å‡ºPOSTè¯·æ±‚:</p><pre class="mj mk ml mm fd nf mh ng nh aw ni bi"><span id="fd1a" class="lf ki hi mh b fi nj nk l nl nm">{</span><span id="8631" class="lf ki hi mh b fi nn nk l nl nm">"username": "sayan",</span><span id="c633" class="lf ki hi mh b fi nn nk l nl nm">"password": "password"</span><span id="3076" class="lf ki hi mh b fi nn nk l nl nm">}</span></pre><p id="20c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ‚¨åº”è¯¥ä¼šæ”¶åˆ°ä»¥ä¸‹å“åº”:</p><pre class="mj mk ml mm fd nf mh ng nh aw ni bi"><span id="47ea" class="lf ki hi mh b fi nj nk l nl nm">{</span><span id="e8b0" class="lf ki hi mh b fi nn nk l nl nm">"authenticated": true</span><span id="8111" class="lf ki hi mh b fi nn nk l nl nm">}</span></pre><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es np"><img src="../Images/15220cc765ecdf77a44764bd981e470b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qq6tqbS18aOVp3uxFiOK7g.png"/></div></div></figure><p id="658d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ‚¨çš„æ§åˆ¶å°åº”è¯¥æ˜¾ç¤ºæ‰€æœ‰è¿™äº›ä¿¡æ¯:</p><figure class="mj mk ml mm fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nq"><img src="../Images/56c14acca35586fe753f36fdeee183dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Pn-rD63KjTmt5JJKYkQVQ.png"/></div></div></figure><p id="998b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å®ƒæ˜¾ç¤º</p><ul class=""><li id="c4e2" class="lt lu hi ix b iy iz jc jd jg mv jk mw jo mx js my mb mc md bi translated">éªŒè¯å‰åçš„usernamepasswordtauthenticationtokenæ•°æ®ï¼Œ</li><li id="c8f7" class="lt lu hi ix b iy mz jc na jg nb jk nc jo nd js my mb mc md bi translated">ç”¨æˆ·è¯¦ç»†ä¿¡æ¯æ•°æ®</li><li id="10b7" class="lt lu hi ix b iy mz jc na jg nb jk nc jo nd js my mb mc md bi translated">å®‰å…¨ä¸Šä¸‹æ–‡æ•°æ®ç­‰..</li></ul><p id="dce1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å°è¯•å‘é€ä¸€ä¸ªé”™è¯¯çš„ç”¨æˆ·åï¼Œç„¶åå‘é€ä¸€ä¸ªæ­£ç¡®çš„ç”¨æˆ·å+é”™è¯¯çš„å¯†ç ï¼Œå¹¶æ£€æŸ¥å“åº”ã€‚</p><p id="2711" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">åœ¨è¿™é‡Œè·å–å®Œæ•´æºä»£ç â€”<a class="ae iu" href="https://github.com/senshiii/Spring-Security-Authentication-Flow" rel="noopener ugc nofollow" target="_blank">https://github . com/senshi ii/Spring-Security-authentic ation-Flow</a>ã€‚</p><p id="92cd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ä¸è¦å¿˜è®°å¯åŠ¨å­˜å‚¨åº“ğŸ˜‰â¤</p><h2 id="f80d" class="lf ki hi bd kj lg lh li kn lj lk ll kr jg lm ln kv jk lo lp kz jo lq lr ld ls bi translated"><strong class="ak">è€¶ï¼ï¼ï¼ï¼æ‚¨å·²ç»æˆåŠŸåœ°å®ç°äº†Spring Securityçš„è®¤è¯æµç¨‹ã€‚æ­å–œä½ ï¼</strong></h2></div><div class="ab cl ka kb gp kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hb hc hd he hf"><h1 id="3a00" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">ç»“è®º</h1><p id="5534" class="pw-post-body-paragraph iv iw hi ix b iy lv ja jb jc lw je jf jg mq ji jj jk mr jm jn jo ms jq jr js hb bi translated">å”·ï¼ï¼é‚£å·²ç»å¾ˆå¤šäº†..æ­å–œæ„Ÿè°¢é˜…è¯»åˆ°æœ€åã€‚å¸Œæœ›ä½ å–œæ¬¢æˆ‘çš„æ–‡ç« ã€‚ä¸€å®šè¦è€ƒè™‘å–œæ¬¢å’Œåˆ†äº«è¿™ç¯‡æ–‡ç« ï¼Œå¹¶åœ¨è¯„è®ºä¸­æ”¾å¼ƒä½ è¯šå®çš„è¯„è®ºã€‚å¦‚æœä½ æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·ç•™è¨€ã€‚ä¸‹æ¬¡è§ã€‚â¤</p><h1 id="a7d4" class="kh ki hi bd kj kk nr km kn ko ns kq kr ks nt ku kv kw nu ky kz la nv lc ld le bi translated"><strong class="ak">æ”¯æŒ</strong></h1><p id="39b0" class="pw-post-body-paragraph iv iw hi ix b iy lv ja jb jc lw je jf jg mq ji jj jk mr jm jn jo ms jq jr js hb bi translated">å¦‚æœä½ å–œæ¬¢æˆ‘çš„åšå®¢ï¼Œå¹¶ä¸”å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œè¯·è€ƒè™‘å¸®æˆ‘ä¹°ä¸€æ¯å’–å•¡ç»™æˆ‘ï¼Œâ˜•ã€‚è¿™å¯¹æœˆçƒæ¥è¯´æ„å‘³ç€ä»€ä¹ˆğŸŒ™å›åˆ°æˆ‘èº«è¾¹ã€‚è°¢è°¢â¤</p><h2 id="6520" class="lf ki hi bd kj lg lh li kn lj lk ll kr jg lm ln kv jk lo lp kz jo lq lr ld ls bi translated"><strong class="ak">æˆ‘çš„å…¶ä»–å¸–å­</strong></h2><ol class=""><li id="8ff7" class="lt lu hi ix b iy lv jc lw jg lx jk ly jo lz js ma mb mc md bi translated"><a class="ae iu" rel="noopener" href="/swlh/demystifying-the-folder-structure-of-a-react-app-c60b29d90836">æ­ç§˜React Appçš„æ–‡ä»¶å¤¹ç»“æ„</a> <strong class="ix hj"> ( 58k+ views ) </strong></li></ol><p id="a270" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.<a class="ae iu" href="https://javascript.plainenglish.io/react-redux-deep-dive-state-management-in-react-with-redux-b9af8b039bcc" rel="noopener ugc nofollow" target="_blank"> React Reduxæ·±æ½œ:React with Reduxä¸­çš„çŠ¶æ€ç®¡ç†</a></p></div></div>    
</body>
</html>