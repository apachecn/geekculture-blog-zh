<html>
<head>
<title>Stripe Integration with Flutter and Firebase Cloud Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¸¦é¢¤æŒ¯å’Œç«ç„°åŸºäº‘åŠŸèƒ½çš„æ¡çº¹é›†æˆ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/stripe-integration-with-flutter-and-firebase-cloud-functions-1caac8d70166?source=collection_archive---------11-----------------------#2021-05-31">https://medium.com/geekculture/stripe-integration-with-flutter-and-firebase-cloud-functions-1caac8d70166?source=collection_archive---------11-----------------------#2021-05-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/a7933fce5400e78dfad8b609f0bc8adb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j0B-9xioEenugvy1E0DTww.png"/></div></div></figure><div class=""/><p id="7aea" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨æˆ‘æœ€è¿‘çš„ä¸€ä¸ªFlutteré¡¹ç›®ä¸­ï¼Œæˆ‘è¢«è¦æ±‚ä¸ºæ”¯ä»˜é›†æˆStripe SDKï¼Œæˆ‘åœ¨åç«¯ä½¿ç”¨Firebaseã€‚å¯¹æˆ‘æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å½“å…·æœ‰æŒ‘æˆ˜æ€§çš„ä»»åŠ¡ï¼Œå› ä¸ºæ²¡æœ‰å¤ªå¤šçš„åœ¨çº¿èµ„æºå¯ä»¥ä¸ºè¿™æ ·çš„æ¡†æ¶æ¸…æ™°åœ°è®¾ç½®äº‘åŠŸèƒ½ã€‚å› æ­¤ï¼Œæˆ‘æƒ³å†™ä¸‹å¹¶åˆ†äº«æˆ‘åœ¨è¿™æ–¹é¢çš„ç»éªŒã€‚</p><p id="dcaf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨æˆ‘ä»¬ç»§ç»­æ·±å…¥è¿™ä¸ªè¯é¢˜ä¹‹å‰ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†ä¸€äº›å…³äºé¢¤æŒ¯å’Œç«ç„°åŸºçš„çŸ¥è¯†ã€‚</p><p id="5532" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ‰€ä»¥ï¼Œæˆ‘ä»¬å¼€å§‹å§ï¼Œå¥½å—ï¼ŸğŸ˜Š</p><p id="ff17" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è®©æˆ‘ä»¬ä»åˆ›å»ºä¸€ä¸ªæ ·æœ¬Flutteré¡¹ç›®å¼€å§‹ã€‚æ‚¨å¯ä»¥å°†å…¶å‘½åä¸º<strong class="is hu"> StripeFlutterProject </strong>å¹¶è®¾ç½®æ‚¨çš„main.dartæ–‡ä»¶ã€‚</p><p id="3506" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ‚¨éœ€è¦å°†è¿™ä¸¤ä¸ªåŒ…æ·»åŠ åˆ°æ‚¨çš„<strong class="is hu"> <em class="jo"> pubspec.yml </em> </strong>æ–‡ä»¶ä¸­:</p><blockquote class="jp jq jr"><p id="4bd2" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">æ¡çº¹_æ”¯ä»˜:^1.0.6</p><p id="f90c" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">äº‘_åŠŸèƒ½:^0.7.2</p></blockquote><p id="5625" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨æ­¤ä¹‹å‰ï¼Œæ‚¨å¿…é¡»åˆ›å»ºä¸€ä¸ªStripe SDKå’ŒFirebaseå¸æˆ·ã€‚æˆ‘ä¸æ‰“ç®—è¯¦ç»†è¯´æ˜ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸€äº›é“¾æ¥ï¼Œä½ å¯ä»¥é€šè¿‡å®ƒä»¬æ¥åˆ›å»ºä½ çš„è´¦æˆ·ã€‚</p><div class="hh hi ez fb hj jv"><a href="https://stripe.com/en-sg" rel="noopener  ugc nofollow" target="_blank"><div class="jw ab dw"><div class="jx ab jy cl cj jz"><h2 class="bd hu fi z dy ka ea eb kb ed ef hs bi translated">äº’è”ç½‘ä¼ä¸šçš„åœ¨çº¿æ”¯ä»˜å¤„ç†â€” Stripe</h2><div class="kc l"><h3 class="bd b fi z dy ka ea eb kb ed ef dx translated">äº’è”ç½‘ä¸šåŠ¡çš„åœ¨çº¿æ”¯ä»˜å¤„ç†ã€‚Stripeæ˜¯ä¸€å¥—æ”¯ä»˜APIï¼Œæ”¯æŒåœ¨çº¿å•†åŠ¡â€¦</h3></div><div class="kd l"><p class="bd b fp z dy ka ea eb kb ed ef dx translated">stripe.com</p></div></div></div></a></div><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="7415" class="kn ko ht kj b fi kp kq l kr ks"><a class="ae kt" href="https://firebase.google.com/docs/projects/learn-more#setting_up_a_firebase_project_and_registering_apps" rel="noopener ugc nofollow" target="_blank">https://firebase.google.com/docs/projects/learn-more#setting_up_a_firebase_project_and_registering_apps</a></span></pre><p id="07c4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">é¦–å…ˆï¼Œä½ éœ€è¦åœ¨æ§åˆ¶å°å»ºç«‹ä¸€ä¸ªFirebaseé¡¹ç›®å’Œæ•°æ®åº“ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥æ·»åŠ æ›´å¤šçš„åŒ…(ä¸‹é¢æä¾›çš„ç‰ˆæœ¬æ˜¯æˆ‘åœ¨æˆ‘çš„é¡¹ç›®ä¸­ä½¿ç”¨çš„ç‰ˆæœ¬ã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥å°†æœ€æ–°çš„ç¨³å®šåŒ…æ·»åŠ åˆ°æ‚¨çš„Flutteré¡¹ç›®ä¸­ï¼Œç”¨äºä¸‹é¢åˆ—å‡ºçš„Firebaseé…ç½®ï¼›</p><blockquote class="jp jq jr"><p id="9f80" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">ç‡ƒçƒ§åŸºåœ°æ ¸å¿ƒ:^0.5.3</p><p id="7ded" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">ç«æƒ…_æ¶ˆæ¯:^6.0.16</p><p id="c219" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">æ•°æ®åº“:^4.4.0</p></blockquote><p id="211b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¸‹ä¸€æ­¥æ˜¯ä»Firebaseæ§åˆ¶å°ä¸‹è½½<strong class="is hu"><em class="jo">Google service-info . plist</em></strong>æ–‡ä»¶ï¼Œå¹¶æ·»åŠ åˆ°Androidå’ŒiOSæ–‡ä»¶å¤¹ä¸­ã€‚</p><p id="8bce" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç°åœ¨ï¼Œå¯¹äºåç«¯(äº‘å‡½æ•°)ï¼Œæ‚¨å°†å¿…é¡»åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹é¡¹ç›®ï¼Œæˆ‘ä»¬åœ¨å…¶ä¸­ç¼–å†™æ‰€æœ‰çš„æ¡å¸¦å‡½æ•°ã€‚å°†æ‚¨çš„æ¡å½¢å¯†é’¥å’ŒåŠŸèƒ½å­˜å‚¨åœ¨åç«¯æ›´åŠ å®‰å…¨ï¼Œå®ƒå…è®¸æ‚¨æ‰§è¡Œæ‰€æœ‰ä¸æ”¯ä»˜ç›¸å…³çš„ç¹é‡ä»»åŠ¡ã€‚</p><p id="8f50" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æˆ‘æ­£åœ¨æ·»åŠ åŸºæœ¬çš„æ”¯ä»˜äº‘åŠŸèƒ½ã€‚æˆ‘ä¸€ä¸ªä¸€ä¸ªè§£é‡Šã€‚è¦è®¾ç½®äº‘å‡½æ•°ï¼Œè¯·åˆ›å»ºä¸€ä¸ªnode.isé¡¹ç›®ã€‚æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨è°·æ­Œäº‘æ§åˆ¶å°ä¸­æ·»åŠ äº‘åŠŸèƒ½ã€‚æˆ‘å°†åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„äº‘å‡½æ•°é¡¹ç›®ï¼Œè®©æˆ‘ä»¬å‘½åä¸º<em class="jo">æ¡çº¹äº‘å‡½æ•°</em>ã€‚</p><p id="16e1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">åœ¨æ­¤ä¹‹å‰ï¼Œè¯·å®‰è£…Firebaseå·¥å…·ï¼Œå¹¶ä½¿ç”¨å‘½ä»¤è¡Œç™»å½•åˆ°æ‚¨çš„Firebaseå¸æˆ·ã€‚</p><blockquote class="jp jq jr"><p id="b795" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hb bi translated">NPM install-g fire base-å·¥å…·</p></blockquote><p id="d882" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹é“¾æ¥è®¾ç½®æ‚¨çš„äº‘åŠŸèƒ½é¡¹ç›®:</p><div class="hh hi ez fb hj jv"><a href="https://firebase.google.com/docs/functions/get-started" rel="noopener  ugc nofollow" target="_blank"><div class="jw ab dw"><div class="jx ab jy cl cj jz"><h2 class="bd hu fi z dy ka ea eb kb ed ef hs bi translated">å¼€å§‹:ç¼–å†™ã€æµ‹è¯•å’Œéƒ¨ç½²æ‚¨çš„ç¬¬ä¸€ä¸ªåŠŸèƒ½| Firebase</h2><div class="kc l"><h3 class="bd b fi z dy ka ea eb kb ed ef dx translated">ç¼–è¾‘æè¿°</h3></div><div class="kd l"><p class="bd b fp z dy ka ea eb kb ed ef dx translated">firebase.google.com</p></div></div><div class="ku l"><div class="kv l kw kx ky ku kz hp jv"/></div></div></a></div><p id="148e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ‚¨å¯ä»¥åœ¨index.tsä¸­æ·»åŠ ä»¥ä¸‹å‡½æ•°:</p><figure class="ke kf kg kh fd hk"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="0e6a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ‚¨éœ€è¦åœ¨firebaseæ§åˆ¶å°ä¸Šéƒ¨ç½²è¿™äº›äº‘åŠŸèƒ½ã€‚ä¸‹ä¸€æ­¥æ˜¯ä»ä½ çš„flutteråº”ç”¨ç¨‹åºä¸­è°ƒç”¨è¿™ä¸ªäº‘å‡½æ•°ï¼Œè®©æˆ‘ä»¬åœ¨ä½ çš„flutteråº”ç”¨ç¨‹åºä¸­æ·»åŠ ä»£ç ï¼Œé€šè¿‡httpä»ä½ çš„åº”ç”¨ç¨‹åºä¸­è§¦å‘ä¸Šè¿°äº‘å‡½æ•°ã€‚</p><p id="411c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">æ³¨æ„</strong>:åœ¨ä½ çš„<em class="jo"> pubspec.yaml </em>æ–‡ä»¶ä¸­æ·»åŠ äº‘å‡½æ•°åŒ…ï¼›</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="8470" class="kn ko ht kj b fi kp kq l kr ks">cloud_functions: ^0.9.0</span></pre><p id="2020" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¸è¦å¿˜è®°è¿è¡Œ<strong class="is hu"> <em class="jo"> flutter pub get </em> </strong>ä¸€æ—¦ä½ åœ¨é¡¹ç›®ä¸­æ·»åŠ äº†æ–°çš„åŒ…ï¼Œç°åœ¨åœ¨ä½ çš„flutteré¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ª<strong class="is hu"><em class="jo">firebase service . dart</em></strong>æ–‡ä»¶ï¼Œè¿™ä¸ªdartæ–‡ä»¶åº”è¯¥åŸºæœ¬ä¸Šå¯ä»¥å¤„ç†ä½ çš„firebaseè°ƒç”¨å’Œå¼•ç”¨ã€‚ä½ å¯ä»¥ç”¨ä¸‹é¢çš„æ„å›¾æ·»åŠ ä½ çš„äº‘å‡½æ•°å¼•ç”¨ï¼Œè¿™é‡Œè¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ä½ éœ€è¦åœ¨ä½ çš„å¯è°ƒç”¨å®ä¾‹ä¸­ä¼ é€’äº‘å‡½æ•°åã€‚</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="75c5" class="kn ko ht kj b fi kp kq l kr ks">//Cloud functions reference</span><span id="314a" class="kn ko ht kj b fi lc kq l kr ks">static final HttpsCallable CREATE_INTENT =   FirebaseFunctions.instance.httpsCallable('createPaymentIntent');</span><span id="44b3" class="kn ko ht kj b fi lc kq l kr ks">static final HttpsCallable GET_PAYMENT_INTENT =<br/>FirebaseFunctions.instance.httpsCallable('getUserPaymentIntent');</span><span id="3b85" class="kn ko ht kj b fi lc kq l kr ks">static final HttpsCallable CONFIRM_PAYMENT_INTENT = FirebaseFunctions.instance.httpsCallable('confirmPaymentIntent');</span><span id="03dc" class="kn ko ht kj b fi lc kq l kr ks">static final HttpsCallable CREATE_CUSTOMER_CHARGE = FirebaseFunctions.instance.httpsCallable('createCustomerCharge');<br/></span></pre><p id="4a61" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä»ä½ çš„flutteråº”ç”¨ç¨‹åºè°ƒç”¨è¿™äº›æ„å›¾ï¼Œå®ƒå°†åŸºæœ¬ä¸Šè§¦å‘ç›¸åº”çš„äº‘åŠŸèƒ½ï¼Œä½ åº”è¯¥å§‹ç»ˆåœ¨åç«¯å¤„ç†æ”¯ä»˜ä¸šåŠ¡é€»è¾‘(åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯äº‘åŠŸèƒ½)ï¼Œå› ä¸ºå®ƒæ›´å®‰å…¨ï¼Œå¹¶ç”±stripeæ¨èã€‚</p><p id="ae57" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¦è§¦å‘è¿™äº›æ„å›¾ï¼Œæ‚¨éœ€è¦ä»ç›¸å…³çš„dartæ–‡ä»¶ä¸­è°ƒç”¨å®ƒä»¬(åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œå®ƒæ˜¯æ˜¾ç¤ºæˆ‘çš„å¡çš„è¯¦ç»†ä¿¡æ¯å¹¶è¦æ±‚ç”¨æˆ·ä»˜æ¬¾çš„é¡µé¢),å¦‚ä¸‹æ‰€ç¤º:</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="47cd" class="kn ko ht kj b fi kp kq l kr ks">FirebaseService.CREATE_INTENT.call(&lt;String, dynamic&gt;{ 'methodId':paymentMethod.id, 'amount': nAmount, 'currency': 'sgd', 'application_fee_amount':fee, 'stripeId':  widget.cardModel.stripe_account}).then((response) {</span><span id="53e2" class="kn ko ht kj b fi lc kq l kr ks">   print("itent response: " + response.data.toString());<br/>   hideLoading();       </span><span id="752e" class="kn ko ht kj b fi lc kq l kr ks">confirmDialog(response.data["client_secret"],response.data["payment_method"], response.data["id"]); //function for confirmation for payment</span><span id="534b" class="kn ko ht kj b fi lc kq l kr ks">}).catchError((error) {</span><span id="9eb1" class="kn ko ht kj b fi lc kq l kr ks">   print("intent error: " + error.toString());<br/>   hideLoading();</span><span id="dd05" class="kn ko ht kj b fi lc kq l kr ks">});</span></pre><p id="65d5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¸€æ—¦æ‚¨è°ƒç”¨è¿™ä¸ªfirebaseæœåŠ¡æ„å›¾ï¼Œæ‚¨çš„åç«¯é€»è¾‘å°†è¿è¡Œï¼Œå¹¶åœ¨ç¡®è®¤ä»˜æ¬¾æ„å›¾ï¼Œç”¨æˆ·çš„ä»˜æ¬¾æ–¹å¼å°†è¢«æ”¶è´¹ã€‚åœ¨æˆ‘çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä½¿ç”¨å¡æ”¯ä»˜æ–¹å¼ï¼Œå¹¶åœ¨æˆ‘çš„åº”ç”¨ç¨‹åºä¸­æä¾›çš„ä»»ä½•ç‰¹å®šæœåŠ¡ä¸Šæ”¶å–ç”¨æˆ·å¡çš„è´¹ç”¨ã€‚</p><p id="5a58" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¿™å°±æ˜¯ç°åœ¨ï¼Œä½ ä»¬å¯ä»¥è¯•è¯•è¿™ä¸ªï¼Œå¦‚æœæˆ‘é”™è¿‡äº†ä»€ä¹ˆï¼Œè¯·åœ¨è¯„è®ºä¸­å‘Šè¯‰æˆ‘ï¼Œæˆ–è€…å¦‚æœä½ ä»¬æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚</p><p id="8727" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¸Œæœ›ä½ å–œæ¬¢é˜…è¯»è¿™ç¯‡æ–‡ç« ğŸ˜Šã€‚ç¼–ç å¿«ä¹ï¼Œå¹²æ¯ï¼ğŸ»</p></div></div>    
</body>
</html>