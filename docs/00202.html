<html>
<head>
<title>Deploying Intent Classifier on Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨Herokuä¸Šéƒ¨ç½²æ„å›¾åˆ†ç±»å™¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/deploying-intent-classifier-on-heroku-a784c22a29fe?source=collection_archive---------1-----------------------#2020-10-24">https://medium.com/geekculture/deploying-intent-classifier-on-heroku-a784c22a29fe?source=collection_archive---------1-----------------------#2020-10-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1e88c137f2ee2de7aed528122d7c622a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JhIvANmCl0p6EpOkyzFfag.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Image by Author</figcaption></figure><p id="4016" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ¬¢è¿æ¥åˆ°æˆ‘åšå®¢çš„ç»­ç¯‡ï¼Œåœ¨è¿™é‡Œæˆ‘è°ˆåˆ°äº†<a class="ae js" rel="noopener" href="/analytics-vidhya/creating-your-own-intent-classifier-b86e000a4926">è®­ç»ƒæ„å›¾åˆ†ç±»å™¨</a>ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†è®­ç»ƒå¥½çš„æ„å›¾åˆ†ç±»å™¨..ä¸‹ä¸€æ­¥ä»€ä¹ˆï¼Ÿæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®ƒã€‚å®ƒå¿…é¡»éƒ¨ç½²åœ¨æŸä¸ªåœ°æ–¹æ‰èƒ½ä½¿ç”¨ï¼Œå¯¹å—ï¼Ÿæˆ‘ä»¬å°†é€‰æ‹©Herokuä½œä¸ºæˆ‘ä»¬çš„å¹³å°æ¥å®æ—¶æŸ¥çœ‹æ„å›¾åˆ†ç±»å™¨ã€‚</p><p id="7f53" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œå¦‚æœä½ æ„¿æ„å’Œæˆ‘ä¸€èµ·èµ°ï¼Œä½ å¯ä»¥åœ¨æˆ‘çš„<a class="ae js" href="https://github.com/thehetpandya/heroku-intent-classifier-deployment" rel="noopener ugc nofollow" target="_blank"> github repo </a>ä¸Šæ‰¾åˆ°æ‰€æœ‰ä»£ç ã€‚</p><h1 id="79c8" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">æ–‡ä»¶å¤¹ç»“æ„</h1><p id="6739" class="pw-post-body-paragraph iu iv hi iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">ä¸ºæ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬å°†ä¿ç•™ä»¥ä¸‹æ–‡ä»¶å¤¹ç»“æ„:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="e6bf" class="lf ju hi lb b fi lg lh l li lj">/your-folder<br/>â”œâ”€â”€â”€models<br/>â”‚   â””â”€â”€â”€intents.h5<br/>â”œâ”€â”€â”€templates<br/>â”‚   â””â”€â”€â”€index.html<br/>â”œâ”€â”€â”€utils<br/>â”‚   â”œâ”€â”€â”€classes.txt<br/>â”‚   â”œâ”€â”€â”€label_encoder.pkl<br/>â”‚   â””â”€â”€â”€tokenizer.pkl<br/>â”œâ”€â”€â”€index.html<br/>â”œâ”€â”€â”€app.py<br/>â”œâ”€â”€â”€requirements.txt<br/>â””â”€â”€â”€Procfile</span></pre><h1 id="c970" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">ç¬¬ä¸€æ­¥</h1><p id="6307" class="pw-post-body-paragraph iu iv hi iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">æ­£å¦‚ä¹‹å‰<a class="ae js" rel="noopener" href="/analytics-vidhya/deploying-bert-on-heroku-7df1d23f9c43">æ‰€è¯´ï¼ŒHerokuéœ€è¦<em class="lk"> "requirements.txt" </em>æ¥å®‰è£…æ‰€æœ‰éœ€è¦çš„ä¾èµ–é¡¹ã€‚åœ¨åŒä¸€ä¸­æ·»åŠ ä»¥ä¸‹åº“:</a></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="267a" class="lf ju hi lb b fi lg lh l li lj">tensorflow==1.5<br/>h5py<br/>scikit-learn<br/>numpy<br/>flask</span></pre><h1 id="f37c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">ç¬¬äºŒæ­¥</h1><p id="b421" class="pw-post-body-paragraph iu iv hi iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»å®‰è£…äº†åº“ï¼Œæ˜¯æ—¶å€™ç¼–å†™ä¸€ä¸ªç¥å¥‡çš„æ–‡ä»¶äº†ğŸ˜‰</p><p id="c006" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åˆ›å»ºä¸€ä¸ªåä¸º<em class="lk"> "app.py" </em>çš„æ–‡ä»¶ï¼Œæ”¾å…¥ä¸‹é¢çš„ä»£ç code:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="7750" class="lf ju hi lb b fi lg lh l li lj">import os<br/>from flask import Flask, render_template<br/>from flask import request<br/><br/>import pickle<br/>from tensorflow.python.keras.models import load_model<br/>from tensorflow.python.keras.preprocessing.sequence import pad_sequences<br/>import numpy as np<br/>import tensorflow as tf<br/><br/>global graph<br/><br/>model = load_model('models/intents.h5')<br/>graph = tf.get_default_graph()<br/><br/>with open('utils/tokenizer.pkl','rb') as file:<br/>    tokenizer = pickle.load(file)<br/><br/>with open('utils/label_encoder.pkl','rb') as file:<br/>    label_encoder = pickle.load(file)<br/><br/>class IntentClassifier:<br/>    def __init__(self,model,tokenizer,label_encoder):<br/>        self.classifier = model<br/>        self.tokenizer = tokenizer<br/>        self.label_encoder = label_encoder<br/><br/>    def get_intent(self,text):<br/>        self.text = [text]<br/>        self.test_keras = self.tokenizer.texts_to_sequences(self.text)<br/>        self.test_keras_sequence = pad_sequences(self.test_keras, maxlen=16, padding='post')<br/>        with graph.as_default():<br/>            self.pred = self.classifier.predict(self.test_keras_sequence)<br/>        return self.label_encoder.inverse_transform(np.argmax(self.pred,1))[0]<br/><br/>app = Flask(__name__)<br/><br/>nlu = IntentClassifier(model,tokenizer,label_encoder) <br/><br/><br/>@app.route('/', methods=['GET', 'POST'])<br/>def index():<br/>  <br/>    if request.method == 'POST':<br/>      form = request.form <br/>        <br/>      result = []<br/>      sentence = form['sentence']<br/>      prediction = nlu.get_intent(sentence)<br/><br/>      result.append(form['sentence'])<br/>      result.append(prediction)<br/><br/>      return render_template("index.html",result = result)<br/><br/>    return render_template("index.html")<br/><br/>if __name__ == '__main__':<br/>    port = int(os.environ.get("PORT", 5000))<br/>    app.run(host='0.0.0.0', port=port)</span></pre><p id="22f1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿™å°†åˆ›å»ºä¸€ä¸ªè§£æå™¨ç±»ï¼Œä»¥ä¾¿æ ¹æ®å®ƒæ‰€æ¥å—çš„è®­ç»ƒå¯¹ç»™å®šçš„æ„å›¾è¿›è¡Œåˆ†ç±»ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªflaskæœåŠ¡å™¨æ¥æ¥æ”¶è¾“å…¥å¹¶å°†å®ƒä»¬ä¼ é€’ç»™è§£æå™¨ç±»ã€‚</p><p id="e7ec" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ¥ä¸‹æ¥ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º<em class="lk"> "index.html" </em>çš„æ–‡ä»¶ï¼Œå¹¶å°†å…¶æ”¾åœ¨<em class="lk"> "templates" </em>æ–‡ä»¶å¤¹ä¸‹ã€‚åœ¨æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç :</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="72f1" class="lf ju hi lb b fi lg lh l li lj">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;Intent Classifier&lt;/title&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;<br/>    &lt;link href="//netdna.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" media="screen"&gt;<br/>    &lt;style&gt;<br/>      .container {<br/>        max-width: 1000px;<br/>      }<br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div class="container"&gt;<br/>      &lt;div class="row-sm-5 row-sm-offset-1"&gt;<br/>          &lt;h4&gt;Enter a sentence to test Intent Classifier&lt;/h4&gt;<br/>            &lt;form role="form" method='POST' action='/'&gt;<br/>              &lt;div class="form-group"&gt;<br/>                &lt;input type="text" name="sentence" class="form-control" id="url-box" placeholder="Enter a sentence" style="max-width: 300px;" autofocus required&gt;<br/>              &lt;/div&gt;<br/>              &lt;button type="submit" class="btn btn-default"&gt;Predict&lt;/button&gt;<br/>            &lt;/form&gt;<br/>          &lt;br&gt;<br/>      &lt;/div&gt;<br/>      <br/><br/>      &lt;div class="row-sm-5 row-sm-offset-1"&gt;<br/>          &lt;p&gt;Find the list of all classes &lt;a href='https://github.com/horizons-ml/heroku-intent-classifier-deployment/blob/main/utils/classes.txt' target="_blank"&gt;here&lt;/a&gt;.&lt;/p&gt;<br/>          {% if result %}<br/>          &lt;h4&gt;Sentence : {{ result[0] }}&lt;/h4&gt;<br/>          &lt;h4&gt;Predicted Intent : {{ result[1] }}&lt;/h4&gt;<br/>          {% endif %}<br/>      &lt;/div&gt;<br/><br/>    &lt;/div&gt;<br/>    <br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h1 id="c52d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">ç¬¬ä¸‰æ­¥</h1><p id="887e" class="pw-post-body-paragraph iu iv hi iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">åˆ›å»º<em class="lk"> "Procfile" </em>å¹¶æ·»åŠ ä»¥ä¸‹ä»£ç :</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="3ae5" class="lf ju hi lb b fi lg lh l li lj">web: python app.py</span></pre><h1 id="b16a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">ç¬¬å››æ­¥</h1><p id="1208" class="pw-post-body-paragraph iu iv hi iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">ç¡®ä¿ä½ å·²ç»å®‰è£…äº†Heroku CLIå’Œgitã€‚å®Œæˆåï¼Œåœ¨æ‚¨çš„ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°†æ‚¨çš„æœºå™¨ä¸Herokuè¿æ¥èµ·æ¥ã€‚ï¼š</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="72d0" class="lf ju hi lb b fi lg lh l li lj">heroku login</span></pre><p id="a864" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ¥ä¸‹æ¥ï¼Œè½¬åˆ°<a class="ae js" href="https://dashboard.heroku.com/new-app?org=personal-apps" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ªé¡µé¢</a>ï¼Œç”¨ä½ æƒ³è¦çš„åå­—åˆ›å»ºä¸€ä¸ªherokuåº”ç”¨ç¨‹åºã€‚æˆåŠŸåˆ›å»ºåº”ç”¨ç¨‹åºåï¼Œé”®å…¥ä»¥ä¸‹å‘½ä»¤å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°Heroku:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="e6ca" class="lf ju hi lb b fi lg lh l li lj">git init<br/>git add .<br/>git commit -m 'initial commit'<br/>git push heroku master</span></pre><p id="2859" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘ä»¬çš„appå·²ç»éƒ¨ç½²å¥½äº†ï¼æ˜¯æ—¶å€™çœ‹çœ‹å®ƒçš„è¿è¡Œäº†ã€‚</p><p id="f9a9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åœ¨æµè§ˆå™¨çª—å£ä¸­è¾“å…¥ä»¥ä¸‹åœ°å€:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="50d5" class="lf ju hi lb b fi lg lh l li lj">https://your_app_name.herokuapp.com</span></pre><p id="c450" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹:</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/527ac939b9a69c33560db065cc37fc7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*Xfa5Ky5zhNgPUPORvVTwNg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Deployed Intent Classifier</figcaption></figure><p id="a96b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è®©æˆ‘ä»¬ç»™å®ƒä¸€ä¸ªæµ‹è¯•å¥å­ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°<a class="ae js" href="https://github.com/thehetpandya/heroku-intent-classifier-deployment/blob/main/utils/classes.txt" rel="noopener ugc nofollow" target="_blank">çš„èŒä¸šåˆ—è¡¨ï¼Œä½œä¸ºæµ‹è¯•æ¨¡å‹çš„å‚è€ƒã€‚</a></p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/add453d1174a115d0dffdfcac1b51f4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*h_pNTCHzuPzAhfgcRsVzxw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Intent Classifier Prediction</figcaption></figure><p id="8d62" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Yaaayyï¼æˆ‘ä»¬çš„åˆ†ç±»å™¨å·¥ä½œäº†ï¼å¦‚æœä½ æƒ³è¯•è¯•ï¼Œæˆ‘å·²ç»åœ¨è¿™é‡Œéƒ¨ç½²äº†æˆ‘çš„åˆ†ç±»å™¨<a class="ae js" href="https://intentclassifier.herokuapp.com" rel="noopener ugc nofollow" target="_blank"/>ã€‚</p><p id="ff38" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æš‚æ—¶å°±è¿™æ ·äº†ã€‚æ„Ÿè°¢æ‚¨çš„é˜…è¯»ğŸ˜„</p></div></div>    
</body>
</html>