<html>
<head>
<title>Getting started with Prisma ORM for Nodejs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Nodejsçš„Prisma ORMå…¥é—¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/geekculture/getting-started-with-prisma-orm-for-nodejs-a2be625ea13e?source=collection_archive---------4-----------------------#2021-08-08">https://medium.com/geekculture/getting-started-with-prisma-orm-for-nodejs-a2be625ea13e?source=collection_archive---------4-----------------------#2021-08-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2399088228ce9766fa495d0c68baf169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Jpn8_KJfdAhmtcpN"/></div></div></figure><p id="4f23" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å½“ä½ ç¬¬ä¸€æ¬¡äº†è§£ç§‘æŠ€é¢†åŸŸçš„è®¸å¤šä¸œè¥¿æ—¶ï¼Œå®ƒä»¬å¬èµ·æ¥æ¯”å®é™…æƒ…å†µæ›´å“äººã€‚ORM(å¯¹è±¡å…³ç³»æ˜ å°„å™¨)åªæ˜¯å…¶ä¸­ä¹‹ä¸€ï¼›å¯¹äºä»»ä½•Nodejsåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ç›¸å½“å¤šçš„é€‰é¡¹ï¼Œä½†æˆ‘å°†åˆ†äº«ä¸€äº›å…¥é—¨Prisma ORMçš„çµæ„Ÿã€‚</p><h1 id="81b4" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">ä»€ä¹ˆæ˜¯ORMï¼Ÿ</h1><p id="9677" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">å¯¹è±¡å…³ç³»æ˜ å°„çš„æ¦‚å¿µæ˜¯ï¼Œèƒ½å¤Ÿä½¿ç”¨æ‚¨å–œæ¬¢çš„ç¼–ç¨‹è¯­è¨€çš„é¢å‘å¯¹è±¡èŒƒä¾‹ç¼–å†™å¦‚ä¸‹æŸ¥è¯¢ä»¥åŠæ›´å¤æ‚çš„æŸ¥è¯¢ã€‚æœ¬è´¨ä¸Šï¼ŒORMæœ‰åŠ©äºæŠ½è±¡å‘æ•°æ®åº“ç¼–å†™å®šåˆ¶SQLæŸ¥è¯¢çš„å¤æ‚æ€§ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="1cf6" class="la jp hi kw b fi lb lc l ld le">SELECT * FROM user where countryId = 2</span></pre><p id="98cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å—¯ï¼Œå°±åƒä»»ä½•å…¶ä»–å·¥å…·æˆ–åº“ä¸€æ ·ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒä»¬æœ‰å¥½å¤„ä¹Ÿæœ‰åå¤„ã€‚åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šï¼Œæˆ‘å¶ç„¶å‘ç°äº†Prismaï¼Œå®ƒå¯ä»¥è¯´æ˜¯ä¸­ä½å¤æ‚åº¦å’Œä¼ä¸šåº”ç”¨ç¨‹åºçš„ä¼˜ç§€å·¥å…·ã€‚</p><ul class=""><li id="3440" class="lg lh hi is b it iu ix iy jb li jf lj jj lk jn ll lm ln lo bi translated">æ‚¨å¯ä»¥ç”¨æœ€å°‘çš„ä»£ç å¿«é€Ÿåœ°ä¸ºNodejsæœåŠ¡å™¨æ­å»ºä¸€ä¸ªæ•°æ®åº“ã€‚</li><li id="c69b" class="lg lh hi is b it lp ix lq jb lr jf ls jj lt jn ll lm ln lo bi translated">å®ƒæ˜¯å¼€æºçš„ï¼Œä¸è®¸å¤šSQLå…¼å®¹ï¼Œå¦‚PostgreSQLã€MySQLå’ŒSQLiteã€‚</li><li id="cf91" class="lg lh hi is b it lp ix lq jb lr jf ls jj lt jn ll lm ln lo bi translated">å¯¹typescriptçš„ç°æˆæ”¯æŒã€‚</li><li id="0e1c" class="lg lh hi is b it lp ix lq jb lr jf ls jj lt jn ll lm ln lo bi translated">è®¸å¤šå·¥å…·éƒ½æ²¡æœ‰é€‚å½“çš„æ–‡æ¡£ï¼Œå½“é‡åˆ°å›°éš¾æ—¶æˆ‘ä»¬ä¸å¾—ä¸ä¾é ç¤¾åŒºçš„å¸®åŠ©ï¼Œä½†æ˜¯<a class="ae lf" href="https://www.prisma.io/docs/" rel="noopener ugc nofollow" target="_blank"> Prisma </a>æ–‡æ¡£éå¸¸ä»¤äººæ„‰å¿«å¹¶ä¸”éå¸¸è¯¦ç»†ã€‚</li></ul><p id="4ed4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥æˆ‘ä»¬å°†çœ‹çœ‹æœ¬æ•™ç¨‹çš„ä¸€äº›å…ˆå†³æ¡ä»¶ï¼ŒåŒ…æ‹¬Prismaã€Express.js + typescriptå’ŒPostgreSQLã€‚</p><h1 id="7339" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">å…ˆå†³æ¡ä»¶</h1><p id="0f66" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">æœ¬æ•™ç¨‹å‡è®¾æ‚¨å¯¹Nodejsæœ‰ä¸€äº›ç»éªŒï¼›</p><ul class=""><li id="d941" class="lg lh hi is b it iu ix iy jb li jf lj jj lk jn ll lm ln lo bi translated">æ‚¨å·²ç»å®‰è£…äº†Nodejs LTS</li><li id="7699" class="lg lh hi is b it lp ix lq jb lr jf ls jj lt jn ll lm ln lo bi translated">æ­å»ºExpressjsåº”ç”¨ç¨‹åº</li><li id="ff1c" class="lg lh hi is b it lp ix lq jb lr jf ls jj lt jn ll lm ln lo bi translated">Javascript/typescriptçš„åŸºç¡€çŸ¥è¯†</li><li id="77dc" class="lg lh hi is b it lp ix lq jb lr jf ls jj lt jn ll lm ln lo bi translated">å…³äºORMå¦‚ä½•ä¸æ•°æ®åº“äº¤äº’çš„ä¸€äº›æƒ³æ³•</li></ul><h1 id="c834" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">å±¥è¡Œ</h1><h2 id="eb5f" class="la jp hi bd jq lu lv lw ju lx ly lz jy jb ma mb kc jf mc md kg jj me mf kk mg bi translated">è®©æˆ‘ä»¬è®¾ç½®Express.jsåº”ç”¨ç¨‹åº</h2><ul class=""><li id="1878" class="lg lh hi is b it km ix kn jb mh jf mi jj mj jn ll lm ln lo bi translated">æˆ‘ä»¬å°†é¦–å…ˆä¸ºç”µå½±åˆ—è¡¨APIæ¼”ç¤ºé¡¹ç›®è®¾ç½®Express.jsåº”ç”¨ç¨‹åºã€‚é¦–å…ˆå¯¼èˆªåˆ°ä¸€ä¸ªæ–°æ–‡ä»¶å¤¹ï¼Œç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®:</li></ul><p id="d926" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æˆ‘ä»¬è¿˜å‡è®¾æ‚¨ä½¿ç”¨çš„æ˜¯Unix shell/ç»ˆç«¯</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="69f8" class="la jp hi kw b fi lb lc l ld le">mkdir movies-listing-api<br/>cd movies-listing-api<br/>npm init -y</span></pre><ul class=""><li id="62bc" class="lg lh hi is b it iu ix iy jb li jf lj jj lk jn ll lm ln lo bi translated">æ¥ä¸‹æ¥ï¼Œå®‰è£…Express.jsï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸ºæ˜Ÿçƒå¤§æˆ˜REST APIè®¾è®¡çš„æç®€æ¡†æ¶:</li></ul><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="3f19" class="la jp hi kw b fi lb lc l ld le">npm install --save express</span></pre><ul class=""><li id="b06a" class="lg lh hi is b it iu ix iy jb li jf lj jj lk jn ll lm ln lo bi translated">æ¥ä¸‹æ¥ï¼Œè®¾ç½®typescriptå¼€å‘ä¾èµ–é¡¹</li></ul><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="4e3e" class="la jp hi kw b fi lb lc l ld le">npm install typescript --save-dev<br/>npm install <a class="ae lf" href="http://twitter.com/types/node" rel="noopener ugc nofollow" target="_blank">@types/node</a> --save-dev</span></pre><ul class=""><li id="d409" class="lg lh hi is b it iu ix iy jb li jf lj jj lk jn ll lm ln lo bi translated">æ¥ä¸‹æ¥ï¼Œåˆ›å»ºä¸€ä¸ªtsconfig.jsonæ–‡ä»¶ï¼Œtsconfig.jsonæ˜¯æˆ‘ä»¬å®šä¹‰TypeScriptç¼–è¯‘å™¨é€‰é¡¹çš„åœ°æ–¹ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå¸¦æœ‰å‡ ä¸ªé€‰é¡¹é›†çš„tsconfigã€‚å®ƒåº”è¯¥åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ã€‚</li></ul><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8c01" class="la jp hi kw b fi lb lc l ld le">npx tsc --init --rootDir src --outDir build \<br/>--esModuleInterop --resolveJsonModule --lib es6 \<br/>--module commonjs --allowJs true --noImplicitAny true</span></pre><p id="4415" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ­¤æ—¶ï¼Œæ‚¨åº”è¯¥æœ‰ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„tsconfig.json:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="b6d5" class="la jp hi kw b fi lb lc l ld le">{<br/>  "compilerOptions": {<br/>    /* Basic Options */<br/>    // "incremental": true,                   /* Enable incremental compilation */<br/>    "target": "es5",                          /* Specify ECMAScript target version: 'ES3' (default), 'ES5', 'ES2015', 'ES2016', 'ES2017', 'ES2018', 'ES2019' or 'ESNEXT'. */<br/>    "module": "commonjs",                     /* Specify module code generation: 'none', 'commonjs', 'amd', 'system', 'umd', 'es2015', or 'ESNext'. */<br/>    "lib": ["es6"],                     /* Specify library files to be included in the compilation. */<br/>    "allowJs": true,                          /* Allow javascript files to be compiled. */<br/>    // "checkJs": true,                       /* Report errors in .js files. */<br/>    // "jsx": "preserve",                     /* Specify JSX code generation: 'preserve', 'react-native', or 'react'. */<br/>    // "declaration": true,                   /* Generates corresponding '.d.ts' file. */<br/>    // "declarationMap": true,                /* Generates a sourcemap for each corresponding '.d.ts' file. */<br/>    // "sourceMap": true,                     /* Generates corresponding '.map' file. */<br/>    // "outFile": "./",                       /* Concatenate and emit output to single file. */<br/>    "outDir": "build",                          /* Redirect output structure to the directory. */<br/>    "rootDir": "src",                         /* Specify the root directory of input files. Use to control the output directory structure with --outDir. */<br/>    // "composite": true,                     /* Enable project compilation */<br/>    // "tsBuildInfoFile": "./",               /* Specify file to store incremental compilation information */<br/>    // "removeComments": true,                /* Do not emit comments to output. */<br/>    // "noEmit": true,                        /* Do not emit outputs. */<br/>    // "importHelpers": true,                 /* Import emit helpers from 'tslib'. */<br/>    // "downlevelIteration": true,            /* Provide full support for iterables in 'for-of', spread, and destructuring when targeting 'ES5' or 'ES3'. */<br/>    // "isolatedModules": true,               /* Transpile each file as a separate module (similar to 'ts.transpileModule'). */</span><span id="dd03" class="la jp hi kw b fi mk lc l ld le">/* Strict Type-Checking Options */<br/>    "strict": true,                           /* Enable all strict type-checking options. */<br/>    "noImplicitAny": true,                    /* Raise error on expressions and declarations with an implied 'any' type. */<br/>    // "strictNullChecks": true,              /* Enable strict null checks. */<br/>    // "strictFunctionTypes": true,           /* Enable strict checking of function types. */<br/>    // "strictBindCallApply": true,           /* Enable strict 'bind', 'call', and 'apply' methods on functions. */<br/>    // "strictPropertyInitialization": true,  /* Enable strict checking of property initialization in classes. */<br/>    // "noImplicitThis": true,                /* Raise error on 'this' expressions with an implied 'any' type. */<br/>    // "alwaysStrict": true,                  /* Parse in strict mode and emit "use strict" for each source file. */</span><span id="97e1" class="la jp hi kw b fi mk lc l ld le">/* Additional Checks */<br/>    // "noUnusedLocals": true,                /* Report errors on unused locals. */<br/>    // "noUnusedParameters": true,            /* Report errors on unused parameters. */<br/>    // "noImplicitReturns": true,             /* Report error when not all code paths in function return a value. */<br/>    // "noFallthroughCasesInSwitch": true,    /* Report errors for fallthrough cases in switch statement. */</span><span id="1c5e" class="la jp hi kw b fi mk lc l ld le">/* Module Resolution Options */<br/>    // "moduleResolution": "node",            /* Specify module resolution strategy: 'node' (Node.js) or 'classic' (TypeScript pre-1.6). */<br/>    // "baseUrl": "./",                       /* Base directory to resolve non-absolute module names. */<br/>    // "paths": {},                           /* A series of entries which re-map imports to lookup locations relative to the 'baseUrl'. */<br/>    // "rootDirs": [],                        /* List of root folders whose combined content represents the structure of the project at runtime. */<br/>    // "typeRoots": [],                       /* List of folders to include type definitions from. */<br/>    // "types": [],                           /* Type declaration files to be included in compilation. */<br/>    // "allowSyntheticDefaultImports": true,  /* Allow default imports from modules with no default export. This does not affect code emit, just typechecking. */<br/>    "esModuleInterop": true,                  /* Enables emit interoperability between CommonJS and ES Modules via creation of namespace objects for all imports. Implies 'allowSyntheticDefaultImports'. */<br/>    // "preserveSymlinks": true,              /* Do not resolve the real path of symlinks. */<br/>    // "allowUmdGlobalAccess": true,          /* Allow accessing UMD globals from modules. */</span><span id="377c" class="la jp hi kw b fi mk lc l ld le">/* Source Map Options */<br/>    // "sourceRoot": "",                      /* Specify the location where debugger should locate TypeScript files instead of source locations. */<br/>    // "mapRoot": "",                         /* Specify the location where debugger should locate map files instead of generated locations. */<br/>    // "inlineSourceMap": true,               /* Emit a single file with source maps instead of having a separate file. */<br/>    // "inlineSources": true,                 /* Emit the source alongside the sourcemaps within a single file; requires '--inlineSourceMap' or '--sourceMap' to be set. */</span><span id="3f49" class="la jp hi kw b fi mk lc l ld le">/* Experimental Options */<br/>    // "experimentalDecorators": true,        /* Enables experimental support for ES7 decorators. */<br/>    // "emitDecoratorMetadata": true,         /* Enables experimental support for emitting type metadata for decorators. */</span><span id="f27a" class="la jp hi kw b fi mk lc l ld le">/* Advanced Options */<br/>    "resolveJsonModule": true                 /* Include modules imported with '.json' extension */<br/>  }<br/>}</span></pre><ul class=""><li id="bc33" class="lg lh hi is b it iu ix iy jb li jf lj jj lk jn ll lm ln lo bi translated">æ¥ä¸‹æ¥ï¼Œé€šè¿‡ç­¾å…¥project/srcç›®å½•æ¥è®¾ç½®åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹ï¼Œå¹¶åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶app.tså’Œserver.tsã€‚</li></ul><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="f7a8" class="la jp hi kw b fi lb lc l ld le">mkdir &amp;&amp;  cd src<br/>touch server.ts<br/>touch app.ts</span></pre><p id="b85b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†express routingå’Œhandle APIè¯·æ±‚ï¼Œåº”è¯¥æ˜¯è¿™æ ·çš„:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="d791" class="la jp hi kw b fi lb lc l ld le">#app.ts<br/>import express, { Application } from 'express';</span><span id="612c" class="la jp hi kw b fi mk lc l ld le">// express app<br/>const app: Application = express();</span><span id="64b5" class="la jp hi kw b fi mk lc l ld le">export default app;</span></pre><p id="9204" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¿™ä¸ªNodejsæœåŠ¡å™¨æœåŠ¡äºexpressåº”ç”¨ç¨‹åºï¼Œå¹¶é€šè¿‡process.env.PORTæˆ–8000å…¬å¼€å®ƒã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="f729" class="la jp hi kw b fi lb lc l ld le">#server.ts<br/>import app from './app';</span><span id="0843" class="la jp hi kw b fi mk lc l ld le">// constants<br/>const PORT = process.env.PORT || 8000;</span><span id="be20" class="la jp hi kw b fi mk lc l ld le">// listen<br/>app.listen(PORT, () =&gt; console.log(`âš¡ on <a class="ae lf" href="http://localhost:${PORT}/api`" rel="noopener ugc nofollow" target="_blank">http://localhost:${PORT}/api`</a>));</span></pre><ul class=""><li id="9a6a" class="lg lh hi is b it iu ix iy jb li jf lj jj lk jn ll lm ln lo bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å»ºç«‹ä¸€ä¸ªPostgreSQLæ•°æ®åº“æ¥ä¸ºæ˜Ÿçƒå¤§æˆ˜ç”µå½±APIåˆ›å»ºè¡¨ã€‚</li></ul><h1 id="7a0a" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">ç”¨dockerå»ºç«‹æœ¬åœ°PostgreSQLæ•°æ®åº“</h1><p id="115f" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">åœ¨é¡¹ç›®ç›®å½•çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªPostgresæ˜ åƒï¼Œæ„å»ºè¯¥æ˜ åƒå¹¶è¿è¡Œå®ƒã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="7bb1" class="la jp hi kw b fi lb lc l ld le">touch postgres.yaml</span></pre><p id="369a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">docker-composeæ–‡ä»¶åº”è¯¥æ˜¯è¿™æ ·çš„:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="3a46" class="la jp hi kw b fi lb lc l ld le">version: '3'<br/>services:</span><span id="8e81" class="la jp hi kw b fi mk lc l ld le">postgres:<br/>    # For more details on configuring the Postgres Docker image, see:<br/>    #   <a class="ae lf" href="https://hub.docker.com/_/postgres/" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com/_/postgres/</a><br/>    image: postgres:10.3-alpine #light weight</span><span id="e2d3" class="la jp hi kw b fi mk lc l ld le"># Expose the default Postgres port on localhost<br/>    ports:<br/>      - '5432:5432'<br/>      # allow connections from the host machine<br/>      # an instance of the postgres image = postgres_docker(container)<br/>    network_mode: bridge # port available on localhost <br/>    container_name: postgres_docker</span><span id="5fde" class="la jp hi kw b fi mk lc l ld le">environment:<br/>      POSTGRES_USER: 'postgres'<br/>      POSTGRES_PASSWORD: 'pgpass'<br/>      POSTGRES_DB: 'postgres'</span><span id="f485" class="la jp hi kw b fi mk lc l ld le"># Copy files from dbinit into the image so that they will be run on boot<br/>    # mount db<br/>    volumes:<br/>      - ./initdb:/docker-entrypoint-initdb.d</span></pre><p id="bdf0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">å¦‚æœæ‚¨æƒ³ç”¨Dockerè¿è¡ŒPostgreSQLæ•°æ®åº“ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="354e" class="la jp hi kw b fi lb lc l ld le">docker compose -f postgres.yaml up</span></pre><p id="9171" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">docker runå‘½ä»¤åˆ›å»ºä¸€ä¸ªåä¸ºpostgres_dockerçš„æ–°dockerå®¹å™¨ï¼Œå°†å®¹å™¨ç«¯å£5432æš´éœ²ç»™æœ¬åœ°ç«¯å£5432ã€‚</p><p id="4ccc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æˆ‘ä»¬çš„æ•°æ®åº“å·²ç»è¿è¡Œäº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŠŠPrismaæ·»åŠ åˆ°Node.jsé¡¹ç›®ä¸­ï¼Œå¹¶åˆ›å»ºæˆ‘ä»¬çš„æ¨¡å¼ã€‚</p><h1 id="d82d" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">å°†Prisma ORMå®‰è£…åˆ°Node.jsé¡¹ç›®ä¸­</h1><p id="d168" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°†Prismaå®‰è£…ä¸ºdevä¾èµ–é¡¹</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="066b" class="la jp hi kw b fi lb lc l ld le">npm install prisma --save-dev</span></pre><p id="c3b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ä¹‹åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆå§‹åŒ–Prismaæ¨¡å¼:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="93cc" class="la jp hi kw b fi lb lc l ld le">npx prisma init</span></pre><p id="09a4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ¥ä¸‹æ¥ï¼Œå°†æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²æ·»åŠ åˆ°envæ–‡ä»¶ä¸­ï¼Œå®ƒåº”è¯¥æ˜¯è¿™æ ·çš„:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="e269" class="la jp hi kw b fi lb lc l ld le">#.env<br/>DATABASE_URL="postgresql://postgres:pgpass@localhost:5432/movies_storage?schema=public"</span></pre><h1 id="5611" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">æ·»åŠ æ¨¡å‹å¹¶è¿è¡ŒPrismaè¿ç§»</h1><p id="ef8a" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">æ ¹ç›®å½•ä¸‹çš„prismaæ–‡ä»¶å¤¹åŒ…å«prisma.schemaæ–‡ä»¶ï¼Œåœ¨å…¶ä¸­æˆ‘ä»¬å®šä¹‰äº†ç”µå½±å’Œç”¨æˆ·çš„æ•°æ®åº“è¡¨ä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="d99f" class="la jp hi kw b fi lb lc l ld le">datasource db {<br/>  provider = "postgresql"<br/>  url      = env("DATABASE_URL")<br/>}</span><span id="bd32" class="la jp hi kw b fi mk lc l ld le">generator client {<br/>  provider = "prisma-client-js"<br/>}</span><span id="d422" class="la jp hi kw b fi mk lc l ld le">model Movie {<br/>  id        Int      <a class="ae lf" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a> <a class="ae lf" href="http://twitter.com/default" rel="noopener ugc nofollow" target="_blank">@default</a>(autoincrement())<br/>  title   String <a class="ae lf" href="http://twitter.com/unique" rel="noopener ugc nofollow" target="_blank">@unique</a><br/>  description     String</span><span id="d540" class="la jp hi kw b fi mk lc l ld le">createdAt DateTime <a class="ae lf" href="http://twitter.com/default" rel="noopener ugc nofollow" target="_blank">@default</a>(now())<br/>}</span></pre><p id="662f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æˆ‘ä»¬å·²ç»å‘æ¨¡å¼ä¸­æ·»åŠ äº†ä¸€ä¸ªè¡¨ã€‚Moviesè¡¨ï¼Œå®ƒæœ‰ä¸€ä¸ªè‡ªåŠ¨é€’å¢çš„IDã€å¿…é¡»å”¯ä¸€çš„titleå­—æ®µã€descriptionå’Œé»˜è®¤ä¸ºå½“å‰æ—¥æœŸçš„createdAtå­—æ®µã€‚</p><p id="35f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¦å°†è¿™äº›æ¨¡å‹è½¬æ¢ä¸ºPostgreSQLæ•°æ®åº“è¡¨ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="471b" class="la jp hi kw b fi lb lc l ld le">prisma migrate dev --name init --preview-feature</span></pre><p id="3218" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">è¿™å°†ç”Ÿæˆè¿ç§»æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«åœ¨PostgreSQLæ•°æ®åº“ä¸­åˆ›å»ºè¡¨çš„SQLã€‚</p><h1 id="60a6" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">ä¸ç”µå½±åˆ—è¡¨äº¤äº’çš„API</h1><p id="57ee" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">æˆ‘ä»¬å°†æ›´æ–°åœ¨ä¸Šä¸€æ­¥ä¸­åˆ›å»ºçš„app.tsæ–‡ä»¶ï¼Œå¹¶æ·»åŠ POST Movieså’ŒGET Movies APIã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="d828" class="la jp hi kw b fi lb lc l ld le">const app: Application = express();</span><span id="17d1" class="la jp hi kw b fi mk lc l ld le">import { PrismaClient } from '<a class="ae lf" href="http://twitter.com/prisma/client" rel="noopener ugc nofollow" target="_blank">@prisma/client</a>';<br/>const prisma = new PrismaClient();</span><span id="8b29" class="la jp hi kw b fi mk lc l ld le">app.get('/', (req, res) =&gt; {<br/>  res.json({message: 'alive'});<br/>});</span><span id="c0f9" class="la jp hi kw b fi mk lc l ld le">app.post('/movies', async (req, res) =&gt; {<br/>  const {title, description} from 'req.body';<br/>await prisma.movie.create({<br/>     data: {<br/>     title,<br/>     description,<br/>}<br/>    });<br/>   res.json({<br/>    message: "movie created"<br/>  });<br/>});</span><span id="a402" class="la jp hi kw b fi mk lc l ld le">app.get('/movies:id', async (req, res) =&gt; {<br/>const movie =  await prisma.movie.findUnique({<br/>   where:{<br/>   id: req.params.id<br/>},<br/>  });</span><span id="c2d7" class="la jp hi kw b fi mk lc l ld le">res.json({<br/>    data: movie,<br/>  });<br/>}</span><span id="c24b" class="la jp hi kw b fi mk lc l ld le">app.get('/movies', async (req, res) =&gt; {</span><span id="2961" class="la jp hi kw b fi mk lc l ld le">const allMovies =  await prisma.movie.findMany({});</span><span id="69ea" class="la jp hi kw b fi mk lc l ld le">res.json({<br/>    data: allMovies,<br/>  });<br/>});</span><span id="a81a" class="la jp hi kw b fi mk lc l ld le">export default app;</span></pre><h1 id="07eb" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">æ€»ç»“</h1><p id="36a5" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">æˆ‘ä»¬ç”¨Express.js+typescriptå’ŒPrisma ORMæ„å»ºäº†ä¸€ä¸ªç”µå½±åˆ—è¡¨APIï¼Œä½¿ç”¨çš„æ˜¯è¿è¡Œåœ¨Dockerä¸Šçš„PostgreSQLæ•°æ®åº“ã€‚æˆ‘çŸ¥é“æˆ‘ä»¬ä»…ä»…è§¦åŠäº†Prismaæ‰€æä¾›çš„è¡¨é¢ï¼Œå°½ç®¡å¦‚æ­¤ï¼Œæˆ‘å¸Œæœ›è¿™èƒ½ç»™ä½ ä¸€äº›å…³äºå°†Prisma ORMæ·»åŠ åˆ°ä½ çš„Nodejsåº”ç”¨ç¨‹åºçš„è§è§£ã€‚</p><p id="2678" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æœ€åï¼Œæˆ‘å»ºè®®ä½ è¿›ä¸€æ­¥æ¢ç´¢ä¸€äº›ä¼Ÿå¤§çš„Prisma ORMç‰¹æ€§ã€‚ä¾‹å¦‚ï¼ŒæŸ¥è¯¢ä¼˜åŒ–ã€æ•°æ®åº“äº‹åŠ¡å’ŒèšåˆæŸ¥è¯¢éƒ½æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚</p><p id="188d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">æ„Ÿè°¢è§‚ä¼—ï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ğŸ¤—ã€‚ä½ å¯ä»¥éšæ—¶åœ¨Githubã€T2ã€æ¨ç‰¹å’ŒT4çš„LinkedInä¸Šè”ç³»æˆ‘ã€‚ä¸€å®šè¦ç‚¹èµã€è¯„è®ºå’Œåˆ†äº«ğŸ˜Œã€‚</p><p id="c717" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ç¼–ç å¿«ä¹ï¼</p></div><div class="ab cl ml mm gp mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hb hc hd he hf"><p id="be24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ms">æœ€åˆå‘å¸ƒäº</em><a class="ae lf" href="https://blog.nextwebb.tech/getting-started-with-prisma-orm-for-nodejs" rel="noopener ugc nofollow" target="_blank"><em class="ms">https://blog . next Webb . tech</em></a><em class="ms">ã€‚</em></p></div></div>    
</body>
</html>